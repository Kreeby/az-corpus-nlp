Коцюбинский А.О., Грошев С.В.
ля бухгалтера
п р и м е р а хf j
лавбух
Коцюбинский А. О., Грошев С. В.
EXCEL ДЛЯ БУХГАЛТЕРА
В ПРИМЕРАХ

Б У Х Г А Л Т Е Р С К А Я П А Н О Р А М А
Коцюбинский А.О., Грошев С.В.
EXCEL ДЛЯ БУХГАЛТЕРА
В ПРИМЕРАХ
Т|лавбух
МОСКВА 2003
УДК 657
ББК 65.052
К11
Коцюбинский А.О., Грошев С.В.
К 11 Excel для бухгалтера в примерах. - М.: ЗАО «Издательский Дом «Глав-
бух». — 2003. - 240 с. — («Бухгалтерская панорама»)
ISSN 0234-543-9-29
Данная книга поможет освоить электронные таблицы Excel, причем особое внимание уделя-
ется практическим вопросам повседневного использования Excel в работе бухгалтера. Книга пред-
назначена для широкого круга читателей, как только начавших изучение Excel, так и достаточно
опытных пользователей, повышающих свою квалификацию.
Основы работы с электронными таблицами Excel изложены в первой главе книги. В ней
представлены основные понятия и правила работы, подробно описан процесс создания и редак-
тирования таблиц, а также особенности их оформления. Отдельный раздел посвящен расчетам
в электронных таблицах. Во второй главе книги описаны особенности Excel, полезные бухгалтеру.
Рассмотрены разные средства автоматизации работы и повышения эффективности использова-
ния Excel, использование списков, сложных формул и сводных таблиц. Также описана работа
с формами, рисунками и диаграммами.
Третья глава целиком посвящена примерам использования Excel в бухгалтерии. Известно,
что лучше изучать приемы работы с программой на примерах, и бухгалтеру понятнее примеры из
его профессиональной области. Описано создание бухгалтерских бланков и автоматизация со-
ставления документов, проведение анализа и поиск приемлемых решений. Также описана авто-
матизация отдельных направлений деятельности и связь Excel с популярными бухгалтерскими
программами. Многочисленные примеры не только облегчат изучение Excel, но и могут быть ис-
пользованы в работе, практически без каких-либо доработок. Вы легко сможете автоматизиро-
вать расчет зарплаты, учет поставок и наличия товаров, учет и амортизацию основных средств,
расчет себестоимости и многие другие операции, воспользовавшись предлагаемыми электрон-
ными таблицами. В четвертой главе описаны примеры ведения бухгалтерского, налогового и уп-
равленческого учета в Excel.
УДК 657
ББК 65.052
ISSN 0234-543-9-29 © ЗАО «Издательский Дом «Главбух», 2003
СОДЕРЖАНИЕ
ГЛАВА 1. ОСНОВЫ РАБОТЫ С ЭЛЕКТРОННЫМИ ТАБЛИЦАМИ EXCEL 7
/./. Знакомство с Excel 7
1.1.1. Основные термины и принципы работы 7
1.1.2. Знакомство с программой 9
1.1.3. Предварительная настройка 11
1.2. Создание и редактирование таблиц 13
1.2.1. Создание, сохранение и открытие рабочих книг 13
1.2.2. Работа с книгами и листами 16
1.2.3. Ввод данных в таблицы 19
1.2.4. Передвижение по таблицам и выбор данных 21
1.2.5. Редактирование данных 24
1.2.6. Печать электронных таблиц 27
1.3. Оформление электронных таблиц 33
1.3.1. Форматирование листов 33
1.3.2. Использование числовых форматов 43
1.3.3. Форматирование ячеек по заданным условиям 45
1.4. Расчеты в электронных таблицах 47
1.4.1. Формулы в Excel 47
1.4.2. Работа с формулами 49
1.4.3. Обзор полезных функций 57
ГЛАВА 2. ОСОБЕННОСТИ EXCEL, ПОЛЕЗНЫЕ БУХГАЛТЕРУ 67
2.1. Особенности работы с формулами 67
2.1.1. Финансовые функции в Excel 67
2.1.2. Использование ссылок и имен в формулах 74
2.1.3. Примеры построения формул 76
2.2. Работа со списками 78
2.2.1. Создание и редактирование списков 78
2.2.2. Отбор записей 80
2.2.3. Сортировка списка 82
2.3. Автоматизация ввода данных 85
2.3.1. Автоматический ввод и заполнение ячеек 85
2.3.2. Проверка вводимых данных 90
2.4. Импорт данных 93
2.4.1. Получение информации из бухгалтерских программ 93
2.4.2. Связь с иными источниками данных 97
2.5. Использование сводных таблиц 102
2.5.1. Создание сводных таблиц 102
2.5.2. Расчет итогов... 105
Содержание
2.5.3. Структуризация и консолидация данных 107
2.5.4. Проведение анализа НО
2.6. Выполнение анализа «что, если» 114
2.6.1. Подбор параметра 115
2.6.2. Поиск решения 116
2.6.3. Использование сценариев 118
2.7. Работа с формами 120
2.7.1. Использование мастера шаблонов 120
2.7.2. Работа с формами 123
2.8. Работа с рисунками и диаграммами 124
2.8.1. Рисунки в таблицах 124
2.8.2. Создание диаграмм 140
2.8.3. Работа с диаграммами 145
2.9. Повышение эффективности работы 151
2.9.1. Автоматизация работы 151
2.9.2. Защита информации 154
2.9.3. Совместная работа 156
2.9.4. Примечания и прочие средства повышения эффективности 158
ГЛАВА 3. ПРИМЕРЫ ИСПОЛЬЗОВАНИЯ EXCEL В БУХГАЛТЕРИИ 167
3.1. Бухгалтерские бланки и отдельные расчеты 167
3.1.1. Оформление стандартных бухгалтерских бланков 167
3.1.2. Использование программы печати суммы прописью 171
3.1.3. Расчет покупки товара в кредит 177
3.1.4. Объединение таблиц с автоматизацией расчетов 180
3.1.5. Расчет авторского вознаграждения 182
3.2. Автоматизация составления документов 185
3.2.1. Автоматическое составление сметы и расчет себестоимости 185
3.2.2. Автоматизация создания платежных поручений 190
3.3. Автоматизация отдельных направлений деятельности 192
3.3.1. Автоматизация учета амортизации основных средств 193
3.3.2. Автоматизация учета расчета зарплаты 195
3.3.3. Учет поставок товаров и услуг потребителям 201
3.3.4. Автоматизация складского учета 204
3.4. Проведение анализа и поиск приемлемых решений 211
3.4.1. Оптимизация сроков и объемов производства или закупок 211
3.4.2. Управление оборотным капиталом 215
3.5. Связь с бухгалтерскими программами 219
ГЛАВА 4. БУХГАЛТЕРСКИЙ, НАЛОГОВЫЙ И УПРАВЛЕНЧЕСКИЙ УЧЕТ В EXCEL 221
4.1. Пример бухгалтерского учета 221
4.2. Ведение налогового учета с помощью Excel 231
4.3. Пример управленческого учета 235
ГЛАВА1.
ОСНОВЫ РАБОТЫ
С ЭЛЕКТРОННЫМИ ТАБЛИЦАМИ EXCEL
В своей работе бухгалтеру приходится выполнять много расчетов и для это-
го можно использовать электронные таблицы. Электронные таблицы похожи на
обычные таблицы, которые вы рисуете на бумаге. Единственным отличием явля-
ется то, что расчеты в электронных таблицах происходят автоматически после
того, как вы скажете программе, что нужно делать.
1.1. Знакомство с Excel
Перед тем, как начать работу с электронными таблицами Excel, нужно озна-
комиться с основными принципами такой работы. После того, как используе-
мые понятия и принципы работы станут вам понятны, можно начать освоение
программы Excel.
1.1.1. Основные термины и принципы работы
Любая таблица состоит из множества строк и столбцов, на пересечении котог
рых расположена разнообразная информация. Электронная таблица также состо-
ит из строк и столбцов. Элемент, расположенный на их пересечении, называется
ячейкой таблицы. Любая электронная таблица состоит из множества ячеек.
В ячейке электронной таблицы могут располагаться текст или числа, как и в обыч-
ных таблицах. Основное отличие электронных таблиц от обычных — наличие фор-
Основы работы с электронными таблицами Excel
мул в некоторых ячейках. Эти формулы используют информацию из разных ячеек
и получают нужный результат, причем все вычисления выполняются автоматиче-
ски. Достаточно ввести исходные данные и формулы, и сразу будет получен ре-
зультат. Электронные таблицы значительно удобнее калькулятора, так как позво-
ляют одновременно выполнять множество вычислений в разных ячейках.
В программе Excel в одном файле может находиться несколько таблиц. Каж-
дая таблица расположена на отдельном листе, а несколько листов, хранящихся в
одном файле, называются рабочей книгой. Рабочая книга является основным
документом, с которым работает Excel. В рабочей книге может быть столько ли-
стов, сколько вам нужно для работы, и вы можете создавать или удалять листы
при необходимости. При этом информацию в различные листы можно вносить
независимо от других листов. Но если вам нужно, вы можете связывать инфор-
мацию из различных листов рабочей книги друг с другом. Иногда бывает нужно
вводить или изменять информацию сразу в нескольких листах рабочей книги, и
вы также можете это сделать.
Ряд ячеек таблицы, расположенный горизонтально называется строкой, а
ячейки расположенные вертикально образуют столбец. В электронной таблице
строки и столбцы пронумерованы. Каждая ячейка в таблице находится на пере-
сечении строки и столбца. Указав номер столбца и номер строки, на пересечении
которых расположена ячейка, вы однозначно определите расположение ячейки.
Таким образом, номер строки и столбца образуют адрес ячейки.
Есть несколько способов нумерации строк и столбцов. По умолчанию ис-
пользуется принцип нумерации, названный в программе стилем А1. В этом слу-
чае столбцы нумеруются буквами, а строки — числами. Например, ячейка в пер-
вой строке второго столбца имеет адрес В1. Эти буквы и числа называются заго-
ловками столбцов и строк. Можно использовать одинаковую нумерацию, как
строк, так и столбцов, и такой стиль нумерации называется R1C1. При использо-
вании этого способа нумерации адрес ячейки записывается как буква R и число-
вой номер строки, а затем буква С и числовой номер столбца. Например, адрес
R3C4 указывает на ячейку, находящуюся на пересечении третьей строки и чет-
вертого столбца. Буквы — это сокращения от английских слов Row — строка и
Column - столбец. В большинстве случаев используется первый способ адреса-
ции ячеек, и мы в нашей книге будем придерживаться именно этого способа.
Ниже мы опишем, как настроить программу, чтобы работать со стилем адреса-
ции А1.
Размер таблицы заранее не определен. Максимальное число строк таблицы
составляет 65536, и этого вполне достаточно для работы. Столбцы нумеруются
буквами, но букв в латинском алфавите очень мало, всего 26. Столбцы с первого
по двадцать шестой обозначаются буквами с А по Z. Для обозначения имен
столбцов, начиная с двадцать седьмого, используют сочетание двух букв. Так,
столбец 27 обозначается АА, следующий АВ, а после названия AZ идет сочетание
букв ВА, ВВ и так далее. Максимальное число столбцов в таблице Excel равно
256, что соответствует адресу IV.
Знакомство с Excel
Итак, адрес ячейки состоит из имени №»
столбца и номера строки, на пересече-
нии которых она находится, например
A3 (Рис. 1.1). Здесь А представляет со-
бой номер столбца, он расположен в адре-
се ячейки первым, а цифра 3 — это но-
мер строки, и он расположен в адресе Рис. 1.1. Адрес ячейки
вторым.
В ячейках электронной таблицы могут храниться числа, текст или формулы.
Числа используются в расчетах, и в программе есть много способов представле-
ния чисел, например, дата отличается от процента и от обычного числа. Текст
обычно вводят в ячейки для пояснений, и эти пояснения делают таблицу более
понятной. С помощью формул производят вычисления с числами из любых яче-
ек. Часто используются такие формулы, как суммирование, вычисление средних
величин и процентов. Однако в электронных таблицах можно вести и более
сложные расчеты.
Особенностью электронных таблиц является то, что после ввода формулы, в
ячейке немедленно появляется результат. Если вы измените информацию в таб-
лице, формулы будут автоматически пересчитаны, и в ячейках появятся новые
результаты. Если формула содержит ошибку, вы об этом сразу же узнаете.
Вы можете оформить таблицу, изменив внешний вид ячеек и информацию
в них, то есть отформатировать таблицу. Если вы знакомы с текстовыми редакто-
рами, например с Word, форматирование ячеек таблицы покажется вам очень
простым. Можно изменить представление чисел, внешний вид и размер надпи-
сей, выбрать цвет, которым будет отображаться информация. С помощью фор-
матирования вы можете создавать красиво оформленные таблицы, а также раз-
личные бланки, вид которых заранее определен.
1.1.2. Знакомство с программой
Чтобы запустить программу Excel, следует выбрать команду главного меню
Windows Пуск т£> Все программы :£> Microsoft Excel. В предыдущих версиях
Windows, вместо команды Все программы, нужно выбирать команду Программы.
После запуска программы на экране появится ее рабочее окно (Рис. 1.2). Хотя
мы в иллюстрациях используем версию Excel 2002, входящую в состав пакета
программ Microsoft Office XP, вы можете с помощью нашей книги также освоить
версии Excel 97 и 2000. Большинство приемов работы с любой версией одинако-
вы, а если есть отличия, мы обязательно их отметим. Если же вы используете бо-
лее раннюю версию, чем описанные в книге, рекомендуем обновить ее. Лучше
работать с последней версией программы Excel 2002.
В верхней части окна программы располагается заголовок, в котором указа-
но название программы, а также имя рабочей книги, с которой вы в данный мо-
Щ Создание
Ц! Q Чистая книге
' ..: Создание из имеющейся книги
Основы работы с электронными таблицами Excel
Меню ^Панели инструментов^, Строка формул
Номера столбцов
Панель задач
Активная ячейка
Полосы прокрутки
Строка состояния
/. Ярлычки листов\_Номера строк
Рис. 1.2. Рабочее окно программы Excel
мент работаете. По умолчанию используется имя Книга!, но вы можете изменить
его по своему желанию.
Ниже заголовка располагается меню, в котором вы выбираете различные
команды при работе с программой. Если вы используете Excel 2000 или 2002, в
меню отображаются только часто используемые команды. Редко используемые
команды убираются из меню и становятся невидимыми. При этом в нижней ча-
сти меню находится изображение стрелки ̂ . Чтобы увидеть все команды меню,
следует щелкнуть мышью на этой стрелке. В Excel 97 показываются все коман-
ды меню.
А как узнать, какой версией программы вы пользуетесь? При запуске про-
граммы на короткое время появляется окно, в котором отображается версия про-
граммы. Во время работы можно узнать о версии программы, выбрав команду ме-
ню Справка э£> О программе. Будет открыт диалог с информацией о версии про-
граммы и другими данными. Чтобы закрыть диалог, нажмите в нем кнопку ОК.
В центральной части рабочего окна располагается сама таблица, с которой
вы работаете. Работа с таблицей заключается во вводе в ячейки нужной инфор-
мации и просмотре результатов вычислений в формулах. Ячейка, с которой вы в
данный момент работаете, называется активной ячейкой, и она выделена в таб-
лице жирной рамкой. Чтобы сделать ячейку активной, следует щелкнуть на ней
мышью. Часто размер таблицы превышает размер окна программы, и часть яче-
ек не видна. Чтобы увидеть нужную ячейку вам может понадобиться переме-
щаться по таблице. Перемещение осуществляется с помощью полос прокрутки.
О том, как это делать, вы узнаете ниже.
10
Знакомство с Excel
Ниже меню располагаются панели инструментов с кнопками для выполне-
ния различных действий. Программа Excel имеет несколько панелей, объединя-
ющих инструменты по какому-либо признаку. Более подробно мы рассмотрим
панели инструментов ниже. Между таблицей и панелями инструментов располо-
жена строка формул, предназначенная для ввода в ячейки таблицы текста, чисел
или формул. Адрес ячейки, в которую вводится информация, отображается в ле-
вой части строки формул.
Если вы используете Excel 2002, в правой части рабочего окна расположе-
на панель задач, которая содержит список команд, облегчающих работу с таб-
лицей. Во многом команды этой панели дублируют команды меню программы,
но есть и дополнительные команды. Где это возможно, мы будет рассказывать,
как использовать панель задач, но при этом обязательно расскажем, как вы-
полнить действие и без использования панели задач в предыдущих версиях
программы.
В нижней части рабочего окна находятся ярлычки для выбора нужного ли-
ста из рабочей книги. У каждого листа книги есть имя, и по умолчанию создает-
ся книга с тремя листами — JIucml, JIucm2 и ЛистЗ. Вы можете создавать и уда-
лять листы из рабочей книги, менять имена листов по вашему вкусу. Чтобы ото-
бразить на экране лист рабочей книги, следует щелкнуть мышью на ярлычке
этого листа.
В нижней части рабочего окна находится строка состояния. В этой строке
отображается информация: о состоянии программы, статистическая информа-
ция о рабочем листе, а также результаты некоторых вычислений.
1.1.3. Предварительная настройка
Внешний вид рабочего окна программы Excel может значительно различать-
ся в зависимости от версии и настройки программы. Вначале выполним некото-
рые настройки, чтобы вид окна был похож на описываемый нами, а также, что-
бы работать с Excel стало удобнее. Скорее всего, все настройки у вас не отлича-
ются от описываемых нами, и вам ничего не надо будет менять.
Выберите команду меню Bud X£> Панели инструментов, и во вложенном ме-
ню будет выведен список доступных панелей инструментов. В этом списке
флажками отмечены панели инструментов, которые отображаются на экране.
Если флажок сброшен, панель не отображается. Чаще всего используется панель
инструментов Стандартная и панель Форматирование. Убедитесь, что около
этих команд в меню установлены флажки. При необходимости щелкните мы-
шью на соответствующей команде меню, чтобы установить флажок. После того,
как вы установите флажок, вложенное меню будет закрыто, и панель инструмен-
тов появится в окне программы.
В дальнейшем мы в основном будет использовать стандартную панель ин-
струментов и панель форматирования, но может случиться, что вы не найдете
II
Основы работы с электронными таблицами Excel
нужный вам инструмент в этих панелях. Посмотрите внимательно на эти па-
нели инструментов на экране. Если вы увидите в панелях значок Л, значит,
показаны не все инструменты в панели. Щелкните мышью на этом значке, и вы
увидите кнопки, которые ранее были не видны. Нажмите нужную кнопку, и по-
сле выполнения команды, эта кнопка останется на панели инструментов.
Но при этом будет скрыта какая-либо другая кнопка. Размер экрана иногда не
позволяет отобразить панель инструментов полностью, и часть кнопок бывает
скрыта.
После того, как на экране появились часто используемые панели инстру-
ментов, настроим программу, чтобы отображалась строка состояния. В этой
строке выводится некоторая по-
лезная информация, а также ре-
зультаты некоторых вычислений.
Выберите команду меню Сервис
э£> Параметры, и будет открыт
диалог настройки параметров.
Щелкните мышью на ярлычке
Вид, чтобы перейти на нужную
Прааи j Общие
Отображать - - . -
ЧУ область задач при запуск* р' строку формул
Примечания •
Г не отображать
ЗЗ -̂ЗЖ,- • • • BBfflWHOfifh
Перепад ] cmtcui ] Диаграмме | Цвет
f строку ссетояния Г '̂ окна на двнепи задай
прокрутки
прокрутки
Рис. 1.3.
Настройка внешнего вида программы
вкладку (Рис. 1.3).
Убедитесь, что в группе эле-
ментов управления Отображать,
установлен флажок Строка со-
стояния. Если это не так, устано-
вите флажок. Также установите
флажок Строка формул, если он
сброшен. Эти элементы обязательно должны быть видны при работе с програм-
мой. Щелкните мышью на ярлычке Общие, чтобы перейти на одноименную
вкладку. Убедитесь, что в группе элементов управления Параметры, сброшен
флажок Стиль ссылок R1C1. Если этот флажок установлен, и строки и столбцы
нумеруются только цифрами. Значительно удобнее использовать нумерацию
буквами и цифрами, которую мы и используем в нашей книге.
Щелкните мышью на ярлычке Правка, чтобы перейти на одноименную
вкладку. Установите флажок Правка прямо в ячейке, если он не установлен. Так-
же установите флажок Перетаскивание ячеек. Установив флажок Переход к другой
ячейке после ввода, вы сделаете доступным открывающийся список для выбора
направления перехода. По умолчанию, после ввода информации в ячейку, актив-
ной становится ячейка, расположенная в том же столбце, но ниже текущей ячей-
ки. Такой переход используется в большинстве случаев, и мы рекомендуем вы-
брать в списке положение Вниз. Однако для вас может оказаться удобным и дру-
гое направление перемещения при вводе информации. В этом случае выберите
в открывающемся списке нужное направление.
В диалоге вы можете настроить самые разные параметры, но в большинстве
случаев подойдут настройки, принятые по умолчанию. В дальнейшем, после
12
Создание и редактирование таблиц
освоения Excel, вы можете попробовать самостоятельно изменить некоторые
настройки, но пока лучше этого не делать. После того, как заданы все нужные
параметры, нажмите кнопку ОК, чтобы закрыть диалог. Выбранные вами наст-
ройки вступят в силу. Теперь можно приступать к работе с программой. Сначала
рассмотрим, как создавать и сохранять таблицы, а также как вводить и редакти-
ровать информацию в ячейках.
1.2. Создание и редактирование таблиц
Чтобы работать с таблицей нужно ее создать. В программе есть несколько
способов создания таблиц. По окончании работы нужно сохранить таблицу на
диске. В дальнейшем вы сможете загрузить таблицу в программу, и продолжить
работу с ней, редактируя содержимое ячеек и вводя новую информацию.
1.2.1. Создание, сохранение и открытие рабочих книг
После того, как программа запущена, автоматически создается пустая рабо-
чая книга, и вы сразу же можете приступать к работе. О том, как работать с таб-
лицей вы узнаете ниже, а пока отметим, что работа заключается в добавлении
информации, редактировании ранее введенной информации и других аналогич-
ных действиях.
По окончании работы с рабочей книгой, ее нужно сохранить. Для этого
нажмите кнопку Щ на панели инструментов или выберите команду меню Файл
з£> Сохранить. На экране появится диалог настройки сохранения документа
(Рис. 1.4). Внешний вид диалога может сильно различаться в разных версиях
Excel, но принципы работы с ним одни и те же.
По умолчанию для сохранения документов, программа предлагает папку
Мои документы. Лучше в ней и сохра-
нять рабочие книги, в этом случае вы
всегда будет знать, где искать их. Ес-
ли вы работаете с множеством элек-
тронных таблиц, желательно создать
в папке Мои документы несколько
вложенных папок, и в них сохранять
создаваемые таблицы. Если же вас не
устраивает папка Мои документы, вы
можете выбрать в списке Папка нуж-
ный диск, а в центральной части диа-
лога выбрать папку для сохранения.
Далее нужно указать имя для сохра-
няемой рабочей книги. По умолча-
j мои документы 3 : Hi-в | ЫЭ-
•О Corel User Ffcs
't.jMs' Virtual Machines
|£3мои видеозаписи
Ля) Мои источники данных
?!, Мои рисунки
[И Моя музыка
,! jGj Рабочая папка №1
,. ^Рабочая папка №2
Рис. 1.4. Сохранение рабочей книги
13
Основы работы с электронными таблицами Excel
I. -м
.: |ёэоы
" ^ баланс 2«tt'
. }®6аланс 2002
{^Расчеты по юнгам
нию программа предлагает имя Книга!, но вы можете изменить это имя, введя
новое имя в поле Имя файла. В заключение нажмите кнопку Сохранить, диалог
будет закрыт, а рабочая книга будет сохранена.
Во время работы над таблицей вы можете сохранить ее в любой момент. Для
этого достаточно еще раз нажать кнопку Q на панели инструментов или вы-
брать команду меню Файл з£> Сохранить. Однако теперь диалог сохранения не
будет появляться. Программа уже знает, куда следует сохранять рабочую книгу, и
будет делать это без лишних вопросов. Если вы хотите сохранить рабочую книгу
под другим именем, нужно выбрать команду меню Файл Х£> Сохранить как. Бу-
дет опять открыт диалог сохранения, в котором вы можете выбрать папку и ука-
зать новое имя для рабочей книги.
Для открытия ранее созданного и сохраненного документа Excel нужно на-
жать кнопку [j£ на панели инструментов, или выбрать команду меню Файл Х£>
Открыть. На экране появится диалог
открытия документа (Рис. 1.5). По
умолчанию в диалоге показывается со-
держимое папки Мои документы. Если
вы храните свои таблицы в этой папке,
просто выберите нужный файл, щелк-
нув на нем мышью в центральной час-
ти диалога. Если вы храните докумен-
ты в других папках, перейдите к нуж-
ной папке, как и при сохранении рабо-
чей таблицы. После выбора папки, в
центральной части диалога появится
список документов, расположенных в
этой папке. Выберите документ, щелк-
нув на нем мышью. В заключение, на-
жмите кнопку Открыть, чтобы загрузить документ в программу и закрыть диалог.
В некоторых версиях программы в правой части диалога открытия и сохра-
нения документов, появляется панель папок. Щелкнув мышью на папке Журнал,
вы откроете список документов, с которыми вы работали в последнее время.
Щелкнув мышью на папке Мои документы, вы откроете основную папку для
хранения ваших документов. Щелкнув мышью на папке Избранное, вы откроете
список документов в специальной папке со ссылками на важные документы. Ес-
тественно, решать, важен для вас документ или нет, должны вы, так же как и по-
мещать документы в список избранного.
В программе Excel 2002 кнопка Открыть является составной. Нажмите
кнопку » в правой части кнопки Открыть, и вы откроете вспомогательное ме-
ню. Выбирая команды этого меню, вы можете открыть документ, открыть доку-
мент только для чтения или открыть документ как копию.
По окончании работы с документом его необходимо закрыть. Для этого вы-
берите команду меню Файл з£> Закрыть. Если в документе были сделаны изме-
мок с«йвое
окружение
L...J"
Ttwf файлов: jece файлы Microsoft Excel
Рис. 1.5. Открытие документа
14
Создание и редактирование таблиц
СМ. -МКМ*|
Авансовый отчет
Рис. 1.6. Выбор готового шаблона
нения, появится диалог с предло-
жением сохранить изменения. Ес-
ли вы хотите, чтобы ваша работа
была сохранена для последующего
использования, нажмите кнопку
Да в этом диалоге. В противном
случае, нажмите кнопку Нет. Если
вы решите продолжить работу с
документом сейчас, нажмите
кнопку Отмена. В любом случае
документ, с которым вы работали,
будет закрыт.
Вместе с программой Excel по-
ставляется несколько заготовок, которые вы можете использовать для создания
своих документов. Эти заготовки называются шаблонами, и их количество зависит
от версии Excel. Чтобы воспользоваться готовым шаблоном, выберите команду
меню Файл :£> Создать. Если вы работаете с Excel 2002, в правой части рабочего
окна появится панель задач, в которой нужно выбрать команду Общие заготовки.
Будет открыт диалог выбора заготовок (Рис. 1.6). В предыдущих версиях програм-
мы, этот диалог появится сразу после выбора команды меню Файл э£> Создать.
На вкладке Общие показано содержимое папки, в которой располагаются ос-
новные шаблоны. При необходимости вы можете создать свой собственный шаб-
лон и поместить его в эту папку. Тогда он также появится в списке. На вкладке Ре-
шения вам предлагается ряд вариантов построения типовых форм. Количество ва-
риантов для выбора заготовки зависит от версии программы и от полноты ее ус-
тановки. Щелкните мышью на шаблоне, и в области предварительного просмот-
ра вы увидите уменьшенный вариант таблицы, шаб-
лон которой вы собираетесь загрузить. После выбо-
ра нужного шаблона нажмите кнопку ОК, чтобы за-
крыть диалог и загрузить шаблон в программу.
Версия Excel 2002 дает вам несколько дополни-
тельных возможностей по созданию и сохранению
документов. Когда вы выбираете команду меню
Файл э£> Создать, в правой части окна программы
появляется панель задач (Рис. 1.7). В верхней части
панели задач расположена группа команд Откры-
тие книги. В этом списке представлены названия
документов, с которыми вы недавно работали.
Щелкните мышью на названии документа, и он бу-
дет загружен в программу и открыт. Если нужного
документа в списке нет, выберите команду Другие
книги и появится диалог открытия документа, рас-
смотренный выше.
т
ОIЩЛЛПК КННП!
Баланс 2002
Расчеты по кнгам
Решение по книгам
Яв*9
Q& Другие книги...
Создание
D Чистая книга
Создание из имеющейся книги
® Выбор книги...
Создание с помощью шаблона
!Ш] Общие шаблоны...
(|| Шаблоны на моих веб-узлах...
в[] Шаблоны на Microsoft.com
И Добавление узла...
Щ| Справка Microsoft Excel
Н Показывать при запуске
Рис. 1.7. Панель задач
15
Основы работы с электронными таблицами Excel
Выбрав команду Чистая книга в группе команд Создание, вы создадите но-
вую пустую рабочую книгу. Действие этой команды аналогично тому, что вы на-
жмете кнопку Г*] на панели инструментов. Группа команд Создание из имеющей-
ся книги содержит список книг, которые вы уже использовали для создания. Вы-
брав команду Выбор книги, вы откроете диалог открытия документа, рассмотрен-
ный выше. Отличие от простого открытия состоит в том, что после выбора доку-
мента в этом диалоге, будет создан новый документ на основе существующего, а
не открыт существующий документ. В группе команд Создание с помощью загото-
вок, также есть несколько команд. Выбрав команду меню Общие шаблоны, вы от-
кроете диалог выбора документа по шаблону, рассмотренный выше. Кроме того,
в этой группе отображаются команды выбора шаблонов, которые вы загружали
ранее. Остальные команды этого списка позволяют выбрать шаблон документа в
Интернете.
7.2.2. Работа с книгами и листами
Программа Excel позволяет отображать рабочую книгу и листы на экране в раз-
ном виде. По умолчанию, во время работы с листами рабочей книги, они отобража-
ются в обычном режиме (Рис. 1.8, слева), в котором вы видите таблицу не разбитую
на отдельные страницы, и именно так удобнее работать с электронной таблицей.
В другом режиме вы можете увидеть разбивку таблицы на отдельные страницы, как
при печати. Чтобы изменить внешний вид просмотра выберите команду меню Вид
Х£> Разметка страницы, и вид таблицы изменится (Рис. 1.8, справа).
<Q фзйп Орлм 1ед вставка
е£Нй
- ж к т
рормэт Сервис- Данные Q«KJ Справка
_ ;-. т сг\ дах
тгптгрттг
Рис. 1.8. Разные режимы просмотра
16
Создание и редактирование таблиц
Вя«9 дна Кг**» «оият Сяяие аг»»*"ami
н а * чж /с
I
. , .Лл
ORQ IRST-
6 ! РАСЧЕТ ПО АВАНСОВЫМ ПЛАТ
7 : СТРАХОВАНИЕ ДЛЯ ЛИЦ, П1
8 ИНДИВИДУАЛЬНЫХ ПР
Я ИНД
jljj за; !
11 (указывается отчетный период, за ко'
Представляется в
по месту нахождения (жителы
, . . , . .
и < . V^«rt/Jl»e«/n«iS/
Рис. 1.9. Разный масштаб
В этом режиме таблица разбивается на страницы, причем границы страниц
обозначаются рамкой синего цвета. Вы можете с помощью мыши перетащить эту
рамку, чтобы изменить размер страницы документа. Номер страницы отобража-
ется прямо в таблице поверх информации в ячейках. Но не волнуйтесь, инфор-
мация в ячейках при этом не портится и при печати документа этих надписей не
будет. Чтобы вернуться к обычному режиму просмотра, выберите команду меню
Вид Х^> Обычный.
Для удобства работы можно менять масштаб отображения листов рабочей
книги. Вы можете просмотреть сразу всю таблицу, установив мелкий масштаб
(Рис. 1.9, слева), или рассмотреть отдельные ячейки, выбрав крупный масштаб
П на100%(Рис. 1.9, справа). Для изменения масштаба используется поле ввода
стандартной панели инструментов. Нажмите кнопку * в правой части этого по-
ля, и будет открыт список масштабов, в котором нужно выбрать требуемый мас-
штаб. После этого список будет закрыт и масштаб просмотра изменится. Можно
указать произвольный масштаб, введя в поле требуемое значение в процентах.
Обращаем ваше внимание, что изменение масштаба отображения листов ра-
бочей книги не связано с масштабом при печати. Чтобы изменить масштаб при
печати, нужно настроить печать. Об этом вы узнаете ниже.
По умолчанию, при запуске программы, создается рабочая книга, содержа-
щая несколько листов. В настройках программы вы можете изменить количест-
во листов во вновь создаваемой книге, но по умолчанию в новой книге имеется
три листа, которые называются JIucml, Лист2 и ЛистЗ (Рис. 1.10).
Вы можете изменить имена листов, если вам это нужно. Чтобы изменить имя
листа, дважды щелкните мышью на ярлычке листа внизу рабочего окна програм-
17
Основы работы с электронными таблицами Excel
л /-PS •-—гже - / мы. Имя ярлычка будет выделено нега-И « > М[\Лист1/Лист2/ЛистЗ/
тивом, то есть светлым текстом на тем-
ном фоне. Введите с помощью клавиа-
_ , 1Л „ туры новое имя и нажмите клавишуРис. 1.10. Ярлычки листов tr£=t
|Ent«j, чтобы завершить ввод.
Если создаваемая таблица простая, вам хватит и одного листа для работы. При
этом остальные листы книги лучше удалить. Для сложных таблиц и трех листов
может оказаться мало. В этом случае можно добавить листы в книгу. Чтобы вста-
вить новый лист рабочей книги, щелкните правой кнопкой мыши на том листе,
перед которым вы хотите вставить новый лист, и в появившемся вспомогательном
меню выберите команду Добавить. Будет открыт диалог добавления, в котором
нужно щелкнуть мышью на значке с именем Лист и нажать кнопку ОК, чтобы за-
крыть диалог. Новый лист будет добавлен перед текущим листом рабочей книги.
Чтобы удалить лист из рабочей книги, щелкните правой кнопкой мыши на
ярлычке удаляемого листа, и в появившемся вспомогательном меню выберите
Удалить. Если в таблицу вносились изменения, появится диалог с предупрежде-
нием о том, что удаленный лист невозможно будет восстановить. Если вы увере-
ны в том, что делаете, нажмите кнопку ОК этого диалога, в противном случае
нужно нажать кнопку Отмена.
Можно копировать и перемещать листы в пределах рабочей книги или даже
между книгами. Чтобы переместить лист в пределах одной рабочей книги, нуж-
но перетащить мышью его ярлычок в новое место. Подведите указатель мыши к
ярлычку листа, который вы хотите переместить. Нажмите и не отпускайте левую
кнопку мыши. Через некоторое время указатель изменит форму на ̂ . Не отпу-
ская кнопку мыши, перемещайте указатель влево или вправо, в зависимости от
того, куда вы хотите переместить лист. После того, как вы отпустите кнопку мы-
ши, операция будет завершена и ярлычок листа окажется на новом месте. Если
при перетаскивании ярлычка вы будете удерживать нажатой клавишу ||см|, лист
будет не перемещен, а скопирован. При этом указатель мыши будет иметь вид
Р*|
'ty. Имя нового листа будет состоять из имени оригинала и номера копии, на-
пример, Лист 1 (2). Лучше после копирования переименовать новый лист, дав
ему другое, более осмысленное имя.
Иногда возникает необходимость работать с несколькими книгами одно-
временно. Вы можете в любой момент загрузить нужную вам книгу, нажав кноп-
ку Qgr на панели инструментов, или выбрав команду меню Файл Х£> Открыть.
При этом закрывать текущую рабочую книгу не нужно. Также вы можете создать
во время работы пустую рабочую книгу. Нажмите кнопку Q на панели инстру-
ментов, и будет создана еще одна пустая рабочая книга. Чтобы переключаться
между рабочими книгами, выберите команду меню Окно, и появится вспомога-
тельное меню. Нижние команды этого меню позволяют переходить к открытым
в настоящее время рабочим книгам. Та книга, с которой вы в настоящий момент
работаете, будет отмечена галочкой. Щелкните мышью на нужной книге, и она
появится в окне программы.
18
Создание и редактирование таблиц
В книгу:
j Создавать копию
Чтобы скопировать или переместить рабочий лист
в другую рабочую книгу, сначала нужно открыть вто-
рую книгу в программе Excel. Выберите в исходной
книге лист, который необходимо скопировать или пе-
реместить, щелкнув на ярлычке этого листа мышью.
Выберите команду меню Правка Х£> Переместить/
Скопировать лист, и будет открыт диалог настройки
копирования и перемещения (Рис. 1.11).
В открывающемся списке В книгу, вы должны вы-
брать книгу, куда будет производиться перемещение
или копирование. Можно выбрать одну из уже откры-
тых книг или создать новую. В списке Перед листом
нужно выбрать место в книге, куда будет помещен лист.
По умолчанию при использовании этого диалога про-
исходит перемещение листа. Если необходимо копировать лист, следует устано-
вить флажок Создавать копию. В заключение нажмите кнопку ОК, чтобы закрыть
диалог и начать копирование или перемещения листа. По окончании перемеще-
ния или копирования, лист появится в новой книге.
Рис. 1.11.
Копирование
и перемещение листов
1.2.3. Ввод данных в таблицы
После того, как вы создали или загрузили рабочую книгу, вы можете присту-
пать к вводу информации. Чтобы ввести информацию в ячейку, нужно сделать ее
активной. Для этого просто щелкните мышью на нужной ячейке. Теперь вы мо-
жете вводить различную информацию с помощью клавиатуры. При вводе ин-
формации она дублируется в строке формул (Рис. 1.12).
При этом если в ячейке была какая-либо информация, она будет заменена
новой, только что введенной вами информацией. Если вы хотите не заменить
информацию в ячейке, а добавить к ней новую информацию, вам нужно отре-
дактировать содержимое ячейки. О том, как это сделать, вы узнаете ниже.
После того, как вы начали вводить информацию, в строке формул появилось
несколько кнопок. Если вы хотите отказаться от ввода информации в ячейку, на-
жмите кнопку V(J. Нажав кнопку ^J или ([Enter] вы завершите ввод информации
в ячейку.
Если вы вводите цифры, то нужно нажимать цифровые клавиши клавиату-
ры. При этом для ввода отрицательных чисел следует перед цифрами ввести знак
минуса, нажав соответствующую клавишу.
Кроме того, если вы введете число в скоб-
ках, например (33), программа также будет
считать его отрицательным.
Чтобы ввести дроби, нужно разделять
вводимые цифры запятой. Если вы будете Рис. 1.12. Ввод данных в ячейку
19
Основы работы с электронными таблицами Excel
Я могу вводить длинный текст F6
В ; J. С.1ГХ;1.0 _ _ J ^ ' . Е _ J L 1... ..:,*':• i... : В [
длинный текст 1 ! Я могу юд^ругрй текст
Рис. 1.13. Ввод длинного текста и перекрывающийся текст
использовать вместо запятой точку, программа будет воспринимать такие числа
не как дроби, а как даты. Например, если вы введете 10,1, это будет дробным чис-
лом, а если вы введете 10.1, программа будет считать, что вы ввели дату 10 янва-
ря и в ячейке появится Юянв. Чтобы ввести полную дату, нужно через точку ука-
зать день, месяц и год, причем год можно указывать двумя последними цифра-
ми, например 1.10.02, а не 01.10.2002.
Если вы вводите в ячейку очень большое число, например 111111111111, оно
будет преобразовано в экспоненциальную форму, и в ячейке появится число
1,11111Е+11. Для математиков такая запись числа не вызывает трудностей, но
бухгалтеру работать с такими числами может показаться неудобным. Вы можете
изменить формат числа в ячейке, и об этом вы узнаете ниже.
Часто бухгалтеру приходится работать с процентами. Проценты вводятся,
как и любое другое число, но в конце следует ввести знак процентов, например
40%. В действительности же в ячейке будет храниться число 0,4.
Текст вводится точно так же, как и числа, то есть вы делаете ячейку актив-
ной, и начинаете вводить текст с помощью клавиатуры. Но текст может быть
длинным и выходить за границы ячейки. При вводе длинного текста он сдвига-
ется так, что в ячейке вы видите только последние введенные символы, однако
после того, как вы ввели весь текст, и нажали кнопку ̂ , он будет выровнен по
левому краю. При этом если соседние ячейки справа будут свободными, вы уви-
дите весь текст (Рис. 1.13, слева). В противном случае вы увидите не весь текст, а
только его часть, которая помещается в ячейке (Рис. 1.13, справа).
Хотя текст в ячейке и не виден целиком, программа хранит его весь без ис-
ключений, не обрезая. В дальнейшем вы сможете изменить внешний вид табли-
цы, чтобы был виден весь текст.
После завершения ввода в одну ячейку, активной автоматически становится
следующая ячейка, и ввод будет происходить именно в нее. Как вы помните, по
умолчанию это ячейка, расположенная ниже текущей ячейки в том же столбце,
но можно изменить направление перемещения в настройках программы.
Можно выделить не одну ячейку, а несколько ячеек. Об этом вы узнаете поз-
же, а пока отметим особенности ввода информации в несколько выделенных
ячеек. При выделении столбца таблицы, ввод информации происходит сверху
вниз (Рис. 1.14, слева). Если выделена строка, то ввод информации происходит
слева направо (Рис. 1.14, в центре). Если выделено несколько строк и столбцов,
ввод информации происходит сверху вниз и слева направо (Рис. 1.14, справа).
Такой же принцип ввода информации, если выделены ячейки, расположенные
в произвольных местах таблицы.
20
Создание и редактирование таблиц
Первый Четвертый
Второй
Третий
Рис. 1.14. Ввод данных в несколько выделенных ячеек
Обычно ввод данных производится в текущем рабочем листе. Однако, вы
можете вводить данные в несколько листов рабочей книги одновременно. Для
этого сначала нужно сгруппировать листы. Листы автоматически группируются,
если выделить несколько ярлычков. При этом в заголовке окна Excel появится
надпись [Группа]. Чтобы выделить несколько листов рабочей книги, располо-
женных подряд, нажмите клавишу ||tshift) и удерживая ее нажатой, щелкните мы-
шью на первом и последнем ярлычке из тех, которые вы хотите выделить. Если
вам нужно выделить листы в произвольном порядке, удерживая нажатой клави-
шу |fcuTj, щелкните мышью на нужных ярлычках.
Если листы сгруппированы, то данные, введенные в один лист группы, по-
падают и во все остальные. Причем данные помещаются в одни и те же ячейки
разных листов. Вы можете проверить это после ввода данных. Выберите один
из выделенных листов и убедитесь, что данные попали во все сгруппированные
листы.
По окончании ввода данных необходимо отменить группировку листов,
иначе все записи, введенные на один лист, попадут и на другие листы группы, за-
меняя уже существующие там данные. Чтобы отменить группировку, щелкните
мышью на ярлычке любого листа, и будет выделен именно он, а группировка ис-
чезнет. Теперь данные в каждый лист можно снова вводить независимо от ос-
тальных листов.
7.2.4. Передвижение по таблицам и выбор данных
•
Перемещаться по таблице можно с помощью мыши. Для этого нужно вос-
пользоваться полосами прокрутки. Есть горизонтальная полоса прокрутки для
перемещения вправо и влево, а также вертикальная полоса для перемещения
вверх и вниз (Рис. 1.15). По краям полос прокрутки есть кнопки со стрелками,
для перемещения на одну строку или один столбец, в зависимости от того, на ка-
кой полосе расположены кнопки. На-
жав кнопку, вы сдвинете таблицу в
сторону, в которую указывает стрелка
на кнопке.
На полосах прокрутки, между
кнопками расположены прямоуголь-
ники, которые называются ползунка-
ми. Ползунки используются для быс- Рис. 1.15. Полосы прокрутки
Полосы прокрутки
Ползунки
21
Основы работы с электронными таблицами Excel
трого перемещения по таблице. Чтобы перемещаться по таблице с помощью
ползунков, необходимо перетаскивать их с помощью мыши вдоль полосы про-
крутки. Чтобы перетащить ползунок, подведите к нему указатель мыши, нажми-
те левую кнопку мыши и, не отпуская ее, перемещайте указатель. Вместе с ука-
зателем будет перемещаться и ползунок. Например, перетаскивая ползунок вер-
тикальной полосы вниз, вы перемещаетесь по таблице также вниз.
Для перемещения можно воспользоваться клавиатурой, но это, на наш
взгляд, менее удобно. Нажмите клавишу ДТЬ и рамка активной ячейки пере-
местится на одну строку вниз, то есть активной станет ячейка, расположен-
ная ниже. Если вы нажмете клавишу Щ, рамка переместится на одну строку
вверх. Перемещаться по таблице вправо и влево можно, используя клавиши
0 и Н- Если, перемещаясь, вы достигнете границы экрана, следующее на-
жатие клавиши приведет к тому, что информация в окне будет прокручена в
направлении, в котором вы перемещаетесь. Так вы можете переместиться к
любой ячейке таблицы.
Можно двигаться вверх и вниз значительно быстрее. Нажмите клавишу [[gggjj
и вы переместитесь вниз на количество строк таблицы, которое помещается на
экране. Если вы нажмете клавишу ||5pgej, вы переместитесь на такое же количест-
во строк назад. В начало текущей строки таблицы вы переместитесь, нажав кла-
вишу ||ноте|, а одновременно нажав клавиши ||ctn| и Цноте], вы переместитесь к на-
чалу таблицы. Чтобы переместиться к концу таблицы, следует одновременно
нажать клавиши |см] и [pndj.
Чтобы не прокручивать таблицу в поисках конкретной ячейки, можно вос-
пользоваться командой перехода. Выберите команду меню Правка э£> Перейти,
и будет открыт диалог перехода (Рис. 1.16). В поле ввода Ссылка нужно ввести ад-
рес той ячейки, куда вы хотите перейти. Программа запоминает адреса ячеек, ку-
да вы переходили ранее и они отображаются в верхней части диалога в виде спи-
ска. Выбрав адрес из списка, вы быстро перейдете к ячейке. После того, как ад-
рес ячейки выбран или введен, нажмите кнопку ОК, чтобы закрыть диалог и осу-
ществить переход. Указанная вами ячейка станет активной, и будет отображена
на экране.
При работе с таблицей часто приходится выде-
лять ячейки. Чтобы выделить одну ячейку, нужно
просто щелкнуть на ней мышью. Вокруг ячейки
появится жирная рамка выделения. Кроме одиноч-
ных ячеек, можно выделять и несколько ячеек од-
новременно. Несколько выделенных ячеек образу-
ют диапазон ячеек.
Чтобы выделить строку или столбец целиком,
нужно щелкнуть мышью на заголовке строки или
столбца. Если нужно выделить несколько ячеек,
подведите указатель мыши к первой выделяемой
ячейке, нажмите кнопку мыши и, не отпуская ее,
т
Рис. 1.16.
Переход к ячейке
22
Создание и редактирование таблиц
Рис. 1.17. Выделение группы ячеек
перемещайте указатель к последней ячейке. Когда вы достигнете последней
ячейки, отпустите кнопку мыши. Группа ячеек останется выделенной. Так мож-
но выделить несколько ячеек в одной строке, одном столбце или даже ячейки в
нескольких строках и столбцах (Рис. 1.17, слева).
Удобно использовать для выделения клавиатуру и мышь одновременно. Для
выделения смежных ячеек, нажмите клавишу [[»shift) и, не отпуская ее, щелкните
на первой ячейке, а затем на последней ячейке в группе. Если вам нужно выде-
лить несколько ячеек, расположенных в произвольном порядке, сначала нажми-
те клавишу [см]. Не отпуская клавиши, щелкайте мышью на нужных ячейках, и
они будут выделены. Если нужно снять выделение с ячеек, просто щелкните мы-
шью на любой, невыделенной ячейке. Она будет выделена, а выделение с груп-
пы ячеек будет снято.
Можно выделять не всю ячейку, а только ее содержимое. Для этого дважды
щелкните на ячейке, содержимое которой нужно выделить. Внутри ячейки по-
явится текстовый курсор в виде мигающей вертикальной черты. Если вы еще раз
дважды щелкните мышью, будет выделена вся информация в ячейке. Если нуж-
но выделить часть информации, щелкните мышью в том месте, где должно начи-
наться выделение, нажмите левую кнопку мыши и, не отпуская ее, перемещайте
указатель к концу выделения. После того, как нужный фрагмент будет выделен,
отпустите кнопку мыши. Выделение информации в ячейке используется для ко-
пирования или переноса ее в другие ячейки. Работа с таким выделением похожа
на работу с выделением в текстовом редакторе.
Имеется возможность выделить на листе ячейки, которые содержат инфор-
мацию определенного типа. Вначале выделите
группу ячеек, в которую должны входить те ячейки,
которые вы хотите выделить. Затем выберите ко-
манду меню Правка э£> Перейти, и будет открыт
диалог перехода, рассмотренный выше. Нажмите в
этом диалоге кнопку Выделить, и будет открыт ди-
алог настройки выделения ячеек (Рис. 1.18).
С помощью переключателя в данном диалоге
вы можете указать, какую информацию должны со-
держать ячейки, которые следует выделить. Напри-
мер, вы хотите выделить ячейки, в которых нахо-
дятся только числа. Для этого нужно установить пе- Рис. 1.18.
реключатель в положение Константы и сбросить Настройка выделения ячеек
If *
Г отличия по строкам.
[•'" . . : • : , - Г зависимые ячейки
Г .,. f f . . . . . . . . .
Г ' Г - ..,,..;...,.
F" -,.:--,--/ Г последнюю ячейку
С пустые ячейки Г только виднкуе ячейки
С тачную аблвсть Г устевдане форматы
Г текущий наняв Г проверка данных
f* объекты <"' •• ,
Г у.ч ,<-
23
Основы работы с электронными таблицами Excel
все флажки, кроме флажка Числа. В заключение нажмите кнопку ОК, чтобы за-
крыть диалог. Все ячейки в указанном вами диапазоне, в которых есть числа, бу-
дут выделены. Таким способом вы можете выделять ячейки, содержащие форму-
лы, пустые ячейки, ячейки содержащие примечания и так далее.
7.2.5. Редактирование данных
Чтобы изменить содержимое ячейки, сделайте ячейку активной, щелкнув на
ней мышью. После того, как ячейка выделена, ее содержимое отображается в
строке формул. Начинайте вводить новую информацию, и старое содержимое
ячейки будет удалено. Если вам нужно изменить информацию в ячейке, а не за-
менить ее, дважды щелкните на ячейке мышью. Внутри ячейки появится тексто-
вый курсор в виде мигающей вертикальной черты. Теперь, когда вы будете вво-
дить новую информацию, она не будет заменять предыдущую информацию, а
будет добавлена к ней. С помощью клавиш управления курсором и клавиш ре-
дактирования, вы можете изменить информацию в ячейке.
Редактировать информацию в ячейке можно с помощью строки формул. Для
этого, щелкните мышью на ячейке, чтобы сделать ее активной, а затем щелкни-
те мышью в строке формул. В строке формул появится текстовый курсор, и вы
можете редактировать информацию.
Можно перенести часть информации из одних ячеек таблицы в другие. Это
может быть как одна ячейка, так и несколько ячеек. При этом используется бу-
фер обмена Windows — специально выделенное место, куда различные програм-
мы могут помещать информацию и получать ее оттуда. После выделения фраг-
мента таблицы, который необходимо скопировать, нажмите кнопку Щ^ на па-
нели инструментов. Границы выделенных ячеек будут очерчены пунктирной
рамкой. Теперь щелкните мышью на той ячейке, куда нужно вставить данные
и нажмите кнопку Щ| на панели инструментов. На экране появится копия со-
держимого выделенных ранее ячеек (Рис. 1.19).
Чтобы переместить информацию из одной ячейки в другую, выделите ис-u
ходную ячейку, а затем нажмите кнопку ̂  на панели инструментов. Граница
выделенной ячейки также будет очерчена пунктирной рамкой. Щелкните мы-
шью на ячейке, куда следует вставить информацию, и нажмите кнопку Щ| на
панели инструментов. Информация в исход-
ной ячейке исчезнет и появится в новой ячей-
ке. Кстати, можно не выбирать команду меню,
а щелкнуть правой кнопкой мыши на той ячей-
ке, где нужно вставить информацию и в по-
явившемся вспомогательном меню выбрать
нужную команду.
Рис. 1.19. Если вы поместили информацию в буфер,
Копирование содержимого ячеек но передумали копировать ячейки, просто на-
24
Создание и редактирование таблиц
жмите клавишу Q на клавиатуре. Выделение ячеек будет снято. В случае если
вы уже завершили операцию, следует воспользоваться специальной командой
для отмены, рассмотренной ниже.
Если вы выделили не всю ячейку, а только информацию в ней, вы также мо-
жете копировать или перемещать ее в другие ячейки с помощью буфера обмена.
При этом способе редактирования ячейки после того, как информация помеще-
на в буфер обмена, нужно завершить редактирование текущей ячейки, нажав
кнопку ̂  в строке формул или клавишу JEnter) на клавиатуре. Затем выберите
ячейку, куда нужно вставить информацию и нажмите на панели инструментов
кнопку ĵ |. Если в ячейке, куда вы вставляете информацию, есть другая инфор-
мация, она будет добавлена к уже существующей информации.
Отметим, что если вы копируете или перемещаете ячейку целиком, инфор-
мация в ней корректируется, чтобы не нарушить ссылки на другие ячейки, если
они есть. При копировании или перемещении части информации из ячейки, ни-
какой корректировки не происходит.
Если вы работаете в программе Excel 2002, вы можете заметить, что кнопка
ĵ | является составной. Нажмите кнопку v в правой части кнопки ̂ 1, и будет
открыто вспомогательное меню. Команды этого меню позволяют выбрать раз-
личные варианты вставки из буфера обмена.
Программа Excel 97 работает так, что при добавлении информации в буфер
обмена, предыдущая информация в нем удаляется. При работе с Excel 2000 или
2002, можно сохранять в буфере обмена несколько порций информации, причем
извлекать их можно независимо друг от друга. Наиболее удобно работа с не-
сколькими фрагментами в буфере обмена реализована в Excel 2002. Если вы ра-
ботаете с версией Excel 2002, выберите команду меню Правка :£> Буфер обмена
Office, и в правой части окна программы появится панель задач (Рис. 1.20).
В средней части панели расположен список информации, хранящейся в бу-
фере обмена. Чтобы вставить какую-либо информацию из буфера обмена, следу-
ет выделить ячейку в таблице, а затем выбрать соответ-
ствующий элемент списка в буфере обмена на панели
задач, щелкнув на нем мышью. Информация будет
вставлена в указанное вами место.
Слева от каждого элемента списка расположен зна-
чок, показывающий, какая программа поместила ин-
формацию в буфер обмена. Нажав кнопку Вставить все,
расположенную в верхней части панели задач, вы вста-
вите все содержимое буфера обмена. Если нажать кноп-
ку Очистить все, вся информация из буфера обмена бу-
дет удалена. Нажав кнопку Параметры в нижней части
панели задач, вы откроете вспомогательное меню наст-
ройки отображения панели задач в режиме работы с бу-
фером обмена. Чтобы убрать дополнительную панель,
нужно нажать кнопку с перекрестием в ее заголовке.
* Буфер обмена (з ю 2' » х
u
Выберите вставляемый объект:
ID Информация для
перемещения
SP Данные
Чтобы вновь показать эту область
задач, выберите в меню "Правка"
пункт "Буфер обмена Office" или
дважды нажмите Ctil-t-c.
Рис. 1.20.
Буфер обмена
в панели задач
25
Основы работы с электронными таблицами Excel
Если нужно полностью удалить содержимое ячейки, сделайте ячейку актив-
ной, а потом нажмите клавишу |[peiete| на клавиатуре. Содержимое ячейки будет
полностью очищено. Более сложные варианты очистки можно осуществить, вы-
делив ячейки, и затем выбрав команду меню Правка Х£> Очистить. Появится
вспомогательное меню с различными вариантами очистки. При очистке ячейки
можно удалить ее содержимое, информацию о форматировании ячейки, приме-
чания или все вместе.
При редактировании таблиц вы можете случайно выполнить ненужное дей-
ствие, например, испортить формулу или удалить текст. Программа Excel позво-
ляет отменять сделанные вами действия. Нажмите кнопку |̂ ^ на панели ин-
струментов, и последняя сделанная вами операция будет отменена. Еще раз на-
жмите эту кнопку, и будет отменена еще одна операция. Чтобы отменить сразу
несколько последних действий, нажмите кнопку чг справа от кнопки |̂ -̂
Будет открыт список действий для отмены.
Можно отменить любое действие из этого списка, щелкнув на нем мышью,
но при этом все действия, которые были сделаны после выбранного вами для от-
мены, также будут отменены. Перемещая указатель вдоль списка отмены, вы вы-
бираете действия, которые надо отменить. Внизу списка отображается число от-
меняемых действий.
Вы можете повторно выполнить отмененное действие. Для этого нажмите
кнопку |̂ Sd на панели инструментов. Однократное нажатие кнопки приводит
к повторному выполнению последнего отмененного действия. Также вы можете
выбрать действие для повтора, нажав кнопку w, правее кнопки (^^4 • Помни-
те, что, выбрав действие для повтора, вы повторите и все действия, которые бы-
ли до этого действия.
При создании таблиц часто приходится добавлять или удалять ячейки, целые
строки или столбцы. Чтобы добавить в таблицу строку, вначале выделите строку,
перед которой нужно добавить новую строку, щелкнув мышью на ее заголовке,
после чего выберите команду меню Вставка ;£> Строки. Новая строка будет до-
бавлена перед выделенной строкой таблицы. Аналогично вы можете выделить
столбец и выбрать команду меню Вставка Х£> Столбцы. Если выделить несколь-
ко строк или столбцов, после выполнения команды бу-
дет добавлено такое же количество строк или столбцов.
Добавить- -
Г ячейки, со сдвигом вправо
9 йче'йки"
Если вам нужно вставить одну или несколько яче-
ек таблицы, вначале следует выбрать место, куда вы хо-
тите осуществить вставку. После того, как место выбра-
но, щелкните правой кнопкой мыши на этом месте.
Появится вспомогательное меню. В этом меню выбе-
ок | _^даа_ рите команду Добавить ячейки. Появится диалог добав-
ления ячейки (Рис. 1.21).
Рис. 1.21. При вставке отдельных ячеек возникает проблема
Добавление ячеек, сдвига строк и столбцов таблицы. Например, у вас есть
строк и столбцов несколько заполненных ячеек и вы хотите вставить но-
26
Создание и редактирование таблиц
Первый
Второй^
Третий Второй
ЗТретий
Рис. 1.22. Сдвиг ячеек при вставке
вую ячейку перед ячейкой А2 (Рис. 1.22, слева). Если установить переключатель
в положение ячейки со сдвигом вниз, ячейки, которые расположены в том же
столбце, что и добавляемая ячейка, переместятся вниз на одну ячейку (Рис. 1.22,
в центре).
Если переключатель установлен в положение ячейки со сдвигом вправо,
ячейки той же строки, что и добавляемая ячейка, переместятся вправо (Рис. 1.22,
справа). С помощью этого диалога можно добавить целый столбец или строку.
Для этого предусмотрены соответствующие положения переключателя. После
того, как переключатель установлен, нажмите кнопку ОК, чтобы закрыть диалог.
Чтобы добавлять ячейки таблицы, можно выбрать команду меню Вставка ^>
Ячейки.
Ячейки, строки и столбцы можно не только добавлять, но и удалять. Удале-
ние ячеек таблицы похоже на процедуру добавления. Сначала нужно выбрать
ячейку или группу ячеек, которые надо удалить. После того, как вы определили,
какие ячейки следует удалять, выделите эти ячейки. Теперь выберите команду
меню Правка Х£> Удалить. Появится диалог удаления ячеек (Рис. 1.23).
С помощью переключателя этого диалога устанавливается, каким образом
будут сдвигаться оставшиеся ячейки после удаления. Назначение положений пе-
реключателя такое же, как при добавлении ячеек, поэтому мы не будем останав-
ливаться на этом. Также можно удалять целые строки или столбцы.
Обращаем внимание, что если информация в удаляемых ячейках использу-
ется в других ячейках, в этих ячейках возникнут ошибки. Также помните, что,
выделив ячейку и нажав кнопку ||oeietaj, вы не удалите
ячейку, а лишь очистите ее содержимое. Кроме того,
оформление ячейки при этом не будет удалено. Чтобы
удалить и оформление ячейки, выберите команду меню
Правка ХР> Очистить.
1.2.6. Печать электронных таблиц
После создания таблицы и во время работы над
ней, таблицу можно распечатать. Обычно вид таблицы
на бумаге может значительно отличаться от ее изобра-
«IX
Удалить -
Г ячейки, со сдвигом влево
й> !ячег 41 ваерх}
Г сцхжу
С столбец
ОК I Отмена
Рис. 1.23.
Удаление ячеек,
строк и столбцов
27
Основы работы с электронными таблицами Excel
натуральней ь- \ • ,
" разместить не более чем t
Просмотр ]
• • свойства... |
и fl ^Ц ар. е высоту
Еазиербум!
Качество™
/Ъс.
Настройка параметров страницы
жения на экране. Чтобы правильно напе-
чатать таблицу нужно установить формат
листа бумаги, на котором мы будем печа-
тать, его ориентацию, отступы от краев
листа бумаги, а также задать или убрать
место для вспомогательной информа-
ции, такой как номер листа, текущая да-
та и так далее.
Выберите команду меню Файл з£>
Параметры страницы, и будет открыт
диалог настройки печати. Щелкните
мышью на ярлычке Страница, чтобы пе-
рейти на вкладку настройки основных
параметров. (Рис. 1.24).
Правильная настройка ориентации
страницы при печати позволяет отобразить больше информации на одном лис-
те. Переключатель Ориентация позволяет выбрать размещение таблицы на листе
бумаги. Если столбцов в таблице больше чем строк, установите переключатель
в положение Альбомная. В этом случае страница будет напечатана не поперек,
а вдоль листа бумаги. Если же строк больше чем столбцов, то целесообразно ус-
тановить переключатель в положение Книжная.
Группа элементов управления Масштаб позволяет настроить степень умень-
шения или увеличения таблицы при выводе на печать. Менять масштаб прихо-
дится, если вы хотите поместить большую таблицу на одном листе бумаги, или
наоборот, выделить какой-либо фрагмент таблицы. Установив переключатель в
положение Установить, вы можете явно указать желаемый масштаб в процентах.
Если переключатель установлен в положение Разместить не более чем на, про-
грамма сама подберет масштаб, чтобы расположить всю информацию на нужном
количестве страниц.
Если вы нажмете кнопку Просмотр,
вы увидите, как будет выглядеть страни-
ца при печати. В списке Размер бумаги
вы может выбрать один из стандартных
размеров используемых при изготовле-
нии бумаги. Если вы хотите установить
качество печати, отличающееся от стан-
дартного, делайте это в списке Качество
печати.
Рассмотрим, какие еще параметры
печати вы можете настроить. Щелкните
мышью на ярлычке Поля, чтобы перейти
на эту вкладку (Рис. 1.25). Поля пред-
ставляют собой полосы по краям листа
|( Страница j поля ;[ Колонтитулы j лист
aepjjHero
UewpiipoeaTb на ci
Г' f C-plllWtf iMU
правде
j_ „
йижнее; нижнего ко*»
ранице --
о [~ верхйкапьно
Рис. 1.25.
Настройка полей
28
Создание и редактирование таблиц
Ораница j Поля i Вош*гмтулыН Лист
Создать нижний колориту л...
_ Просыоту j
Свойства... |
Рис. 1.26.
Настройка колонтитулов
бумаги, на которых ничего не печатается.
Размеры полей задаются отдельно для
каждой границы листа, в соответствую-
щих полях ввода со счетчиками. Вы мо-
жете ввести величину поля в сантимет-
рах, а можете, нажимая кнопки счетчика,
увеличивать или уменьшать значение в
поле для более точной установки полей
листа бумаги. Кроме полей для границ
листа, есть два поля для верхнего и ниж-
него колонтитулов. Информация в эти
поля вводится точно так же.
Чтобы увидеть изменения, которые
вы сделали с полями, используйте кноп-
ку Просмотр. Если значения полей достаточно велики, может оказаться полез-
ным располагать таблицу в центре листа. Для выравнивания по горизонтали и
вертикали используются соответствующие флажки в нижней части диалога.
Колонтитулы в печатных документах представляют собой специальные об-
ласти в верхней и нижней части страницы, в которые выводится различная ин-
формация. Например, в колонтитулах можно отобразить номер страницы, на-
звание таблицы, текущую дату и много другой информации. Щелкните мышью
на ярлычке Колонтитулы, чтобы перейти на одноименную вкладку (Рис. 1.26).
По умолчанию колонтитулы отсутствуют, однако вы можете создать их, если
захотите. Можно выбрать один из вариантов колонтитулов, предлагаемых про-
граммой. Для этого в открывающихся списках Верхний колонтитул или Нижний
колонтитул следует выбрать один из вариантов. Можно также создать колонти-
тулы самостоятельно. Для этого нажмите кнопку Создать верхний колонтитул
или Создать нижний колонтитул. Будет открыт диалог создания и модификации
колонтитула (Рис. 1.27).
Данный диалог содержит три поля ввода и ряд кнопок для вставки стандарт-
ной информации в колонтитулы. Колонтитул можно разместить слева, по цент-
ру или справа. Для этого следует щелкнуть мышью на нужном поле ввода и на-
чинать вводить текст колонти-
тула. Если вы хотите изменить
используемый для текста ко-
лонтитула шрифт, нажмите
кнопку А;. Будет открыт диа-
лог, в котором вы можете вы-
брать наименование и размер
шрифта, его начертание.
Нажав кнопку и , вы вста-
вите в колонтитул номер стра-
ницы. Причем при изменении
• Дня ijiTencra EWW.wre >e«cr, чптен нажииге кнопку шрифта.
3 Чтобы поместить HOHfp страницы, ftery, время, пня файла, путь и файлу или имя ярлымхв,
|| установил' - < I. HBWu-i» чулч'/и снопку.
5 ЧУовм вставить putyirait. нлкш-'е кнчпку впаьчи рису»*). Дчв фо̂ ггашровани» рисунка
:i уавноате курсор е пая» |jtv«(ni)peaHH» киюкчите кчопку форнагироааииярисунка.
!
Слева: 8 центре: Сараев:
Рис. 1.27.
Создание колонтитула
29
Основы работы с электронными таблицами Excel
таблицы, номера пересчитываются автоматически. Если вы хотите, чтобы в ко-
лонтитуле отображалось общее число страниц, нажмите кнопку jg . Это число
также автоматически пересчитывается при изменении таблицы. Нажав кнопку
JB], вы вставите в колонтитул текущую дату, а, нажав кнопку Q , вы вставите те-
кущее время.
Иногда бывает полезным вставлять в колонтитул информацию о названии
рабочего листа и названии файла, в котором хранится рабочая книга. Чтобы
вставить имя файла и путь к этому файлу в колонтитул, нажмите кнопку j&j.
В том случае если вам нужно вставить только имя файла, следует нажать кноп-
ку е_. Если вы нажмете кнопку ш|, в колонтитул будет вставлено имя рабочего
листа, который вы собираетесь печатать.
Вы можете добавлять в колонтитул и изображения, например, логотип ва-
шей фирмы. Чтобы выбрать изображение, нажмите кнопку JS; . Появится диалог
открытия файла, в котором вы должны выбрать папку и указать файл, в котором
хранится изображение. Если вы вставили изображение, становится доступной
кнопка Vi- Нажав эту кнопку, вы откроете диалог настройки, в котором вы мо-
жете изменить размер изображения, его масштаб, повернуть его на нужный угол,
а также провести обрезку изображения.
После того, как вы создали колонтитул, нажмите кнопку ОК, чтобы закрыть
диалог настройки и вернуться к настройке параметров страницы. Щелкните мы-
шью на ярлычке Лист диалога настройки, чтобы перейти на одноименную
вкладку (Рис. 1.28).
На этой вкладке вы можете настроить область печати, повторение строк и
столбцов, печать сетки. По умолчанию программа печатает таблицу от началь-
ной ячейки А1 до последней заполненной ячейки рабочего листа. Если вы хоти-
те печатать не весь рабочий лист, а только его часть, в поле ввода Выводить на пе-
чать диапазон нужно указать адреса ячеек, которые необходимо печатать. Это
можно сделать, введя адреса с помощью клавиатуры или, нажав кнопку ррр, ука-
зать их мышью. Если указанный вами диапазон содержит несмежные ячейки,
каждый непрерывный диапазон будет пе-
чататься на отдельной странице.
Если распечатка таблицы занимает
несколько страниц, то, возможно, будет
полезным печатать на каждой странице
заголовки строк и столбцов. Это позволит
легче определять принадлежность содер-
жимого ячейки к тем или иным данным.
В этом случае нужно указать адреса заго-
ловков сквозных строк и столбцов в соот-
ветствующих полях ввода.
Если установлен флажок Сетка в
группе элементов управления Печать,
при печати будет выводиться сетка, кото-
Рис. 1.28.
Настройка листа
30
Создание и редактирование таблиц
Земать,., Страница.,,] Поди } Обычный веж w
рую вы видите на экране при работе с таблицей. Если флажок сброшен, при пе-
чати сетки не будет, хотя на экране она будет присутствовать. Если установить
флажок Заголовки строк и столбцов, будут печататься номера строк и столбцов.
Это бывает полезно при поиске ошибок в таблице. Если вы печатаете цветную
таблицу на черно-белом принтере, лучше установить флажок Черно-белая. Если
установить флажок Черновая, вы указываете программе, что следует печатать
таблицу без сетки и графических объектов.
Открывающийся список Примечания позволяет указать, нужно ли выводить
примечания, и если нужно, то в каком виде. В группе элементов управления По-
следовательность вывода страниц с помощью установки переключателя можно
определить различный порядок вывода страницы на печать. Этот порядок дейст-
вует, если вы печатаете более одной страницы на одном листе бумаги.
Во время настройки параметров страницы, вы можете посмотреть, как будет
выглядеть страница при печати, нажав кнопку Просмотр. В этот же режим мож-
но переключиться в любой момент работы с таблицей, нажав кнопку fg^ на па-
нели инструментов или выбрав команду меню Файл Х£> Предваритель-
ный просмотр. В любом случае, внешний вид рабочего окна программы изменит-
ся и в окне появится изображение листа бумаги с таблицей в том виде, как она
будет напечатана (Рис. 1.29).
В верхней части окна распо-
ложен ряд кнопок для настроек
параметров печати. Если печата-
ется больше одной страницы, ста-
новится доступной кнопка Далее.
Нажмите эту кнопку, и вы увидите
изображение второй страницы.
При этом станет доступной кноп-
ка Назад, нажав которую, вы вер-
нетесь к предыдущей странице.
Нажав кнопку Масштаб, вы уве-
личите масштаб изображения для
просмотра деталей. Нажмите эту
кнопку еще раз, и изображение
вернется к прежнему масштабу,
при котором страница отобража-
ется целиком. Если нажать кноп-
ку Страница, появится диалог на-
стройки, который мы только что
рассмотрели.
Если нажать кнопку Поля, в
изображении страницы появятся
линии, обозначающие установ-
ленные для данной страницы по-
Г"П [ЦЗ ЩЛ1
i !J._l--LLi-l-4'-ri ГП ttapn. д™ p~l fTI
Падин ' Дп П~1 Г~П
[""П Г"]"") Г"1"ТТ
Рис. 1.29.
Предварительный просмотр
31
Основы работы с электронными таблицами Excel
ля. Подведите указатель мыши к границе поля, и указатель изменит форму ~|~
или -^-. Перетаскивая границы полей мышью, вы можете установить нуж-
ные вам поля.
Нажав кнопку Разметка страницы, вы измените отображение таблицы на
экране. Что такое режим разметки страницы вы уже знаете, и мы не будем оста-
навливаться на этом. Чтобы вернуться в режим предварительного просмотра, на-
жмите кнопку [~ĵ  на панели инструментов еще раз. Обратите внимание, что
кнопка Разметка страницы теперь называется Обычный режим. Нажав эту кноп-
ку, вы закроете режим предварительного просмотра и вернетесь к обычному ре-
жиму работы с таблицей.
Чтобы выйти из режима предварительного просмотра, можно нажать и
кнопку Закрыть. При этом вы вернетесь в тот режим, в котором вы работали до
перехода в режим предварительного просмотра. И, наконец, нажав кнопку Пе-
чать, вы откроете диалог настройки параметров печати.
Чтобы напечатать текущий документ, нажмите кнопку <Щ> на панели инст-
рументов. Сразу начнется печать с установленными по умолчанию параметрами.
Если вы хотите изменить параметры печати, выберите команду меню Файл ^>
Печать. Отметим, что печать документа возможна и из режима предварительно-
го просмотра и из диалога настройки параметров страницы. Во всех этих случа-
ях, при выборе команды печати появится диалог настройки (Рис. 1.30).
Если у вас несколько принтеров, в списке Имя вы можете выбрать, какой ис-
пользовать принтер. Если у вас один принтер, его имя само появится в этом спи-
ске. Нажав кнопку Свойства, вы откроете диалог настройки дополнительных па-
раметров принтера. В большинстве случаев ничего дополнительно настраивать
не нужно.
Переключатель Печатать позволяет выбрать, все ли страницы нужно печа-
тать или определенный диапазон, или отдельные страницы для печати. Устано-
вив переключатель Вывести на печать, вы можете указать, какую часть рабочего
листа или рабочей книги необходимо распечатать. Вы можете печатать выделен-
ный диапазон ячеек, выделенные листы
Принтер
Им»: \~& IBM 4039 LaserPrmter PS
Состояние: свободен
T«rt: IBM 4039 Laserprinter PS
Порт: LPTl:
Звнмии;
С страницы
Вывести не печать
f" выселенный диапазон
Я выделенные ЕМСГЫ
Рис. 1.30.
Настройка печати
В поле ввода со счетчиком Копии, вы
можете указать число копий печатаемо-
го документа. По умолчанию это число
равно единице и, если вы не хотите печа-
тать большее число копий, ничего не
нужно менять в этом поле. Если установ-
лен флажок Разобрать по копиям, сначала
будут напечатаны все страницы одной ко-
пии, а затем все страницы второй копии
и т. д. Если сбросить этот флажок, снача-
ла будут напечатаны первые страницы
всех копий, затем вторые и так далее.
32
Оформление электронных таблиц
Чтобы закрыть диалог настройки и начать печать документа, нажмите кноп-
ку ОК. Если при этом принтер не включен, через некоторое время вы увидите со-
общение об ошибке. В этом случае включите принтер и нажмите кнопку Повто-
рить в диалоге с предупреждением.
1.3. Оформление электронных таблиц
В большинстве случаев кроме правильных вычислений, электронные табли-
цы должны иметь определенный вид, что достигается с помощью средств
оформления таблиц, имеющихся в Excel. Оформление в Excel похоже на оформ-
ление в широко распространенном текстовом редакторе Word. Вы можете менять
оформление самостоятельно или выбрать один из готовых вариантов, предлага-
емых программой.
1.3.1. Форматирование листов
Перед тем, как рассматривать различные варианты оформления таблицы,
обратим ваше внимание на то, что все настройки оформления ячеек, такие,
как вид и начертание шрифта, а также все варианты форматирования, приме-
няются только к активной ячейке. После завершения ввода информации в эту
ячейку, все параметры форматирования устанавливаются в состояние, приня-
тое по умолчанию. Чтобы оформить несколько ячеек, их нужно сначала вы-
делить.
Чтобы сделать информацию в ячейке непохожей на другие ячейки, проще
всего изменить шрифт. Шрифтом называют набор изображений всех букв, цифр
и специальных символов, и, меняя вид шрифта, можно значительно изменить
внешний вид документа. На панели инструментов программы есть ряд кнопок
для выбора шрифта для текста, чисел и формул.
В открывающемся списке АгйСуг -г t
расположенном в панели инструментов форматиро-
вания, отображается название текущего используе- [*
I* A=j*e,En8'i»e<llLET
мого шрифта. Нажмите кнопку "•*•, расположенную
справа от названия шрифта, и будет показан список |*лсо,хв
всех доступных шрифтов (Рис. 1.31). 1*д!!Т*В1
Многие программы устанавливают на ваш ком-
пьютер дополнительные шрифты, поэтому состав спи-
>
ска шрифтов может быть различным на разных ком- [*Ауапюага»
пьютерах. Название шрифта в списке написано с по-
мощью этого шрифта, так вы можете увидеть, как будут Рис. 1.31.
выглядеть символы, если вы выберете этот шрифт. Список шрифтов
33
2-5458
Основы работы с электронными таблицами Excel
По умолчанию для заполнения таблицы используется шрифт Arial, но вы мо-
жете выбрать любой другой из имеющихся шрифтов. Чтобы изменить начерта-
ние уже введенных данных, следует выделить требуемую ячейку или группу яче-
ек, а затем выбрать шрифт из списка на панели инструментов. При вводе новой
информации шрифтом, отличающимся от принятого по умолчанию, вам следу-
ет сделать требуемую ячейку активной, затем выбрать нужный шрифт из списка.
Потом вы можете начинать ввод информации в ячейку.
По умолчанию используется размер символов, равный 10 пунктам. Вы можете
указать другой размер символов, как для вновь вводимой информации, так и для
введенной ранее информации. Размер символов выбранного шрифта выбирается из
открывающегося списка ю *• на панели инструментов форматирования. Текущий
размер отображается на панели, а справа находится кнопка для открытия списка.
Если вам нужно изменить размер символов уже введенной информации, вы-
делите ячейки и нажмите кнопку », в составной кнопке ю -v , и рядом появит-
ся список возможных размеров. Выберите нужный размер в списке, и вид ин-
формации в выделенных ячейках изменится. Если нужно вводить новую инфор-
мацию в ячейку, выберите ячейку или группу ячеек, откройте список размеров,
выберите нужный размер и начинайте вводить информацию.
Для оформления ячеек можно использовать различное начертание одного и
того же шрифта, например, обычное начертание, полужирное начертание, курсив
и подчеркивание. Выбор начертания осуществляется нажатием кнопок на панели
инструментов форматирования. Выделите ячейку или группу ячеек и нажмите
2К- Если в ячейках уже введена информация, она будет отображаться полужир-
ным шрифтом. Если вы вводите новую информацию, она будет введена сразу по-
лужирным шрифтом. Если нажать кнопку ]£, в дополнение к полужирному на-
чертанию информация будет отображаться еще и курсивом. Если нажать кнопку
"Ч> символы станут подчеркнутыми. Таким образом, кнопки }Ji£, J£ и *J мож-
но использовать независимо друг от друга и нажимать их в любой комбинации.
После того, как вы нажмете одну из этих кнопок, она останется в нажатом состо-
янии, и вся последующая информация будет вводиться с учетом выбранного ре-
жима начертания символов. Повторное нажатие кнопки отменит выбранное на-
чертание, и кнопка будет отжата. Вы можете отформатировать разным способом
части текста в ячейке. Для этого нужно выделить фрагмент текста в активной
ячейке, после чего изменить форматирование.
Еще одним способом оформления информации в ячейках является ее вырав-
нивание. По умолчанию, различная информация выравнивается по-разному. На-
пример, текст выравнивается по левому краю, а числа — по правому. Вы можете из-
менить выравнивание информации в ячейках по своему вкусу. Для выравнивания
информации в ячейках предназначено несколько кнопок на панели инструментов
форматирования. Выделите ячейку или группу ячеек и нажмите кнопку sh. Ин-
формация в ячейках будет выровнена по левому краю ячейки. Если нажать кнопку
ds, информация будет выровнена по правому краю ячейки. Нажав кнопку •=•, вы
выровняете информацию по центру ячейки.
34
Оформление электронных таблиц
В
Информация 1 Информация
Рис. 1.32. Объединение ячеек
Вы можете объединить несколько ячеек и выровнять информацию в них.
Введите информацию в ячейку (Рис. 1.32, слева), а затем выделите несколько
смежных ячеек, включая ячейку с информацией, и нажмите кнопку ^Щ. Выде-
ленные ячейки будут объединены в одну ячейку, а информация в них будет вы-
ровнена по центру (Рис. 1.32, справа).
Не все операции по форматированию можно выполнить из панели инстру-
ментов. Полностью возможности по выравниванию и расположению текста,
можно реализовать с помощью заполнения полей в специальных диалогах наст-
ройки форматирования. Выделите ячейку или группу ячеек, а затем выберите ко-
манду меню Формат Х£> Ячейки. Можно также после выделения ячеек щелкнуть
на них правой кнопкой мыши и в появившемся вспомогательном меню выбрать
команду Формат ячеек. В любом случае появится диалог настройки форматиро-
вания ячеек. Щелкните мышью на ярлычке Выравнивание, чтобы перейти на од-
ноименную вкладку (Рис. 1.33).
В данном диалоге вы можете настроить расположение информации в ячей-
ках. Группа элементов управления Выравнивание содержит открывающиеся спи-
ски для выравнивания по горизонтали и вертикали, а также поле ввода для зада-
ния отступа информации от границы ячейки. В открывающихся списках вы мо-
жете выбрать выравнивание по левому краю, по правому краю, по центру, по вы-
деленной области и так далее.
Выбрав выравнивание по значению в списке по горизонтали, вы установите
выравнивание в зависимости от типа информации в ячейке. Напомним, что текст
выравнивается по левому краю, а числа —
по правому, а логические значения вырав-
ниваются по центру ячейки. Выбрав вырав-
нивание по центру, вы установите данные в
ячейке строго по ее центру, вне зависимос-
ти от типа данных. Если вы выберете вы-
равнивание по левому краю или по правому
краю, станет доступным поле ввода отступ.
В этом поле нужно ввести значение отсту-
па, которое задается в знаках. Меняя вели-
чину отступа, вы можете подобрать нужное
вам положение данных в ячейке.
Если информация в ячейке больше,
чем ширина столбца, выбрав выравнива-
ние по ширине, вы сделаете так, что инфор-
Чжао {jwpeems9H«e '- \ шрифт [ Граница
Выравнивание
по горизонт апи:
г • - • . •
Отображение - - -
Г" переводить по словам
Г' автоподбор ширины
Г объединение ячеек
Направление текста
направление тексте;
т
Рис. 1.33.
Настройка выравнивания
35
Основы работы с электронными таблицами Excel
мация поместится в ячейке без изменения ее ширины. Чаще всего происходит
изменение высоты ячейки и перенос части информации вниз. Выбрав выравни-
вание с заполнением, вы размножите содержимое ячейки так, что информация
займет всю ячейку. Например, если в ячейке хранится число 123, то применив
это выравнивание, вы увидите в ячейке 123123, хотя в действительности там хра-
нится все то же число 123. Если вам нужно расположить информацию в центре
группы ячеек, выделите группу ячеек и выберите выравнивание по центру вы-
деления.
Так же вы можете настроить и выравнивание по вертикали. Выбрав в списке
по вертикали выравнивание по нижнему краю, вы поместите информацию вдоль
нижней границы ячейки. Выбрав выравнивание по центру, вы разместите ин-
формацию в середине ячейки, а, выбрав выравнивание по высоте, вы измените
высоту ячейки так, чтобы вся информация помещалась в ячейку.
Группа элементов управления Отображение предназначена для дополни-
тельного форматирования содержимого ячейки. Установив флажок переносить
по словам, вы говорите программе, чтобы при вводе информации, выходящей за
пределы ячейки, она переносилась на следующую строку этой же ячейки. Уста-
новка флажка автоподбор ширины уменьшает размер используемого шрифта так,
чтобы информация помещалась в ячейке. Вы можете указать программе, что не-
обходимо объединить смежные ячейки, если информация выходит за границы
одной ячейки. Для этого нужно установить флажок объединение ячеек.
Группа элементов управления Ориентация служит для изменения ориента-
ции данных в ячейке. По умолчанию, все слова и числа, помещенные в ячейку,
расположены горизонтально (Рис. 1.34, слева). Чтобы расположить их верти-
кально (Рис. 1.34, в центре), следует щелкнуть мышью на вертикальной надписи
Текст в группе элементов управления Ориентация.
Для поворота текста на произвольный угол в пределах девяноста градусов
вверх и вниз от горизонтали (Рис. 1.34, справа), используют индикатор со словом
Надпись. Чтобы установить угол поворота информации в ячейке следует щелк-
нуть мышью на точках, которые образуют полукруг вокруг слова Надпись. Это
слово будет повернуто в то место, куда вы щелкнули мышью. Для точного указа-
ния угла поворота служит поле ввода со счетчиком, расположенное ниже инди-
катора. Щелкните мышью на этом поле и введите нужное значение угла поворо-
та в градусах.
В открывающемся списке Направление текста, вы можете выбрать, как следу-
ет отображать текст. Можно указать ото-
> д бражение слева направо, справа налево
—~- или в зависимости от контекста. Чтобы
^ пу? применить новое форматирование, на-
12345]^ ^ J "х_ жмите кнопку ОК. Диалог будет закрыт и
внешний вид ячейки изменится.
Рис. 1.34. Если вы хотите, чтобы информация
Различное расположение информации в таблице легче воспринималась, лучше
36
Оформление электронных таблиц
АВТО
тттттттт
тттттттт
выделять важные места цветом. Смотрите ли вы на
таблицу на экране или печатаете ее на принтере,
разноцветное оформление может существенно
улучшить восприятие таблицы. Для цветового
оформления таблиц на панели инструментов фор-
матирования есть несколько кнопок.
Выделите ячейки, в которых вы хотите изме-
11 !("Ш 1ЯВИГ~1нить цвет текста, и нажмите кнопку "W, которая
расположена на панели инструментов правее
кнопки А. . Под кнопкой появится список цветов
— Выбор цвета
с образцами (Рис. 1.35).
Теперь вы можете выбрать любой цвет, щелкнув мышью на образце. При
этом список цветов исчезнет, а выбранный вами цвет появится в нижней поло-
се кнопки J L и одновременно изменится цвет текста выделенных ячеек. Для
изменения цвета уже введенных данных, выделите ячейки и нажмите кнопку
А^ на панели инструментов. Информация в выделенных ячейках изменит свой
цвет. При вводе новых данных, также выделите ячейку и нажмите кнопку
А_ Теперь начинайте набор информации новым цветом. Не забывайте, что по-
сле завершения ввода, установки цвета сбрасываются, и в следующую ячейку ин-
формация будет вводиться цветом, принятым по умолчанию.
Кроме изменения цвета вводимой информации вы можете изменить и цвет
фона, выбрав цвет заливки. Чтобы выбрать цвет заливки, нажмите кнопку v
правее кнопки ̂ 1, чтобы открыть список цветов с образцами (Рис. 1.35). На этот
раз палитра используется для задания фона ячейки. По умолчанию заливка от-
сутствует. Щелкнув мышью на нужном вам образце цвета, вы выбираете его для
заливки. После того, как цвет выбран, изменится фон выделенных ячеек. Также,
как для других операций оформления ячеек, действие кнопки заливки заканчи-
вается после завершения операции ввода. То есть, если вы хотите изменить фон
других ячеек, вам снова следует их выбрать и нажать кнопку ̂ .̂
Чтобы использовать дополнительные возможности заливки, выделите ячейку
или группу ячеек и затем выберите команду меню Формат Х£> Ячейки. Щелкните
мышью на ярлычке Вид, чтобы открыть одноименную вкладку (Рис. 1.36, слева).
Большую часть диалога занимает палитра для выбора цвета заливки ячеек.
Эта палитра также открывается при нажатии кнопки ̂  на панели инструмен-
тов. Однако дополнительно на данной вкладке имеется возможность создавать
более сложные, чем одноцветные заливки. Кроме заливки однородным цветом,
добавляется заливка с помощью различных узоров. Щелкните мышью на кноп-
ке т j в правой части открывающегося списка Узор, и будет открыта палитра с
набором узоров (Рис. 1.36, справа). Вверху расположен набор вариантов узоров,
а в нижней части диалога расположена палитра для выбора цвета узора. Щелч-
ком мыши выбирается как узор, так и его цвет.
Цвет заливки ячеек и цвет узора — это разные цвета, и применяются они не-
зависимо друг от друга. Сочетание цвета заливки и цвета узора может давать ин-
37
Основы работы с электронными таблицами Excel
нетцеете :
********m» mmm
* & «,* я а • в ш
Ш *
•Я
' ' • Э * ' '• -Образец
••••
Авто
•••••••К Ш С]  В В • И
mmmmmmmo
mm \mrnn
Puc. 1.36. Выбор цвета и узора
тересные цветовые эффекты при оформлении ячеек. В поле Образец вы можете
наблюдать получающийся результат действия выбранной комбинации цвета и
узора. Одновременно выбрать вид узора и его цвет нельзя. Вам придется сделать
это в два приема: сначала выбрать узор, а затем, еще раз открыв список, выбрать
цвет. В заключение, после того, как вариант заливки фона ячейки выбран, за-
кройте диалог настройки формата, нажав кнопку ОК. Выделенные ячейки изме-
нят свой внешний вид.
Когда вы видите таблицу на экране, ячейки разделены линиями сетки. Но
при печати документов этой сетки в документе не будет. Чтобы визуально выде-
лить часть ячеек таблицы, можно использовать обрамление с помощью специ-
альных линий и заполнение ячеек узорами. Выделите ячейку, для которой вы
хотите изменить обрамление, и нажмите кнопку Т', расположенную правее
кнопки И»;. Рядом с кнопкой появится вспомогательная панель с вариантами
обрамления (Рис. 1.37).
Щелкнув мышью на нужном образце, вы не только измените обрамление
выделенных ячеек, но и выберете его для работы. Выбранный вариант появляет-
ся внутри кнопки. В дальнейшем вам нужно выделить ячейку или группу ячеек,
нажать кнопку |»N, и выбранный вами вариант
обрамления будет применен к ним. Выбрав команду
Нарисовать границы, вы откроете вспомогательную
панель инструментов Граница. С помощью инструмен-
тов этой панели вы можете рисовать границы ячеек
прямо на экране. Можно выбирать режим рисования
или стирания границ, толщину и стиль линии грани-
цы, а также цвет линии.
Программа имеет гораздо больше вариантов об-
рамления, чем представлено среди образцов на панели
инструментов. Выделите ячейку или группу ячеек и за-
ш ш
Нэт Нарисовать границы...
Рис. 1.37.
Варианты обрамления
38
Оформление электронных таблиц
Число ] Выравнивав
ш;
Выберите ти
диапазона о
границей яч
с помощью мьдаи указ
я; Внешней границе в
•дельной ячейке.
Рис. 1.38.
Настройка границ
тем выберите команду меню Формат э£>
Ячейки. Щелкните мышью на ярлычке
Граница, чтобы открыть вкладку с полями
настройки обрамления (Рис. 1.38).
В группе элементов управления Все
расположены кнопки, с помощью кото-
рых можно выбрать вариант обрамления
по всем сторонам ячейки. В группе эле-
ментов управления Отдельные расположе-
но поле просмотра, а также кнопки для ус-
тановки обрамления по отдельным сторо-
нам ячейки. В поле просмотра вы видите
получающийся результат обрамления.
Список Линия позволяет выбрать один из
вариантов границы ячейки. Это может
быть сплошная или пунктирная линия различной толщины. Дополнить картину
обрамления ячейки можно, изменив его цвет с помощью открывающегося спис-
ка Цвет. Выбирая разные типы и цвета линий, вы должны нажимать и отжимать
кнопки в диалоге, чтобы добавлять или удалять линии обрамления. После того,
как обрамление ячейки настроено, нажмите кнопку ОК, чтобы закрыть диалог и
применить настройки. Внешний вид выделенных ячеек изменится.
Чтобы не настраивать форматирование ячеек для каждой ячейки, можно скопи-
ровать форматирование одной ячейки в другую. Если вы хотите скопировать не содер-
жимое ячейки, а ее оформление, следует выделить требуемую ячейку и нажать кнопку
^ на панели инструментов программы. Указатель мыши изменит форму на cQlj^.
Теперь следует выделить ячейки, куда вы хотите скопировать оформление, и формат
исходной ячейки будет скопирован в эти ячейки. Обратите внимание, что скопирова-
но только оформление ячейки, а ее содержимое не будет скопировано.
Если вам требуется скопировать формат ячейки в несколько ячеек, после
выделения исходной ячейки следует дважды щелкнуть мышью на кнопке ^.
При этом она останется нажатой. Щелкая мышью на нужных вам ячейках, вы
переносите в них новый формат. Чтобы закончить копирование формата, еще
раз нажмите кнопку *$ на панели инструментов. Кнопка будет отжата, и вы
выйдете из режима копирования формата.
При создании нового рабочего листа все его столбцы имеют одинаковую
ширину и, как вы уже видели, может возникнуть проблема с вводом больших чи-
сел и длинного текста (Рис. 1.39, слева). В этом случае нужно изменить размер
ячеек. В программе нельзя менять размер отдельных ячеек, однако можно изме-
||»го йНШШйи ^ Много информации
Рис. 1.39. Изменение ширины столбца и высоты строки
39
Основы работы с электронными таблицами Excel
нить размер столбца или строки целиком. Для изменения ширины столбца под-
ведите указатель мыши к правой границе заголовка столбца. Указатель изменит
вид на ~|-. Нажмите левую кнопку мыши и, не отпуская ее, перемешайте указа-
тель вправо. Правая граница столбца будет также перемещаться. После того, как
весь текст поместится в ширину столбца, отпустите кнопку мыши, и ширина
столбца изменится. (Рис, 1.39, в центре).
Высоту строки регулируют так же, как ширину столбца. Если подвести ука-
затель мыши к нижнему краю заголовка строки, указатель изменит вид на
-J-. Нажмите левую кнопку мыши и, не отпуская ее, перемещайте указатель
вверх или вниз, тем самым, уменьшая или увеличивая высоту строки. После то-
го, как вы отпустите кнопку мыши, высота строки будет изменена (Рис. 1.39,
справа).
Так вы можете приблизительно установить нужные размеры ячеек таблицы,
однако удобнее использовать автоматический подбор ширины и высоты ячеек.
Необходимо подвести указатель мыши к соответствующей границе заголовка
столбца или строки, чтобы указатель изменил форму на »|» или -|-. Затем дваж-
ды щелкните мышью, и размеры столбца или строки будут изменены так, чтобы
информация поместилась в них полностью. Если вы выделите несколько столб-
цов или строк, то можно изменить их ширину и высоту одновременно. Для это-
го следует дважды щелкнуть на границе любого из выделенных столбцов или
строк. Те же действия можно выполнить с помощью команды меню Формат Х£>
Столбец Х£> Автоподбор ширины. Для автоматического изменения высоты строки
следует выбрать команду меню Формат Х£> Строка Х£> Автоподбор высоты.
Можно задать размеры строк и столбцов в специальных диалогах. Чтобы за-
дать высоту строки, выберите команду меню Формат ^> Строка. Появится
вспомогательное меню, в котором вы можете выбрать команды форматирова-
ния такие, как изменение высоты строки вручную или автоматически, скрытие и
отображение строк. Выберите команду вспомогательного меню Высота, и по-
явится диалог настройки высоты (Рис. 1.40, слева).
В поле ввода Высота строки этого диалога можно изменить текущую высо-
ту строки в миллиметрах. Если менять высоту не нужно, нажмите кнопку Отме-
на. В противном случае введите новое значение высоты и нажмите кнопку ОК,
чтобы закрыть диалог.
Для задания ширины столбцов следует выбрать команду меню Формат з£>
Столбец. Будет открыто вспомогательное меню. Действия со столбцами анало-
гичны действиям со строками, только меня-
ется не высота, а ширина столбца. Выберите
команду вспомогательного меню Ширина, и
будет открыт диалог настройки ширины
(Рис. 1.40, справа). В поле ввода Ширина
Рис. 1.40. столбца следует ввести требуемое значение
Настройка высоты строки ширины в миллиметрах и нажать кнопку
и ширины столбца ОК, чтобы завершить ввод.
40
Оформление электронных таблиц
ОК | Отмена | !
Рис. 1.41.
Список скрытых листов
Можно настроить программу так, чтобы она не
отображала некоторые листы рабочей книги. Выбе-
рите лист, который вы хотите скрыть, щелкнув мы-
шью на его ярлычке в нижней части рабочего окна
программы, и затем выберите команду меню Фор-
мат :£> Лист ХР> Скрыть. Лист пропадет из рабо-
чей книги. Если вы захотите снова отобразить
скрытые листы, выберите команду меню Формат
:£> Лист :£> Отобразить. Будет открыт диалог со
списком скрытых листов (Рис. 1.41). Выберите в
списке скрытых листов тот, который необходим и нажмите кнопку ОК, чтобы за-
крыть диалог. Лист снова появится в рабочей книге.
В Excel есть несколько заранее определенных наборов оформления таблиц.
Это могут быть, например, списки, деловые листы, финансовые документы.
Удобнее воспользоваться готовыми вариантами оформления, чем создавать но-
вые. Чтобы воспользоваться автоматическим форматированием, нужно вначале
выделить ячейки, к которым нужно применить форматирование. После того, как
ячейки выделены, выберите команду меню Формат ^> Автоформат. Появится
диалог, содержащий различные готовые варианты форматирования (Рис. 1.42).
В этом диалоге в качестве образцов представлены имеющиеся в программе
варианты оформления. Щелкнув мышью на варианте оформления, вы выберете
его. Более того, вы можете использовать не все элементы оформления ячеек в
выбранном образце, а только часть. Для этого нажмите кнопку Параметры.
Внешний вид диалога изменится, и внизу появятся дополнительные элементы
управления.
Сбрасывая и устанавливая флажки в нижней части диалога, можно исполь-
зовать всю схему форматирова-
ния или ее часть. При сбросе или анш_лвшшш11^^
установке флажков в окне с вари-
антами форматирования автома-
тически будут происходить соот-
ветствующие изменения. После
того, как вариант выбран, нажми-
те кнопку ОК, чтобы закрыть диа-
лог и применить вариант форма-
тирования. Внешний вид выде-
ленных заранее ячеек изменится
в соответствии с выбранным вами
вариантом.
Сочетание нескольких видов
форматирования, включающих,
начертание и размер шрифта, его
цвет, заливку ячеек и так далее,
we фее мае Всего
Классический 2
вор-
Р* выравнивание
Р" ширину и высоту
Рис. 1.42.
Выбор варианта формата
41
Основы работы с электронными таблицами Excel
Рис. 1.43.
Настройка стиля
СТ«Л„ называется стилем оформления ячеек.
В программе есть ряд заранее опреде-
ленных стилей, применяемых к ячей-
кам. Так по умолчанию, ко всем ячейкам
применяется стиль Обычный, в котором
используется черный цвет для симво-
лов, отсутствие заливки, отсутствие об-
рамления, шрифт Arial размером 10 и
так далее.
Чтобы выбрать для ячеек другой
стиль, следует вначале выделить ячейки,
а затем выбрать команду меню Формат з£> Стиль. На экране появится диалог
выбора и настройки стилей (Рис. 1.43).
В открывающемся списке Имя стиля нужно выбрать подходящий стиль.
Можно применять стиль не полностью, а только отдельные его элементы. Это
осуществляется путем установки или сброса флажков в левой части диалога. Вы
можете создать свой собственный стиль, взяв готовый стиль и изменив его пара-
метры по своему вкусу. Для этого применяется кнопка Изменить. Кроме того, вы
можете выделить группу ячеек, которые оформлены так, как нужно, затем от-
крыть диалог настройки стиля и подправить, если есть необходимость, формати-
рование ячеек.
При создании стиля нужно дать ему имя, чтобы вы могли затем выбирать его
из списка стилей. Щелкните мышью на поле ввода Имя стиля, и введите новое
имя с помощью клавиатуры. При создании стиля все флажки в левой части диа-
лога будут установлены. Если вы хотите внести изменения в создаваемый стиль,
сбросьте ненужные флажки и нажмите кнопку Изменить. Появится уже знако-
мый вам диалог настройки форматирования ячеек.
С помощью вкладок этого диалога вы можете менять форматирование для
нового стиля, точно так же, как это рассмотрено выше. После того, как форма-
тирование ячеек изменено, закройте диалог форматирования, нажав кнопку ОК.
Теперь нажмите кнопку Добавить в диалоге
настройки стилей. В заключение закройте
этот диалог, также нажав кнопку ОК.
Стили будут храниться вместе с рабочей
книгой до тех пор, пока вы их не удалите. Для
удаления стиля выберите команду меню Фор-
мат :£> Стиль. В открывшемся диалоге выбе-
рите удаляемый стиль и нажмите кнопку Уда-
лить. Выбранный стиль будет удален, и вы не
сможете его больше использовать.
Если копируемые или перемещаемые
ячейки содержат оформление, при выполне-
нии операции копирования в новую ячейку
Г условия на значения
Гфеэраяви
Г щирины столбцов
(' формулы и форматы чисел
I значенид и форматы чисел
Рис. 1.44.
Параметры вставки
42
Оформление электронных таблиц
переносится все оформление. Если вы не хотите этого делать, а, например, хоти-
те перенести только данные, нужно воспользоваться специальной вставкой. Для
этого, выделите ячейки и нажмите кнопку Щ=|) или j£(, чтобы скопировать или
вырезать информацию. Затем выберите ячейку, куда следует поместить инфор-
мацию, и выберите команду меню Правка з£> Специальная вставка. Будет открыт
диалог настройки параметров вставки (Рис. 1.44).
С помощью переключателя Вставить вы выбираете, какую информацию из
оригинальной ячейки следует перенести в новую ячейку. Если в той ячейке, куда
вы вставляете информацию, уже есть данные, с помощью переключателя Опера-
ция вы можете выбрать, какие математические действия следует произвести над
данными в оригинальной ячейке и ячейке, куда вы производите вставку. По
умолчанию операции не производятся, и новые данные заменяют предыдущие
данные. После настройки параметров вставки нажмите кнопку ОК, и диалог бу-
дет закрыт, а информация вставлена в новую ячейку.
1.3.2. Использование числовых форматов
Одно и то же число, хранящееся в ячейке электронной таблицы, может ото-
бражаться по-разному в зависимости от используемого числового формата. На-
пример, введя число 0,4, вы можете отобразить его как 40%, 0,40р., и даже как 0.
Вне зависимости от того, как число отображается на экране, оно хранится в про-
грамме с точностью до 15 разрядов. Различные числовые форматы, которые мы
рассмотрим ниже, позволяют изменять внешний вид чисел, не изменяя их внут-
реннее представление.
По умолчанию, ко всем числам применяется формат Общий, который не
предусматривает никаких разделителей внутри числа (Рис. 1.45, слева). Если ва-
ши числовые данные в таблице являются денежными величинами, выделите
нужные ячейки и нажмите кнопку Щр. После этого внешний вид чисел изме-
нится (Рис. 1.45, второй слева).
Для работы с процентами следует выделить ячейки и нажать кнопку у£.
Посмотрите, как изменился вид чисел в выделенных ячейках (Рис. 1.45, второй
справа). Если вы должны использовать дробные числа с разделителем, выделите
ячейки и нажмите кнопку QQQ. В правой части числа появится дробная часть
(Рис. 1.45, справа). Для увеличения или уменьшения разрядности отображаемых
дробных чисел, нажимайте кнопки *,j§ и ̂  соответственно.
Кроме рассмотренных форматов, программа знает еще множество других.
Выделите ячейку или группу ячеек и выберите команду меню Формат з£> Ячей-
123456 11 123456,00р. f 12345600% 1 J 123456,000
Рис. 1.45. Различные варианты представления числа
43
Основы работы с электронными таблицами Excel
Число | Выравнивание ] Шрифт' j 'Границе j Вид'; .j Защита j
Образец
; 12345,00
десятичных знании:
GJytin разрядов
il
числовой формат являет чения чисел.
Для вывода денежных значений исло-илуюгся 1екж« форматы "Денежный" и
"фин внес БУЙ".
Рис. 1.46.
Настройка числовых форматов
ки. Появится диалог настройки форматиро-
вания. Щелкните мышью на ярлычке Чис-
ло, чтобы перейти на одноименную вкладку
диалога (Рис. 1.46).
Доступные числовые форматы пред-
ставлены в виде списка, расположенного в
левой части диалога. Выбрав формат из
списка, можно уточнить его параметры с
помощью элементов системы управления,
расположенных в правой части. Набор
элементов управления зависит от выбран-
ного вами формата. Так, для числового
формата можно указать точность числа,
вид разделителя, а также вид отрицатель-
ного числа.
Формат Общий используется для отображения данных в ячейках таблицы в
соответствии с их типом, то есть программа сама решает, как отображать инфор-
мацию. Выбрав формат Числовой, вы преобразуете информацию в ячейке в чис-
ло. Правила преобразования можно настроить в правой части диалога. Так вы
можете указать количество знаков после запятой, и выбрать в списке вид отри-
цательных чисел. Вам предлагается ставить перед отрицательным числом знак
минус или выделять отрицательное число красным цветом.
Для представления денежных величин используется формат Денежный. Вы-
брав этот формат в левой части диалога, в правой части вы можете выбрать число
десятичных знаков, символ обозначения валюты, а также выбрать в списке вид
отрицательных чисел. Если вам необходимо выравнивать денежные величины по
десятичному разделителю, используйте формат Финансовый. В настройках фор-
мата также можно указать обозначение валюты и количество десятичных знаков.
Формат Дата используется для представления дней месяцев и годов. В наст-
ройках вы можете выбрать вид представления даты в списке Тип. Если вам нуж-
но представление даты, используемое в разных странах, в списке Язык выберите
нужную вам страну. Для представления времени используется формат Время,
в настройках которого вы также можете выбрать вид и страну.
Если информация в ячейке должна быть представлена в виде процентов,
следует применить к этой ячейке формат Процентный. В настройках формата вы
можете в поле ввода указать число десятичных знаков. Для представления дро-
бей используется формат Дробный. В настройках вы можете выбрать вид изобра-
жения дробей, например, простые дроби, дроби в виде сотых долей и так далее.
В программе есть ряд дополнительных форматов, в которых можно выбрать фор-
мат для представления номеров телефонов, почтовых индексов, табельных номе-
ров и так далее.
Если вас не удовлетворяет ни один из предложенных форматов, вы можете
создать свой собственный числовой формат. Выберите формат Все форматы
44
Оформление электронных таблиц
в левой части диалога. Далее в поле ввода Тип нужно записать шаблон отображе-
ния чисел. При этом помните, что количество символов в шаблоне определяет
количество символов в ячейке. Используйте шаблон, достаточный для отобра-
жения всего предполагаемого вами диапазона чисел. Вы можете выбрать гото-
вый шаблон из списка ниже поля ввода, а можете создать его самостоятельно.
Нажав кнопку ОК, вы закроете диалог и примените выбранный формат для вы-
деленных ячеек.
1.3.3. Форматирование ячеек по заданным условиям
Удобной возможностью Excel является различное форматирование ячеек в
зависимости от информации, содержащейся в них. Например, можно залить
ячейку зеленым цветом, если число в ней положительное, или залить ее красным
цветом, если число отрицательное. То есть мы даем разное форматирование
ячейке в зависимости от условия, которое может выполняться или не выпол-
няться. Поэтому данный вид форматирования называется условным форматиро7
ванием. В качестве условного форматирования можно задавать параметры
шрифта, обрамления или заливки ячеек.
Сделайте активной ячейку, к которой хотите применить условное формати-
рование, после чего выберите команду меню Формат Х£> Условное форматирова-
ние. Появится диалог настройки условного форматирования (Рис. 1.47).
Левый открывающийся список позволяет выбрать тип условия. Выбрав эле-
мент значение, вы указываете, что форматирование ячейки должно быть выполне-
но на основе ее значения. При этом в списке, расположенном правее, нужно вы-
брать операцию сравнения. Если вы выберете операцию между, правее появятся
два поля ввода, в которых нужно указать граничные значения для сравнения.
В этих полях вы можете вводить как числа, так и адреса ячеек, содержимое кото-
рых будет использовано для сравнения с содержимым ячейки, в которой вы наст-
раиваете условное форматирование. Например, если вы хотите, чтобы при значе-
нии ячейки от 100 до 200 применялось условное форматирование, нужно в первом
списке выбрать значение, во втором списке выбрать операцию между, в первом по-
ле ввести число 100, а во втором поле ввести число 200. Также доступны операции
сравнения: вне, равно, неравно, больше, меньше, больше или равно и меньше или рав-
но. Смысл операции понятен из ее
названия, и в зависимости от опе-
рации возможно появление одного
или двух полей для задания сравни-
ваемых значений. Кроме чисел в
качестве сравниваемых значений
могут выступать результаты фор-
мул, а также адреса ячеек, значения
которых нужно использовать.
; ячейки при
выполнении условия:
Формат не задан
Рис. 1.47.
Настройка условного форматирования
45
Основы работы с электронными таблицами Excel
После указания операции и значений нажмите кнопку Формат, чтобы от-
крыть диалог настройки. Вкладки этого диалога повторяют часть вкладок диало-
га настройки форматирования ячеек, рассмотренного выше. Отметим, что на
вкладках этого диалога вы можете изменить шрифт, которым отображается ин-
формация, обрамление ячейки, а также цвет и узор заливки ячейки. После наст-
ройки форматирования нажмите кнопку ОК, чтобы закрыть диалог. В централь-
ной части диалога настройки условного форматирования появится изображение
оформления, которое будет применено к ячейке.
Иногда в качестве условия форматирования нужно использовать не значе-
ние данной ячейки, а информацию из других ячеек или информацию, которая
в ячейках не хранится, например информацию о текущей дате, времени и так да-
лее. В этом случае в качестве условия в левом списке диалога нужно выбирать
элемент формула. Правее появится поле для ввода формулы. Более подробно
о работе с формулами вы узнаете ниже, а пока отметим, что формула, которая ис-
пользуется в качестве условия, должна быть логической, то есть результатом
должно быть не число, а логическое значение ИСТИНА или ЛОЖЬ. Например,
если вы хотите, чтобы другое форматирование применялось, когда значение в
ячейке А1 больше значения в ячейке В1, нужно ввести формулу =А1>В1. После
ввода формулы вы нажимаете кнопку Формат и настраиваете форматирование
ячейки.
Иногда одного условия бывает недостаточно. Программа позволяет созда-
вать до трех условий, которые действуют как дополнение к основному условию.
По умолчанию отображаются элементы управления только для одного условия,
но если вы нажмете кнопку А также, появятся элементы управления для второ-
го условия. Если еще раз нажать кнопку А также, появятся элементы управле-
ния для настройки третьего условия. Для каждого условия можно задать свое
форматирование. Если выполняются несколько условий одновременно, приме-
няется форматирование, определенное для первого из этих условий. Если ни од-
но из условий не является истинным, применяется форматирование ячейки, ис-
пользуемое по умолчанию.
Если вы создали несколько условий, но потом решили удалить какое-либо
из условий, чтобы упростить общее условие, нажмите кнопку Удалить. Будет от-
крыт диалог удаления условий форматирования (Рис. 1.48). Установите флажки
у тех условий, которые нужно удалить и нажмите кнопку ОК, чтобы закрыть
диалог. Условие будет удалено, и внешний вид диалога
•УДМ.ЯИ. уел»™ форм... [; настройки изменится и из него исчезнут элементы
управления для удаленных условий.
После того, как условия и формат ячейки опреде-
лены, нажмите кнопку ОК, чтобы закрыть диалог наст-
ройки форматирования. Теперь, если будет выпол-
няться условие в указанной вами ячейке, оформление
Рис. 1.48. ячеек будет меняться. Отметим, что если остается хотя
Удаление условий бы одно условие, условное форматирование продол-
Укажите, какие условия
I ;усчо8»!е 1-
i условие 2
Г* условие £
46
Расчеты в электронных таблицах
жает действовать, даже если это условие не выполняется. Чтобы отменить услов-
ное форматирование, нужно удалить все условия, как это рассмотрено выше.
1.4. Расчеты в электронных таблицах
После того, как вы научились вводить и редактировать информацию в ячейках
электронной таблицы, нужно научиться обрабатывать эту информацию. В про-
грамме Excel обработка информации выполняется с помощью формул. Далее мы
рассмотрим, какие бывают формулы, как их вводить и как с ними работать.
1.4.1. Формулы в Excel
Формулами в программе называют выражения, по которым выполняются
вычисления на странице. Используя формулы, вы можете сравнивать данные в
ячейках, складывать и умножать значения ячеек, объединять содержимое ячеек
и выполнять множество других действий. Формулы можно вводить вручную или
использовать готовые формулы, предлагаемые программой.
Формула всегда начинается со знака равенства, и если в ячейке первый сим-
вол «=», программа считает, что это формула, и ее нужно вычислить. В противном
случае, программа воспримет выражение как текстовую строку. Например, выра-
жение 2*2 — это просто строка текста, а выражение =2*2 — формула. В этой фор-
муле есть операция умножения, обозначаемая символом «*», а также два числа,
являющихся константами, то есть постоянными, невычисляемыми значениями.
Для создания формул в программе предусмотрено несколько математичес-
ких и логических операций, каждая из которых описывается своим оператором.
Если вы хотите сложить или вычесть, нужно использовать операторы «+» и «-».
Для умножения и деления применяют операторы «*» и «/», а если нужно возве-
сти в степень, следует использовать оператор «А». Для сравнения величин в фор-
мулах используется отдельная группа операторов. Для проверки равенства или
неравенства используются операторы «=» и «О», а для сравнения нужно ис-
пользовать операторы «>», «<», «>=», «<=».
Вид выражения в формуле может быть довольно сложным. При вычислении
формулы сначала выполняется возведение в степень, затем умножение и деле-
ние, а потом сложение и вычитание. Сравнение выполняется только после вы-
полнения всех остальных операций. Если встречается несколько однотипных
операторов, вычисления идут слева направо. Однако вы можете изменить поря-
док выполнения операторов с помощью скобок. Вначале будут выполняться опе-
рации в скобках.
Кроме констант, в формулах можно использовать адреса и имена ячеек эле-
ктронной таблицы. В этом случае в формуле участвует не сам адрес, а значение в
47
Основы работы с электронными таблицами Excel
ячейке с данным адресом, то есть в формуле используется ссылка на ячейку. На-
пример, формула =А1+А2*3 берет содержимое ячейки А2, умножает его на три,
после чего прибавляет содержимое ячейки А1. Результат записывается в ячейку,
где расположена формула.
При помощи ссылок можно использовать в одной формуле информа-
цию, находящуюся в разных частях листа, а также использовать в несколь-
ких формулах значение одной ячейки. Кроме того, можно задавать ссылки
на ячейки других листов той же книги и на другие книги. В ссылках мож-
но использовать не только одинарные ячейки, но и диапазоны ячеек. Напри-
мер, ссылка А1, указывает на ячейку с данным адресом, а ссылка А1:АЗ,
указывает на диапазон ячеек между этими адресами. Ссылка А1;АЗ будет
указывать на две ячейки А1 и A3. Ссылка А 1:А2;А7указывает на ячейки Al, A2,
АЗиА7.
Если нужно указать ссылку на ячейку из другого листа рабочей книги, сле-
дует указать имя листа, символ «!» и адрес ячейки, например, Баланс!А1. Ино-
гда в формулах используют ячейки из разных рабочих книг. Чтобы ввести ссыл-
ку на ячейку из другой рабочей книги, следует записать путь к файлу с книгой:
= 'c:\Mou документы\[накладная.хЬ]Лист '!А1.
Кроме констант и ссылок на содержимое ячеек, в формулах могут участво-
вать функции, то есть стандартные формулы, которые возвращают результат раз-
личных действий над значениями, входящими в функцию, как аргументы. Для
вызова функции нужно написать ее имя и в скобках указать список аргументов,
разделенных запятыми, например ЦЕЛОЕ(А1). В качестве аргументов могут вы-
ступать числа, адреса ячеек, формулы или другие функции. Например, выраже-
ние СУММ(А1,МАКС(А2,АЗ)) содержит функцию суммирования содержимого
ячейки А1 и максимального значения из ячеек А2 и A3.
Если вы введете, например, в ячейку А4 следующую формулу:
—СУММ(А1:АЗ), а затем скопируете содержимое ячейки А4 в ячейку В4, вы
увидите, что в ячейке формула будет выглядеть по-другому: СУММ(В1:ВЗ).
Это происходит потому, что по умолчанию в Excel принята относительная ад-
ресация ячеек в формулах. На самом деле, запись ссылок А1:АЗ в формуле оз-
начает, что используются не сами ячейки, а их координаты по отношению к
той ячейке, где расположена формула. При переносе формулы на новое место
относительные координаты будут другими, и ссылки в формуле изменятся.
Это очень удобно, так как вы можете легко копировать ячейки с формулами в
любое место таблицы, и при этом их значение будет автоматически скоррек-
тировано.
Иногда в формуле требуется указать адрес конкретной ячейки, который не
должен меняться при перемещении ячейки с формулой. Для этого используется
абсолютная адресация ячеек. Чтобы адрес ячейки не менялся при копировании
формулы, перед адресом строки или столбца нужно поставить символ «$». Если
мы запишем нашу формулу так: =СУММ($А$1:$А$3), при переносе этой форму-
лы в любую другую ячейку ссылки на ячейки не изменятся. Естественно можно
48
Расчеты в электронных таблицах
сделать абсолютным только часть адреса, например, $А1. В этом случае при пе-
реносе будет меняться только адрес строки, а адрес столбца будет неизменным.
Для удобства работы с таблицей, вы можете присвоить ячейке или группе
ячеек собственное имя, которое можно использовать для адресации ячейки в
дальнейшем. Это имя может быть произвольным, но с некоторыми ограничени-
ями. Если ячейке присвоено имя, то адресовать эту ячейку можно как обычным
способом, так и по этому имени. Имена можно присваивать ячейкам, диапазо-
нам, формулам и константам. Имена могут заменять собою ссылки, что сущест-
венно облегчает задачу адресации в электронных таблицах. Преимущество от ис-
пользования имен заключается в том, что формулы благодаря именам становят-
ся более наглядными и понятными, например, формула =СУММ(дохо-
ды_за_1_квартол) лучше воспринимается, чем =СУММ(А1:В1).
Имя обладает некоторыми ограничениями. Оно должно начинаться с буквы
или с символа подчеркивания. После первой буквы можно использовать любые
символы, кроме дефисов и пробелов, то есть два слова в имени не должны разде-
ляться пробелом. Длина имени не должна превышать 255 символов, но предпо-
чтительнее короткие имена, которые проще набираются и легко читаются в рас-
крывающихся списках. В имени могут присутствовать как строчные, так и про-
писные буквы, но программа их не различает. Имя не должно напоминать адре-
са ячеек, например, АВ1, В$20 и так далее.
Чтобы присвоить имя ячейке или группе ячеек, выделите их, и щелкните мы-
шью левее строки формул, там, где показан адрес выделенной ячейки. Введите
вместо адреса произвольное имя, и оно будет присвоено ячейке. После того, как
вы присвоили имя выбранной ячейке, вы можете использовать это имя для адре-
сации ячейки при работе с Excel, например, вставлять его в формулы. Также мож-
но присвоить имя ячейке с помощью команды меню. Выберите команду Вставка
Х£> Имя Х£> Присвоить. Появится диалог ввода имени ячейки (Рис. 1.49).
В поле ввода Имя следует ввести имя ячейки. В списке, расположенном ни-
же, отображаются имена, уже присвоенные ячейкам. После ввода имени в поле
нажмите кнопку Добавить, и имя появится в списке имен. Добавление имени с
помощью команды меню менее удобно, чем первый из рассмотренных способов,
а вот для удаления имени ячейки или группы ячеек, удобнее воспользоваться
этим диалогом. Чтобы удалить имя из спис-
ка, выберите его и нажмите кнопку Уда-
лить. После ввода имени или его удаления
нажмите кнопку ОК, чтобы закрыть диалог.
7.4.2. Работа с формулами
Простейшие формулы лучше вводить
вручную, а для ввода формул, содержащих
функции, лучше воспользоваться мастером,
Рис. 1.49.
Присвоение имени ячейке
49
Основы работы с электронными таблицами Excel
который мы рассмотрим ниже. Сложные формулы, содержащие множество
функций, также удобнее вводить вручную. Для ручного ввода формулы введите в
строке формул знак равенства =, обозначающий начало формулы, после чего
введите собственно формулу, в которой могут быть константы, ссылки и опера-
торы. Отметим, что вместо ввода адреса ячейки можно просто щелкнуть на нуж-
ной ячейке мышью, и соответствующий адрес будет добавлен в формулу. Напри-
мер, вы можете ввести формулу =А1+А2, а можете ввести знак равенства, щелк-
нуть мышью на ячейке А1, ввести знак «плюс», после чего щелкнуть мышью на
ячейке А2. По окончании ввода выражения нажмите клавишу [[Enter] на клавиату-
ре. В активной ячейке появится результат. Так вы можете вводить любые форму-
лы в разные ячейки.
Часто используемые функции можно вставлять в формулы простым нажати-
ем кнопки на панели инструментов. Выделите ячейку и щелкните мышью на
строке формул. Нажмите кнопку jT на панели инструментов, и в строку формул
будет вставлена функция суммирования СУММ(). Далее нужно щелкнуть мы-
шью между скобок и указать адреса или диапазоны ячеек, которые следует сум-
мировать. Можно ввести адрес прямо в строке формул, а можно щелкать мышью
на нужных ячейках и ссылки на них будут подставляться в формулу. Для ввода
диапазона ячеек, эти ячейки нужно выделить. Если вы работаете с программой
Excel 2002, справа от кнопки ]§Г находится кнопка ~чг. Нажмите эту кнопку, и вы
увидите список часто используемых функций. Выбрав функцию в списке, вы
вставите ее в строку формул.
Открывающийся список десяти последних использовавшихся функций по-
является в левой части строки формул в тот момент, когда вы вводите символ =.
Откройте список, нажав кнопку ж в его правой части, и вы увидите перечень
используемых функций. Выбрав функцию из списка, вы подставите ее в строку
формул, и на экране появится диалог для ввода аргументов функции. В полях
ввода вы можете указать адреса ячеек или константы, участвующие в формуле.
После ввода всех аргументов нажмите кнопку ОК, диалог будет закрыт, а функ-
ция добавлена в формулу.
Если вы работаете в программе Excel 2002, чтобы облегчить ввод функции,
после того, как вы начали это делать, программа отображает подсказку; содержа-
щую синтаксис вводимой вами функции, то есть порядок следования всех ее ар-
гументов. Эта подсказка появляется после того, как вы введете название функ-
ции (Рис. 1.50).
Большинство функций вводят-
СУММ -г х \f £ =cyMM(l1;J1) ся в ячейки с помощью специаль-
В> С_ D ного мастера. Сначала выбирается
=СУММ(11;Л) ячейка, в которую мы будем зано-
СУНМ(число1; [число2]; [числоЗ];"...Д сить форМуЛу. После появления
курсора для ввода информации в
Рис. 1.50. строке формул, нажмите кнопку
Подсказка по функции fx в строке формул программы
50
Расчеты в электронных таблицах
Ооиск функции;
.•; • Введите краткое описание действия, которое нужно
выполнить, и нажмите «ночку "На1гги"
Категория; [id недавно использовавшихся jrj
Выберете функцию;
СРЭНАЧ
ЕСЛИ
' ГИПЕРССЫЛКА
. . СЧЁТ
МАКС
СУММ(число1;чнслоЭ;,.,)
Суинврует аргументы.
Справка no you ФУНКЦИИ I np J
щ 1
йайти j
zJ
Отмене j
Рис. 1.51.
Первый диалог мастера
или на стандартной панели инструментов, в
зависимости от версии программы. В строку
формул автоматически будет подставлен сим-
вол =, и на экране появится первый диалог
мастера вставки функций (Рис. 1.51).
Выбор функции осуществляется в не-
сколько этапов. Сначала в списке Категория
нужно выбрать группу функций, объединен-
ных по их назначению, к которой принадле-
жит искомая функция. После того, как кате-
гория выбрана, в списке Выберите функцию
появится список функций, относящийся к
выбранной категории.
Программа предлагает вам 12 категорий
функций. Если вам нужны математические расчеты, выбирайте категорию Ма-
тематические. Среди функций этой группы вы найдете тригонометрические
функции, округление, вычисление степеней и логарифмов, и так далее. Часто
при работе с таблицами используют текстовые функции. Чтобы выбрать функ-
цию из этой группы, выберите категорию Текстовые. Среди текстовых функций
есть функции поиска строк, изменения регистра символов, и так далее. Для срав-
нения различных величин используются логические функции. Выберите катего-
рию Логические, и вы сможете выбрать функции логического сложения, умноже-
ния и функции проверки условий. Если вы хотите использовать функции рабо-
ты с датами, выбирайте категорию Дата и время. С помощью функций этой ка-
тегории вы можете узнать текущую дату, время, день недели и так далее. Много
полезных функций находится в категории Финансовые. Если вы не представляе-
те себе, к какой области относится нужная вам функция, выберите категорию
Полный алфавитный перечень.
После того, как функция найдена, щелкните на ней мышью в списке Выбери-
те функцию. Обратите внимание, что ниже списка отображается синтаксис вы-
бранной функции, то есть правило ее написания и набор аргументов. Еще ниже на-
ходится описание функции, помо-
гающее определить ее назначе-
ние. Нажмите кнопку ОК, и пер-
вый диалог мастера будет закрыт.
Появится следующий диалог, ко-
торый предназначен для конкре-
тизации параметров функции, оп-
ределенной ранее. Количество и
вид параметров зависят от типа
выбранной функции. Может быть
один параметр, а может быть не-
сколько (Рис. 1.52).
Рис. 1.52.
Второй диалог мастера
51
Основы работы с электронными таблицами Excel
Параметры можно задать вручную, введя константу или ссылку в поле вво-
да, а можно с помощью мыши указать ячейки таблицы, значения которых ис-
пользуются как параметры. Нажмите кнопку ̂  в правой части поля ввода па-
раметров функции, диалог мастера будет свернут, освобождая тем самым рабо-
чую область окна программы. Теперь можно щелкнуть мышью на требуемой
ячейке, и ее адрес будет автоматически подставлен в функцию. Чтобы вернуть
диалог, нажмите кнопку [ср| в правой части свернутого диалога. Аналогично
можно заполнить остальные поля для ввода параметров, если они есть. После то-
го, как параметры функции установлены, нажмите кнопку ОК, чтобы закрыть
второй диалог мастера. На этом работа мастера будет закончена, и в активную
ячейку будет вставлена нужная формула.
Отметим, что если вы работаете с программой Excel 2002, в первом диалоге
мастера вставки функции есть возможность для поиска нужных функций. В по-
ле ввода Поиск функции вы должны ввести фразу, описывающую нужную функ-
цию, например, финансы. После того, как текст введен, нажмите кнопку Найти.
Будет произведен поиск указанной функции, и в списке Выберите функцию по-
явятся функции, отвечающие вашему запросу. Если немного изменить тему по-
иска, результат будет другим. Если по указанной вами фразе ничего не найдено,
в поле ввода появится текст с просьбой изменить фразу для поиска.
Чтобы изменить формулу в ячейке, следует сделать ячейку с формулой ак-
тивной, и текст формулы появится в строке формул. Если щелкнуть мышью на
строке формул, ячейки, участвующие в формуле, будут выделены разными цве-
тами (Рис. 1.53). Таким же цветом выделяются аргументы функции в строке фор-
мул. Это сделано специально, чтобы вы могли увидеть, какие ячейки участвуют
в редактируемой формуле. Вы можете внести исправления в формулу, отредакти-
ровав ее в строке формул. По окончании нажмите кнопку ̂  в строке формул
или нажмите клавишу ||Ent»r).
Если вы допустили ошибку при вводе или редактировании формулы, про-
грамма сообщит вам об этом. Если в ячейке с формулой отображается текст, на-
чинающийся с символа «#», значит, в формуле есть ошибка. Если в ячейке вы
увидите #####, ширина ячейки недостаточна для отображения результата. Что-
бы устранить ошибку, нужно расширить ячейку или изменить формат числа.
Когда в ячейке появляется сообщение #ИМЯ?, значит программа не распоз-
нала имя функции или имя ячейки, используемое в формуле. Сообщение
#ЗНАЧ! говорит о попытке некорректного использования функции. Обычной
ошибкой является несоответствие
СУММ =СУММ(ВЗ;С1)|
Рис. 1.53.
Редактирование формулы в ячейке
данных установленному формату, на-
пример, вместо числа или даты в аргу-
менте стоит текст. Это же значение
ошибки будет появляться, когда для
функции или оператора, которые тре-
буют одного значения аргумента, за-
дается диапазон.
52
Расчеты в электронных таблицах
Сообщение #ЧИСЛО! появляется, если
возникли проблемы с представлением или с
использованием чисел. Не исключено, что в
функции с числовым аргументом использу- Рис. 1.54.
ется аргумент нечислового формата. Воз- Панель зависимостей
можно также, что в ячейку введена формула,
возвращающая слишком большое значение. Если в ячейке появилось сообщение
#ССЫЛКА! значит есть проблема с адресацией ячеек, участвующих в формуле.
Возможно, что формула содержит ссылку на ячейку, которая уже удалена, или
ссылку на ячейку, в которую скопировано содержимое других ячеек.
Сообщение #ДЕЛ/0! возникает при попытке деления на ноль. Такая ситуа-
ция чаще возникает не из-за того, что в ячейку записано явное деление на ноль,
а как следствие использования в качестве делителя ссылки на пустую ячейку или
ячейку, содержащую нулевое значение. Сообщение #ПУСТО! говорит о появле-
нии ошибки в случае задания в ссылке пустого множества ячеек. Возможно, что
вы ошиблись в определении пересечения двух диапазонов. Сообщение #Н/Дго-
ворит о наличии неопределенных данных.
Если после ввода формулы программа не сообщила об ошибке, это еще не
значит, что ошибки нет. В составе программы есть ряд средств проверки пра-
вильности введенных формул. Например, вы можете наглядно посмотреть, как
значения в одних ячейках влияют на результат формул в других ячейках. Выбе-
рите команду меню Сервис :£> Зависимости з£> Панель зависимостей, чтобы ото-
бразить на экране панель инструментов проверки формул (Рис. 1.54).
Давайте рассмотрим назначение инструментов данной панели. Чтобы уви-
деть, какие ячейки участвуют в формуле, выделите ячейку с формулой и нажми-
те кнопку Ц" на панели инструментов зависимостей. Будут автоматически на-
рисованы связи от используемых ячеек к ячейке с формулой (Рис. 1.55).
Чтобы убрать связи от ячеек к формуле, нажмите кнопку •})• на панели ин-
струментов зависимостей. Если результат формулы в ячейке используется в дру-
гих формулах, вы легко можете это проверить. Выделите ячейку с формулой и
нажмите кнопку •£]•. Будут нарисованы стрелки к другим ячейкам, в которых
используется результат данной ячейки. Если таких ячеек нет, будет открыт диа-
лог с сообщением о том, что данных связей нет. Нажмите кнопку «^ для удале-
ния этого вида связей. Если вам потребуется удалить все изображения связей, то
следует нажать кнопку ̂ . Если нажать кнопку ф, то будут показаны зависи-
мости, приведшие к появлению ошибки
в активной ячейке. А1 , »; =сумм(ВЗ;С1)
Кроме того, в Excel 2002 около ячей- | ., д в | : с р
ки с ошибкой появится значок [ф]. Если ЩЭ *r̂ ~JSL Т"*-..
подвести к этому значку указатель мыши, :̂ Ц^
рядом появится кнопка Т". Нажмите эту
кнопку, и будет открыто вспомогательное Рис. 1.55.
меню. С помощью команд этого меню вы Связи между ячейками
53
Основы работы с электронными таблицами Excel
в D
1
2
3
"4"
5
6
0'
и
^
Иии
1
Сергей:
Здесь есть
ошибка, надо
подумать
Рис. 1.56. Ввод заметки
можете посмотреть справку по ошиб-
ке, игнорировать ошибку или отре-
дактировать ячейку.
Удобной возможностью програм-
мы является добавление к ячейкам
различных комментариев. При этом
ячейка будет содержать особую отмет-
ку, а при выборе этой ячейки на экра-
не будет отображаться окно с коммен-
тарием (Рис. 1.56).
Чтобы добавить или отредактиро-
вать комментарий, следует выбрать нужную ячейку и нажать кнопку ffjj на па-
нели инструментов проверки формул. Появится поле для ввода комментария.
Обратите внимание, что комментарий вставляется от имени владельца копии
программы Excel. Вы можете ввести в данном поле любой комментарий. При
этом размер поля будет автоматически изменяться. Чтобы завершить ввод ком-
ментария, щелкните мышью вне поля ввода. Поле будет закрыто, а ячейка, име-
ющая комментарий, будет выделена значком ^ в правом верхнем углу ячейки.
В дальнейшем, щелкнув мышью на ячейке, содержащей комментарий, вы отоб-
разите его на экране.
Чтобы видеть, где расположены ошибочные данные, удобно обвести их в
таблице. Выделите ячейку с формулой, которая содержит ошибки, и нажмите
кнопку Щ на панели инструментов зависимостей. Ячейки, в которых есть
ошибочные данные, будут обведены. Чтобы снять обводку, следует нажать кноп-
Кроме рассмотренных кнопок на панели зависимостей в программе Excel 2002
есть еще ряд кнопок. Выделите ячейку или группу ячеек, которые содержат фор-
мулы и нажмите кнопку ̂ . Программа последовательно просматривает вы-
деленные вами ячейки и проверяет формулы, которые в них находятся. Если бу-
дет обнаружена формула, содержащая ошибку, появится диалог контроля оши-
бок (Рис. 1.57).
В данном диалоге показана ошибочная формула, а также адрес ячейки, в ко-
торой она находится. Ниже формулы расположен текст ошибки для поясне-
ния. Кнопки, расположенные в правой части диалога помогут вам исправить
обнаруженную ошибку. Нажав кнопку
Справка по этой ошибке, вы откроете
окно подсказки, где детально описа-
ны обнаруженная ошибка и возмож-
ные пути ее устранения. Кнопка По-
казать этапы вычислений вызывает
диалог пошагового выполнения фор-
мулы, позволяющий определить, на
каком этапе вычисления возникает
Ошибка в яче
; =СУММ(аЗ;е
Формула содержит nepacnosi
Рис. 1.57.
Контроль ошибок
54
Расчеты в электронных таблицах
ошибка. Нажав кнопку Пропус-
тить ошибку, вы помечаете дан-
ную ошибку как просмотренную,
но никакие исправления в нее не
вносятся. Если вы хотите испра-
вить ошибку, нажмите кнопку
Изменить в строке формул. С по-
мощью кнопок Назад и Далее вы
можете переходить от одной
ошибки к другой и назад. Нажав
кнопку Параметры, вы откроете
диалог настройки параметров по-
иска ошибок (Рис. 1.58).
Проверка ошибок |
Периметры - • - - - •• -
(5" Включить фожйую проверку ощибок
. . Щит отображения ошибок: | Дето j«j
Проверять Наличие следующих ошибок
Р*" вычисление формулы вызывает ошибку
р" текстовая дате с2-значным гадом
р" нислч сохранено «к текст
F" нвсоглвсуащаисн формула в области . • . . . . :
Р~ формула не-юв&гыввет оедкны* ячейки
"Р? «еэ&юкирвваив ячейка, содержащая формулу
Г~ форму» сшйветс» «в пустые анейки
ос пропущенных ошибок :
Рис. 1,58.
Параметры контроля ошибок
Установив флажок Включить фоновую проверку ошибок, вы разрешаете про-
грамме проверять формулы на наличие ошибок автоматически в то время, ког-
да вы занимаетесь другими делами. В списке вы можете выбрать цвет, которым
будут выделяться ошибочные формулы. Кроме того, нажав кнопку Сброс пропу-
щенных ошибок, вы снова включите в проверку те формулы, которые содержат
ошибки, но были ранее пропущены. Ниже расположен ряд флажков, которые
включают или выключают правила поиска ошибок в формулах. Сброс флажка
исключает правило из проверки, а установка флажка — включает правило для
проверки.
После того, как параметры настроены, нажмите кнопку ОК, чтобы закрыть
диалог настроек и вернуться к диалогу контроля ошибок. Диалог будет закрыт,
когда вы просмотрите последнюю ошибку из имеющихся в таблице. Чтобы пре-
рвать контроль ошибок, закройте диалог, нажав кнопку ЦЩ в правом верхнем уг-
лу диалога.
Можно проверять наличие ошибок с помощью контроля за содержимым
ячеек. Если нажать кнопку Цр на панели инструментов проверки формул, то по-
явится окно наблюдения (Рис. 1.59).
В этом окне в виде списка отображаются ячейки, которые помечены для на-
блюдения за их содержимым. Каждый элемент списка содержит адрес ячейки, ее
имя, название листа рабочей книги, на котором он расположен. Также отобража-
ются название самой рабочей книги, формула и ее значение.
Чтобы удалить ячейку из списка наблюдения, следует выделить ее в списке,
и нажать кнопку Удалить. Удаленная ячейка исчезнет из списка. Можно выде-
лить несколько ячеек и удалить их за один
прием. Чтобы добавить ячейки в список на-
блюдения, следует нажать кнопку Добавить.
Появится диалог добавления ячеек в список
наблюдения (Рис. 1.60).
В поле ввода данного диалога нужно ввес-
ти адрес ячейки и формулу, в которой следует
2з добавить контрольное значение,..
Рис. 1.59.
Окно наблюдения
55
Основы работы с электронными таблицами Excel
•v нужно просмотреть:
Рис. 1.60.
Добавление ячейки
для наблюдения
наблюдать. Если нажать кнопку [§| в правой час-
ти поля ввода параметра, диалог будет свернут, ос-
вобождая тем самым рабочую область окна про-
граммы. Теперь можно выделить мышью нужную
ячейку или группу ячеек для добавления в список
наблюдения. Чтобы вернуть диалог, нажмите
кнопку [ср[ в правой части свернутого диалога.
После того, как ячейки выбраны, нажмите кноп-
ку Добавить, чтобы закрыть диалог и добавить ячейки в список. Чтобы убрать
окно наблюдения, нажмите кнопку J^ в правом верхнем углу этого окна.
Можно выявить ошибку в формуле, если выполнять ее шаг за шагом. Вы-
делите ячейку с формулой, в которой есть ошибка, и нажмите кнопку (Щ на па-
нели инструментов зависимостей. Появится диалог пошагового выполнения
(Рис. 1.61).
В данном диалоге вы можете шаг за шагом выполнить формулу, наблюдая
за промежуточными результатами. Чтобы начать выполнение, нажмите кнопку
Выполнить. Будет выполнена первая операция формулы, и станут доступными
кнопки Шаг с заходом и Шаг с выходом. Если нажать кнопку Шаг с заходом, бу-
дет выполнена очередная операция формулы, а если нажать кнопку Шаг с вы-
ходом, вы вернетесь к предыдущему шагу вычислений. Во время пошагового
выполнения в левой части диалога появляются адреса используемых ячеек, вы-
деленные цветом. Это помогает отслеживать правильность выполнения фор-
мулы. Для завершения пошагового выполнения формулы, нажмите кнопку За-
крыть.
Чтобы работать с некоторыми из описываемых в книге функций, нужно ус-
тановить дополнительные компоненты Excel, не установленные по умолчанию.
Если при описании функции сказано, что требуется пакет анализа или пакет по-
иска решения, нужно выполнить дополнительную настройку Excel. Выберите
команду меню Сервис 3£> Надстройки. Будет открыт диалог выбора дополнитель-
ных пакетов программы Excel (Рис. 1.62). Если нужных пакетов нет в списке,
следует выполнить дополнительную установку пакета программ Microsoft Office,
выбрав недостающие компоненты.
В списке надстроек, выведен-
ном в диалоге, полезно установить
флажки у элементов Пакет анализа
и Поиск решения. Эти надстройки
полезны сами по себе, вне зависимо-
сти от необходимости использова-
ния функций. Если флажки у этих
элементов уже установлены, ничего
делать не нужно. После того, как вы
выбрали нужные надстройки, на-
жмите кнопку ОК, чтобы закрыть
Для просмотре результата вычисления подчеркнутого выражения нажмите кнопку
"вычислить". Последний полученный результат отображается курсивом.
Рис. 1.61.
Пошаговое выполнение
56
Расчеты в электронных таблицах
диалог. Необходимые надстройки будут подключе-
ны к программе. После этого лучше завершить ра-
боту в программе, сохранив результаты работы, а за-
тем снова запустить программу и загрузить рабочую
книгу для дальнейшей работы.
1.4.3. Обзор полезных функций
Analysis ToolPel
Мастер падет at
пересчет в евро
Поиск решения
Помощник ПО И кг ер нету
Содержит функции и интерфейсы для е
научных и финансовых данных
Рис. 1.62.
Выбор дополнительных
функций
В состав программы входит очень много встро-
енных функций, и бывает сложно разобраться, что
делает каждая из них. Так, в мастере ввода функций
вы найдете 12 категорий функций: математические,
функции сравнения, текстовые функции, функции
работы с датой и временем, функции работы со
ссылками и так далее. Ниже мы дадим краткий обзор некоторых полезных функ-
ций, и вы сможете пользоваться этим разделом, как справочником.
Очень часто при составлении таблиц используют математические функции.
Например, функция СУММ(число1; число2;...) используется для суммирования
содержимого указанного интервала ячеек. Максимально в функции может быть
до 30 аргументов. В качестве аргументов этой функции используются числа, ад-
реса ячеек, диапазон ячеек. При этом если в диапазоне ячеек встречаются пустые
ячейки, ячейки содержащие текст, который нельзя преобразовать в число, при
вычислении суммы они игнорируются.
Если вам нужно суммировать ячейки по какому-либо условию, можно вос-
пользоваться функцией СУММЕСЛЩдиапазон; критерий; диапазон суммирова-
ния). Аргумент диапазон определяет диапазон вычисляемых ячеек. Аргумент
критерий представляет собой число, выражение или текст, по которому идет
сравнение результата суммирования ячеек, определяемых первым аргументом.
Аргумент диапазон суммирования определяет адреса ячеек, сумма значений в ко-
торых будет вычисляться, если сумма значений в ячейках первого аргумента
удовлетворяет критерию.
Иногда бывает нужно использовать целую часть дробного числа. В этом слу-
чае можно воспользоваться функцией ЦЕЛОЕ(число), где число — это аргумент,
определяющий число, которое нужно округлить. В качестве аргумента функции
может выступать численная константа или ссылка на ячейку, содержащую чис-
ловой результат. Обратите внимание, что результатом выполнения функции бу-
дет округление до ближайшего меньшего целого числа, например, результатом
формулы =ЦЕЛОЕ(3,3) будет число J, а результатом =ЦЕЛОЕ(3,99) также будет
число 3. Так, что правильнее назвать действие данной функции не округлением,
а взятием ближайшего меньшего целого.
Если вам нужно изменить разрядность числа, воспользуйтесь функцией ок-
ругления ОКРУГЛ(число; число разрядов), которая округляет число до указанного
57
Основы работы с электронными таблицами Excel
количества десятичных разрядов. Аргумент число содержит округляемое число, а
аргумент число разрядов - количество десятичных разрядов, до которого нужно
округлить число. Если число разрядов больше нуля, число округляется до ука-
занного количества десятичных разрядов справа от десятичной запятой. Если
число разрядов равно нулю, число округляется до ближайшего целого, а если
число разрядов меньше нуля, число округляется слева от десятичной запятой.
Для округления чисел также можно воспользоваться функцией НЕЧЁТ(чис-
ло), которая возвращает число, округленное до ближайшего нечетного целого.
Аргумент число — это округляемое значение. Если аргумент функции не являет-
ся числом, то функция возвращает значение ошибки #ЗНАЧ!. Независимо от
знака числа, округление всегда производится с избытком. Если число является
нечетным целым, то округления не происходит.
Для нахождения абсолютной величины числа, то есть числа без знака, мож-
но использовать функцию АВЗ(число), где число — действительное число, абсо-
лютную величину которого требуется найти.
С помощью функции ОСТАТ(делимое; делитель) вы можете определить оста-
ток при делении чисел. Функция возвращает остаток от деления делимого на де-
литель. Результат имеет такой же знак, как и делитель. Аргумент делимое — это
число, остаток от деления которого определяется, а делитель — число, на которое
нужно разделить. Если делитель равен нулю, функция возвращает значение
ошибки #ДЕЛ/0!.
Иногда бывает нужно преобразовать арабские цифры в римские. Для этого
используйте функцию РИМСКОЕ(число; форма), где число - преобразуемое чис-
ло в арабской записи, а форма — число от нуля до четырех, задающее нужную
форму римской записи чисел. Чем меньше число, определяющее форму, тем бо-
лее упрощенной будет римская запись числа.
Для вычисления различных величин в списках, в составе программы также
есть функции, одной из которых является функция ПРОМЕЖУТОЧНЫЕ.ИТО-
ГЩномер функции; ссылка!; ссылка2;...), которая возвращает промежуточный ре-
зультат вычислений в список или базу данных. Аргумент номер функции пред-
ставляет собой число от единицы до 11, которое указывает, какую функцию ис-
пользовать при вычислении итогов внутри списка. Если этот аргумент равен
единице, используется функция СРЗНАЧтл вычисляется среднее значение. Если
аргумент равен двум, используется СЧЁТ кия подсчета количества чисел. При
аргументе равном трем используется функция СЧЁТЗ, которая подсчитывает ко-
личество чисел и непустых ячеек. Если номер функции равен четырем, исполь-
зуется функция М4Ж7для вычисления максимального значения, а при номере
функции равном пяти используется функция МИН. Когда номер функции равен
шести, промежуточные итоги вычисляются с помощью функции ПРОИЗВЕД, то
есть произведения элементов списка. Если номер функции равен семи или вось-
ми, промежуточные итоги вычисляются с помощью функций СТАНДОТКЛОН и
СТАНДОТКЛОНП. Это означает, что будет вычислено стандартное отклонение по
выборке значений и по всем значениям списка. Если номер функции равен де-
58
Расчеты в электронных таблицах
вяти, будет вычислена сумма значений списка с помощью формулы СУММ. Ког-
да номер функции равен 10 или 11, промежуточными итогами будут дисперсия
по выборке и по общей совокупности значений. Эти итоги вычисляются с помо-
щью функций ДИСП и ДИСПР. Вторым, третьим и остальными аргументами
функции являются ссылки на ячейки или интервалы ячеек, по которым подво-
дятся итоги. Если уже имеются формулы подведения итогов внутри ссылок, эти
вложенные итоги игнорируются, чтобы избежать двойного суммирования.
Функция игнорирует все скрытые строки, которые получаются в результате
фильтрации списка. Это важно в том случае, когда нужно подвести итоги только
для видимых данных.
Для вычисления сумм в столбцах списка в зависимости от разных условий
следует применять функцию БДСУММ(база данных; поле; критерий). Данная
функция суммирует числа в столбце списка или базы данных, которые удовле-
творяют заданным условиям. Аргумент база данных представляет собой интервал
ячеек, в котором расположен список. Базой данных называют список связанных
данных, в котором строки данных являются записями, а столбцы — полями.
Верхняя строка списка содержит названия всех столбцов. Аргумент поле опреде-
ляет столбец, используемый функцией. Аргумент может быть задан в виде текс-
та с названием столбца в двойных кавычках, например «Доход» или «Расход», или
как число, определяющее номер столбца в списке, начиная с единицы. Аргумент
критерий определяет интервал ячеек, который содержит задаваемые условия.
Любой интервал, который содержит, по крайней мере, одно название столбца и,
по крайней мере, одну ячейку под названием столбца с условием, может быть ис-
пользован в качестве аргумента критерий.
Кроме математических функций, часто используются функции для работы
с текстом. Если вам нужно объединить несколько текстовых строк в одну стро-
ку, следует воспользоваться функцией СЦЕПИТЬ(текст1;текст2;...), где
текст!, текст2, и так далее — от одного до 30 текстовых строк или адресов яче-
ек, содержащих текстовые строки. Например, если в ячейки A3 и СЗ вы введете
строки Баланс и 2002, тогда результатом функции =СЦЕПИТЬ(АЗ;СЗ), будет
строка Баланс 2002.
Иногда бывает нужно заменить часть одной текстовой строки символами из
другой текстовой строки. В этом случае используют функцию ЗАМЕНИТЬ (ста-
рый текст; начальная позиция; число знаков; новый текст). Аргумент старый
текст определяет текстовую строку, где нужно менять некоторые символы. Ар-
гумент начальная позиция представляет собой номер символа в старом тексте,
начиная с которого будет идти замена. Аргумент число знаков — это число сим-
волов, которое следует заменить. Последний аргумент новый текст содержит
текстовую строку, откуда будут браться символы для замены. Например, резуль-
татом формулы =ЗАМЕНИТЬ(«Отчет за январь»; 10;6;» апрель») будет строка
Отчет за апрель.
Если нужно преобразовать буквы в тексте из одного регистра в другой, ис-
пользуются специальные функции ПРОПИСН(текст) и СТРОЧН(текст).
59
Основы работы с электронными таблицами Excel
Функция ПРОПИСНделает все буквы в текстовой строке прописными, а если вы
хотите сделать обратное преобразование, то есть преобразовать буквы в строч-
ные, следует использовать функцию СТРОЧН. У данных функций только один
аргумент, определяющий текстовую строку, которая будет преобразована. На-
пример, результатом работы формулы =ПРОПИСН(«баланс»), будет строка БА-
ЛАНС, а результатом формулы =СТРОЧН(«ОТЧЕТ») будет строка отчет. Можно
также использовать в функции не текст, а ссылки на ячейки, содержащие текст,
например, ПРОПИСЩА1) или СТРОЧЩВ2).
Иногда бывает нужно удалить из строки лишние пробелы. Для этого мож-
но использовать функцию СЖПРОБЕЛЫ(текст), где текст — это преобразуе-
мый текст. Функция используется для обработки текстов, если эти тексты мо-
гут содержать избыточные пробелы. Результатом работы функции является
удаление из текста всех пробелов, за исключением одиночных пробелов между
словами.
Если вам нужно преобразовать число в текст, следует воспользоваться функ-
цией ТЕКСТ(значенш; формат), которая преобразует значение в текст в задан-
ном числовом формате. Аргумент значение определяет число, которое будет пре-
образовываться, и должен быть либо значением, либо формулой, либо ссылкой
на ячейку, содержащую числовое значение. Аргумент формат — это один из чис-
ловых форматов, выбираемый при форматировании ячейки. Мы уже рассматри-
вали числовые форматы, поэтому не будем на них останавливаться. Отметим
лишь, что формат задается в виде текстовой строки.
Иногда возникает обратная задача — преобразовать текст в число. Для этого
используйте функцию ЗНАЧЕН(текст), которая преобразует строку текста, ото-
бражающую число, в число. Аргумент текст - это текст в кавычках или ссылка
на ячейку, содержащую текст, который нужно преобразовать. Текст может быть в
любом формате, допускаемом программой для числа, даты и времени. Если текст
не удовлетворяет ни одному из этих форматов, то функция возвращает значение
ошибки #ЗНАЧ!.
Можно преобразовать число в текст, используя денежный формат. Для этого
используется функция РУБЛЬ(число; число знаков), которая преобразует число в
текстовый формат и добавляет к нему обозначение денежной единицы с округ-
лением до заданного числа десятичных знаков. Аргумент число - это либо число,
либо ссылка на ячейку, содержащую число, либо формула, вычисление которой
дает число. Аргумент число знаков — это число цифр справа от десятичной запя-
той. Если число знаков отрицательно, число округляется слева от десятичной за-
пятой. По умолчанию число знаков равно двум.
Если вам нужно узнать, сколько знаков в строке, воспользуйтесь функцией
ДЛСТР(текст), которая возвращает количество знаков в текстовой строке. Аргу-
мент текст — это текстовая строка, длину которой нужно вычислить. Обращаем
внимание, что пробелы в тексте также учитываются при определении длины.
Для сравнения текстовых строк используется функция СОВПАД(текст1;
текст2), которая сравнивает две строки текста и возвращает значение ИСТИНА,
60
Расчеты в электронных таблицах
если они в точности совпадают, или ЛОЖЬ в противном случае. Функция учиты-
вает регистр, но игнорирует различия в форматировании. Аргумент текст! — это
первая текстовая строка, а текст2 — вторая текстовая строка.
Если нужно найти какие-либо символы в текстовой строке, можно исполь-
зовать функцию ПОИСК(искомый текст; текст для поиска; начальная позиция).
Эта функция просматривает строку слева направо и возвращает номер символа,
начиная с которого в тексте есть искомая фраза. Аргумент искомый текст — это
фраза, которую вы ищете. В искомой фразе можно использовать шаблоны, на-
пример, знак вопроса «?», что соответствует любому знаку, и звездочку «*», кото-
рая соответствует любой последовательности знаков. Аргумент текст для поиска
содержит текстовую строку, в которой нужно найти фразу. Аргумент начальная
позиция определяет номер символа в тексте, начиная с которого будет идти по-
иск. С помощью этого аргумента можно пропустить при поиске нужное число
знаков. При этом помните, что функция возвращает номер символа, начиная с
первого, не взирая, с какого символа начался поиск. Если искомый текст не най-
ден, возвращается значение ошибки #ЗНАЧ!.
Функция ПОИСК не различает регистр символов при поиске. Если нужно
искать с учетом регистра, следует использовать функцию НАЙТЩискомый
текст; просматриваемый текст; начальная позиция). Эта функция находит
вхождение одной текстовой строки в другую текстовую строку и возвращает по-
ложение начала искомого текста относительно крайнего левого знака просмат-
риваемого текста. Аргумент искомый текст — это фраза для поиска, просматри-
ваемый текст содержит текст, в котором идет поиск, а начальная позиция — это
позиция знака, с которой следует начинать поиск. В отличие от функции ПО-
ИСК, данная функция не позволяет искать по шаблону и при поиске учитывает
регистр символов.
В программе есть большое число функций для работы с датой и временем.
Давайте рассмотрим некоторые из этих функций, однако вначале отметим, что в
программе Excel даты хранятся в виде чисел, и можно выполнять над ними вы-
числения. По умолчанию порядковый номер первого января 1900 года равен
единице, и от этой даты идет отсчет.
Функция ДАТА(год; месяц; день) возвращает целое число, представляющее
определенную дату. Функция особо полезна в тех случаях, когда год, месяц и
день, получаются в результате расчетов. Если до ввода этой функции форматом
ячейки был формат Общий, то в результате формат изменится на Дата. Аргумент
год может иметь от одной до четырех цифр, например 2002. Аргумент месяц оп-
ределяет число, представляющее месяц года. Если значение аргумента больше
12, введенное число месяцев отсчитывается от первого месяца следующего года.
Например, ДАТА(2002;14;2) возвращает второе февраля 2003 года. Аргумент день
представляет собой число, определяющее день месяца. Если значение аргумента
больше числа дней в указанном месяце, введенное число дней отсчитывается от
первого дня-следующего месяца. Например, ДАТА(2002;1;35) возвращает четвер-
тое февраля 2002 года.
61
Основы работы с электронными таблицами Excel
Если нужно узнать дату, отстоящую от текущей на заданное количество ме-
сяцев, используйте функцию ДАТАМЕС(начольноя дата; число месяцев). Эта
функция работает только при установленном пакете анализа. О том, как это сде-
лать рассказано выше. Данная функция возвращает в числовом формате дату, от-
стоящую на заданное количество месяцев вперед или назад от заданной даты.
Чаще всего эта функция используется для вычисления срока погашения или да-
ты платежа, приходящейся на тот же день месяца, что и начальная дата. Аргумент
начальная дата определяет дату начала расчетов. Дата задается с помощью числа
и для этого удобно использовать функцию ДАТА. При этом вводить даты как
текст не допускается. Аргумент число месяцев определяет количество месяцев до
или после даты начала. Положительное значение аргумента означает даты в бу-
дущем, а отрицательное значение - даты в прошлом. Если начальная дата не яв-
ляется допустимой датой, функция возвращает значение ошибки #ЗНАЧ!. Если
число месяцев нецелое, производится усечение до целого числа месяцев.
Как вы уже знаете, даты хранятся в программе в виде чисел,"и чтобы узнать,
какой год соответствует числу, воспользуйтесь функцией ГОД(дата в числовом
формате). Эта функция возвращает год, соответствующий аргументу, являюще-
муся датой в числовом формате. Год определяется как целое число в интервале
1900—9999. Единственный аргумент дата в числовом формате — это дата, год ко-
торой необходимо найти. Даты должны вводиться с использованием функции
ДАТА или как результат вычисления других формул и функций. Например, для
22 июля 2002 года следует использовать ДАТА(2002;7;22). Дату как текст вводить
нельзя. В заключение нажмите кнопку ОК, чтобы закрыть диалог.
Можно узнать месяц в числе, которое интерпретируется программой как да-
та. Это делается с помощью функции МЕСЯЩдата в числовом формате), кото-
рая возвращает месяц в дате, заданной в числовом формате. Месяц возвращает-
ся как целое число в диапазоне от единицы до 12. Аргумент дата в числовом
формате определяет дату, месяц которой необходимо найти. Даты должны вво-
диться с использованием функции ДАТА или как результат других формул
и функций.
Можно узнать текущие время и дату с помощью функции ТДАТА() и исполь-
зовать эту информацию в таблицах. Функция возвращает целое число, пред-
ставляющее текущие дату и время. В числовом формате даты цифры справа от
десятичной запятой представляют время, а цифры слева от десятичной
запятой представляют дату. Если до ввода этой функции форматом ячейки был
Общий, результат будет отформатирован как Дата. Аргументов у данной функ-
ции нет, но скобки все равно нужно добавлять.
Если вам нужно узнать только текущие дату, а время вас не интересует, мож-
но воспользоваться функцией СЕГОДНЯ(), которая возвращает текущую дату в
числовом формате. Если до ввода этой функции форматом ячейки был Общий, ре-
зультат будет отформатирован как Дата. У этой функции также нет аргументов.
Если вам нужно узнать день недели для произвольной даты, следует исполь-
зовать функцию ДЕНЬНЕД(дата в числовом формате; тип). Эта функция воз-
62
Расчеты в электронных таблицах
вращает день недели, соответствующий указанной в качестве аргумента дате.
День недели определяется как целое в интервале от одного до семи или от нуля
до шести. Аргумент дата в числовом формате представляет собой число, обозна-
чающее дату, день недели которой нужно вычислить. Даты должны вводиться с
использованием функции ДАТА или как результат вычисления других формул и
функций. Аргумент тип представляет собой число, которое определяет, как вы-
числяется дата. Если этот аргумент равен единице, неделя начинается с воскре-
сенья, и дни имеют номера от единицы до семи. Если аргумент равен двум, не-
деля начинается с понедельника, и дни нумеруются как в предыдущем случае.
Когда аргумент равен трем, неделя также начинается с понедельника, но дни ну-
меруются от нуля до шести.
Среди полезных функций для бухгалтера можно отметить вычисление числа
рабочих дней между двумя заданными датами. Такой расчет делается с помощью
функции ЧИСТРАБДНЩначальная дата; конечная дата; праздники). Эта функ-
ция требует, чтобы был установлен пакет анализа, и возвращает количество рабо-
чих дней между начальной датой и конечной датой. Праздники и выходные в это
число не включаются. Функцию можно использовать для вычисления оплаты
работника на основе количества дней, отработанных в указанный период. Аргу-
мент начальная дата содержит число, являющееся датой начала расчетов, аргу-
мент конечная дата содержит дату окончания расчетов. Аргумент праздники
является необязательным. Но если он введен, то это список из одной или не-
скольких дат, которые требуется исключить из рабочего календаря, например го-
сударственные праздники. Список может представлять собой диапазон ячеек,
содержащих даты. Все даты должны быть представлены в виде чисел. Проще все-
го это сделать с помощью функции ДАТА. Если любой из аргументов не является
допустимой датой, то функция возвращает значение ошибки #ЗНАЧ!.
Можно узнать какое число будет последним днем в месяце, отстоящем от
заданной даты на выбранное число месяцев с помощью функции КОНМЕСЯ-
ЦА(начальная дата; число месяцев). Эта функция также требует включения па-
кета анализа, как это показано выше. Функция возвращает число, представля-
ющее собой дату последнего дня месяца, отстоящего на указанное количество
месяцев от начальной даты. Часто эта функция используется для вычисления
даты вступления в силу обязательств или даты платежа, которая приходится на
конец месяца. Аргумент начальная дата хранит начальную дату для расчетов,
представленную в виде числа. Даты должны вводиться с использованием функ-
ции ДАТА или как результат вычисления других формул и функций. Аргумент
число месяцев определяет количество месяцев до или после начальной даты. По-
ложительное значение аргумента означает будущие даты, а отрицательное зна-
чение — прошедшие даты. Если число месяцев не целое, то производится усече-
ние. Если начальная дата не является допустимой датой в числовом формате, то
функция возвращает значение ошибки #ЧИСЛО!. Эта же ошибка возникает, ес-
ли сумма начальной даты и конечной даты также является недопустимой датой
в числовом формате.
63
Основы работы с электронными таблицами Excel
Для сравнения различных данных в ячейках используют логические функ-
ции. Например, если вам нужно проверить содержимое ячеек и в зависимости от
этого содержимого выполнить различные действия, удобно использовать функ-
цию ЕСЛЩлогическое выражение; значение если истина; значение если ложь). Эта
функция возвращает одно значение, если заданное условие выполняется, и дру-
гое значение, если условие не выполняется. Аргумент логическое выражение -
это любое значение или выражение, принимающее значения ИСТИНА или
ЛОЖЬ. Например, 5>J это логическое выражение, имеющее всегда значение
ИСТИНА. А вот выражение А10>0 может принимать как значение ИСТИНА, так
и ЛОЖЬ, в зависимости от содержимого ячейки А10. Аргумент значение если ис-
тина хранит значение, которое возвращается, если первый аргумент функции
принимает значение ИСТИНА. Это может быть число или текстовая строка, или
ссылка на ячейку. Аргумент значение если ложь хранит значение, которое возвра-
щается функцией, если первый аргумент принимает значение ЛОЖЬ. Можно ис-
пользовать вложенные функции ЕСЛИ, то есть аргументами функции могут быть
другие условные функции. Это позволяет строить сложные условия для провер-
ки. Кроме функции ЕСЛИ, в программе есть еще ряд условных функций, напри-
мер СУММЕСЛИ или СЧЁТЕСЛИ.
Если нужно проверить, все ли значения в указанном вами диапазоне имеют
значение ИСТИНА, следует использовать функцию Щлогическое значение!; логи-
ческое значение2;...), которая возвращает значение ИСТИНА, если все аргументы
имеют значение ИСТИНА и возвращает значение ЛОЖЬ, если хотя бы один аргу-
мент имеет значение ЛОЖЬ. Аргументы логическое значение!, логическое значе-
ние2 и так далее, содержат проверяемые условия, которые могут иметь значение
либо ИСТИНА, либо ЛОЖЬ. Если аргумент, который является ссылкой, содер-
жит текст или пустые ячейки, то такие значения игнорируются. Если указанный
интервал не содержит логических значений, то функция возвращает значение
ошибки #ЗНАЧ!.
В программе есть ряд функций, облегчающих работу со ссылками. С помо-
щью встроенных функций можно узнать номер строки или столбца, на которые
указывает ссылка и другие значения. Функция СТРОКА(ссылка) возвращает но-
мер строки, определяемой ссылкой. Аргумент ссылка указывает ячейку или ин-
тервал ячеек, для которых определяется номер строки. Если ссылка опущена, то
предполагается, что это ссылка на ячейку, в которой находится сама функция.
Аналогичная функция есть и для столбцов — СТОЛБЕЦ(ссылка). Эта функ-
ция возвращает номер столбца по заданной ссылке. Единственный аргумент
ссылка описывает адрес ячейки или интервал ячеек, для которых определяется
номер столбца. Если ссылка опущена, предполагается, что это ссылка на ячейку,
в которой находится сама функция.
В программе есть ряд функций для работы со списками. Более подробно о
списках вы узнаете в следующей главе, а пока отметим, что списками называют-
ся таблицы, которые содержат связанные между собой данные. Если нужно най-
ти какое-либо значение в столбце списка и выдать значение из указанной ячей-
64
Расчеты в электронных таблицах
ки в найденной строке, используйте функцию ВПР(искомое значение; таблица;
номер столбца; интервальный просмотр). Эта функция ищет значение в крайнем
левом столбце таблицы и возвращает значение в той же строке из указанного
столбца таблицы. Текстовые строки сравниваются без учета регистра букв. Аргу-
мент искомое значение хранит значение, которое должно быть найдено в первом
столбце списка и может быть числом, ссылкой или текстовой строкой. Аргумент
таблица определяет список, в котором ищутся данные. Можно использовать
ссылку на интервал или имя интервала, если вы присвоили интервалу имя.
Аргумент номер столбца определяет номер столбца в списке, в котором
должно быть найдено соответствующее значение. Если номер столбца равен еди-
нице, возвращается значение из первого столбца списка. Если номер равен двум,
возвращается значение из второго столбца, и так далее. Если номер столбца
меньше единицы, функция возвращает значение ошибки #ЗНАЧ!, а если номер
столбца больше, чем количество столбцов в списке, то функция возвращает зна-
чение ошибки ЯССЫЛ!.
Аргумент интервальный просмотр является логическим. Если он имеет зна-
чение ИСТИНА, значения в первом столбце списка должны быть расположены в
возрастающем порядке. В этом случае возвращается приблизительно соответст-
вующее значение. Если этот аргумент имеет значение ЛОЖЬ, список сортиро-
вать не обязательно. В этом случае функция ищет точное соответствие. Если со-
ответствие не найдено, возвращается значение ошибки #Н/Д.
Аналогично функции ВПР работает функция ГПР. Она ищет значение в
верхней строке списка и возвращает значение в том же столбце из заданной стро-
ки списка. Функция используется, когда сравниваемые значения расположены в
верхней строке списка, а возвращаемые значения расположены на несколько
строк ниже. Если сравниваемые значения расположены в столбце слева от иско-
мых данных, то следует использовать функцию ВПР. Назначение аргументов
этих функций одинаково.
Если нужно изменить ссылку на ячейку в формуле, не изменяя саму формулу,
следует воспользоваться специальной функций ДВССЫЛ(ссылка на ячейку; А1),
которая возвращает ссылку, заданную текстовой строкой. Аргумент ссылка на
ячейку содержит ссылку на ячейку, которая в свою очередь содержит ссылку на
другую ячейку. Эта ссылка может быть обычной, а может быть именем. Если
ссылка на ячейку не является допустимой ссылкой, то функция возвращает зна-
чение ошибки #ССЫЛ!. Если ссылка на ячейку является внешней ссылкой, то
есть ссылкой на другую рабочую книгу, эта книга должна быть открыта. Если это
не так, функция возвратит значение ошибки ЯССЫЛКА!. Аргумент А1 является
логическим и указывает, какого типа ссылка содержится в первом аргументе
функции. Если аргумент имеет значение ИСТИНА, или вообще не указан, ссыл-
ка на ячейку интерпретируется как ссылка в стиле А1. Если второй аргумент име-
ет значение ЛОЖЬ, первый аргумент интерпретируется как ссылка в стиле R1C1.
Вы можете получить адрес ячейки по ее координатам с помощью специаль-
ной функции АДРЕС(номер строки; номер столбца; тип ссылки; А1; имя листа),
65
3—5458
Основы работы с электронными таблицами Excel
которая создает адрес ячейки в виде текста, используя номер строки и номер
столбца. Аргумент номер строки определяет номер строки, используемый в ссыл-
ке ячейки. Аргумент номер столбца определяет номер столбца, используемый в
ссылке ячейки. Аргумент тип ссылки определяет, какого типа создается ссылка.
Если тип равен единице, создается абсолютная ссылка. Если тип равен двум, со-
здается ссылка с абсолютной строкой и относительным столбцом. Если тип ра-
вен трем, в ссылке будет относительная строка и абсолютный столбец. И, нако-
нец, если тип равен четырем, создается относительная ссылка. Аргумент А1 яв-
ляется логическим и определяет стиль ссылок. Если аргумент имеет значение
ИСТИНА или вообще не указан, создается ссылка в стиле А1. В противном случае
будет создана ссылка в стиле R1C1. Аргумент Имя листа является текстовым и
определяет имя рабочего листа, который используется для формирования внеш-
ней ссылки. Если имя листа опущено, то внешние листы не используются.
Конечно, мы рассмотрели далеко не все имеющиеся в составе программы
функции. Функции, посвященные финансовому анализу, мы рассмотрим в сле-
дующей главе, а остальные функции вы можете изучить самостоятельно. В гла-
вах, посвященных примерам, вы познакомитесь с практическим использовани-
ем разных функций.
ГЛАВА 2.
ОСОБЕННОСТИ EXCEL, ПОЛЕЗНЫЕ БУХГАЛТЕРУ
Изучив первую главу книги, вы сможете создавать в Excel практически любые
таблицы. Однако для повышения эффективности работы вам будет полезно изу-
чить некоторые дополнительные особенности Excel. Финансовые функции, ис-
пользование списков, сводных таблиц, импорт данных из бухгалтерских и других
программ, выполнение анализа данных, а также работа с рисунками и диаграмма-
ми, могут оказаться полезными при работе бухгалтера с электронными таблицами.
2.1. Особенности работы с формулами
Формулы в электронных таблицах Excel позволяют воспользоваться множе-
ством приемов, значительно повышающих эффективность работы. Вы можете
давать имена отдельным ячейкам, диапазонам ячеек, и даже целым столбцам
таблицы, и потом использовать их в формулах. Ввод формул в смежные ячейки
также имеет свои особенности. Кроме того, в Excel имеется множество финансо-
вых функций, полезных бухгалтеру.
2.1.1. Финансовые функции в Excel
Среди встроенных функций Excel есть несколько десятков финансовых
функций. В большинстве случаев эти функции используются для проведения
финансового анализа, но часто эти функции могут оказаться полезными и
67
Особенности Excel, полезные бухгалтеру
для бухгалтера. Некоторые финансовые функции требуют для своей работы
установки пакета анализа. О том, как устанавливать дополнительные пакеты,
мы уже говорили в первой главе, поэтому сейчас мы не будем на этом оста-
навливаться. Если для работы функции нужен пакет анализа, мы отметим это
при описании функции. Также следует отметить, что состав финансовых
функций в Excel 2002 немного отличается от Excel 97 или 2000. При описании
функций мы обязательно отметим различия финансовых функций в разных
версиях.
Достаточно часто используются функции расчета амортизации. При работе
в Excel 97 или 2000 полезна функция АМГД(Начольноя стоимость; Остаточная
стоимость; Время эксплуатации; Период), предназначенная для расчета годовой
амортизации имущества для выбранного вами периода. Параметр Начальная
стоимость определяет начальную стоимость имущества, параметр Остаточная
стоимость определяет стоимость имущества в конце периода амортизации. Па-
раметр Время эксплуатации определяет время амортизации, выраженное в коли-
честве периодов, а параметр Период определяет период, за который вычисляется
амортизация. Например, если у вас на балансе находится компьютер, приобре-
тенный за 30000 рублей, срок его амортизации составляет 10 лет и остаточная
стоимость 10000 рублей, для расчета амортизационных отчислений на втором го-
ду эксплуатации можно воспользоваться формулой =АМГД(30000;10000; 10;2) и
получить в результате 3272,73 рубля.
В Excel 2002 функции ЛМ/Д нет, зато есть две аналогичные функции. Функ-
ция АПЛ(Началъная стоимость; Остаточная стоимость; Время эксплуатации)
вычисляет величину амортизации за период, используя линейный метод. Так как
амортизация в каждом году одинаковая, период не задается. Функция АСЧ(На-
чальная стоимость; Остаточная стоимость; Время эксплуатации; Период) вы-
числяет величину амортизации за период, используя метод суммы чисел, то есть
точно так же, как функция АМГДъ предыдущих версиях.
Также часто используется функция ДЦОБ(Начальная стоимость; Остаточ-
ная стоимость; Время эксплуатации; Период; Коэффициент), которая вычисляет
значение амортизации актива за данный период, используя метод двойного
уменьшения остатка или иной явно указанный метод. Параметры Начальная
стоимость и Остаточная стоимость определяют начальную и конечную стои-
мость имущества, параметр Время эксплуатации определяет число периодов, за
которые имущество амортизируется, параметр Период определяет период, за ко-
торый нужно вычислить амортизацию, параметр Коэффициент определяет про-
центную ставку снижающегося остатка. Если коэффициент опущен, то он пола-
гается равным двум, то есть используется метод удвоенного процента со снижа-
ющегося остатка. Если нужно использовать другой метод вычисления амортиза-
ции, измените значение коэффициента.
В Excel 97 или 2000 есть функция АМР(Начальная стоимость; Остаточная
стоимость), которая вычисляет величину амортизации за один период. Параме-
тры Начальная стоимость и Остаточная стоимость определяют начальную и
68
Особенности работы с формулами
конечную стоимость имущества. Если вы пользуетесь Excel 2002, рекомендуется
пользоваться функцией АЛЛ и указать в качестве периода единицу.
Функция ПУО(Начольноя стоимость; Остаточная стоимость; Время экс-
плуатации; Начальный период; Конечный период; Коэффициент; Переключатель)
в Excel 2002 вычисляет величину амортизации для частичных периодов с исполь-
зованием метода двойного уменьшения остатка. Параметры Начальная стои-
мость и Остаточная стоимость определяют соответственно затраты на приоб-
ретение имущества и его стоимость в конце периода амортизации. Параметр
Время эксплуатации определяет количество периодов, за которые собственность
амортизируется. Параметры Начальный период и Конечный период определяют на-
чальный и конечный периоды вычисления амортизации. Параметр Коэффици-
ент определяет процентную ставку снижающегося остатка. Если коэффициент
опущен, то используется метод удвоенного процента со снижающегося остатка;
Если нужно использовать другой метод вычисления амортизации, введите значе-
ние этого параметра, отличное от двух. Параметр Переключатель — это логичес-
кое значение, определяющее, следует ли использовать линейную амортизацию в
том случае, когда амортизация превышает величину, рассчитанную методом
снижающегося остатка.
Функция ФУО(Начальная стоимость; Остаточная стоимость; Время экс-
плуатации; Период; Месяцы) возвращает величину амортизации имущества для
заданного периода, рассчитанную методом фиксированного уменьшения остат-
ка. Параметры Начальная стоимость и Остаточная стоимость определяют со-
ответственно затраты на приобретение имущества и стоимость имущества в кон-
це периода амортизации. Параметр Время эксплуатации определяет количество
периодов, за которые собственность амортизируется. Параметр Период опреде-
ляет период, для которого требуется вычислить амортизацию. Параметр Месяцы —
это количество месяцев в первом году. Отметим, что в Excel 97 или 2000 функций
ПУО и ФУО нет.
Есть еще несколько функций для вычисления амортизации. Если вы ис-
пользуете французскую систему бухгалтерского учета, полезной может оказаться
функция АМОРУВ, которая вычисляет величину амортизации для каждого пери-
ода, и функция АМОРУМ, которая подобна функции АМОРУВ, за исключением
того, что применяемый в вычислениях коэффициент амортизации зависит от пе-
риода амортизации.
Обратите внимание, что в функциях вычисления амортизации, период дол-
жен быть выражен в тех же единицах, что и время эксплуатации. Например, ес-
ли вы хотите вычислить амортизацию за день, время амортизации также должно
быть указано в днях. Если нужна амортизация за какой-либо год, время также
должно быть указано в годах.
Множество финансовых функций можно использовать для расчетов креди-
тов и инвестиций. Часто используется функция БЗ(Норма; Периоды; Выплата;
Приведенная стоимость; Тип), которая вычисляет будущую стоимость инвести-
ции на основе периодических постоянных платежей и постоянной процентной
69
Особенности Excel, полезные бухгалтеру
ставки. Параметр Норма определяет процентную ставку за период, параметр Пе-
риоды определяет общее число периодов платежей. Параметр Выплата определя-
ет выплату, производимую в каждый период, параметр Приведенная стоимость
определяет приведенную к текущему моменту стоимость будущих платежей.
Можно опустить этот параметр, и тогда он будет считаться равным нулю. Пара-
метр Тип определяет, когда должна производиться выплата. Если он равен нулю,
выплата производится в конце периода, а если он равен единице, выплата про-
изводится в начале периода. Отметим, что в Excel 2002 аналогичная функция на-
зывается БС и имеет те же параметры. Например, вы хотите узнать, какая сумма
накопится на счете за два года, если вы в конце каждого месяца кладете на счет
1000 рублей, а банк начисляет девять процентов годовых и условия вклада не из-
менятся. Можно составить формулу =БС(0,09/12;24;-1000;0;0) и получить ре-
зультат 26188,47 рублей.
Можно сформулировать задачу немного иначе: вы раз в месяц кладете в
банк 10000 рублей под 15 процентов годовых. Через сколько лет у вас на счете
будет миллион рублей. Для решения подобных задач используется функция
КПЕР(Ставка; Платеж; Приведенная стоимость; Будущая стоимость; Тип), ко-
торая возвращает общее количество периодов выплаты для инвестиции на ос-
нове периодических постоянных выплат и постоянной процентной ставки. Па-
раметр Ставка определяет процентную ставку за период, параметр Платеж оп-
ределяет выплату, производимую в каждый период, а параметры Приведенная
стоимость и Тип такие же, как и у предыдущей рассмотренной функции. Пара-
метр Будущая стоимость определяет требуемое значение будущей стоимости
или остатка средств после последней выплаты. В нашем примере формула будет
выглядеть так =КПЕР(0,15/12;10000;0;1000000;0), а результатом будет 65,3 меся-
ца или 5,44 года.
Функция ППЛАТ(Ставка; Периоды; Приведенная стоимость; Будущая стои-
мость; Тип), которая в Excel 2002 называется ПЛТ, возвращает сумму периодиче-
ского платежа на основе постоянства сумм платежей и постоянства процентной
ставки. Параметр Ставка определяет процентную ставку по ссуде, параметр Пе-
риоды определяет общее число выплат по ссуде, параметр Приведенная стои-
мость определяет приведенную к текущему моменту стоимость, или общую сум-
му, которая на текущий момент равноценна ряду будущих платежей. Параметр
Будущая стоимость определяет требуемое значение будущей стоимости, или ос-
татка средств после последней выплаты, а параметр Тип — это ноль для выплат в
конце периода и единица для выплат в начале периода. Эту функцию можно ис-
пользовать для решения, например, такой задачи: при каком размере ежемесяч-
ного платежа удастся накопить миллион к 50 годам без изменения ставки 15 про-
центов, если вам сейчас 35 лет. В этом случае формула будет выглядеть
=ПЛТ(0,15/12;(50-35)*12;;1000000), ответ будет -1495,87 рубля. Отрицательное
значение означает расход средств.
Функция НОРМА(Периоды; Платеж; Приведенная стоимость; Будущая сто-
имость; Тип), которая в Excel 2002 называется СТАВКА, возвращает процентную
70
Особенности работы с формулами
ставку за один период при выплате ренты. Параметр Периоды определяет общее
число периодов платежей, параметр Платеж определяет величину регулярного
платежа один раз за период, величина которого остается постоянной. Параметр
Приведенная стоимость определяет приведенную к текущему моменту стоимость
или общую сумму, которая на текущий момент равноценна ряду будущих плате-
жей, а параметр Будущая стоимость определяет требуемое значение будущей
стоимости или остатка средств после последней выплаты. Параметр 7мл должен
содержать ноль или единицу и означает, когда должна производиться выплата -
в конце или начале периода. С помощью этой функции можно определить, при
какой годовой процентной ставке удастся накопить миллион к 55 годам, откла-
дывая на счет ежемесячно 100 рублей, если вам сейчас 35 лет. В этом случае фор-
мула будет выглядеть =СТАВКА((55-35)*12;-100;;1000000)*12. Ответом будет
число 0,28, что означает 28 процентов.
Функция ПЗ(Ставка; Периоды; Платеж; Будущая стоимость; Тип) в Excel 2002
называется ПС и возвращает приведенную к текущему моменту стоимость инве-
стиции. Параметр Ставка определяет процентную ставку за период, параметр
Периоды определяет общее число периодов платежей по регулярным выплатам.
Параметр Платеж — это выплата, производимая в каждый период и не меняю-
щаяся за все время выплаты. Параметр Будущая стоимость определяет требуе-
мое значение будущей стоимости или остатка средств после последней выплаты.
Параметр Тип должен содержать ноль или единицу и означает, когда должна про-
изводиться выплата. С помощью данной функции можно определить, какую
сумму достаточно вложить на срок 10 лет единовременно, чтобы при доходно-
сти 15 процентов и при ежемесячном начислении сложных процентов нако-
пить миллион рублей. Формула для решения задачи будет выглядеть так:
=ПС(0,15/12; 10*12;; 1000000). Ответ на задачу будет -225214,41 рублей.
Функция НОМИНАЛ(Ставка; Периоды) вычисляет номинальную годовую
ставку, если заданы фактическая ставка и число периодов в году, за которые на-
числяются сложные проценты. Параметр Ставка определяет фактическую про-
центную ставку. Параметр Периоды определяет количество периодов в году.
Функция ОБЩДОХОД(Ставка; Периоды; Текущая стоимость; Первый пери-
од; Последний период; Тип) вычисляет общую сумму, выплачиваемую в погашение
основной суммы займа в промежутке между двумя периодами. Параметр Ставка
определяет процентную ставку, параметр Периоды определяет общее количество
периодов выплат, параметр Текущая стоимость определят стоимость инвестиции
на текущий момент. Параметр Первый период определяет номер первого периода,
включенного в вычисления. Периоды выплат нумеруются, начиная с единицы.
Параметр Последний период определяет номер последнего периода, включенного
в вычисления. Параметр Тип — это выбор времени платежа.
Функция ОБЩПЛАТ(Ставка; Периоды; Текущая стоимость; Первый период;
Последний период; Тип) вычисляет суммарную величину процентов, выплачивае-
мых по займу в промежутке между двумя периодами выплат. Параметр Ставка
определяет процентную ставку, параметр Периоды определяет общее количество
71
Особенности Excel, полезные бухгалтеру
периодов выплат, параметр Текущая стоимость определят стоимость инвестиции
на текущий момент. Параметр Первый период определяет номер первого периода,
включенного в вычисления. Периоды выплат нумеруются, начиная с единицы.
Параметр Последний период определяет номер последнего периода, включенного
в вычисления. Параметр Тип — это выбор времени платежа.
Функция ОСПЛТ(Ставка; Период; Периоды; Приведенная стоимость; Буду-
щая стоимость; Тип) вычисляет величину платежа в погашение основной сум-
мы по инвестиции за данный период на основе постоянства периодических
платежей и постоянства процентной ставки. Параметр Ставка определяет про-
центную ставку, параметр Период задает период, значение которого должно
быть в интервале от единицы до Периоды. Параметр Периоды определяет общее
количество периодов выплат, параметр Приведенная стоимость — это приве-
денная стоимость, то есть сумма, которая равноценна ряду будущих платежей.
Параметр Будущая стоимость определяет требуемое значение будущей стоимо-
сти или остатка средств после последней выплаты. Параметр Тип — это выбор
времени платежа. Если параметр опущен или равен нулю, выплаты произво-
дятся в конце месяца, а если параметр равен единице, выплаты идут в начале
месяца.
Функция ЭФФЕКТ(Ставка; Периоды) вычисляет эффективную годовую
процентную ставку, если заданы параметр Ставка, определяющий номинальную
годовую процентную ставку, и параметр Периоды, определяющий в году количе-
ство периодов, за которые начисляются проценты.
Несколько финансовых функций предназначены для расчетов по ценным
бумагам. Отметим, что большинство этих функций ориентировано на запад-
ный рынок ценных бумаг. Кроме того, практически все эти функции требуют
установки пакета анализа. Функция ИНОРМА(Дата; Погашение; Инвестиция;
Сумма; Базис) вычисляет процентную ставку для полностью инвестированных
ценных бумаг. Параметр Дата определяет дату расчета за ценные бумаги, па-
раметр Погашение определяет срок погашения ценных бумаг, параметр Инвес-
тиция определяет объем инвестиции в ценные бумаги, параметр Сумма — это
сумма, которая должна быть получена на момент погашения ценных бумаг, и
параметр Базис определяет способ вычисления дня. Если этот параметр равен
нулю, используется американский способ вычисления дня NASD. Если этот
параметр равен единице, используется фактический день, а если параметр ра-
вен двум, день определяется как фактический, деленный на 360.
Нередко стоимость ценных бумаг указывается в дробных величинах, напри-
мер, 1 и 2/16рубля за акцию. С помощью функций РУБЛЬ.ДЕС и РУБЛЬ.ДРОБЬ
вы можете преобразовывать суммы из дробного представления в обычный, и на-
оборот. Для работы этих функций должен быть установлен пакет анализа Excel.
Функция РУБЛЬ.ДЕС(Дробное; Знаменатель) преобразует цену в рублях, выра-
женную в виде дроби, в цену в рублях, выраженную десятичным числом. Пара-
метр Дробное содержит целую часть дроби и числитель дробной части, а параметр
Знаменатель содержит знаменатель дробной части. Например, чтобы преобразо-
72
Особенности работы с формулами
вать число 1 и 2/16 нужно создать формулу =РУБЛЬ.ДЕС(1,02;16). В результате
вы получите 1,125.
Функция НАКОПДОХОД(Дата выпуска; Первая выплата; Расчет; Ставка;
Номинал; Частота; Базис) вычисляет накопленный процент по ценным бумагам
с периодической выплатой процентов. Параметр Дата выпуска определяет дату
выпуска ценных бумаг. Параметр Первая выплата определяет дату первой выпла-
ты по ценным бумагам. Параметр Расчет — это дата расчета за ценные бумаги.
Параметр Ставка определяет годовую процентную ставку для купонов по цен-
ным бумагам. Параметр Номинал определяет номинальную стоимость ценных
бумаг. Если параметр опущен, используется значение 1000 рублей. Параметр Ча-
стота определяет количество выплат по купонам за год. Параметр Базис — это
используемый способ вычисления дня.
Функция НАКОПДОХОДПОГАШ(Дата выпуска; Расчет; Ставка; Номинал;
Базис) вычисляет накопленный процент по ценным бумагам, процент по кото-
рым выплачивается в срок погашения. Параметр Дата выпуска определяет дату
выпуска ценных бумаг. Параметр Расчет — это дата расчета за ценные бумаги.
Параметр Ставка определяет годовую процентную ставку для купонов по цен-
ным бумагам. Параметр Номинал определяет номинальную стоимость ценных
бумаг. Параметр Базис — это используемый способ вычисления дня.
Функция ПОЛУЧЕНО(Расчет; Срок погашения; Инвестиции; Скидка; Базис)
вычисляет сумму, полученную к сроку погашения полностью обеспеченных цен-
ных бумаг. Параметр Расчет — это дата расчета за ценные бумаги. Параметр Срок
погашения определяет срок погашения ценных бумаг. Параметр Инвестиции оп-
ределяет объем инвестиции в ценные бумаги. Параметр Скидка — это скидка на
ценные бумаги. Параметр Базис — это используемый способ вычисления дня.
Функция РАВНОКЧЕК(Расчет; Срок погашения; Скидка) вычисляет эквива-
лентный облигации доход по казначейскому векселю. Параметр Расчет — это да-
та расчета за ценные бумаги. Параметр Срок погашения определяет срок погаше-
ния ценных бумаг. Параметр Скидка — это скидка на ценные бумаги.
Функция ДОХОДКЧЕЩРасчет; Срок погашения; Цена) вычисляет доход-
ность по казначейскому векселю. Параметр Расчет — это дата расчета за ценные
бумаги. Параметр Срок погашения определяет срок погашения ценных бумаг и
соответствует дате истечения срока действия векселя. Параметр Цена — это цена
казначейского векселя на 100 рублей номинальной стоимости.
Функция СКИДКА(Расчет; Срок погашения; Цена; Погашение; Базис) вычис-
ляет ставку дисконтирования для ценных бумаг. Параметр Расчет определяет да-
ту расчета за ценные бумаги. Параметр Срок погашения определяет срок погаше-
ния ценных бумаг. Параметр Цена определяет цену ценных бумаг за 100 рублей
номинальной стоимости. Параметр Погашение определяет выкупную стоимость
ценных бумаг за 100 рублей номинальной стоимости. Параметр Базис определя-
ет используемый способ вычисления дня.
Функция ДОХОД(Расчет; Срок погашения; Ставка; Цена; Погашение; Час-
тота; Базис) вычисляет доходность ценных бумаг, по которым производятся
73
Особенности Excel, полезные бухгалтеру
периодические выплаты процентов. Параметр Расчет определяет дату расчета
за ценные бумаги. Параметр Срок погашения определяет срок погашения ценных
бумаг. Параметр Ставка определяет годовую процентную ставку для купонов по
ценным бумагам. Параметр Цена определяет цену ценных бумаг за 100 рублей
номинальной стоимости. Параметр Погашение определяет выкупную стоимость
ценных бумаг за 100 рублей номинальной стоимости. Параметр Частота опре-
деляет количество выплат по купонам за год. Для ежегодных выплат частота
равна единице, для полугодовых выплат частота равна двум, для ежекварталь-
ных выплат частота равна четырем. Параметр Базис определяет используемый
способ вычисления дня.
Кратко перечислим ряд других финансовых функций для работы с ценными
бумагами. Функция ДОХОДПОГАШ вычисляет годовую доходность ценных бу-
маг, по которым проценты выплачиваются при наступлении срока погашения.
Функция ДЛИТ вычисляет взвешенное среднее приведенной стоимости инвес-
тиций для предполагаемой номинальной стоимости 100 рублей и используется
как мера реакции цен облигаций на изменение доходности. Функция ЦЕНА вы-
числяет цену за 100 рублей номинальной стоимости ценных бумаг, по которым
выплачивается периодический процент. Функция ЦЕНАКЧЕК вычисляет цену
на 100 рублей номинальной стоимости для казначейского векселя. Функция
МДЛИТ вычисляет модифицированное взвешенное среднее для ценных бумаг с
предполагаемой номинальной стоимостью 100 рублей.
В заключение отметим, что финансовые функции Excel реализуют далеко не
все задачи финансового анализа. Однако вы можете легко составить формулу в
Excel самостоятельно, ведь в большинстве случаев методика расчета различных
финансовых показателей известна.
2.1.2. Использование ссылок и имен в формулах
Кроме констант в формулах можно использовать ссылки на ячейки. При
этом в вычислениях используется значение из ячейки, на которую указывает
ссылка. Как вы уже знаете, ссылки бывают абсолютными и относительными. По
умолчанию, при вводе ссылки в формулу ссылка является относительной, то есть
она будет изменена, если вы скопируете или переместите формулу в другую ячей-
ку. Абсолютные ссылки указывают на одну и ту же ячейку, куда бы вы не переме-
щали формулу. Подробно о разных ссылках рассказано в первой главе книги.
Еще одним инструментом адресации в Excel являются имена. Имена можно
присваивать ячейкам, диапазонам, формулам и константам. Имена могут заме-
нять собою ссылки, что существенно облегчает задачу адресации в электронных
таблицах. Благодаря использованию имен, формулы становятся более понятны-
ми. Кроме того, употребляя имена в формулах, вы экономите время на вводе ин-
формации, так как имя набрать значительно легче, чем сложное выражение с
обозначениями ячеек и адресными операторами.
74
Особенности работы с формулами
Февраль
Январь
И
[. с ^ [
1 ]
Рис. 2.1.
Список имен
Чтобы присвоить имя ячейке или группе ячеек, выделите их, а затем щелкни-
те мышью на поле в левой верхней части окна программы. В этом поле отобража-
ются адреса ячеек, когда вы их выделя-
ете. После того, как вы щелкнули мы-
шью на этом поле, вы можете ввести
имя для ячейки или группы ячеек. За-
вершите ввод имени, нажав клавишу
[[Enter]. Если в таблице есть хотя бы одно
имя ячейки, в поле имени в левой
верхней части строки формул появится
кнопка ; чК Нажав эту кнопку, вы уви-
дите список имен ячеек (Рис. 2.1).
Выбрав имя из списка, вы сделаете ячейку с этим именем активной. Так
можно легко перемещаться от одной ячейки с именем к другой. Также можно
присвоить имя ячейке с помощью команды меню. Выберите команду Вставка
Х^> Имя э£> Присвоить. Появится диалог ввода имени ячейки (Рис. 2.2). Данный
диалог мы уже рассматривали в предыдущей главе, но описали не все его воз-
можности. В поле Имя задайте имя ячейки, а затем в поле Формула введите адрес
ячейки или группы ячеек, которой вы присваиваете имя. Особенностью являет-
ся то, что если вы присваиваете имена строкам или столбцам, Excel сам предла-
гает вам назвать строку по содержимому ячейки, расположенной левее выделен-
ного фрагмента строки, а столбец - по содержимому ячейки над выделенным
столбцом, то есть по заголовкам.
Еще одна особенность присвоения имени в этом диалоге состоит в том, что
в поле Формула можно вводить не только ссылки, но и константы, и даже фор-
мулы. Чтобы присвоить имя константе, например, значению 20% присвоить имя
НДС, введите в поле Имя — слово НДС, а в поле Формула — значение 20%. Чтобы
добавить имя в список, нажмите кнопку Добавить. В дальнейшем вы сможете
использовать имя в формулах, например =А1*НДС.
Также можно давать имена формулам, при этом в поле Формула нужно ввес-
ти выражение, начинающееся с символа =. Чтобы узнать, что стоит за тем или
иным именем - ссылка, формула или кон-
станта — выберите в списке имен нужное
имя и прочтите описание имени в поле Фор-
мула. Для имени диапазона в этом поле бу-
дет указан лист и диапазон, для имени фор-
мулы — сама формула, для имени констан-
ты — постоянное значение.
Чтобы удалить имя из рабочей книги,
выделите его в списке Имя и нажмите кноп-
ку Удалить. Чтобы изменить имя ячейки,
формулы или константы, выделите исходное
имя в списке, наберите в поле Имя новое
Февраль
Январь
Рис. 2.2.
Присвоение имени
75
Особенности Excel, полезные бухгалтеру
февраль
Янаарь
| д . .;| ; • yfe: i имя и нажмите кнопку Добавить.
1 !Пи !.=3..-1.4_ Снова вьщелите старое имя и на-
:=Г S ™те кнопку ̂ «„ь. Чтобы за-
крыть диалог добавления имени,
нажмите кнопку ОК.
Теперь вы можете использо-
вать в формулах созданные имена.
Рис. 2.3. Вставив в формулу имя ячейки,
Вставка значения и полный список имен вы используете в вычислениях ее
содержимое. Если использовать
имя, определяющее константу, в формулу будет подставлено значение констан-
ты, а если вы обратитесь по имени к формуле, будет вставлен ее результат.
Чтобы вставить в выбранную ячейку данные, которым присвоено имя, выбе-
рите команду меню Вставка з£> Имя ^> Вставить. Будет открыт диалог со спи-
ском существующих имен (Рис. 2.3, слева).
Выберите в списке имя и нажмите, кнопку ОК, чтобы вставить в ячейку дан-
ные, обозначаемые выбранным именем. Если нажать кнопку Все имена, в таб-
лице будет создан полный список всех имен и их значений. Причем активная
в данный момент ячейка образует верхний левый угол списка (Рис. 2.3, спра-
ва). Полученный список будет состоять из двух столбцов: имен и описаний
имен.
2.1.3. Примеры построения формул
При построении формул можно использовать различное сочетание функ-
ций, констант, ссылок и операторов. Давайте рассмотрим несколько примеров
построения функций разной сложности. Если нужно, например, вычислить сум-
му значений в нескольких ячейках, самым простым, но не самым удобным спо-
собом записи формулы может быть =С2+СЗ+С4+С5. В Excel есть встроен-
ная функция суммирования и предыдущую формулу можно записать так:
=СУММ(С2;СЗ;С4;С5). Это также будет верная запись, но так формулу никто не
записывает. В данном случае лучше использовать диапазон ссылок и записать
формулу так: =СУММ(С2:С5). Видите, в зависимости от примененного способа
записи формулы, ее можно значительно упростить. А если нужно вставить в фор-
мулу ячейку, находящуюся на другом листе книги, формула может выглядеть так:
=СУММ(С2:С5; Лтт2!Е7).
Если вы работаете с таблицами, в которых у строк или столбцов есть имена,
можно очень просто подсчитывать величины, в которых участвуют все ячейки
строки или столбца. Например, присвоив столбцу имя Продажи, вы можете за-
писать формулу =СУММ(Продажи), и программа просуммирует все значения в
этом столбце. Чтобы такая возможность работала, нужно настроить Excel опре-
деленным образом. О том, как это сделать, вы узнаете ниже.
76
Особенности работы с формулами
Разнообразие встроенных функций Excel позволяет выполнять разные рас-
четы. Например, если вы хотите узнать, какая сегодня дата, введите формулу
=СЕГОДНЯ(). А если нужно узнать, какой сегодня день недели, формулу нужно
изменить: =ДЕНЬНЕД(СЕГОДНЯ()). Результатом будет число, являющееся по-
рядковым днем недели, начиная с воскресенья. Чтобы первого числа каждо-
го месяца в ячейке выводился текст Начало месяца и ничего не выводилось
в остальных случаях, можно составить такую формулу: =ЕСЛИ(ДЕНЬ(СЕГО-
ДНЯ())=1;"Началомесяца";'"')- Как вы видите, аргументами функций в форму-
лах могут быть другие функции.
Для построения более сложных условий, можно использовать и другие логи-
ческие функции. Например, если нужно выяснить, а не пятница ли сегодня, и не
тринадцатое ли число, можно создать формулу
=ЕСЛИ(И(ДЕНЬНЕД(СЕГОДНЯ())=6;ДЕНЬ(СЕГОДНЯ())=13);
"Осторожно, сегодня пятница 13-е!"; "Обычный день ")
Конечно, в ячейке формула записывается в одной строке. В зависимости от
текущей даты вы увидите в ячейке, в которой расположена данная формула,
один из указанных в ней текстов. Как видно на этом примере, формулы могут
быть довольно сложными и громоздкими. Для повышения наглядности можно
разнести части формулы по разным ячейкам. Например, можно формулу
=ДЕНЬНЕД(СЕГОДНЯ()) записать в ячейке А1, а формулу =ДЕНЬ(СЕГОДНЯ())
записать в ячейку А2. Текст Осторожно, сегодня пятница 13-е! можно записать в
ячейку A3, а текст Обычный день, записать в ячейку А4. Тогда итоговую формулу
можно записать так: =ЕСЛИ(И(А1=6;А2=13);АЗ;А4). Формула значительно упро-
стилась, но не стала более понятной. Если присвоить формулам имена, можно
значительно повысить наглядность. Если присвоить ячейке А1 имя День, ячейке
А2 присвоить имя Число, формула может выглядеть так: =ЕСЛИ(И(День=6;Чис-
ло=13);АЗ;А4). Однако в первом столбце при таком способе появятся дополни-
тельные промежуточные данные, что не очень удобно.
При составлении формул, содержащих множество разных операций, вы
можете получить не такой результат, который ожидаете. Например, введя фор-
мулы =А1/А2*АЗ и =А1/(А2*АЗ) вы получите разные результаты. В первом слу-
чае содержимое ячейки А1 будет разделено на содержимое ячейки А2 и резуль-
тат будет умножен на содержимое ячейки A3. Во втором случае, сначала будет
умножено содержимое ячеек А2 и A3, и на это число будет поделено содержи-
мое ячейки А1, то есть содержимое ячейки A3 используется в числителе или
знаменателе, в зависимости от наличия скобок. Внимательно следите за поряд-
ком вычисления формул. Если вы сомневаетесь, лучше использовать скобки.
Лишняя пара скобок не навредит, но вы будете уверены, что формула считает-
ся так, как вы и планировали. Например, поместив в ячейки информацию о на-
чальной стоимости, конечной стоимости и времени эксплуатации, можно в
ычислить фиксированную процентную ставку амортизации по формуле:
=1-((А1/А2)*(1/АЗ)). При вводе формулы важно не ошибиться с количеством и
расположением скобок. Баланс скобок проверит программа и сообщит вам об
77
Особенности Excel, полезные бухгалтеру
ошибке, если число открывающихся скобок не равно числу закрывающихся
скобок. А вот правильно расположить скобки — это ваша задача.
2.2. Работа со списками
Несколько строк листа рабочей книги Excel, содержащих однородные дан-
ные, например, набор адресов и телефонов или список сотрудников и их оклады,
называются списком. Первая строка в этом списке содержит заголовки столб-
цов. Списком может быть ведомость, справочник и так далее. В бухгалтерии
часто нужно вести учет множества однотипных объектов, поэтому освоение ра-
боты со списками чрезвычайно полезно именно бухгалтеру. Список восприни-
мается программой, как аналог базы данных, и вы можете сортировать список
или искать в нем нужную информацию. Имеется набор функций, облегчающих
обработку и анализ данных в списках.
2.2.1. Создание и редактирование списков
Excel создает списки из фрагментов таблицы, которые должны быть запол-
нены по определенным правилам. Поскольку списки размещаются на рабочем
листе, размеры списка ограничены размерами листа Excel, то есть число столб-
цов не может превышать 256, а число строк 65535. При работе со списками при-
нято строки называть записями, а столбцы — полями. Запись представляет собой
элемент информации в списке, а поле представляет собой определенную катего-
рию информации. Например, если представить в виде списка штатное расписа-
ние предприятия, то записью будет каждая отдельная строка, описывающая кон-
кретного сотрудника, а полями — информация об этом сотруднике: фамилия,
должность и так далее.
Чтобы создать список, нужно вначале ввести информацию в ячейки табли-
цы. Это делается как обычно, то есть вы выделяете ячейку, а затем вводите в нее
нужную информацию. Столбцы таблицы становятся полями списка, строки таб-
лицы становятся записями, а заголовки столбцов — именами полей списка. Пус-
тая строка указывает на окончание списка, поэтому не оставляйте пустых строк
между заголовками столбцов и записями. Имена полей должны располагаться в
верхней части списка и находиться в отдельных ячейках (Рис. 2.4).
Программа может автоматически использовать заголовки полей списка для
работы с формулами. При этом, если в формуле встретится имя заголовка столб-
ца, значит, в формуле будут участвовать данные из указанного поля списка. На-
пример, если в списке есть поле Зарплата, и вы введете в какой-либо ячейке
формулу =СУММ(Зартата), результатом формулы будет сумма всех записей
в столбце Зарплата. По умолчанию Excel не распознает заголовки в формулах.
78
Работа со списками
\: А \ в 1:......е,Ч: ;_j5_d_li.L:.: . . . : ':.:'£Jl.~iZ_r__~_~~
1 Должность Фамилия Имя Отчество Должностные обязанности
2:Директор Иванов Иван Иванович Руководить пердприятием
3 ; Гл. Бухгалтер Петрова Галина Борисовна Вести бухгалтерский учет
4 '• Секретарь Сидорова Ирина |Петровн)| Отвечать на звонки
Полесписка_1 Заголовок поляЛ Запись списка.
Рис. 2.4. Список и его элементы
Чтобы появилась такая возможность, следует настроить программу. Выберите
команду меню Сервис :£> Параметры, чтобы открыть диалог настройки. Щелк-
ните мышью на ярлычке Вычисления, чтобы перейти на одноименную вкладку
диалога. Установите флажок Допускать названия диапазонов и нажмите кнопку
ОК, чтобы закрыть диалог настройки.
После того, как список создан, вы можете начинать работу с ним. Обычно
выделять список в таблице не нужно. При выборе команды работы со списками,
программа сама определит, есть ли на листе списки. Если возникли сложности с
автоматическим определением списка, вы можете подсказать программе, где
расположен список, щелкнув мышью на любой ячейке списка или выделив диа-
пазон ячеек, содержащий список.
Вы можете изменить список по вашему желанию. Чтобы изменить информа-
цию в ячейке, щелкните на ней мышью и введите новую информацию или дваж-
ды щелкните на ячейке мышью и отредактируйте информацию. Чтобы добавить
запись в список, нужно добавить строку в таблицу и ввести в нее нужную инфор-
мацию. Для этого вначале выделите строку, перед которой нужно добавить но-
вую строку, щелкнув мышью на ее заголовке. Затем выберите команду меню
Вставка ;£> Строки. Новая строка будет добавлена перед выделенной строкой
таблицы. Когда вы введете в ячейки этой строки информацию, строка станет но-
вой записью списка.
Аналогично вы можете добавить в список новое поле. Выделите столбец, пе-
ред которым вы хотите добавить поле. Для этого щелкните мышью на заголовке
столбца. Нужно щелкнуть мышью именно на заголовке столбца таблицы, а не на
заголовке поля списка. Это разные заголовки. После того, как столбец выделен,
выберите команду меню Вставка э£> Столбцы. Будет вставлен пустой столбец,
который разобьет список. Когда вы введете заголовок поля, список восстановит
свою целостность, и вы сможете работать с новым списком. Не забудьте ввести в
новое поле информацию.
Чтобы удалить запись или поле из списка, нужно удалить соответствую-
щую строку или столбец таблицы. Эта процедура описана в предыдущей гла-
ве нашей книги. При удалении записи или поля списка, будьте внимательны,
так как все формулы, входящие в список, будут автоматически скорректиро-
ваны.
79
Особенности Excel, полезные бухгалтеру
A J В : ;.С:.::.11...;...Р.. 1 Е . ' F ;
1 Должность *!Фамили!̂ Имя ^Отчество^Должностныеобязанности^Зарплата^
2 Директор Иванов Иван Иванович Руководить пердприятием 10000,00р.
3 ; Гл. Бухгалтер Петрова Талина Борисовна Вести бухгалтерский учет ; 8000,00р.
4'IСекретарь : Сидорова Ирина Петровна Отвечать на звонки 6000,00р.
Рис. 2.5. Список с фильтром
2.2.2. Отбор записей
При работе с большими списками бывает удобнее отображать на экране не
весь список, а лишь его подмножество. Отбор записей (или, как еще говорят,
фильтрация), представляет собой выделение из списка определенных записей,
которые удовлетворяют заданным критериям. В программу встроена возмож-
ность фильтрации данных в списках. Щелкните мышью на любой ячейке спис-
ка, а затем выберите команду меню Данные Х£> Фильтр Х£> Автофильтр. Обрати-
те внимание, как изменился вид списка£Рис. 2.5).
У каждого поля появилась кнопка ИИ, нажатие которой приводит к откры-
тию перечня условий отбора для соответствующего поля. Эти условия представ-
ляют собой список значений в соответствующем столбце, а также ряд общих ус-
ловий, типа Все, Последние десять и так далее.
Выбрав одно из условий, мы изменим вид всего списка, и в списке останут-
ся лишь те записи, которые удовлетворяют условиям фильтрации, а остальные
записи будут скрыты. Заголовки отфильтрованных столбцов окрашены по умол-
чанию в синий цвет. Кнопка \.т'\ у названия поля списка также изменяет свой
цвет, показывая нам, что она используется в качестве условия для фильтра.
В строке состояния рабочего окна программы отображается общее число за-
писей и число записей, удовлетворяющих условию. Обращаем ваше внимание,
что нумерация строк не изменилась. Вы можете продолжить фильтрацию, указы-
вая в списках других столбцов необходимые элементы.
Для полей списка при выборе условия Первые 10... действительно выводятся
первые десять записей исходной таблицы. Если выбрать элемент Первые 10... в
списке условий поля, в котором есть только цифры, будет открыт диалог нало-
жения условий (Рис. 2.6). В поле ввода со счетчиками, расположенном в левой
части диалога, вы выбираете количество за-
писей, которое нужно показать. В открыва-
ющемся списке расположенном правее, вы
можете выбрать два варианта отбора: наи-
больших и наименьших. В последнем списке,
расположенном в правой части диалога, вы
Рис. 2.6. можете выбрать: показать заданное количе-
Наложение условий ство элементов списка или заданное количе-
80
Работа со списками
Спивал"?" обозначает любой единичный знак
Знак "*" обозначает последовательность пь.
Рис. 2.7.
Настройка автофильтра
ство процентов от общего количества эле-
ментов. Элемент элементов списка служит
для отображения определенного числа
строк с наибольшими или наименьшими
значениями в данном поле, а параметр
% от количества элементов служит для ото-
бражения строк с наибольшими или наи-
меньшими значениями в процентном отно-
шении. После ввода условия, нажмите
кнопку ОК, чтобы закрыть диалог и приме-
нить условие к выбранному полю списка.
Можно настроить довольно сложные условия фильтрации. В открываю-
щемся списке условий выберите элемент Условие, и будет открыт диалог наст-
ройки (Рис. 2.7). В левом верхнем списке выбираются логические операции рав-
но, неравно, больше или равно и так далее. Кроме того, есть ряд операций для тек-
стовых данных, например, начинается с, заканчивается на, содержит, не содер-
жит. Операция задает как действие, которое будет произведено над записями
списка в выбранном вами поле, так и условия для поиска данных, содержащих
или не содержащих заданный текст. Правее списка операций располагается по-
ле ввода для указания значения, которое будет проверяться при выполнении
операции. Вы можете ввести в этом поле любую информацию, а можете выбрать
одну из записей, нажав кнопку в правой части поля ввода. Если вы будете вво-
дить информацию с помощью клавиатуры, можно использовать и символы ма-
сок. Маска ? обозначает любой символ, а маска * обозначает любое количество
любых символов, например при вводе Н?? или Н* будут отобраны записи со
значениями НДС и НСП.
В диалоге можно задать два условия фильтрации. Для этого в нижней час-
ти диалога расположен список для выбора еще одной операции, и поле ввода
для указания еще одного значения. Условия могут объединяться по правилу И,
когда общее условие выполняется, если выполняются оба условия, а также по
правилу ИЛИ, когда общее условие выполняется, если выполняется хотя бы од-
но из условий. Выбор способа объединения условий происходит с помощью ус-
тановки переключателя. После завершения настройки условий, нажмите кноп-
ку ОК, чтобы закрыть диалог, и выбранное вами условие будет применено к по-
лю списка.
Вы можете вернуться к исходному виду таблицы, выбрав в списке элемент
Все. Для полной отмены процедуры фильтрации нужно выбрать команду меню
Данные з£> Фильтр и убрать флажок у команды Автофильтр, выбрав эту команду.
По умолчанию, результат фильтрации строится на месте исходного списка,
просто не показывается часть его записей. Вы можете настроить программу так,
чтобы результат фильтрации был оформлен в виде отдельного списка в указан-
ном вами месте. Выберите команду меню Данные :£> Фильтр :£> Расширенный
фильтр, и будет открыт диалог настройки (Рис. 2.8).
81
Особенности Excel, полезные бухгалтеру
С помощью переключателя в верхней части ди-
алога выберите вариант фильтрации. Если вы уста-
s|«»i%bj,iw,TjigK«jss новите переключатель в верхнее положение,
Iиовдни»»»™»» [»№№» ~g j фильтр будет скрывать записи, а если установить
!п13г7П*Гич»«™»«=г переключатель в нижнее положение, записи спис-
| г т»™ «,,«="»«.».»"»» ка, удовлетворяющие условиям фильтра, будут ско-
пированы в другое место листа.
В поле ввода Исходный диапазон нужно указать
Рис. 2.8. диапазон ячеек списка, которые должны участво-
Дополнительные вать в фильтрации. По умолчанию в этом поле ав-
настройки фильтра тематически выбирается весь список, но вы може-
те указать лишь его часть. Нажав кнопку ;§{ в пра-
вой части поля ввода, вы свернете диалог для выбора ячеек. Чтобы восстановить
диалог, нажмите кнопку Щ | в правой части свернутого диалога.
В поле ввода Диапазон условий нужно ввести диапазон ячеек списка, содер-
жащих условие. Для удобства выбора вы также можете свернуть диатог. В поле
ввода Поместить результат в диапазон, нужно выбрать группу ячеек, куда следу-
ет скопировать результат действия фильтра.
Флажок Только уникальные записи позволяет ограничить результат фильтра-
ции только уникальными записями. Если диапазон условия не задан, установка
этого флажка убирает из списка все повторяющиеся записи. В заключение на-
жмите кнопку ОК, чтобы закрыть диалог настройки расширенного фильтра.
2.2.3. Сортировка списка
При вводе записей в списки можно не обращать внимания на их порядок,
так как в дальнейшем есть возможность сортировки списков. Сортировка пред-
ставляет собой изменение относительного положения информации в списке в
соответствии со значением или с типом информации. Чаще всего информацию
в списках сортируют по алфавиту, по численному значению или по дате.
По умолчанию, если содержимым ячеек являются числа, то они сортируют-
ся в порядке возрастания, от наименьшего отрицательного до наибольшего по-
ложительного числа. Если в ячейки записан текст, то при сортировке произво-
дится сравнение содержимого ячеек по символам слева направо. Вначале идут
латинские символы от А до Z, а затем русские символы от А до Я. В тексте кроме
букв могут использоваться цифры и другие символы.
Есть несколько ограничений при сортировке текстов. Текст не должен начи-
наться с символов @, +, =, -. Эти символы могут стоять, только начиная со вто-
рой позиции. Если в начале произвольного слова поставить, например, дефис, то
программа выдаст ошибку #ИМЯ?, поскольку этот символ в первой позиции оз-
начает знак минус, а слово, следующее за ним, не является числом. Если слово
содержит дефис или апостроф, эти символы не участвуют в сортировке и игно-
82
Работа со списками
_j- ; :A;J;:: :; ;je ь с { ; р j ; / §
1 Должность Фамилия Имя Отчество Должностные обязанности Зарплата
2 Секретарь Сидорова Ирина Петровна Отвечать на звонки 6000,00р.
3 • Гл. Бухгалтер Петрова Галина Борисовна Вести бухгалтерский учет 8000,00р.
4 Директор Иванов Иван Иванович Руководить пердприятием 10000,00р.
Рис. 2.9 Список после сортировки
рируются. Пустые ячейки списка всегда помещаются в конец, независимо от на-
правления сортировки, по возрастанию или по убыванию.
Записи списка можно отсортировать на основе данных любого из полей спи-
ска. Следует различать сортировку, производимую по одному столбцу, и сорти-
ровку по нескольким столбцам. Чтобы отсортировать список по какому-либо
полю, щелкните мышью на любой ячейке нужного поля списка и нажмите кноп-
ку ̂ | на панели инструментов. В результате будет проведена сортировка запи-
сей списка на основании выбранного поля по возрастанию значений в этом по-
ле. В нашем примере проведена сортировка по размеру зарплаты (Рис. 2.9).
Если требуется сортировка по убыванию, нужно нажать на панели инстру-
ментов кнопку |̂. Заголовки столбцов в процесс сортировки по умолчанию не
попадают. При сортировке списка, в котором нет выделенных областей, запи-
си переставляются целиком. Если кнопки сортировки на панели инструментов
отсутствуют, выполните команду меню Сервис :£> Настройка, и затем щелкни-
те на ярлычке Команды, чтобы перейти на одноименную вкладку. В списке Ка-
тегории выберите элемент Данные. В правой части диалога, в списке Команды,
выделите значок сортировки и перетащите его с помощью мыши на панель ин-
струментов.
С помощью кнопок сортировки вы можете провести упорядочение данных
внутри некоторого выделенного диапазона ячеек списка. Перед тем, как выпол-
нить сортировку выделенного диапазона, учтите, что упорядочение будет произве-
дено по значениям крайнего левого столбца. Если сортировка оказалась неудачной,
вы можете ее отменить сразу после того, как она была выполнена. Для этого нажми-
те кнопку |̂ } на панели инструментов или выберите команду меню Правка ;£>
Отменить. Отметим, что в описанном способе сортировки, когда предварительно
выделяются неполные строки, сортировка может привести к совершенно непра-
вильным результатам, поскольку меняются местами фрагменты строк. Если такого
результата заранее не предвидеть, то ваши таблицы превратятся в бесполезный на-
бор данных.
Если нужна более сложная сортировка, программа позволяет вам сортиро-
вать по одному, двум или трем столбцам одновременно. При этом, если строки
имеют одинаковые значения в первом указанном столбце, сортировка выполня-
ется по значениям второго столбца и так далее. Сначала программа должна об-
наружить список в таблице, поэтому вначале необходимо щелкнуть мышью на
любой ячейке, относящейся к списку. Далее выберите команду меню Данные т&
Сортировка. Программа просмотрит ячейки во всех направлениях, сама опреде-
83
Особенности Excel, полезные бухгалтеру
Сортировать по .
{Должность ПО S O " ,
' по убыванию
В последнюю очередь, по - - -
I ~3 <8по8031
••••;.. ' Г.погуби
Идектифицировить поля по
* надписям (первая строка диапк
<" обйзнэнеш1ям столбцов листа
Рис. 2.10.
Настройка
сортировки
лит границы списка и выделит ячейки. Также по-
явится диалог настройки сортировки, позволяющий
настроить достаточно сложную сортировку данных
(Рис. 2.10).
Группа элементов управления Сортировать по
содержит открывающийся список, предназначенный
для выбора поля, по которому будет вестись сорти-
ровка, а также переключатель направления сортиров-
ки — вверх или вниз. Переключатель задает направле-
ние сортировки По возрастанию пли По убыванию.
Переключатель По возрастанию позволяет осущест-
вить сортировку в порядке от наименьшего числа к
наибольшему, он первой буквы алфавита к последней
и от давней даты к недавней. Переключатель По убы-
ванию позволяет осуществить сортировку в порядке от наибольшего числа к на-
именьшему, от последней буквы алфавита к первой, и от недавней даты к давней.
Пустые ячейки после сортировки всегда располагаются в конце списка.
Часто бывает, что разные записи списка содержат одинаковые значения по-
лей. Например, в телефонном справочнике может быть несколько Ивановых.
Для решения подобных проблем в диалоге есть группа элементов управления За-
тем по и В последнюю очередь по. Группа Затем по используется, если есть не-
сколько одинаковых элементов списка, а группа В последнюю очередь по приме-
няется, если есть несколько элементов списка имеющих два одинаковых поля.
С помощью этих групп можно определять несколько полей для сортировки. Об-
ратите внимание, что каждый последующий уровень сортировки действует, толь-
ко если произошло совпадение на предыдущем уровне. Трехуровневая сортиров-
ка позволяет успешно сортировать сложные таблицы.
В нижней части диалога расположена группа элементов управления Иден-
тифицировать поля по, которая с помощью переключателя определяет, как
программа будет искать поля списка для сортировки. Если у столбцов вашей
таблицы отсутствуют подписи, то для идентификации столбцов можно ис-
пользовать обозначения столбцов на листе. Если переключатель этой группы
установлен в положение Подписям, список Сортировать по будет содержать
названия полей списка. Если переключатель уста-
новлен в положение Обозначениям столбцов листа,
список будет содержать буквенные названия столб-
цов таблицы.
Нажмите кнопку Параметры, чтобы открыть диа-
лог дополнительных настроек сортировки (Рис. 2.11).
Открывающийся список Сортировка по первому ключу
в верхней части диалога позволяет выбрать один из
нестандартных порядков сортировки, отличающийся
от сортировки по возрастанию или убыванию. Вы мо-
t Учитывать регистр
Сортировать
* сфок» диапазона
С егалбцы диапазона
Рис. 2.11.
Параметры
сортировки
84
Автоматизация ввода данных
жете выбрать упорядочение данных по дням недели и по месяцам. Если устано-
вить флажок Учитывать регистр, при сортировке будут различаться строчные и
прописные буквы, и слова, начинающиеся с прописной буквы, будут распола-
гаться раньше слов, начинающихся со строчной буквы.
Обычно в качестве полей сортировки используют столбцы, а не строки, хо-
тя процедура допускает сортировку и по строкам. Для этого нужно установить
переключатель Сортировать. Установив переключатель в положение Строки ди-
апазона, вы будете сортировать строки по значениям одного или нескольких
столбцов. При установке переключателя в положение Столбцы диапазона столб-
цы сортируются по значениям одной или нескольких строк. Нажмите кнопку ОК
диалога дополнительной настройки, чтобы закрыть его и вернуться к диалогу на-
стройки сортировки. Чтобы закрыть и этот диалог, нажмите кнопку ОК еще раз.
Диалог будет закрыт, и список будет отсортирован в соответствии с вашими на-
стройками.
В заключение отметим, что если нужно вести сортировку по более чем трем
столбцам, например, по четырем столбцам, сначала отсортируйте список по
столбцу с самым низким приоритетом в сортировке, а затем одновременно по
трем оставшимся столбцам.
2.3. Автоматизация ввода данных
При создании таблиц часто возникает необходимость во вводе большого ко-
личества сходной информации. В программе есть несколько средств, облегчаю-
щих ввод однотипных данных. Используя автоматический ввод, автоматическое
заполнение, а также автоматическую замену вводимой информации, вы сущест-
венно повысите эффективность работы.
2.3.1. Автоматический ввод и заполнение ячеек
Если вам нужно ввести одинаковую информацию
сразу в несколько ячеек, вы легко можете это сделать,
не вводя информацию в каждую ячейку в отдельности.
Выделите группу ячеек, в которую нужно вставить оди-
наковую информацию. Затем введите нужную инфор-
мацию, но по окончании ввода нажмите не клавишу
IJEiiur), а комбинацию клавиш |[ctri| и рпиг). Во все выде-
ленные ячейки будет размножена введенная вами ин-
формация.
Программа запоминает все введенные данные, и при
очередном вводе предлагает вам вариант подстановки из
1 IБаланс„__—t
2 j Отчет
Рис. 2.12.
Автоввод
информации
85
Особенности Excel, полезные бухгалтеру
. ' '''У'
1
2
3
4
5
6
Баланс
Отчет
Ведомость
Баланс
Ведомость
Отчет
введенной ранее информации. Обычно бывает доста-
точно ввести несколько первых символов, и программа
сама допишет остальные, если раньше вы вводили по-
хожие данные в этом столбце таблицы (Рис. 2.12).
С помощью автоввода удобно создавать большие
списки с повторяющимися словами. Обратите внима-
ние, что информация, добавленная программой, ос-
тается выделенной, и если вариант вас не устраивает,
вы легко можете удалить предлагаемые данные, на-
пример, нажав клавишу JDejetjjj. Автоматический ввод
действует только при вводе информации по столбцам.
Если вы перешли к новому столбцу таблицы, про-
грамма не будет вам предлагать информацию из дру-
гих столбцов.
Вы можете сами выбирать информацию из ранее введенной. Для этого
щелкните правой кнопкой мыши в ячейке, куда следует ввести информацию.
В появившемся вспомогательном меню выберите команду Выбрать из списка.
Ниже выбранной ячейки появится список введенных ранее слов (Рис. 2.13). Вы
можете выбрать слово из предложенного списка, и оно тут же будет вставлено
в ячейку. Подобным образом вы мо-
жете быстро вводить повторяющий-
ся текст в ячейки.
Вводя данные, можно заполнять
ячейки, основываясь на информации
в других ячейках. Это позволяет быс-
Рис. 2.13.
Выбор информации
из списка
1
Маркер
заполнения
Рис. 2.14.
Маркер заполнения тро заполнять ячейки одинаковой
информацией или создавать различ-
ные списки. Когда ячейка активна, она выделена жирной рамкой, и в правом
нижнем углу рамки появляется маркер заполнения (Рис. 2.14).
Маркер заполнения используется для множества операций по автоматичес-
кому заполнению ячеек. Подведите указатель мыши к маркеру заполнения. При
этом указатель изменит свою форму с CJjJl на -|-. Нажмите и не отпускайте ле-
вую кнопку мыши. Теперь перемещайте указатель вниз. При этом область выде-
ления ячеек будет увеличиваться. Обратите внимание, что, как бы вы ни переме-
щали указатель мыши, выделение ячеек идет только по
вертикали или горизонтали, то есть выделяется строка
или столбец (Рис. 2.15).
После того, как указатель переместился настоль-
ко, что выделенными оказались несколько ячеек, от-
пустите кнопку мыши. Все выделенные ячейки будут
заполнены содержимым самой первой ячейки. Подоб-
ным образом можно легко получать строки или столб-
цы, заполненные одинаковыми данными.
12345
Рис. 2.15.
Выделение
для заполнения
86
Автоматизация ввода данных
.07.2002
25,07.2002
26.07.2002
27.07.2002
24.07.2002
18.07.200?
01.08.2002
05.08.2002
Рис. 2.16. Варианты автозаполнения
Если ячейка содержит формулу, то в результате автоматического заполнения
ее копию будут содержать все ячейки выбранного диапазона. При этом адреса
ячеек, участвующих в формуле, для автоматически заполненных ячеек будут
скорректированы, если, конечно, они не являются абсолютными. В этом случае
адреса останутся неизменными.
Кроме заполнения ячеек одинаковыми данными, вы можете автоматически
вводить в ячейки информацию, основанную на содержимом нескольких преды-
дущих ячеек. При этом программа сама формирует остальные элементы после-
довательности чисел. Такая последовательность называется прогрессией. На-
пример, если ввести в одну ячейку число 1, а в следующую ячейку — число 3, а за-
тем выделить обе эти ячейки, то, перетаскивая мышью маркер заполнения, мож-
но построить ряд заполнения ячеек (Рис. 2.16, слева).
В этом ряду числа, расположенные в соседних ячейках, будут отличаться друг
от друга на величину, равную разности между значением второй и первой ячеек.
Чтобы внести в ячейки последовательность дат, просто введите первую из них,
а затем выберите нужные ячейки с помощью маркера заполнения. Программа
будет считать, что следующая дата больше предыдущей на одни сутки (Рис. 2.16,
в центре). Если необходимо задать другую последовательность, введите две пер-
вые даты в двух первых ячейках, выделите их, а затем, перетаскивая маркер запол-
нения, создайте требуемую последовательность дат (Рис. 2.16, справа).
Вы можете настроить параметры автоматического создания прогрессий. Вы-
берите команду меню Правка Х£> Заполнить :£> Прогрессия, и будет открыт диа-
лог настройки прогрессий (Рис. 2.17).
Переключатель Расположение определяет,
что заполняется — ряд строк или столбцов.
Содержимое первой ячейки или ячеек этой
строки или столбца будет использовано как
начальное значение ряда. Шаг прогрессии -
это положительное или отрицательное число,
используемое для вычисления следующего
значения ряда по предыдущему. Если установ-
лен флажок Автоматическое определение ша-
га, программа сама будет вычислять шаг исхо-
Рис. 2.17.
Настройка прогрессии
87
Особенности Excel, полезные бухгалтеру
дя из значений в первой или нескольких первых ячейках вьщеления. Если фла-
жок сброшен, становится доступным поле ввода Шаг, и вы можете задать эту ве-
личину самостоятельно.
Установив переключатель Tun, вы выберете, какую прогрессию вы хотите со-
здать. Положение Арифметическая говорит о том, что выделенные ячейки будут
образовывать прогрессию, в которой значение каждого элемента формируется
путем добавления к предыдущему значению величины, указанной в поле Шаг.
Если переключатель установлен в положение Геометрическая, выделенные ячей-
ки будут образовывать прогрессию, значение каждого элемента которой форми-
руется путем умножения предыдущего значения на величину шага.
Если вы установите переключатель в положение Даты, то создадите про-
грессию, в которой выделенные ячейки будут заполнены рядом дат. При этом
становится доступным переключатель Единицы, установив который, вы выбере-
те тип дат, которые будут образовывать прогрессию.
Установив переключатель в положение Автозаполнение, вы опишете запол-
нение пустых выделенных ячеек значениями соответствующего ряда. Это дейст-
вие совпадает с рассмотренным выше перетаскиванием маркера заполнения.
В поле ввода Предельное значение можно ввести положительное или отрица-
тельное число, определяющее предельное значение прогрессии. Заполнение яче-
ек в выделенном диапазоне осуществляется либо до заполнения всего диапазона,
либо до достижения элементом прогрессии предельного значения, указанного в
этом поле. В этом случае несколько ячеек выделенного диапазона остаются пус-
тыми. Заполнение поля Предельное значение необязательно. После настройки па-
раметров прогрессии нажмите кнопку ОК, чтобы закрыть диалог. В выделенных
предварительно ячейках будет построена прогрессия в соответствии с вашими на-
стройками.
Автоматическое заполнение реализуется за счет встроенных в программу
списков автозаполнения. К таким спискам относятся, например, названия дней
недели, месяцев. Вы можете использовать встроенные списки автозаполнения
своих нужд, а если перечень
Проверка ошибок
Общие | Переход
Безопасность
мм ( цвет
НОВЫЙ СПИСОК
яме, фее, кар, enp, май, июн, июл, at
Январь, Февраль, Март, Апрель, Май, 1
Дли разделения элементов; списка №
Суббога
воскресенье
Рис. 2.18.
Настройка списков автозаполнения
списков вас не устраивает, вы мо-
жете добавить новый, свой собст-
венный список.
Чтобы создать новый список
автозаполнения или редактиро-
вать уже существующий список,
выберите команду меню Сервис
Х£> Параметры. На экране по-
явится диалог настройки параме-
тров. Щелкните мышью на яр-
лычке Списки этого диалога, что-
бы перейти на соответствующую
вкладку (Рис. 2.18).
Автоматизация ввода данных
Иванов
Петров
Сидоров
В левой части диалога отображается ряд встроен-
ных списков, и если выбрать список автоматического
заполнения в левой части, в правой части появится
перечень элементов данного списка. Отредактировать
встроенные списки вы не можете, но можете создать
собственные списки автоматического заполнения.
Это можно сделать несколькими способами.
Можно создать список на основе выделенных
ячеек, содержащих элементы списка. Предварительно
введите информацию, которая будет элементами спи-
ска, в ячейки и выделите их (Рис. 2.19).
Далее откройте диалог настройки параметров и перейдите на вкладку работы со
списками. Обратите внимание, что в поле ввода Импорт списка из ячеек указаны ад-
реса диапазона выделения ячеек. Нажмите кнопку Импорт, и новый список появит-
ся влевой части диалога. Если ячейки предварительно не выделены, нажмите кноп-
в правой части поля ввода Импорт списка из ячеек, и диалог настройки будет
Рис. 2.19.
Ввод элементов
списка
ку
свернут, освобождая тем самым рабочую область окна программы. Теперь выделите
диапазон ячеек, в котором содержатся элементы создаваемого списка. Чтобы вос-
становить диалог, нажмите кнопку [Щ Ц в правой части свернутого диалога. В заклю-
чение нажмите кнопку Импорт, и новый список появится в левой части диалога.
Можно также создать список самостоятельно. Выберите в левой части диало-
га из перечня Списки элемент НОВЫЙ СПИСОК. В правой части диалога, в облас-
ти Элементы списка, появится текстовый курсор. Вы можете вводить элемент спи-
ска с помощью клавиатуры. Элемент списка может состоять из нескольких слов.
Пока вы не нажмете клавишу '| Enter|, вы вводите информацию об одном элементе
списка. После того, как вы нажмете
клавишу i|Enter|, текстовый курсор
перейдет на новую строку, и вы мо-
жете приступать к вводу следующе-
го элемента списка. Так вы вводите
все элементы списка. После ввода
всего списка следует нажать кнопку
Добавить. Новый список будет со-
здан и появится в перечне списков
(Рис. 2.20).
Если вы хотите изменить спи-
сок, выберите его в левой части ди-
алога, щелкнув на нем мышью, а
затем щелкните мышью в правой
части диалога, где отображаются
элементы списка. Вы можете добавлять или удалять элементы списка, а также
менять их названия. Чтобы программа запомнила изменения, по окончании ре-
дактирования нажмите кнопку Добавить.
Международные | Сохранение | Проверка ошибок { Орфография \ Безопасность
Вид j Вычисления | Правка Общие j Переход Списки j Диаграмма Цвет
Спида*: 2<1еиенпч списка:
список *. {
^ пн, вг, ср, чт, т, сб, ве
1 Понедельник, Вторник, Среде, Четверг,
;'.:. чнв, фев, мер, аир, май, мю», топ. авг.
Январь, Февраль, Март, Апрель. Мей, 1 .'".'-
Иигаа, Петров, Сидоров - .,;|;
1. т ̂  . , . ^
££, |Lj|ES*M
££. _J£SL I
Рис. 2.20.
Созданный список автозаполнения
89
Особенности Excel, полезные бухгалтеру
Если вы хотите удалить список, выберите его в левой части диалога, а затем
нажмите кнопку Удалить. Появится диалог с предупреждением, что восстано-
вить удаляемый список нельзя. Нажмите кнопку ОК этого диалога, и список бу-
дет удален. Отметим, что удалять вы можете только те списки, которые создали
сами. Удалить встроенные в программу списки автозаполнения нельзя.
После того, как список создан или отредактирован, нажмите кнопку ОК в
диалоге настройки, чтобы закрыть диалог. Теперь вы можете проверить работу
созданных списков. Введите в ячейку первый элемент списка, а затем перетащи-
те с помощью мыши маркер заполнения. Когда вы отпустите кнопку мыши, в
выделенных ячейках появятся остальные элементы списка. Причем, если вы вы-
делили больше ячеек, чем элементов в списке, то после последнего элемента бу-
дет вставлен опять первый элемент, за ним второй и так далее.
Если вы используете Excel 2002, то можете выбирать, какая информация из
первой ячейки прогрессии будет переноситься в другие ячейки. После перетас-
кивания мышью маркера выделения около маркера появится значок JM]. Щелк-
ните мышью на этом значке, и появится вспомогательное меню. В этом меню вы
можете выбрать, какую информацию из ячеек следует переносить. Можно ука-
зать, что нужно переносить всю информацию, только форматирование ячейки
или только ее содержимое, без форматирования.
2.3.2. Проверка вводимых данных
При вводе большого количества информации в ячейки таблицы, легко допу-
стить ошибку. Чтобы облегчить ввод данных в таблицу, вы можете проверять их
при вводе, и программа будет информировать вас о том, что вы вводите ошибоч-
ные данные. При этом информация в ячейке не меняется, а только выводится
предупреждение. Вы должны сами исправить ошибочную информацию.
Для использования этой возможности программы выберите ячейку или
группу ячеек, в которых нужно проверять
данные при вводе, а затем выберите команду
меню Данные ^> Проверка. В появившемся
диалоге настройки щелкните мышью на яр-
лычке Параметры, чтобы перейти на одно-
именную вкладку (Рис. 2.21).
Открывающийся список Tun данных со-
держит разные варианты проверки. Выбрав
элемент списка Любое значение, вы сделаете
недоступными все элементы управления на
этой вкладке. При этом проверяться будет
любая вводимая информация. Выбрав эле-
мент Целое число или элемент Действитель-
ное, вы укажете программе, что проверяться
условие проверки .
Дпчмйие .:;'
Шюбм значение
: --;•;•: .; •:-. ' •;< , :','•.' ' ' •:-.'•
Рис. 2.21.
Параметры проверки
90
Автоматизация ввода данных
должны только вводимые числа, соответственно целые и
вещественные, причем числа должны находиться в задан- 1 ,|
ных вами пределах. При этом станет доступным список
Значение, в котором нужно выбрать способ ограничения. „ , 22
Для задания интервала можно выбрать элементы Между Выбор из списка
или Вне, для сравнения можно выбрать элементы Равно, при ввоое
Неравно, Больше, Меньше.
В зависимости от способа ограничения вводимых значений будет появлять-
ся поле ввода для указания границ. Вы можете ввести число или указать адрес
ячейки, где находится число, которое будет ограничением. Чтобы свернуть диа-
лог для выбора ячейки с помощью мыши, нажмите кнопку ̂ g в правой части по-
ля ввода, и после выбора, чтобы восстановить диалог на экране, нажмите кнопку
g]. Если вы не будете вводить данные в ячейку, то при установленном флажке
Игнорировать пустые ячейки сообщение об ошибке не будет появляться.
Если вы хотите, чтобы вводимые данные были исключительно значениями из
списка, выберите в списке Тип данных элемент Список. При этом станет доступ-
ным поле ввода Источник, в котором следует указать элементы списка, которые
будут основанием для проверки. Вы можете перечислить элементы списка в этом
поле через запятую или точку с запятой, также вы можете указать диапазон ячеек,
где находится список допустимых значений. Если вы хотите отметить диапазон
с помощью мыши, сверните диалог, нажав кнопку Egg в правой части поля вво-
да, и после выбора, чтобы восстановить диалог на экране, нажмите кнопку
ср]. Если проверка осуществляется по списку, становится доступным флажок
Список допустимых значений. Если установить этот флажок, то при вводе справа
от активной ячейки будет появляться кнопка открытия списка г*"; (Рис. 2.22).
Нажав эту кнопку, вы откроете список допустимых значений, который вы
определили ранее, и можете выбрать из него информацию для ввода. Также при
вводе информации из списка можно пропускать проверку пустых ячеек. Для это-
го установите соответствующий флажок в диалоге настройки.
Если вводимая информация, которую нужно проверить, является датой или
временем, в списке Тип данных выберите элементы Дата или Время соответст-
венно. Так же как и для чисел, в списке Значение нужно выбрать способ ограни-
чения, а затем в полях ввода Начальная дата и Конечная дата или Время начала
и Время конца указать границы интервала даты или времени. Можно вводить в
эти поля дату или время непосредственно, а можно указать адреса ячеек, в кото-
рых хранятся эти данные.
Можно ограничить длину вводимого в ячейки текста. Для этого в списке Тип
данных, выберите элемент Длина текста. Станет доступным список Значение, в
котором нужно выбрать способ ограничения длины текста. После выбора спосо-
ба ограничения в полях ввода Минимум и Максимум укажите число символов
или адреса ячеек, в которых хранятся числа.
Excel позволяет строить сложные условия проверки при вводе. Выберите в
списке Тип данных элемент Другой, и станет доступным поле ввода Формула.
91
Особенности Excel, полезные бухгалтеру
F Отображать подсказку, если ячейка является текущей
При выборе ячейки вывести следующее сообщение:
... .(прове
Рис. 2.23.
Сообщение при вводе
В этом поле вы можете ввести нужную вам
формулу, по которой вычисляется ограниче-
ние для ввода данных. Особенностью форму-
лы является то, что она должна возвращать
логическое значение ИСТИНА для коррект-
ных данных или ЛОЖЬ для некорректных
данных.
После выбора типа проверяемых данных
и установки ограничений, нужно указать
программе, какие сообщения нужно выво-
дить при вводе и при обнаружении ошибки.
Щелкните мышью на ярлычке Сообщение для
ввода, чтобы перейти на одноименную вклад-
ку диалога (Рис. 2.23).
В поле ввода Заголовок следует ввести на-
звание появляющегося сообщения. Это название будет отображено в заголовке
диалога, открывающегося при вводе данных в проверяемые ячейки. В поле вво-
да Сообщение, можно ввести поясняющий текст, например, описывающий огра-
ничения при вводе. Такая подсказка может быть полезной. Максимальная длина
текста составляет 255 символов, а для перехода на новую строку нажимайте кла-
вишу |[Entef|. Если установить флажок Отображать подсказку, если ячейка являет-
ся текущей, то, когда вы сделаете ячейку активной, будет выводиться сообщение
с подсказкой.
Чтобы настроить текст сообщения, появляющегося при вводе ошибочных
данных, щелкните мышью на ярлычке Сообщение об ошибке, чтобы перейти на
одноименную вкладку диалога проверки (Рис. 2.24).
В открывающемся списке Вид, нужно выбрать тип сообщения. Для отобра-
жения информационного сообщения, не запрещающего ввод неправильных
данных, выберите элемент Сообщение. Для
отображения предупреждения, не запрещаю-
щего ввод неправильных данных, выберите
элемент Предупреждение. Чтобы запретить
ввод неправильных данных, выберите эле-
мент Останов.
В поле ввода Заголовок можно указать
текст, появляющийся в заголовке диалога с
сообщением об ошибке, а в поле ввода Сооб-
щение, введите текст сообщения об ошибке.
Так же, как и для сообщения о проверке, дли-
на текста должна быть менее 255 символов.
Данное сообщение будет выводиться, только
если установлен флажок Выводить сообщение
об ошибке. В противном случае сообщение не
!•- 8ui!(vj.iiiu юы'ипеиий об ошибке
При попытке ввода неверных данных отображать сообщение
8ид: Заголовок:
Рис. 2.24.
Настройка сообщения
об ошибке
92
Импорт данных
будет появляться. Если вы установили флажок, но не ввели заголовок и текст со-
общения об ошибке, будут использованы стандартные заголовок и текст. Заголо-
вок будет Microsoft Excel, а текст будет следующим: Введенное значение неверно.
Набор значений, которые могут быть введены в ячейку, ограничен.
В заключение отметим, что на всех вкладках диалога настройки проверки
есть кнопка Очистить все. Нажав эту кнопку, вы сбросите все настройки на со-
ответствующей вкладке диалога. После того, как настройка завершена, нажмите
кнопку ОК, чтобы закрыть диалог. Теперь информация при вводе в выбранные
вами ячейки будет проверяться по настроенным вами правилам.
2.4. Импорт данных
С помощью импорта данных вы можете вводить информацию в программу
Excel из других программ. При этом вы избежите повторного ввода данных. В ка-
честве источника данных, импортируемых в Excel, могут служить различные бух-
галтерские программы, а также базы данных. Установив связь с базой данных,
программа будет автоматически обновлять импортированные данные, если они
изменились и в базе данных.
2.4.1. Получение информации из бухгалтерских программ
Не все бухгалтерские программы могут строить нестандартные расчеты на
основе информации из журнала операций, хотя и ведут учет всех первичных до-
кументов. Кроме того, не все программы позволяют вести анализ данных, накап-
ливаемых в результате ведения хозяйственной деятельности. Для этих целей
удобно использовать программу Excel, но нужно передать информацию из бух-
галтерских программ в эту программу.
Большинство программ позволяет сохранить отчеты в формате Excel. В этом
случае вы можете в дальнейшем работать с ними, как с любыми другими файла-
ми. Например, экспортировав журнал проводок в виде таблицы, вы можете
задать собственные формулы для обработки и получения нестандартных отчетов.
В разных бухгалтерских программах информация может быть перенесена в Excel
различными способами.
Работая в программе 1C:Бухгалтерия, создайте отчет, а затем нажмите кноп-
ку Ц. Вы откроете диалог настройки сохранения отчета, в котором следует вы-
брать папку для сохранения и ввести имя файла. В качестве типа файла нужно
указать элемент списка Таблица Excel, и созданный отчет можно в дальнейшем
исправить с помощью Excel. Из программы БЭСТ экспортировать некоторую
информацию можно с помощью генератора отчетов, предназначенного для пе-
чати отчетов в Windows. Чтобы экспортировать отчет в Excel, после создания от-
93
Особенности Excel, полезные бухгалтеру
чета откройте панель инструментов Экспорт и нажмите кнопку, соответствую-
щую этой программе.
Работая с программой ИНФИН, вы также можете передать документ в про-
грамму для работы с электронными таблицами Excel. Создайте отчет и выберите
команду меню Файл :£> Экспорт в Excel. Будет запущена программа Excel и в нее
будет загружен документ. Особенностью программы ПАРУС-предприятие явля-
ется то, что все отчеты формируются для просмотра и печати в программе Excel,
и вам не нужно предпринимать каких-либо действий, чтобы импортировать до-
кументы в программу Excel. Работая в программе Турбо Бухгалтер, выберите ко-
манду меню Журнал э£> Список отчетов. Будет открыт диалог настройки отчета,
в котором следует установить переключатель Отчет в форме в положение Excel.
Затем выберите отчет в левой части диалога и нажмите кнопку Создать, чтобы
сгенерировать отчет. В некоторых программах, например, в Инфо-Бухгалтер,
экспорт в Excel реализован так, что вы не сможете воспользоваться вычисления-
ми. Все числа помещаются не в ячейки таблицы, а в надписи. Фактически полу-
чается просто рисунок документа, не подходящий для работы.
Некоторые бухгалтерские программы не позволяют экспортировать в Excel.
Кроме того, вам может понадобиться перенести часть информации из докумен-
та в таблицу. Для этого можно воспользоваться буфером обмена Windows. Выде-
лите нужные строки редактируемого документа, например журнала операций, и
скопируйте их в буфер обмена. После этого вы можете вставить в таблицу Excel
данные из буфера обмена и работать с ними обычным способом.
Например, работая в программе 1C:Бухгалтерия, выделите нужную инфор-
мацию, а затем скопируйте ее в буфер обмена, нажав кнопку Щ||] на панели ин-
струментов. Далее переключитесь в программу Excel, или запустите ее, если она
до сих пор не запущена. Затем нажмите кнопку ̂ | на панели инструментов
Excel, и данные будут вставлены в таблицу. В других программах вы должны дей-
ствовать аналогично.
Excel может читать информацию из стандартных баз данных. Многие бух-
галтерские программы хранят информацию в базах форматов dBase, Paradox,
Oracle и других форматах, которые легко используются Excel для чтения. Ниже
мы рассмотрим, как экспортировать внешние данные из баз данных, однако
нужно помнить, что часто информация в базах носит служебный характер, защи-
щена паролями, и получить нужные данные бывает достаточно сложно.
Если бухгалтерская программа, например Турбо Бухгалтер, позволяет экс-
портировать документ в текстовый файл, вы можете прочитать его из Excel, од-
нако при двойном преобразовании из таблицы в текст и снова в таблицу может
потеряться структура, так что информацию будет трудно обработать.
Давайте рассмотрим, как импортировать текстовый файл в Excel. В програм-
ме Excel 97 эту операцию, к сожалению, выполнить нельзя. Если вы работаете в
Excel 2000, выберите команду меню Данные :£> Внешние данные -ф Импорт тек-
стового файла. Если вы работаете с Excel 2002, выберите команду меню Данные
э£> Импорт внешних данных ;£> Импортировать данные. В обоих случаях появит-
94
Импорт данных
ся диалог выбора источника данных,
похожий на диалог открытия файла.
В списке Тип файла, выберите эле-
мент Текстовые файлы, а затем ука- s-Se."S»S"»« ^̂ Z^S^T'"'"*
жите папку, где находится импорти- 1 »»„*„,,„,„„ „.„„„«р—g «^ф^р .̂"^^"
руемый текст, и имя файла. В заклю- | „„„„„_, про„„рфавтЕ:,^,ООК5МЕКЕЩит
чение нажмите кнопку Открыть \ и -̂ш» »>«••>•«»«* «»»™~ »™«»«™««у
или кнопку Импорт для Excel 2000.
Диалог будет закрыт и появится пер- | Ц— —j—
вый диалог мастера импорта текстов
Отмена ! Двдее > 1 Готово I
(Рис. 2.25)
Переключатель Формат исход- рис 2.25.
ных данных определяет, как програм- Первый диалог
ма будет формировать поля таблицы. мастера импорта текстов
Если установить переключатель в по-
ложение С разделителем, значения полей будут определяться разделительными
знаками, такими, как запятая, точка, точка с запятой и другими. Если переклю-
чатель установить в положение Фиксированной ширины, то поля будут иметь за-
данную величину.
Поле ввода Начать импорт со строки определяет, с какой строки в текстовом
документе начинается импорт текста. По умолчанию импорт идет с первой стро-
ки, но вы можете указать номер начальной строки вручную, введя номер в поле
ввода. Открывающийся список Формат файла предназначен для выбора типа
кодировки текстового файла. Кодировка выбрана правильно, если в поле про-
смотра в нижней части диалога удается прочитать текст. Если это не так, попро-
буйте выбрать в списке другую кодировку. Пробуйте разные кодировки до тех
пор, пока текст не удастся прочитать.
После настройки параметров в этом диалоге нажмите кнопку Далее, чтобы
продолжить импорт текста в таблицу. Будет открыт следующий диалог мастера им-
порта текстов. Если в предыдущем диалоге вы выбрали формирование полей по
разделителям, во втором диалоге нужно указать тип разделителя (Рис. 2.26, слева).
В данном диалоге с помощью установки флажков в группе Символом-разде-
лителем является нужно выбрать символы, которые программа будет считать
разделителями полей. Если вы укажите в качестве разделителя Другой, то долж-
ны будете ввести этот символ в поле ввода справа от переключателя. Список Ог-
раничитель строк позволяет выбрать одинарную или двойную кавычку в качест-
ве символа разделения. Если установлен флажок Считать последовательные раз-
делители одним, программа проигнорирует все разделители, кроме одного, когда
встретит несколько подряд идущих разделителей. Определению разделителей
поможет поле предварительного просмотра в нижней части диалога.
Если в первом диалоге мастера вы выбрали формирование фиксированных
полей, второй диалог мастера будет иным (Рис. 2.26, справа). В этом диалоге
нужно вручную указать размер строки. Чтобы установить указатель конца стро-
95
Особенности Excel, полезные бухгалтеру
Данный manor попади •. • ш дп* «Kmwwi дачных.
Результат вь»|" i >азбоо.
1 : Сннаолом-ризделителем
• Г тон» с запятой р"
; f " аапятая
строк;
Г op**» Г д а т е * : Г": . ' : ' " " '
1" liJ'"'".' Счн™ть ! i . 'игелиоднич
; УетвнОянге шири!*/ полей (y«,*nfe, клю-ро. .i сгоябц<4
; Линии со стрмдаи (йвнймввт конец столбца.
:| Чтобы ВСТАВИТЬ «онец Строки, wiWWTS в нужней псеиции, ;
|| : Чтобы УДАЛИТЬ конецСТ1ИИЙ,йв.го«дыuwwmiffв>»строке. . : .
;! Чтобы !)£-;••
йрп-жц разбора данных
«1
Ш i:
I: zzzzr f.i ' i : ^ '• • ; ; . : ••;:• . - . " • : -...т-.-: ; : • j i
on™».) «Нищ KflSit'l Ся«» j j ,
эбразе^ разборе данная .
' , ! « , ' , ' • i! ','•,'„ ,'V : „1«; ',Л ,5<
ВНЖИЯКЕ 1 Чтавы РВ&СТДЛИ кекагворве }^нкщек делены б
- 1 _J.
„«"«"• : :J525Jl
. *•:.; ;-,.
>
й«Я|, w«
в
г
щщ
1
Рис. 2.26. Определение полей
ки, щелкните мышью в нужном месте на поле просмотра. Чтобы удалить указа-
тель, дважды щелкните на нем мышью. Если нужно переместить указатель, про-
сто перетащите его с помощью мыши.
После того, как размеры полей определены, нажмите кнопку Долее, чтобы
продолжить работу мастера импорта текстов. Будет открыт следующий диалог
мастера (Рис. 2.27, слева). Данный диалог мастера предназначен для установки
формата данных. По умолчанию импортируемым данным присваивается формат
Общий, но с помощью установки переключателя Формат данных столбца, вы мо-
жете выбрать текстовый формат, формат даты или вообще не форматировать
столбец. Если нужно уточнить параметры форматирования, нажмите кнопку По-
дробнее. Будет открыт диалог настройки (Рис. 2.27, справа).
В списке Разделитель целой и дробной части вы можете выбрать символ-раз-
делитель. А в списке Разделитель разрядов, нужно выбрать символ, который будет
разделять группы разрядов. Обычно в качестве разделителей выбирают точку или
запятую. Если установить флажок в нижней части диалога, числа, в конце кото-
рых стоит знак минус, например /00-, будут считаться отрицательными.
««даго столбца формат »«»ых.
ушврсат- ,.,!«
b'C.yajcri г* i . е
дэт - в деты, э а<*х праднх значений • в текст.
("'дата: ДМГ т]
^ зропустигь столбец
Н«тро,к,»Лр,дИ«»„«сл.8«„,н»Я. : ' ' .
.1 дробной ч
Разделитель разрядов:
Примечание. ЧИ<УИ отображаются а соответствия
. i 'пвнели
Р^^ак'цйкус'в конце отричатеньньн'чиевл
|Г.Г.Ж.-"71 Отмена
Рис. 2.27. Настройка формата полей
96
Импорт данных
После настройки параметров нажмите кнопку
ОК, чтобы закрыть диалог. Теперь можно завер-
шить работу мастера, для чего нажмите кнопку Го-
тово. Диалог мастера будет закрыт, и появится ди-
алог для определения места в таблице, куда встав-
лять импортируемый текст (Рис. 2.28).
Установив переключатель в положение
Имеющийся лист, вы должны подтвердить диа-
пазон ячеек, в который будут помещены импор-
тируемые данные. Можно ввести диапазон с по-
мощью клавиатуры, а можно указать его с помо-
щью мыши. В последнем случае, сверните диалог, нажав кнопку
Рис. 2.28.
Диапазон для импорта
в пра-
вой части поля ввода. Выделите мышью нужный диапазон и нажмите кнопку
g], чтобы восстановить диалог. Если импортируемый текст нужно размес-
тить на отдельном листе, установите переключатель в положение Новый лист.
При этом в книгу будет добавлен новый лист, а внешние данные будут разме-
щены в его левом верхнем углу. В заключение нажмите кнопку ОК диалога, и
текст будет импортирован в таблицу.
Попробуйте все варианты получения информации из вашей бухгалтерской
программы: экспортируйте в формат Excel, переносите информацию через бу-
фер обмена и попытайтесь открыть для чтения базу данных. Если вы получите
полезную информацию, можете с помощью Excel попытаться ее обработать и
провести анализ.
2.4.2. Связь с иными источниками данных
Программа Excel позволяет импортировать информацию из разных источ-
ников данных. В частности, это могут быть различные базы данных, а также
информация из Интернета. Если вы работаете в Excel 2002, для импорта дан-
ных из большинства источников нужно выбрать команду меню Данные ^>
Импорт внешних данных :£> Импортировать данные. Будет открыт диалог вы-
бора документа для импорта, в котором нужно указать тип данных и имя фай-
ла. Далее следуйте инструкциям мастера импорта, и вы вставите информацию
в таблицу.
Если вы работаете с Excel 97 или 2000, нужно создать запрос к источнику
информации, чтобы вставить ее. Для этого нужно выбрать команду меню Дан-
ные Х£> Внешние данные :а£> Создать запрос. Создать запрос можно и в Excel 2002,
для этого выберите команду меню Данные :£> Импорт внешних данных Х£> Со-
здать запрос.
Отметим, что для создания запросов к внешним данным, должен быть уста-
новлен компонент Microsoft Office, который называется Microsoft Query. Если эта
программа не установлена, появится диалог, предлагающий установить програм-
97
4-5458
Особенности Excel, полезные бухгалтеру
Рис. 2.29.
Выбор источника данных
му. Вставьте компакт-диск с Microsoft
Office в дисковод и нажмите кнопку
ОК. Программа будет автоматически
установлена. После этого выберите
команду создания запроса еще раз.
Будет открыт диалог выбора источ-
ника данных для импорта (Рис. 2.29).
В данном диалоге нужно в спис-
ке поддерживаемых баз данных вы-
брать тип базы, откуда следует им-
портировать данные. Нажав кнопку
Обзор, вы откроете диалог выбора других источников данных, а нажав кнопку
Параметры, вы откроете диалог, в котором можно указать папки, в которых
будет произведен поиск источников данных. Также в этом диалоге можно вклю-
чить в список источники данных более ранних версий. Если вы хотите исполь-
зовать мастер построения запросов к базам данных, установите флажок в ниж-
ней части диалога выбора источника. После выбора типа источника, нажмите
кнопку ОК, чтобы закрыть диалог. Появится диалог для выбора базы данных вы-
бранного вами типа (Рис. 2.30).
В списке Диски, нужно выбрать диск, на котором находится база данных. Ес-
ли база находится на другом компьютере, и компьютеры соединены сетью, на-
жмите кнопку Сеть, и будет запущен мастер подключения сетевых дисков. По
окончании работы мастера сетевой диск появится в списке дисков, и вы сможе-
те выбрать его в списке Диски. После выбора диска, нужно в списке Каталоги
выбрать папку, в которой расположена база данных, а после выбора папки в спи-
ске в левой части диалога нужно выбрать саму базу данных для импорта.
Если установить флажок Только чтение, вы не сможете менять импортируе-
мые данные, а сможете только просматривать их. Если установить флажок Моно-
польный доступ, во время импорта другие пользователи не смогут работать с этой
базой данных. После выбора базы нажмите кнопку ОК, чтобы закрыть диалог.
В зависимости от типа базы данных возможно появление еще нескольких
диалогов мастера для уточнения выбора информации. Вначале появится диа-
лог выбора полей базы для импорта
(Рис. 2.31, слева).
В этом диалоге нужно выбрать
столбцы базы данных, которые нуж-
но включить в запрос на импорт.
Имеющиеся столбцы располагаются
в левой части диалога. Чтобы доба-
вить столбец в запрос, нужно выбрать
его в левой части диалога и нажать
кнопку _^ > J в центральной части.
Название столбца базы данных no-
В Сергей
fo Мои документы
CD Corel User Files
CD My Virtual Machines
CD Мои видеозаписи
D Мои источники даЬ
Справке
Рис. 2.30.
Выбор базы данных
Импорт данных
дыавимн*сл«йывтгЧ'.11с'-1:!,ч. Е, .-«iii-j,,1 ! i Звлвйтфщаевялоcreepsяончмк
I '( £cj'« трева'-'тсаповуцигьзсвдаы!
.„.i | f CrndPLit.: дпм (iTWpcr 8гэЁ|
_-̂ j , 4 i ..„;_:__ 7,_J ;... I "П"-,-f ___-,.. I I « тг!
Рнс. 2. J/. Выбор столбцов и отбор данных
явится в правой части диалога. Если нужно удалить элемент из запроса, выбери-
те его в правой части диалога и нажмите кнопку _f_J • После выбора столбцов
для включения в запрос нажмите кнопку Далее, чтобы продолжить работу. По-
явится следующий диалог мастера создания запроса (Рис. 2.31, справа).
В этом диалоге нужно для каждого столбца базы данных, отобранных в пре-
дыдущем диалоге, указать условия отбора. Можно не задавать условий, тогда бу-
дут импортированы все данные. Если нужно выбрать данные, выберите столбец
в левой части диалога и с помощью открывающихся списков в правой части ди-
алога укажите тип условия для отбора и значение, являющееся условием отбора.
Можно задать до трех условий, объединяемых по правилу И или ИЛИ. Эту опе-
рацию можно повторить для каждого из отобранных столбцов. После указания
условий отбора, нажмите кнопку Далее, чтобы продолжить работу. Появится сле-
дующий диалог мастера (Рис. 2.32, слева).
В этом диалоге нужно указать порядок сортировки выбранных столбцов ба-
зы данных. В списке Сортировать по выберите столбец для сортировки, а с по-
мощью переключателя, расположенного правее, установите порядок сортиров-
ки: по возрастанию или по убыванию. Можно установить сортировку по двум
столбцам. Для этого выберите в списке Затем по второй столбец для сортиров-
ки, а также выберите порядок с помощью переключателя. После выбора сорти-
ровки нажмите кнопку Далее, чтобы продолжить создание запроса. Будет открыт
заключительный диалог мастера создания запросов (Рис. 2.32, справа). В этом
диалоге с помощью переключателя выбирается вариант дальнейших действий.
Установите переключатель в положение Вернуть данные в Microsoft Excel. Если
Рис. 2.32. Порядок сортировки и заключительный шаг
99
Особенности Excel, полезные бухгалтеру
ИМЯ: J Запрос из Базе данных MS Access
• stipoca
Р^ сохранить определение запроса
р" сохранять Нарояь
Обновление экрана
F фоновое обновление
!"" обновлять каждые [ б З - ^ • •
f" обновление при открытии файле
г -• •• . - - . - . - -
о сортировке/фнпьтре/формэте д
сли количество сгр
!» добавить новые строки и удалить существующие
'" добавить новые строки и очистить пустые ачейки
Г' ззйентъ существующие ячейки и удгодг ,̂ пустые
заполнить формулами соседние сгопбцы . ..
Рис. 2.33.
Настройка свойств
нажать кнопку Сохранить запрос, созданный
вами запрос будет сохранен, и вы можете вы-
зывать его в дальнейшем. Нажмите кнопку Го-
тово, чтобы закрыть диалог мастера и завер-
шить его работу.
Будет открыт диалог для определения мес-
та в таблице, куда будут помещены импортиру-
емые данные (Рис. 2.28), который рассмотрен
выше. Установив переключатель в положение
Имеющийся лист, вы должны указать диапазон
ячеек, в который будут помещены импортиру-
емые данные. Установив переключатель в по-
ложение Новый лист, вы разместите импорти-
рованные данные на отдельном листе. В за-
ключение нажмите кнопку ОК диалога, и дан-
ные будут импортированы в таблицу.
Если в таблице есть импортированные
данные, на экране появится панель инструментов Внешние данные. С помощью
инструментов этой панели можно изменить настройки импорта, указать имя
внешнего диапазона, периодичность обновления связи, формат данных и неко-
торые другие параметры. Чтобы настроить параметры импорта, нажмите кнопку
цЦ* на этой панели инструментов. Будет открыт диалог настройки (Рис. 2.33).
Если установлен флажок Сохранить определение запроса, разрешено обнов-
лять данные из базы. Сбросьте этот флажок, если необходимо запретить обновле-
ние данных. Некоторые базы данных требуют для доступа к информации пароль.
Установив флажок Сохранить пароль, вы сохраните в запросе пароль для дальней-
шего использования. При этом Excel будет запрашивать пароль только при пер-
вом обращении к источнику внешних данных. Если требуется обеспечить ввод
пароля при каждом обращении к источнику данных, сбросьте этот флажок.
Группа флажков Обновление экрана определяет, как будут обновляться дан-
ные в запросе. Если установлен флажок Фоновое обновление, вы можете работать
в программе до завершения запроса. Если необходимо запретить работу до за-
вершения запроса, сбросьте этот флажок. Если установлен флажок Обновлять
каждые, становится доступным поле ввода для задания интервала автоматичес-
кого обновления. Если установлен флажок Обновлять при открытии файла, им-
портированные данные будут обновлены только при открытии книги Excel в на-
чале работы.
Группа флажков Формат и разметка данных определяет параметры форма-
тирования импортированных данных. Если установлен флажок Включить имена
полей, в подписях столбцов будут использованы имена из диапазона внешних
данных. Если необходимо определить собственные подписи, сбросьте этот фла-
жок. В этом случае подписи вводятся в строке, которая расположена над диапа-
зоном внешних данных.
100
Импорт данных
Если установить флажок Включить номера строк, в импортируемые данные
будут добавлены номера строк из внешнего источника данных. По умолчанию
этот флажок сброшен, и номера строк из внешнего источника не переносятся в
результирующий набор импортированных данных. Если установить флажок За-
дать ширину столбца, ширина столбцов будет меняться при обновлении диапа-
зона внешних данных. Чтобы ширина столбцов оставалась прежней, флажок
нужно сбросить. Если установлен флажок Автоформат данных, после обновле-
ния диапазона внешних данных сохраняется форматирование ячеек в Excel.
Переключатель Если количество строк в диапазоне изменится определяет
действия программы в случае, когда при обновлении импортируемых данных
произошло изменение количества строк. Можно добавить новые строки и уда-
лить предыдущие, а можно заменить текущие строки и удалить образовавшиеся
пустые ячейки. Если установлен флажок Заполнить формулами соседние столбцы,
программа будет копировать формулы из столбцов справа от диапазона внешних
данных в новые строки, которые добавляются при обновлении данных. После
настройки параметров нажмите кнопку ОК, чтобы закрыть диалог.
Созданный вами запрос будет храниться в программе. Для повторного вы-
полнения запроса нужно выбрать команду меню Данные :£> Внешние данные *£>
Выполнить запрос к базе данных, если вы работаете в Excel 97 и 2000. Если вы ра-
ботаете в Excel 2002, выберите команду меню Данные ^> Импорт внешних данных
т£> Импортировать данные. В любом случае появится список запросов, в кото-
ром нужно выбрать нужный запрос.
В Excel 97 и 2000 можно выполнять запросы к базам данных в Интернете.
В программе есть ряд готовых запросов на получение курса валют или котировок
акций, но вы не можете создавать собственные запросы в Интернет. Если вы ра-
ботаете с Excel 2002, вы можете импортировать данные из любых страниц в Ин-
тернете. Для этого необходимо,
чтобы на вашем компьютере было
настроено подключение к Интер-
нету. Эта задача не входит в рамки
нашей книги, и мы будем считать,
что ваш компьютер настроен для
работы в Интернете.
Выберите команду меню Дан-
ные Х£> Импорт внешних данных
Х£> Создать веб-запрос. Будет уста-
новлено соединение с Интерне-
том и открыто окно создания за-
проса (Рис. 2.34).
В поле Адрес вы вводите адрес
в Интернете той информации, ко-
торую нужно импортировать. По-
сле ввода адреса, нажмите кнопку
_.] | ||у;« |
ц, к(гм;рм(; |̂ жно выбрать, w нажми 40ПКУ "Импорт".
Структура поступление налогов и сборов в федеральный
бюджет по видам налогов за январь-сентябрь 2001 года
НДС
462%
Рис. 2.34.
Выбор объекта для вставки
101
Особенности Excel, полезные бухгалтеру
Пуск, и информация будет загружена в окно. При этом в окне появятся кноп-
ки [ф], выделяющие информацию, которую можно импортировать. Чтобы выде-
лить информацию для импорта, нажмите одну из этих кнопок, и она изменится
на Щ. Можно выделять несколько областей в окне. После того, как все области
в окне выделены, нажмите кнопку Импорт. Окно будет закрыто, и информация
из Интернета будет импортирована в таблицу.
2.5. Использование сводных таблиц
Очень полезным средством анализа и обработки данных являются сводные
таблицы. С помощью сводных таблиц можно быстро и без труда обобщать боль-
шие объемы данных, в том числе и расположенные на разных листах рабочей
книги. В результате громоздкие списки могут быть представлены в удобном ви-
де. Отчеты сводных таблиц допускают различные варианты форматирования,
сортировки, группирования данных и так далее. Исходной информацией для
сводных таблиц могут быть не только списки Excel, но и внешние базы данных.
2.5.1. Создание сводных таблиц
Чтобы создать сводную таблицу, выберите команду меню Данные Х£> Сводная
таблица. Будет открыт первый диалог мастера создания сводных таблиц и диа-
грамм (Рис. 2.35).
В данном диалоге нужно выбрать, что является источником данных для со-
здания сводной таблицы. Установив переключатель в положение В списке или ба-
зе данных, вы говорите программе, что сводная таблица будет построена на осно-
ве списка. Установив переключатель в положение Из внешнего источника данных,
вы выберете создание сводной таблицы
из импортируемых данных. Если пе-
реключатель установлен в положение
В нескольких диапазонах консолидации,
вы создадите сводную таблицу на осно-
ве нескольких диапазонов рабочего ли-
ста или списков из нескольких листов
рабочей книги. Если вы хотите постро-
ить сводную таблицу на основе другой
сводной таблицы, установите переклю-
чатель в нижнее положение В другой
сводной таблице.
В Excel 2000 и 2002 в этом диалоге
Си деть T«SvTiiiiy н
•"» в списке ил
'- во внешнем источите данных
Г* в нескольких диапазонах консолидации
Г е другой сводной хаблице wn сводной диаграмме
ове данных,
м данных Microsoft EXC»I'
вид создаваема го отчета:
'-• £водная таблица
а (со сводной таблицей}
Рис. 2.35.
Первый диалог мастера есть еще один переключатель для выбо-
102
Использование сводных таблиц
.•/•'•"•: •"::Д!;:«!ёй:«'-'-' ,.' ^ •
т«6яиц и ди!гр«мм - oat 2 и» 3ра вида создаваемого отчета. Можно создать
сводную таблицу или сводную диаграмму. В
Excel 97 можно создавать только сводные
таблицы. Установите переключатель в поло-
жение Сводная таблица и нажмите кнопку
Далее, чтобы продолжить создание сводной
таблицы. Будет открыт второй диалог масте-
ра (Рис. 2.36).
В этом диалоге вам предлагается выделить диапазон ячеек, содержащих ис-
ходные данные для построения сводной таблицы. По умолчанию будет выделена
вся область, занимаемая таблицей, но вы можете указать область, которая вам
необходима. Для этого нажмите кнопку
Рис. 2.36.
Выбор диапазона
в правой части поля ввода Диапазон,
и диалог будет свернут. Выделите ячейки для построения сводной таблицы и на-
жмите кнопку Jcg], чтобы восстановить диалог.
Если вы хотите использовать в качестве данных для сводной таблицы другую
таблицу, нажмите кнопку Обзор, и будет открыт диалог для выбора файла. Укажи-
те в этом диалоге папку и файл, содержащий нужную вам таблицу, и нажмите
кнопку ОК этого диалога. Ссылка на диапазон ячеек нужной вам таблицы по-
явится в поле ввода Диапазон. Нажмите кнопку Далее, чтобы продолжить созда-
ние сводной таблицы.
Если вы создаете сводную таблицу из нескольких листов рабочей книги и вы-
брали в первом диалоге положение переключателя В нескольких диапазонах консо-
лидации, второй диалог мастера будет иметь несколько иной вид (Рис. 2.37, слева).
В данном диалоге нужно установить переключатель, определяющий, как со-
здавать поля сводной таблицы. Верхнее положение переключателя означает со-
здание только одного поля страницы для отчета сводной таблицы. Нижнее поло-
жение переключателя означает назначение диапазонам разных имен.
После установки переключателя нажмите кнопку Далее, чтобы продолжить
работу. Появится следующий диалог мастера для указания диапазонов ячеек на
разных листах рабочей книги (Рис. 2.37, справа). В поле ввода Диапазон, нужно
указать адреса ячеек, образующих сводную таблицу. Нажав кнопку в правой
Сеодяую таблицу можно создать на основе
диапазонов «i одного мм (i?r*mi.u-ux листов.
Каждый диап^и и< и арок
г.то;Лцао: дамггыг г. одмзкоеыпи низаниями
буд/г пра.умпировзны.
Укажете, кик следую к.довагьсгрвничиые по
• затеи нежите кнопку "Далее >".
;'" 'Свз,ь инцы]
С Создать пола страницы
Отмена | < Назад 1 Далее 1 Щ Отмена | < Назад М .Додее > ' I Готовс
Рис. 2.37. Создание сводной таблицы из нескольких листов
103
Особенности Excel, полезные бухгалтеру
Рис. 2.J&
Заключительный диалог мастера
части поля ввода, вы свернете диа-
лог и сможете выделить диапазон
ячеек мышью на любом листе рабо-
чей книги. Чтобы развернуть диалог
мастера после выбора диапазона на-
жмите кнопку |cg|.
После того как диапазон вы-
бран, нажмите кнопку Добавить, и
диапазон будет помещен в список в
нижней части диалога мастера. Так
вы можете добавить в сводную таб-
лицу несколько диапазонов с одного или нескольких листов рабочей книги. Ес-
ли вы хотите удалить диапазон из списка, выберите его в нижней части диалога
и нажмите кнопку Удалить. Если нужно добавить диапазон ячеек из другого ра-
бочего листа, нажмите кнопку Обзор, и в появившемся диалоге выберите файл с
таблицей. После выбора всех диапазонов нажмите кнопку Далее, чтобы продол-
жить создание сводной таблицы.
В Excel 97 будет открыт диалог мастера для настройки макета сводной табли-
цы. Настройку макета мы рассмотрим ниже. В Excel 2000 и 2002 будет открыт за-
ключительный диалог мастера (Рис. 2.38).
В данном диалоге вам предлагается с помощью установки переключателя
Поместить таблицу в указать, где должна быть расположена сводная таблица.
По умолчанию предлагается разместить таблицу на новом листе, но вы можете
установить переключатель в положение Существующий лист и в поле ввода ука-
зать диапазон ячеек, куда помещать сводную таблицу. Можно указать диапазон
вручную, а можно выделить диапазон мышью, предварительно скрыв диалог с
помощью кнопки ;|= в правой части поля ввода.
Нажмите кнопку Макет заключительного диалога мастера, и будет открыт
диалог настройки макета сводной таблицы (Рис. 2.39). Этот же диалог появится
в Excel 97 после выбора диапазона
ячеек для сводной таблицы.
В этом диалоге вам предлагает-
ся задать структуру сводной табли-
цы. В правой части диатога в виде
кнопок располагаются наименова-
ния полей исходной таблицы. Вам
нужно перетащить мышью эти
кнопки в ту или иную область маке-
та. В область Столбец и Строка пе-
ретаскиваются те кнопки, которые
будут заголовками столбцов и строк
сводной таблицы. В область Данные
перемещаются кнопки тех полей,
Рис. 2.39.
Настройка макета сводной таблицы
104
Использование сводных таблиц
Список полей сводной таблицы т
Перетащите элементы э сводную таблицу
16
-rre сю/уд иа;-;^ Q Дебет
НКргдсс
£) Сумма
3 Содержание проводки
Рис. 2.40. Создание макета вручную
которые составят содержимое сводной таблицы. В область Страница можно пе-
ретащить те кнопки, которые не попали в предыдущие области, и с помощЫб
этих кнопок можно будет также управлять структурой сводной таблицы, как бы
перелистывая страницы. После того, как макет сформирован, нажмите кнопку
ОК, чтобы закрыть диалог. В окне программы должна появиться сводная табли-
ца по вашему макету.
Работая в Excel 2000 и 2002 можно создавать макет сводных страниц и вруч-
ную. Для этого нужно не открывать диалог создания макета в заключительном
диалоге мастера. Тогда по окончании работы мастера вместо сводной таблицы на
экране появится ее макет (Рис. 2.40, слева).
Рядом с макетом будет открыт диалог с именами полей исходной таблицы,
на основе которой строится сводная таблица (Рис. 2.40, справа). Выбрав поле в
диалоге, вы можете перетащить его в нужное место макета сводной таблицы с
помощью мыши. Также можно выбрать поле в списке, а затем в открывающемся
списке, расположенном в нижней части диалога, выбрать область, куда следует
поместить поле. В заключение нужно нажать кнопку Поместить в, и выбранное
поле будет помещено в нужную область на макете страницы. После того, как
сводная страница создана, вы можете приступать к анализу данных. Об этом вы
узнаете чуть ниже, а пока рассмотрим, как еще можно структурировать инфор-
мацию в таблицах, чтобы с ней было удобно работать.
2.5.2. Расчет итогов
При работе со списками и сводными таблицами возможен анализ записей на
наличие повторяющихся данных в столбце и подведение промежуточных итогов.
Чтобы данная возможность работала правильно, нужно, чтобы список был от-
сортирован по какому-либо полю.
Создайте любой список и отсортируйте его по какому-либо полю, выделив
поле и нажав кнопку д| на панели инструментов. Затем щелкните мышью на
105
Особенности Excel, полезные бухгалтеру
Рис. 2.41.
Настройка итогов
Промежуточные итоги любой ячейке списка и выберите команду меню Дан-
ные ^> Итоги. Будет открыт диалог настройки вычис-
ления итогов (Рис. 2.41)
Открывающийся список При каждом изменении в
предназначен для выбора поля, по которому будут
подсчитываться итоги. В списке вы можете выбрать
одно из полей вашей таблицы. В открывающемся спи-
ске Операция вы можете выбрать вид вычисляемых
итогов, например, количество значений, среднее, ми-
нимум и так далее. Группа элементов управления До-
бавлять итоги по содержит список всех полей вашей
таблицы. Установив флажок около поля, вы включае-
те вычисление итогов по этому полю, а если флажок
сброшен, итоги по этому полю не вычисляются.
Если установлен флажок Заменить текущие итоги, при вычислении новые
итоги заменят предыдущие итоги. Если флажок сброшен, новые итоги будут до-
бавлены к предыдущим итогам. Если установить флажок Конец страницы между
группами, после вычисления итогов каждая группа итогов будет разделена сим-
волами разрыва страницы. Если установлен флажок Итоги под данными, сначала
выводятся данные, а затем итоги. Если флажок сброшен, сначала выводятся ито-
ги, а затем данные таблицы. Нажав кнопку Убрать все, вы удалите ранее подсчи-
танные итоги. После настройки нажмите кнопку ОК, чтобы закрыть диалог и вы-
числить итоги. При этом внешний вид списка изменится (Рис. 2.42).
При вставке промежуточных итогов программа изменяет разметку списка за
счет группировки однотипных данных и вывода итогов в дополнительные стро-
ки. При вычислении итогов просматриваются столбцы сверху вниз и считаются
записи, удовлетворяющие условиям. Именно поэтому прежде чем вычислить
итоги, необходимо отсортировать список по соответствующему полю.
В левой части списка после вычисления итогов появляются элементы управ-
ления структурой таблицы. О том,
что такое структура, вы узнаете
ниже, а пока отметим, что, нажав
кнопку _%|, вы откроете список
элементов в группе, и кнопка пре-
вратится в JfH. Нажав кнопку j^J,
вы свернете список, и кнопка опять
станет _+], а вместо группы оста-
нется только строка итога. Подоб-
ным образом можно свернуть часть
информации в таблице, а можно
свернуть все, оставив только итоги.
Отметим, что в группы можно
1 Дата Дебет
"25 01.01.01 Количес
26 03 01 01
27 03 01 05
28 0301 01
29 03 01 01
'='•30 03 01 05
31 03.01.01 Количество
Г • ; 32 04 01 01
| - ; 33 . 04 01 01
- 34 04.01.01 Количество
35 05 01 01
36 05 01 01
37 0501 01
38 05 01 01
40 05.01.01 К
41 06 01 01
42": 0601 01
43 06 01 01
44 06.01.01 Количество
45 Общее ко.
С D ' Е ; F G
Деб ее Кредит Кред ее Сумма Содерхан
о 23
1 80 50000 Вклад s ус
1 80 150000 Вклад а ус
1 80 30000 Вклад а ус
4 75.
4 75
1 8
1 8
75
75
1 60
1 60
1 60
о
10
10
10
15000 Поступило
7300 Поступило
5
15000 Введение
7800 Введено в
2
50000 Вклад в ус
150000 Вклад е ус
5000 Поступили
5000 Поступили
15000 Поступили
5
500 Передан м
500 Передам м
7500 Передан м
И
е проводки
тавной фонд
тэемой фонд
тавнои фонд
ОС
ОС
эксплуатация
эксплуатации:
тавнои фонд
тввной фонд
материалы
материалы
материалы
атериап
а те риал
втвривл
Рис. 2.42.
Пример промежуточных итогов вставлять промежуточные итоги
106
Использование сводных таблиц
для более мелких групп. Однако прежде чем вставлять вложенные итоги, нужно
выполнить сортировку по полю, значения которого будут определять необходи-
мость вычисления вложенного итога.
2.5.3. Структуризация и консолидация данных
Для повышения наглядности и читаемости таблиц в программе есть средст-
во, называемое структурой таблицы. Структура позволяет быстро найти в гро-
моздких таблицах интересующие вас данные. Структурирование таблицы - это
изменение степени детализации отображения данных с помощью создания
структуры. Благодаря структуре часть данных можно скрыть, но можно в любой
момент снова вывести на экран.
Для создания структуры вы должны вначале создать какой-либо список.
При структурировании будут использоваться названия полей и записей списка.
Чтобы создать структуру, выберите команду меню Данные Х£> Группа и структу-
ра Х£> Создание структуры. Сразу после этой команды на экране в дополнение к
исходной таблице появятся элементы структуры (Рис. 2.43).
Кнопки уровня детализации предназначены для изменения степени подроб-
ности при выводе списка на экран. Нажав кнопку уровня детализации J для
строк, вы перейдете к сокращенному виду таблицы, в котором отсутствуют запи-
си списка, охваченные символом группы в виде скобки. Если структура постро-
ена по столбцам, то, нажав кнопку уровня детализации J для столбцов, вы
свернете структуру по столбцам. Чтобы развернуть структуру, нужно нажать
кнопку уровня детализации |2[. Сложные структуры могут иметь много уровней
детализации, и вы, нажимая кнопки уровней детализации, можете придавать
списку различный вид.
Уровни детализации Группы
1
,2-
3
4
5
6
у
8
15
| С ; _, D
•Деб cc_J£pea"frr
76
80
90
99
1Г 80
11 80
И 80
1
^=i±3_ F
Кред ее Сумма
50000
150000
; 30000
i
Содержание проводки
Вспомогательная проводка
Вспомогательная проводка
Вспомогательная проводка
Вспомогательная проводка
Вклад в уставной фонд
Вклад в уставной фонд
Вклад в уставной фонд
.Кнопки сворачивания и разворачивания групп
Рис. 2.43. Элементы структуры
107
Особенности Excel, полезные бухгалтеру
Сгруппировать
<• ktpowl
С сгодбцы
Рис. 2.44.
Группировка
Нажимая кнопки уровня детализации, вы сворачиваете или разворачиваете
все группы одного уровня. Если нужно свернуть определенную группу, следует
воспользоваться кнопками на конце скобки выделения соответствующей груп-
пы. Нажав кнопку _-^J, вы свернете группу, и кнопка станет _+_]. Нажав эту кноп-
ку, вы снова развернете группу, и кнопка примет первоначальный вид. Структу-
ра будет отображаться на экране до тех пор, пока вы не удалите ее. Чтобы удалить
структуру выберите команду меню Данные Х£> Группа и структура Х£> Удалить
структуру.
В большинстве случаев программа в состоянии разобраться в созданном ва-
ми списке и предложить конкретный вариант структуры. Однако возможны слу-
чаи, когда вам придется самим создавать нужную вам структуру вручную. Чаще
всего это происходит, если непосредственно над ячейкой с формулой имеется
пустая строка, или слева от такой ячейки расположен пустой столбец. Также руч-
ное создание структуры придется применить, если структура должна охватывать
только часть таблицы, или некоторые формулы рабо-
тают в одних направлениях, а другие — в противопо-
ложных.
Чтобы начать создавать структуру вручную, нуж-
но выделить строки и столбцы, которые будут образо-
вывать группу, то есть могут быть свернуты одновре-
менно, и затем выбрать команду меню Данные т£>
Группа и структура :£> Группировать. Будет открыт
диалог группировки (Рис. 2.44).
Установите переключатель в положение, соответ-
ствующее способу группировки по строкам или по
столбцам и нажмите кнопку ОК, чтобы закрыть диалог группировки. Выделен-
ные вами ячейки будут сгруппированы, и в левой или верхней части списка по-
явятся элементы структуры. Так, группируя разные ячейки списка, вы можете
построить нужную вам структуру. Чтобы удалить часть структуры, выделите
ячейки, образующие группу и затем выберите команду меню Данные э£> Группа и
структура Х£> Разгруппировать.
При создании структуры по умолчанию никакого оформления не происхо-
дит. Вы можете оформить уже созданную структуру или создать новую оформ-
ленную структуру. Выделите ячейки, образующие список, а затем выберите ко-
манду меню Данные з̂ > Группа и структура Х£>
Настройка. Будет открыт диалог настройки
(Рис. 2.45).
В этом диалоге нужно с помощью флаж-
ков указать программе, где расположены ито-
говые данные, которые следует выделить с по-
мощью форматирования. Если флажки уста-
новлены, считается, что итоги расположены в
строках под данными и в столбцах справа от
Расположение «готовых данных -
Р" итогиврроНахподдвчныни
f итог» в столбце* справа от да:
Совать 11
применить
Рис. 2.45.
Настройка структуры
108
Использование сводных таблиц
данных. Если сбросить флажки, программа будет считать, что итоги расположе-
ны в строках сверху данных и в столбцах слева от данных.
Лучше установить флажок Автоматические стили, чтобы программа само-
стоятельно оформила итоговые данные. Для оформления уже готовой структуры
нажмите кнопку Применить стили. Если нужно создать новую структуру, нажми-
те кнопку Создать. В заключение нажмите кнопку ОК, чтобы закрыть диалог.
Структура будет создана или оформлена.
Если вы не знаете, какие на данном листе есть формулы или как они распо-
ложены, попробуйте структурировать лист автоматически, а если результат не
будет соответствовать желаемому, отмените это действие и выполните структу-
рирование вручную.
Консолидацией называется объединение значений из нескольких диапазо-
нов данных. Например, если нужно просуммировать данные из одной и той же
ячейки на разных листах рабочей книги, следует консолидировать эти ячейки, и
тогда операция суммирования будет происходить автоматически. Кроме сумми-
рования при консолидации можно указать и другие действия.
Консолидировать данные можно несколькими способами. Можно объеди-
нять ячейки с помощью формул, используя в формулах ссылки на ячейки, рас-
положенные на разных листах рабочей книги или в разных книгах. Формулы, со-
держащие ссылки на несколько листов, называются трехмерными формулами.
Напомним, что при использовании в формуле ссылок из разных листов ра-
бочей книги, следует указать имя листа и адрес ячейки через символ «!», напри-
мер, Баланс!А1. Если название листа имеет пробелы, его нужно указывать в ка-
вычках, например «Журнал операций»!А1. Чтобы объединить данные из ячеек с
одинаковым адресом с разных листов, нужно их перечислить перед адресом
ячейки, например, =СУММ(Лист1:Лист5!А1). Если информация в ячейках, уча-
ствующих в формуле, меняется, консолидация автоматически обновляется.
Если все данные всех исходных областей находятся в одной рабочей книге и
размещены в одинаковом порядке (например, данные из нескольких листов со-
зданы на основе одного шаблона), можно использовать консолидацию по распо-
ложению. Перед использованием консолидации по расположению следует убе-
диться, что макеты всех диапазонов совпадают.
Если требуется обобщить набор листов, имеющих одинаковые заголовки
рядов и столбцов, но различную организацию данных, следует использовать
консолидацию по категории. Этот способ позволяет консолидировать данные с
одинаковыми заголовками со всех листов. В этом случае перед консолидацией
нужно убедиться, что имена столбцов или строк, которые требуется объединить,
совпадают с учетом регистра букв. Если строки или столбцы не имеют имен,
присвойте им имена. Для этого выделите диапазон, а затем щелкните мышью
слева от строки формул и введите с помощью клавиатуры имя для выделенного
диапазона.
Консолидированные данные рекомендуется располагать на отдельном листе
рабочей книги. Перейдите на нужный лист, щелкнув мышью на его ярлычке. За-
109
Особенности Excel, полезные бухгалтеру
:| Сеул*
Г~
Использовать в качестве име
I подписи верхней строим
Г" значения левого столбца
Щ2Щ тем Щелкните мышью в левом верхнем углу
области, в которой требуется разместить кон-
солидированные данные. Выберите команду
меню Данные з£> Консолидация. Будет открыт
»*22Ji диалог настройки (Рис. 2.46).
В открывающемся списке Функция нуж-
но выбрать функцию, которая будет исполь-
зоваться при консолидации. Можно выбрать
| Г" Создавать связи с исходными данными [;•-" •-•• '-—•'•-л . • . i Jl
функцию суммирования, произведения, на-
хождения среднего значения, а также ряд
Рис. 2.46. статистических функций.
Настройка консолидации в поле Ссшт нужно перечислить име.
на всех диапазонов для консолидации. Можно ввести имя диапазона с помо-
щью клавиатуры, а можно нажать кнопку Щ в правой части поля ввода, и вы-
брать диапазон с помощью мыши. После выбора, чтобы снова развернуть диа-
лог, нажмите кнопку Qg. Нажмите Добавить, и выбранный вами диапазон по-
явится в Списке диапазонов. Повторите эти действия для всех диапазонов, кото-
рые нужно включить в консолидацию. Если диапазон добавлен ошибочно, вы-
берите его в списке диапазонов в центральной части диалога и нажмите кноп-
ку Удалить.
Группа флажков Использовать в качестве имен устанавливается в зависимо-
сти от выбранного вами способа консолидации. Если консолидация выполня-
ется по положению, все флажки в группе должны быть сброшены. Если консо-
лидация выполняется по категории, в группе нужно установить флажки, соот-
ветствующие расположению подписей в исходных диапазонах. Все имена, не
совпадающие с именами в других исходных областях, в консолидированных
данных будут расположены в отдельных строках или столбцах.
Если таблицу консолидации требуется обновлять автоматически при каждом
изменении данных в каком-либо исходном диапазоне и позже не потребуется
изменять или добавлять диапазоны исходных данных для консолидации, устано-
вите флажок Создавать связи с исходными данными. По окончании настройки
нажмите кнопку ОК, чтобы закрыть диалог. Будет осуществлена консолидация
указанных вами диапазонов с помощью выбранной вами функции.
Отметим, что консолидацию данных можно проводить и при создании свод-
ных таблиц, если в качестве источников данных в первом диалоге мастера созда-
ния сводной таблицы выбрать В нескольких диапазонах консолидации. Данный ме-
тод похож на консолидацию по категории, однако обладает большей гибкостью.
2.5.4. Проведение анализа
Рассмотренные способы структурирования данных в таблице удобно ис-
пользовать для анализа большого объема информации. Например, изменяя вид
110
Использование сводных таблиц
таблицы, вы можете структурировать информацию в
v (Показать все)
таблице определенным образом, и у вас будет возмож-
ность лучше проанализировать ее. *8шо
Можно изменить состав элементов каждого поля
•Й! 20
-и 26
•43*0
и 41
ОК Отмена
сводной таблицы. Для этого нажмите кнопку \ ̂ ' в пра-
вой части нужного поля таблицы. Будет открыт диалог
со списком элементов данного поля (Рис. 2.47).
Например, если вы построили сводную таблицу на
основе журнала хозяйственных операций, вы можете в
качестве поля выбрать номер счета. По умолчанию ото- puc ^ 47
бражаются все элементы поля. Если сбросить флажок Список элементов
Показать все, можно выбрать те элементы, которые поля
нужны для анализа. Например, вы можете проследить
все операции по выбранному вами счету. После выбора элементов нажмите
кнопку ОК, чтобы закрыть диалог. Вид сводной таблицы изменится, и вы увиди-
те информацию только по выбранным вами элементам поля.
Отметим, что после создания сводной таблицы, на экране появляется па-
нель инструментов Сводные таблицы. Если этой панели на экране нет, выбери-
те команду меню Вид т£> Панели инструментов Х£> Сводные таблицы. Можно
изменить макет сводной таблицы, если это необходимо. Если вы работаете в
Excel 97 или Excel 2000, щелкните мышью на каком-либо поле таблицы. В пане-
ли инструментов Сводные таблицы ниже кнопок появится список всех полей.
Чтобы добавить новое поле в сводную таблицу, перетащите название поля из
списка на панели инструментов в нужную часть таблицы. Если вы работаете в
Excel 2002, то чтобы добавить поле в сводную таблицу, нажмите кнопку 11 на
панели инструментов Сводные таблицы. Будет открыт диалог со списком полей
(Рис. 2.40, справа). Выбрав поле в диалоге, перетащите его с помощью мыши в
нужное место таблицы.
Иногда наглядность представления информации можно повысить, переме-
щая поля сводной таблицы. Чтобы переместить любое поле, подведите к нему
указатель мыши, и он изменит форму на -*|*. Перетащите поле с помощью мы-
ши в нужное место таблицы, и, когда вы отпустите клавишу мыши, поле окажет-
ся на новом месте. Чтобы исключить поле из анализа, нужно подвести указатель
мыши к заголовку этого поля и перетащить его с помощью мыши за пределы
сводной таблицы.
Для каждого элемента поля строк или поля столбцов сводной таблицы мож-
но вывести на экран более подробные данные. Если выделить ячейку в области
данных сводной таблицы и нажать кнопку Q! на панели инструментов, будет
создан еще один лист Excel, в который будут помещены данные, скрываемые под
выбранным элементом сводной таблицы. Если щелкнуть на каком-либо поле
таблицы, в сводной таблице появятся дополнительные строки и столбцы, содер-
жащие дополнительную информацию об элементах ̂ выбранного поля. Чтобы
убрать дополнительные сведения, нажмите кнопку DJ.
I l l
Особенности Excel, полезные бухгалтеру
Рис. 2.48.
Настройка вычисляемого поля
Иногда бывает нужно, чтобы области
полей строк, столбцов и страниц сводной
таблицы были обведены сплошной синей
линией. Чтобы эти границы были видны,
нажмите кнопку || на панели инструмен-
тов. Повторное нажатие этой кнопки уби-
рает границы полей сводной таблицы.
При подведении итогов в сводной таб-
лице может быть использована функция
отличная от той, которая применялась при
построении исходной таблицы. Для задания новой функции щелкните мышью
на вычисляемом поле сводной таблицы и нажмите кнопку ̂ |д на панели инстру-
ментов. Будет открыт диалог настройки (Рис. 2.48).
В поле Имя можно задать новое имя для выбранного поля, при этом имя по-
ля в исходных данных не изменяется. Переключатель Итоги определяет вычис-
ление промежуточных итогов по выбранному полю. Если нужно вычисление
итогов по каждому элементу выбранного поля внешней строки или столбца, ус-
тановите переключатель в положение Автоматические. Чтобы итоги подводи-
лись по каждому элементу выбранного поля внутренней строки или столбца, вы-
берите параметр Другие, и укажите нужную операцию в списке. Положение Нет
выбирается, если не нужно показывать итоговые значения для выделенного по-
ля сводной таблицы. Флажок Отображать пустые элементы следует установить
в том случае, когда на экране должны отображаться элементы полей строк,
столбцов и страниц, в которых не содержатся данные.
Нажав кнопку Дополнительно, вы откроете диалог настройки дополнительных
параметров. В этом диалоге можно указать параметры сортировки выбранного по-
ля сводной таблицы. Если нажать кнопку Макет, вы откроете диалог, в котором
нужно выбрать, как располагать поля сводной таблицы. Можно выбрать отобра-
жение в виде таблицы или в виде структуры. Нажав кнопку Число, вы откроете ди-
алог настройки формата чисел. В
этом диалоге нужно зтсазать, ка-
кой формат применять к числам в
выбранном поле сводной табли-
цы. После настройки параметров
нажмите кнопку ОК, чтобы за-
крыть диалог. Область данных
сводной таблицы будет заполне-
на новыми итогами.
Отметим, что для получения
обобщенных итогов вы можете в
сводной таблице применить
группировку данных по некото-
рым элементам полей. О группи-
Рис. 2.49.
Выбор варианта оформления
112
Использование сводных таблиц
ровке данных рассказано выше. Если вы работаете в Excel 2000 или 2002, вы мо-
жете изменить внешний вид сводной таблицы, выбрав один из предлагаемых
форматов оформления. Нажмите кнопку у^ на панели инструментов Сводные
таблицы, и будет открыт диалог выбора формата (Рис. 2.49).
В этом диалоге представлено несколько вариантов оформления сводных
таблиц, которые вы можете использовать по своему усмотрению. Чтобы выбрать
вариант оформления, щелкните на нем мышью, а потом нажмите кнопку ОК.
Диалог будет закрыт, а оформление сводной таблицы изменится.
Обычно при создании сводных таблиц подходят параметры, принятые по
умолчанию. Но вы можете изменить параметры сводной таблицы в процессе
анализа информации в ней. Для этого в панели инструментов Сводные таблицы
нажмите кнопку Сводная таблица. Будет открыто вспомогательное меню, в кото-
ром выберите команду Параметры таблицы. Появится диалог настройки пара-
метров сводной таблицы (Рис. 2.50).
В поле ввода Имя можно изменить предлагаемое программой имя сводной
таблицы. Группа элементов управления Формат определяет параметры форма-
тирования сводной таблицы. Если установлен флажок Общая сумма по столбцам,
в отчете сводной таблицы будут показаны суммы по столбцам данных. Если ус-
тановлен флажок Общая сумма по строкам, в отчет сводной таблицы также будут
включены суммы по строкам данных. Для отображения в сводной таблице ито-
гов расчетов необходимо установить эти флажки в зависимости от того, какие
итоги вы желаете видеть в отчете.
Если установлен флажок Автоформат, к таблице будет применено формати-
рование, используемое программой по умолчанию. Если вы хотите, чтобы про-
грамма сама подбирала формат создаваемой сводной таблицы, установите этот
флажок. Если установлен флажок Включать скрытые значения, в итоги отчета
сводной таблицы попадут неотобра-
жаемые элементы полей страниц. Ес-
ли вы хотите, чтобы значения скры-
тых ячеек учитывались при подсчете
итогов, установите этот флажок.
Если установлен флажок Объеди-
нять ячейки заголовков, будет произ-
ведено объединение ячеек всех под-
писей внешних строк и столбцов в от-
чете сводной таблицы. Установив
флажок Сохранять форматирование,
вы скажете программе, что при изме-
нении структуры отчета или самого
отчета форматирование данных отче-
та менять не нужно. Если установлен pUCf 2.50.
флажок Повторять подписи на каждой Настройка параметров
странице, подписи элементов будут сводной таблицы
(сеодиаяТвблица!
Формат
{i? общая сумма
!*• общая сумма
1~ включать скрытые значения
Г" объединять ячейки заголовков
!*•' совранлть форматирование
Р повторять подписи на каждой
Данные; —--
источник;
i-' сохранить данные вместе с
Г-*' развертывание разрешено
! обновить при открытии
макет страницы:
число полей в столбце:
, |~ для ощнбоя отображать:
'•' для пусщх. ячеек отображать;
Г" печать заголовков
F ••-• ! т I " -
м поперек — 1
вданные;
113
Особенности Excel, полезные бухгалтеру
повторяться для всех полей строк, расположенных слева от поля, где разрыв
страницы отделяет группу элементов. Чтобы при выводе на печать подписи эле-
ментов не повторялись, этот флажок следует сбросить.
В списке Макет страницы можно выбрать порядок отображения полей
страниц. Вариант Вниз, затем поперек, установленный по умолчанию, можно
заменить на вариант Поперек, затем вниз. В поле ввода Число полей в столбце
можно указать, сколько полей в столбце или строке должны располагаться пе-
ред началом новой строки или столбца. Если вы желаете, чтобы ошибки или от-
сутствующие данные в ячейках отображались определенными символами, вве-
дите эти символы в поля Для ошибок отображать и Для пустых ячеек отобра-
жать, предварительно установив соответствующие флажки. Если установлен
флажок Печать заголовков, подписи полей и элементов отчета сводной таблицы
будут использованы в качестве заголовков строк и столбцов при печати сводной
таблицы.
Если в сводной таблице есть импортированные внешние данные, наст-
ройки параметров этих данных осуществляются в группе элементов управле-
ния Данные. Флажок Сохранять данные вместе с таблицей устанавливается по
умолчанию и означает одновременное копирование внешних данных вместе с
таблицей. Если вы установите флажок Развертывание разрешено, при двойном
щелчке в- области данных сводной таблицы будут развертываться подробные
данные. Установленный флажок Обновить при открытии означает, что данные
сводной таблицы будут обновляться при открытии, если были внесены изме-
нения в исходный список. Установив флажок Обновлять каждые, вы можете
указать в поле ввода интервал автоматического обновления данных в сводной
таблице.
Если в качестве источника данных для отчета сводной таблицы или сводной
диаграммы используется внешняя база данных, которая запрашивает пароль,
можно сохранить пароль как часть отчета с помощью установки флажка Сохра-
нить пароль. Чтобы работать с отчетом можно было только после окончательной
загрузки указанных в запросе внешних данных, нужно сбросить флажок Фоно-
вый запрос. Если флажок установлен, запрос будет выполняться в фоновом режи-
ме, а вы можете продолжать работать с таблицей. В заключение, после настрой-
ки параметров нажмите кнопку ОК, чтобы закрыть диалог параметров сводной
таблицы.
2.6. Выполнение анализа «что, если»
Процесс изменения значений ячеек и анализа влияния этих изменений на
результат вычисления формул на листе называется в программе Excel анализом
«что, если». Для данного вида анализа применяется процедура подбора парамет-
ров, а также процедура поиска решения.
114
Выполнение анализа «что, если»
Установить в дчейке:
Значение;
Изменяя значение ячейки
,. . If ™оГ™
Рис. 2.51.
Настройка подбора
параметра
2.6.1. Подбор параметра
Процедура подбора параметра применяется, если известен желаемый ре-
зультат формулы, но неизвестны значения, которые требуется ввести для получе-
ния этого результата. Методом перебора воспользоваться можно, но это очень
утомительно. При подборе параметра программа автоматически изменяет значе-
ние в ячейке до тех пор, пока формула, зависимая от этой ячейки, не возвраща-
ет нужный результат.
Примером подбора параметров может служить такая задача. Какова должна
быть прибыль, чтобы налог получился равным заданной величине. Чтобы вы-
полнить задачу подбора параметров, выберите ко-
манду меню Сервис з£> Подбор параметра. Появит-
ся диалог настройки подбора (Рис. 2.51).
В поле ввода Установить в ячейке указывается
адрес ячейки, в которой находится формула, пара-
метры которой мы будем подбирать. Вы можете
ввести адрес с помощью клавиатуры, а можете
свернуть диалог и выбрать ячейку с помощью мы-
ши. Поле Значение предназначено для указания
числового результата, который мы хотим полу-
чить, подбирая параметры в формуле. Последнее
поле Изменяя значение ячейки задает адрес ячейки,
изменяя значение которой, мы будем стремиться получить нужный результат.
Это поле также содержит кнопку для свертывания диалога, и вы можете указать
ячейку не только с помощью клавиатуры, но и выбрав ее мышью. После завер-
шения ввода параметров следует нажать кнопку ОК, чтобы закрыть диалог и на-
чать подбор.
Скорость завершения этой операции будет зависеть от мощности вашего
компьютера и сложности формулы, в которой вы подбираете параметры. Под-
бор сопровождается появлением соответствующего диалога, в котором отобра-
жается текущее значение параметра, а также количество шагов подбора, кото-
рое уже сделано. По окончании подбора в диалоге появится результат операции
(Рис. 2.52).
Если вы хотите приостановить подбор параметров, нажмите кнопку Пауза.
При этом становится возможным выполнение
подбора в пошаговом режиме. Нажимая кнопку
Шаг, вы выполняете следующую итерацию. Но-
мер итерации, текущее значение параметра и те-
кущий результат отображаются в диалоге.
Отметим, что в Excel реализован только под-
бор по одному параметру, и если ваша формула
содержит несколько параметров, то вам придет-
ся производить подбор по каждому из них.
подбор параметра дли ячейки В5.
Подбираемое знамение: 12000
Текущее значение: 12000
Рис. 2.52.
Результат подбора
параметров
115
Особенности Excel, полезные бухгалтеру
2.6.2. Поиск решения
Процедура поиска решения позволяет найти оптимальное значение фор-
мулы, содержащейся в ячейке, которая называется целевой. При этом, чтобы
получить нужный результат, происходят изменения в группе ячеек, прямо или
косвенно связанных с формулой в целевой ячейке. Такие ячейки называются
влияющими ячейками. Процедура одновременного изменения значений в не-
скольких влияющих ячейках достаточно трудоемкая, и, чтобы сузить множест-
во значений, используемых при поиске решения, накладываются ограничения.
Эти ограничения могут ссылаться на другие влияющие ячейки.
Чтобы использовать процедуру поиска решения, программа должна быть
соответствующим образом настроена. Для настройки выберите команду меню
Сервис :£> Надстройки. Будет открыт диалог выбора дополнительных пакетов
программы Excel. В этом списке нужно установить флажок у элемента Поиск ре-
шения. Если этот флажок уже установлен, ничего делать не нужно. Нажмите
кнопку ОК, чтобы закрыть диалог. После этого лучше завершить работу в про-
грамме, сохранив результаты работы, а затем снова запустить программу и за-
грузить рабочую книгу для дальнейшей работы.
Чтобы начать поиск решения, выберите команду меню Сервис Х£> Поиск ре-
шения. Будет открыт диалог настройки параметров поиска (Рис. 2.53). Поле вво-
да Установить целевую ячейку используется для указания целевой ячейки, реше-
ние в которой нужно найти. Нажав кнопку Щ] в правой части поля ввода, вы
свернете диалог и сможете выбрать нужную ячейку с помощью мыши. Затем на-
жмите кнопку [с Л в правой части свернутого диалога, чтобы развернуть его. Пе-
реключатель Равной определяет цель поиска. Можно выбрать максимальное зна-
чение, минимальное значение или конкретное значение, которое указывается в
поле ввода справа от положения переключателя.
Поле ввода Изменяя ячейки служит для указания ячеек, значения которых
изменяются в процессе поиска решения до тех пор, пока не будут выполнены на-
ложенные ограничения и условие оптимизации значения ячейки, указанной в
поле Установить целевую ячейку. Можно ввести ячейки с помощью клавиатуры
или свернуть диалог и выбрать ячейки с
помощью мыши. Также можно нажать
кнопку Предположить, и программа са-
ма попробует найти ячейки, влияющие
на формулу.
Список Ограничения служит для
отображения граничных условий по-
ставленной задачи. Нажав кнопку До-
бавить, вы откроете диалог добавления
Рис. 2.53. ограничения (Рис. 2.54). Поле ввода
Настройка параметров Ссылка на ячейку используется для ука-
поискарешения зания ячейки или диапазона, на значе-
116
Выполнение анализа «что, если»
Рис. 2.54.
Добавление ограничения
ния которых необходимо наложить ограниче-
ние. Поле ввода Ограничение служит для зада-
ния условия, которое накладывается на значе-
ния ячейки или диапазона, указанного в поле
Ссылка на ячейку. Между полями расположен
открывающийся список для выбора вида огра-
ничения. Нажав кнопку Добавить, вы добавите
ограничение. При этом диалог не будет закрыт,
и вы можете добавлять другие ограничения. Чтобы закрыть диалог, нажмите
кнопку (Ж и вы вернетесь к диалогу настройки параметров.
Выбрав ограничение в списке и нажав кнопку Изменить, вы снова откроете
диалог добавления ограничения с уже заполненными полями. Измените значе-
ния в полях ввода и открывающемся списке и нажмите кнопку ОК, чтобы за-
крыть диалог. Если нужно удалить ограничение из списка, выберите его, а затем
нажмите кнопку Удалить.
Нажав кнопку Восстановить, вы очистите поля ввода и список ограниче-
ний, а также восстановите значения параметров поиска решения, используемые
по умолчанию. Если нужно уточнить параметры поиска решения, нажмите
кнопку Параметры. Будет открыт диалог дополнительной настройки (Рис. 2.55).
Поле ввода Максимальное время используется для ограничения времени, от-
пускаемого на поиск решения задачи. В поле можно ввести время в секундах. Ес-
ли при поиске решения это время превышено, поиск будет остановлен. Поле
ввода Предельное число итераций служит для ограничения числа промежуточных
вычислений. Поле ввода Относительная погрешность определяет точность, с ко-
торой определяется соответствие ячейки целевому значению. Поле должно со-
держать десятичную дробь от нуля до единицы. Чем больше десятичных знаков
в задаваемом числе, тем выше точность. Поле ввода Допустимое отклонение ис-
пользуется для задания допуска на отклонение от оптимального решения. При
указании большего допуска поиск решения заканчивается быстрее. Поле ввода
Сходимость используется для определения условия окончания поиска. Если от-
носительное изменение значения в целевой ячейке за последние пять итераций
становится меньше числа, указанного в
этом поле, поиск прекращается.
Если установлен флажок Линейная мо-
дель, для поиска используется линейная мо-
дель, что в некоторых случаях может увели-
чить скорость поиска. Если установлен фла-
жок Показывать результаты итераций, по-
иск идет в пошаговом режиме. Флажок Ав-
томатическое масштабирование служит для
включения автоматической нормализации
параметров поиска решения, например, ес-
ли цель решения — определение прибыли в
Максимальное 8ремв:
Предельное число итераций;
Относительная погрешность:
Дцпустимое отклонение:
Сходимость: : (0,0001
Г" Пинвйнвя модель Г* Автоиэтическое ивсштвбирование
Г Неетршательчие значения Г~ Показывать еезультаты итераций
• Оценки - . . Разности . • Метод поиска' • - • - - • • -
<* линейная . . ft прямые • !• Ньютона
С квадратичная : • С центральные ; Г сопряженных градиентов
Рис. 2.55.
Дополнительные настройки
117
Особенности Excel, полезные бухгалтеру
процентах, а параметры исчисляются в руб-
лях, нужна нормализация. Установив фла-
жок Значения не отрицательны, вы ограни-
чите значения влияющих ячеек положитель-
ными величинами.
Группа переключателей в нижней части
Рис. 2.56. диалога служит для настройки таких параме-
Результат поиска решения тров оптимизации, как экстраполяция зна-
чений, а также метода поиска. Нажав кнопку
Сохранить модель, вы откроете диалог сохранения, в котором можно задать ссыл-
ку на область ячеек, предназначенную для хранения модели оптимизации.
После настроек дополнительных параметров нажмите кнопку ОК, чтобы за-
крыть диалог и вернуться к диалогу настройки параметров поиска решения. Что-
бы начать поиск, нажмите кнопку Выполнить. Диалог настройки параметров бу-
дет закрыт, и начнется процесс поиска решения. При этом в строке состояния
программы будет отображаться вспомогательная информация о ходе поиска: те-
кущий шаг, а также значения целевой функции и влияющих ячеек. Чтобы до-
срочно прервать поиск решения, можно нажать клавишу Д. По окончании по-
иска или по истечении ограничений на время и количество шагов появится диа-
лог с результатами (Рис. 2.56).
Установив переключатель в этом диалоге в положение Сохранить найденное
решение, вы сохраните решение во влияющих ячейках модели. Если переключа-
тель установлен в положение Восстановить исходные значения, во влияющих
ячейках останутся исходные значения параметров. Программа может показать
вам ход поиска решения. Для этого используются отчеты, формируемые на от-
дельных листах рабочей книги. В списке Тип отчета вы можете выбрать, какой
отчет нужно сформировать. Отчет Результаты состоит из целевой ячейки и спи-
ска влияющих ячеек модели, их исходных и конечных значений, а также формул
ограничений и дополнительных сведений о наложенных ограничениях. Отчет
Устойчивость содержит сведения о чувствительности решения к малым измене-
ниям в формуле. Отчет Пределы состоит из целевой ячейки и списка влияющих
ячеек модели, их значений, а также нижних и верхних границ. Нажав кнопку ОК,
вы закроете диалог результатов поиска решения, и если вы указали формирова-
ние отчета, он будет сформирован на отдельном листе.
2.6.3. Использование сценариев
Excel позволяет работать с несколькими наборами данных для одних и тех же
ячеек. Это нужно, например, для прогноза развития событий при разных исход-
ных данных. Данная операция реализуется с помощью сценариев. Вы можете со-
здать и сохранить на листе различные группы значений ячеек в сценариях, а затем
переключаться на любой из этих сценариев для просмотра различных результатов.
118
Выполнение анализа «что, если»
Рис. 2.57.
Работа со сценариями
Вначале создайте таблицу, ко-
торая будет использована для ана-
лиза или прогноза. Введите в
ячейки формулы и другую инфор-
мацию. Затем выберите команду
меню Сервис :£> Сценарии. Будет
открыт диалог диспетчера сцена-
риев (Рис. 2.57, слева).
В левой части диалога распо-
лагается список созданных сцена-
риев. Для каждого из сценариев в
списке в поле Изменяемые ячейки
можно посмотреть, какие ячейки охвачены сценарием. Чтобы добавить новый
сценарий, нажмите кнопку Добавить, и будет открыт диалог добавления сцена-
рия (Рис. 2.57, справа).
В поле ввода Название сценария, вы должны ввести имя для сценария, кото-
рое будет отображаться в списке сценариев. В поле ввода Изменяемые ячейки,
нужно указать адреса ячеек в таблице, которые будут участвовать в сценарии.
Можно указать отдельные ячейки, перечислив их адреса через запятую, а можно
указать диапазон ячеек, как с помощью клавиатуры, так и выделив ячейки мы-
шью в таблице. В поле Примечание можно добавить комментарий к создаваемо-
му сценарию. Заполнение этого поля не обязательно. Для защиты сценария от
изменений установите флажок Запретить изменения. Если нужно вносить в сце-
нарий изменения, флажок нужно сбросить. Нажмите кнопку ОК, чтобы создать
новый сценарий. Будет открыт диалог для ввода значений в ячейки (Рис. 2.58,
слева).
В полях ввода данного диалога нужно ввести значения ячеек, используемых
в сценариях. Программа запомнит эти значения и будет автоматически подстав-
лять их в ячейки при выборе данного сценария для работы. Для быстрого созда-
ния другого сценария с теми же ячейками нажмите кнопку Добавить. Будет
открыт диалог добавления сценария, в котором адреса ячеек будут теми же самы-
ми. Можно ввести в них другие значения и дать сценарию другое имя.
После ввода информации в ячейки нажмите кнопку ОК, чтобы закрыть диалог
BBOJ» и вернуться к диспетчеру сценариев. Если вы создали несколько сценариев
для разных ячеек на одном листе,
можно объединить их в один сце-
нарий. Для этого нажмите кнопку
Объединить. Если для одних и тех
же ячеек создано несколько сце-
нариев, вы можете выбирать, ка-
кой сценарий использовать.
Выбрав сценарий из списка
и нажав кнопку Вывести, вы по-
Рис. 2.58.
Ввод значения и отчеты
119
Особенности Excel, полезные бухгалтеру
мещаете в ячейки значения, запомненные в сценарии. Нажмите кнопку За-
крыть, чтобы закрыть диалог диспетчера, и вы можете проводить анализ с дан-
ными в таблице. Если нужно рассмотреть другой вариант, откройте диспетчер
сценариев, выберите другой сценарий из списка и нажмите кнопку Вывести. За-
крыв диспетчер, вы можете работать с новыми данными.
Excel может строить отчеты по использованию сценариев. Нажмите в дис-
петчере сценариев кнопку Отчет, и будет открыт диалог настройки (Рис. 2.58,
справа). С помощью переключателя вы можете выбрать тип отчета: структуру
или сводную таблицу. Нажмите кнопку ОК, будет создан новый лист рабочей
книги и в него будет помещен созданный отчет. Анализируя результаты отчета,
вы можете сделать выводы и принять нужное решение.
2.7. Работа с формами
Формы представляют собой набор элементов управления, предназначенный
для облегчения ввода информации в различные списки. Кроме того, с помощью
форм можно искать информацию в списках, обновлять данные и удалять строки
из списков.
2.7.7. Использование мастера шаблонов
Можно создать форму для работы со списком автоматически. Для этого нуж-
но начать создавать список, введя хотя бы названия полей. В этом случае про-
грамма сама определит структуру базы данных, которую будет представлять спи-
сок, и построит форму для работы. Однако можно создать форму и вручную,
используя мастер шаблонов.
Работу с автоматически созданными формами мы рассмотрим ниже, а сей-
час рассмотрим создание формы с помощью мастера. Отметим, что мастер шаб-
лонов по умолчанию есть только в Excel 97 и 2000, а для Excel 2002 мастер шаб-
лонов необходимо загрузить из Интернета и установить дополнительно.
Если у вас Excel 2002, то для установки мастера шаблонов подключитесь к
Интернету и откройте страницу по адресу http://office.microsoft.com/rus/Downloads
/2002/tmplwiz.aspx. Следуя инструкциям на этой странице, перепишите програм-
му установки на ваш компьютер. Затем завершите работу программы Excel, если
она была запущена, и запустите программу установки, которую вы переписали из
Интернета. По окончании работы программы мастер будет установлен.
Теперь, работая в любой версии программы, выберите команду меню Сервис
:£> Надстройки. Будет открыт диалог выбора дополнительных пакетов програм-
мы Excel. В этом списке нужно установить флажок у элемента Мастер шаблонов
и нажать кнопку ОК, чтобы закрыть диалог.
120
Работа с формами
_'. .' -.•'•«и
На основе имеющегося документа с п
мастера шаблонов легко создать шаблон
документа и $аэу данных, при сел'м-г
•Ч. указываются ячейки, которые станут палями
\базы данных
Каждый раз, когда на основе шаблона
будет создаваться документ с аовыми
даииыки, оми будут занесены а базу
Укажете имя шаблона: ;
J С: ̂ Documents afio^settlngs\Ceprefi\A
| готово I
Рис. 2.59.
Первый диалог мастера шаблонов
;| Укажите формат базы данных, в которую следует помещать записи.
] Книга Microsoft Excel Т]
Чтобы создать шаблон с помощью
мастера, сначала создайте таблицу, со-
держащую список. Эта таблица будет
использована в качестве образца при
создании шаблона. Затем выберите ко-
манду меню Данные Х£> Мастер шабло-
нов, и будет открыт первый диалог мас-
тера (Рис. 2.59).
В верхнем поле ввода этого диало-
га нужно указать имя книги, которая
является образцом. Это может быть од-
на из книг, с которыми вы сейчас рабо-
таете. Выбранная книга будет исполь-
зована для автоматического создания шаблона. При этом сама книга не изменя-
ется. Поле ввода Укажите имя шаблона предназначено для указания пути и име-
ни файла, в котором будет располагаться создаваемый шаблон. Лучше не менять
информацию, которая предлагается программой в этом поле ввода. Нажмите
кнопку Далее, чтобы продолжить создание
шаблона. Появится следующий диалог ма-
стера (Рис. 2.60).
Данные, которые вводятся в книгу, со-
зданную на основе шаблона, автоматически
копируются в базу данных, формат и поло-
жение которой определяются в этом диало-
ге. Программа может создавать различные
базы данных, но мы рассмотрим только со-
здание книги Excel. Поэтому в верхнем от-
крывающемся списке выберите элемент Книга Microsoft Excel. В поле ввода Вве-
дите имя и местоположение базы данных указывается имя файла, в котором будет
создана база данных на основе шаблона. По умолчанию используется та же рабо-
чая книга, где располагается образец шаблона. После выбора базы данных на-
жмите кнопку Далее, чтобы продолжить созда-
ние шаблона. Будет открыт третий диалог мас-
тера (Рис. 2.61).
В этом диалоге нужно установить соответ-
ствие между полями базы данных и ячейками
листа, из которых следует копировать данные.
В поле ввода Лист нужно указать название ли-
ста книги, для которого устанавливается соот-
ветствие с ячейками шаблона. При создании
новой базы данных можно ввести произволь-
ное имя. В поле Код содержатся номера полей,
в которые будут копироваться данные из ука-
[слой ы\Книга1 - дайн
Рис. 2.60.
Выбор базы данных
Укажите каждую ячейку, зад
Лист; J Таблица!
| "Код "Г" Ячейка
. Г""| "ЗГ
1
Рис. 2.61.
Определение полей шаблона
121
Особенности Excel, полезные бухгалтеру
других «wrMicresoftacel, . .
L < B I
1НЫ.
в базу донных
данные нз других книг
Г Л& включить
!•' пег, пг/опусгить этот шаг
Рис. 2.62.
Данные из других книг
занных ячеек. Вы не можете изменить со-
держимое этого поля. В поле ввода Ячейка
указывается адрес ячейки, из которой будут
копироваться данные. В поле Имя поля ука-
зывается имя поля базы данных для связи с
ячейкой. Вы должны указать соответствие
всех полей и ячеек списка, которые должны
быть включены в шаблон. Укажите соответ-
ствие и нажмите кнопку Далее, чтобы про-
должить работу и открыть следующий диа-
лог мастера (Рис. 2.62).
Если есть таблицы, структура которых сходна со структурой создаваемого
шаблона, можно собрать данные в этих книгах и поместить в создаваемую базу
данных. В этом случае установите переключатель в положение Да, включать. Ес-
ли информацию из других книг включать не нужно, установите переключатель в
положение Нет. Затем нажмите кнопку Далее, чтобы открыть заключительный
диалог мастера (Рис. 2.63).
Новый шаблон создан и сохранен в папке для шаблонов. Кроме того, созда-
на и новая рабочая книга на основе этого шаблона. Открыв эту книгу в програм-
ме, вы увидите, что в ней уже созданы поля, и вам остается только вводить ин-
формацию. О том, как это сделать с помощью форм, вы узнаете ниже. На основе
шаблона можно создавать любое количество списков. Чтобы создать документ
на основе шаблона, выберите команду меню Файл з£> Создать. Если вы работа-
ете с Excel 2002, в правой части рабочего окна появится панель задач. Выберите
в ней команду Общие заготовки. Будет открыт диалог выбора заготовок. В преды-
дущих версиях программы этот диалог появится сразу после выбора команды ме-
ню Файл э£> Создать. Выберите созданный вами шаблон, и на его основе будет
создан документ.
Чтобы изменить созданный шаблон, выберите команду меню Файл ^> От-
крыть. Затем в появившемся диалоге укажите тип файла Шаблоны и выбери-
те папку, в которой располагаются
шаблоны, а затем выберите нуж-
ный шаблон. В заключение нажмите
кнопку Открыть, и шаблон будет
загружен в программу Excel. Теперь
выберите команду меню Данные ^>
Мастер шаблонов, чтобы снова запу-
стить мастер. В диалогах данного
мастера измените шаблон, по свое-
му усмотрению и изменения автома-
тически запишутся в шаблон. В за-
ключение закройте шаблон, выбрав
команду меню Файл Х£> Закрыть.
данник м шаблон.
Шаблон: C:\C4KAtments and Settings\CepreflV^plicatiOF
база данных; C:\0ootroents and 5еШгдМС«фгей\мои
Чтобы добавить или удалить ячейки, связанна с полями базы
данных, открой; • \f "Мастер шаблонов" из
Чтобы передать шаблон двугдау ппиь-ом^пю, («жируйте его в
:
]ff выбрать команду 'Создав и
быть аетонатимески
ь перечислелнын в маршруте.
1 -.- сейчас шаблон отправлен по почте we будет. ••
Рис. 2.63.
Заключительный диалог мастера
122
Работа с формами
2.7.2. Работа с формами
Вы можете создать заготовку списка с помощью шаблона или ввести ее
вручную. Вводить данные в список можно просто выбирая ячейки и вводя в них
информацию, но можно для ввода использовать форму данных, которая пред-
ставляет собой диалог для создания и редактирования записей. Щелкните мы-
шью на любой ячейке списка, чтобы выделить его, и затем выберите команду
меню Данные :£> Форма. Чтобы форма была выведена на экран, вы должны
предварительно создать на листе по крайней мере одну запись списка, но лучше
когда на листе имеются как минимум две строки, из которых верхняя строка
представлена названиями полей, а вторая представляет собой первую запись
списка. В этом случае программа будет в состоянии распознать структуру буду-
щей базы данных и выведет диалог формы с содержанием всех записей списка
(Рис. 2.64).
В левой части диалога располагаются поля ввода, соответствующие полям
списка. В правой верхней части диалога отображается номер текущей записи и
общее количество записей в списке. Чтобы добавить запись в список, нажмите
кнопку Добавить, и количество записей в списке увеличится. При этом поля в
форме очистятся, и вы сможете ввести в эти поля новую информацию. Если вы
передумали вводить информацию, нажмите кнопку Вернуть. После этого вы
вернетесь к записи, введенной до последнего нажатия кнопки Добавить.
Для возврата к предыдущему полю, следует нажать кнопку Назад, а для пе-
рехода к следующей записи — нажать кнопку Далее. Когда вы достигнете послед-
ней записи, кнопка Далее станет недоступной. Точно также, когда вы достигнете
первой записи, недоступной станет кнопка Назад. Если нужно удалить запись из
списка, выберите эту запись с помощью кнопок Назад или Далее, а затем нажми-
те кнопку Удалить. Обращаем ваше внимание, что удаленную таким способом
запись списка восстановить будет нельзя.
С помощью формы можно легко искать записи в списках. Когда форма от-
крыта, нажмите кнопку Критерии, после чего вид формы немного изменится. Вве-
дите в поля формы информацию, кото-
рую нужно найти, и нажмите кнопку Да-
лее. Вы перейдете к записи списка, удов-
летворяющей условиям поиска. Нажав
эту кнопку еще раз, вы перейдете к следу-
ющей найденной записи. В поля формы
поиска можно вводить только часть ин-
формации. Если при заполнении формы
поиска вы вводите значения в несколько
полей, то поиск будет проведен по не-
скольким критериям. Завершив работу
над записями списка с помощью формы, рис. 2.64.
закройте диалог, нажав кнопку Закрыть. Форма работы с записями
'
123
Особенности Excel, полезные бухгалтеру
2.8. Работа с рисунками и диаграммами
Наглядность таблиц можно значительно повысить, если использовать в них
различные графические объекты. Кроме того, само представление данных таб-
лицы в виде графиков улучшает восприятие этих данных. Программа Excel рас-
полагает богатым набором возможностей, как для графического представления
данных, так и для работы с иллюстрациями.
2.8.1. Рисунки в таблицах
Программа Excel позволяет вставлять в таблицы различные изображения,
которые хранятся в виде файлов, или могут быть получены с помощью различ-
ных устройств ввода, таких как сканеры или цифровые фотокамеры. Кроме того,
вы можете сами создать рисунки, используя встроенные средства.
Чтобы вставить созданный ранее рисунок в рабочий лист, следует выбрать
команду меню Вставка :£> Рисунок Х£> Из файла. Появится диалог вставки ри-
сунка (Рис. 2.65).
Внешний вид данного диалога может отличаться в различных версиях
Windows. Возможно, в диалоге будет область предварительного просмотра, а мо-
жет, файлы будут представлены в виде уменьшенных изображений. В любом слу-
чае вам следует в этом диалоге выбрать папку с файлами изображений, затем вы-
брать изображение в папке и нажать кнопку Вставить. После этого изображение
будет вставлено в рабочий лист. Место появления рисунка на рабочем листе по-
сле вставки вы не можете проконтролировать, однако изображение не привяза-
но к какой-либо ячейке, и вы можете свободно перемещать его по рабочему ли-
сту и разместить в нужном вам месте.
Когда вы подводите указатель мыши к вставленному рисунку, указатель ме-
няет форму на •«!*. Вы можете перетащить с помощью мыши рисунок в любое
место таблицы. Если вы щелкните мышью на рисунке, он будет выделен, и во-
круг него появится рамка выде-
ления и маркеры (Рис. 2.66).
Когда вы подводите указа-
тель мыши к маркеру, внешний
вид указателя меняется в зависи-
мости от точки, к которой он под-
веден. Для пропорционального
изменения размеров изображе-
ния переместите с помощью мы-
ши один из угловых маркеров.
Для изменения размера изобра-
жения по ширине или высоте пе-
реместите с помощью мыши со-Рис. 2.65. Вставка рисунка
124
Работа с рисунками и диаграммами
2
3
'4
,5
6
10
11'i
.Маркер поворота
.Маркеры размеров
Рис. 2.66.
Изменение размеров и поворот
на панели инструментов.
ответствующий срединный мар-
кер. Подведя указатель мыши к
маркеру поворота, вы можете,
перетаскивая мышью этот мар-
кер, повернуть изображение на
произвольный угол как по часо-
вой стрелке, так и против часовой
стрелки. Если нужно удалить
изображение, просто нажмите
КНОПКУ [[Peletej . ЕСЛИ КаКОб-ЛИбО
действие оказалось неверным, вы
всегда можете его отменить, нажав кнопку
Когда вы выделите изображение, щелкнув на нем мышью, появится па-
нель инструментов настройки изображения (Рис. 2.67). Эту панель можно
также вызвать в любое время, выбрав команду меню Вид Х£> Панели инстру-
ментов. В появившемся списке панелей выберите элемент Настройка изобра-
жения.
С помощью этой панели вы можете менять размеры, количество цветов в
изображении, яркость, контрастность и другие параметры. Нажав кнопку цЦ на
панели инструментов настройки изображения, вы откроете вспомогательное ме-
ню, в котором можно выбрать команду для преобразования цветов. Команда
Авто оставляет цвета исходного изображения, команда Оттенки серого убирает
из изображения цвет, который заменяется оттенками серого цвета. Выбрав ко-
манду Черно-белое, вы делаете изображение черно-белым, а, выбрав команду
Подложка, вы делаете изображение полупрозрачным. Отметим, что программа
запоминает оригинальные цвета изображения, поэтому действия по преобразо-
ванию цвета являются обратимыми. То есть, если вы после преобразования изо-
бражения в черно-белое снова выберете команду Авто, изображение опять ста-
нет цветным.
Чтобы увеличить контрастность изображения, нажимайте кнопку (Jff. Каж-
дый раз, когда вы нажимаете эту кнопку, контрастность увеличивается на один
шаг. Чтобы уменьшить контрастность изображения, следует нажимать кнопку ^ЭД
до тех пор, пока контрастность не достигнет нужной величины. Для изменения
яркости изображения предназначены кнопки ;1ф-| и {ф;4-
Кнопка «|f" на панели инстру-
ментов настройки изображения
предназначена для обрезки. После
обрезки будет отображаться только
часть рисунка. Если вы нажмете эту
кнопку, вокруг изображения по-
явится рамка обрезки. Перемещая с
помощью мыши маркеры, располо-
женные по краям рисунка, вы обре-
Рис. 2.67.
Панель инструментов
настройки изображения
125
Особенности Excel, полезные бухгалтеру
жете изображение до нужных вам размеров. При
этом часть, не попавшая в рамку, не будет видна.
По окончании изменения рамки обрезки еще раз
нажмите кнопку „ft", чтобы вернуться в обычный
режим работы.
Чтобы повернуть изображение влево на
90 градусов, нажмите кнопку J^V Повторное на-
жатие кнопки приведет к тому, что изображение
повернется еще на 90 градусов. Для выбора типа
линии, образующей рамку вокруг рисунка, пред-
назначена кнопка jjjjjjjjj j. Нажав эту кнопку, вы
откроете список доступных вариантов линий об-
рамления. Выберите тип линии в списке, и рису-
нок будет обрамлен в соответствии с вашим выбором. Кнопка ̂  позволяет сде-
изменить разрешение - '••-- • • - •-
• <"*• для интернов и экрана
и» для печати Разрешение: 200
Параметры
Р Окэть рисун)*" • ' • ; • .•
Р ^залить обрезанные области рисунков
Рис. 2.68.
Настройка сжатия
рисунков
лать прозрачным один из цветов рисунка. Нажав эту кнопку и щелкнув мышью
на выбранном цвете в рисунке, вы сделаете все фрагменты рисунка, имеющие
выбранный цвет прозрачными.
Если вы нажмете кнопку Щ на панели настройки изображения, появится
диалог вставки рисунка, рассмотренный выше. Новый рисунок заменит выде-
ленный фрагмент текста, и ваш старый рисунок будет удален. Нажав кнопку *£g] ,
вы сбросите все изменения рисунка, которые вы внесли с помощью описанных
выше инструментов. Рисунок станет таким же, каким он был сразу после встав-
ки в документ.
Работая в программе Excel 2002, вы можете сжать рисунки, чтобы они зани-
мали меньше места в таблице. Нажав кнопку ^й£, вы откроете диалог настройки
сжатия рисунков (Рис. 2.68). Изменив параметры сжатия, вы можете существен-
но уменьшить размер редактируемого документа.
С помощью переключателя Применить в верхней части диалога вы выбира-
ете рисунки, подлежащие сжатию. Можно сжать все рисунки в таблице, или
только выделенные рисунки. Переключатель Изменить разрешение в центре диа-
лога позволяет изменить разрешение рисунков. Чем меньше разрешение, тем
меньше места занимает рисунок, но и качество изображения ухудшается. Если
вы не планируете печатать рисунки, вам не потребуется высокое разрешение, и
лучше установить переключатель в положение Для Интернета и экрана.
Если установить флажок Сжать рисунки, то рисунки будут преобразованы в
один из графических форматов, использующих сжатие информации. При этом
возможна небольшая потеря качества рисунка, но размер его может уменьшить-
ся в десятки раз. Если установлен флажок Удалить обрезанные области, невиди-
мые фрагменты изображения, которые получились в результате обрезки, будут
удалены, и вы не сможете отменить операцию обрезки. Установив нужные пара-
метры, нажмите кнопку ОК, чтобы закрыть диалог сжатия.
Нажав кнопку Ф^ на панели инструментов настройки изображения, вы от-
кроете диалог для более точных настроек изображений. Диалог настройки имеет
126
Работа с рисунками и диаграммами
I Формат рисунке
Рис. 2.69.
Настройка цвета и линий
несколько вкладок. Щелкните мышью на яр-
лычке Цвета и линии, чтобы перейти на соот-
ветствующую вкладку диалога (Рис. 2.69).
Группа элементов управления Заливка
используется для выбора цвета заливки и ти-
па линии обрамления. В открывающемся
списке Цвет вы выбираете цвет заливки.
Нажмите кнопку -jfj, и будет открыт список
цветов для заливки. Элемент Нет заливки
удаляет выбранную ранее заливку, а элемент
Авто устанавливает заливку, принятую в про-
грамме по умолчанию. Ниже расположена
палитра для выбора цвета заливки. Щелкни-
те мышью на нужном цвете в палитре, список
будет закрыт, а выбранный цвет появится в
поле открывающегося списка.
Ниже палитры для выбора цвета располагаются элементы списка для выбора
других цветов, а также настройки способов заливки. Выберите элемент Другие цве-
та, и будет открыт диалог для выбора дополнительных цветов (Рис. 2.70, слева).
В этом диалоге вид палитры для выбора цвета будет другим, и в ней будет
больше цветов. Щелкните мышью на образце нужного цвета, чтобы выбрать его.
Образец цвета появится в поле Новый в нижней части диалога. Там же располо-
жено поле Текущий, так что вы можете сравнивать выбранный и текущий цвет за-
ливки.
В нижней части диалога расположен ползунок Прозрачность. Перемещая
ползунок вправо, вы увеличиваете прозрачность выбранного цвета, а перемещая
ползунок влево — уменьшаете прозрачность. Величина прозрачности отобража-
ется в поле ввода, расположенном правее ползунка. Вы можете ввести в это поле
любое значение прозрачности с
помощью клавиатуры. При этом
ползунок сам переместится в по-
ложение соответствующее вве-
денной вами прозрачности.
Если нужно выбрать цвет
очень точно, воспользуйтесь
другим способом выбора. Щелк-
ните мышью на ярлычке Спектр,
чтобы перейти на другую вклад-
ку диалога (Рис. 2.70, справа).
На этой вкладке можно выбрать
любой цвет из полного спектра
или задать его составляющие
в одной из цветовых моделей.
Рис. 2.70.
Выбор дополнительных цветов
127
Особенности Excel, полезные бухгалтеру
Градиентная J Текстура jj Узор j Рисунок |
1ексгура: ! \
Рис. 2.77. Настройка заливки градиентом и текстурой
Отметим, что данный способ лучше использовать, если вы умеете работать с цве-
том. Выбрав цвет, нажмите кнопку ОКддя закрытия диалога выбора цвета.
Если вы выберете элемент Способы заливки, вы откроете диалог для настрой-
ки параметров заливки. В этом диалоге можно выбрать градиентную заливку, за-
ливку узором, текстурой или рисунком. Щелкните мышью на ярлычке Градиент-
ная, чтобы перейти на одноименную вкладку диалога (Рис. 2.71, слева).
Группа элементов управления Цвета содержит переключатель для выбора
количества цветов заливки, а также списки для выбора цвета. Установив пере-
ключатель в положение Один цвет, вы выбираете заливку выбранным вами цве-
том. С помощью ползунка, расположенного под полем для выбора цвета, вы мо-
жете менять направление заливки. Перемещая ползунок влево, вы создаете за-
ливку от выбранного вами цвета до черного, а, перемещая ползунок вправо, вы
создаете заливку от выбранного вами цвета до белого. Установив переключатель
в положение Два цвета, вы выбираете эти цвета, и заливка будет происходить от
первого цвета до второго. Установив переключатель в положение Заготовка, вы
можете выбрать в открывающемся списке один из готовых вариантов заливки,
предлагаемых программой.
Группа элементов управления Прозрачность с помощью ползунков От и До
задает изменение прозрачности цвета во время заливки. Вы можете выбрать про-
зрачность, перемещая ползунки или вводя ее в полях ввода правее ползунков.
Переключатель Тип штриховки определяет направление заливки. Вы можете вы-
брать горизонтальную, вертикальную, диагональную и другие заливки, устано-
вив переключатель в нужное положение. Поле Варианты содержит несколько
вариантов для каждого из выбранных направлений заливки. Щелкнув мышью на
варианте, вы выберете его. Получающуюся заливку вы можете наблюдать в поле
128
Работа с рисунками и диаграммами
Градиентная : Текстура | Узор Рисунок
Рис. 2.72. Настройка заливки узором и рисунком
Образец. Если установить флажок Вращать заливку вместе с фигурой, при пово-
роте рисунка также изменится направление заливки.
Щелкните мышью на ярлычке Текстура, чтобы перейти на одноименную
вкладку диалога настройки заливки (Рис. 2.71, справа). В этом диалоге распо-
ложены образцы текстур, выбирая которые вы указываете, что следует ис-
пользовать эту текстуру в качестве заливки. Нажав кнопку Другие текстуры,
вы откроете диалог в котором можно указать папку и файл, который будет ис-
пользован в качестве текстуры. Щелкните мышью на ярлычке Узор, чтобы пе-
рейти на соответствующую вкладку диалога настройки заливки (Рис. 2.72,
слева).
В данном диалоге вы можете выбрать образец узора, который будет исполь-
зован в качестве заливки. Как вы видите, все образцы узоров являются черно-бе-
лыми. Если требуется раскрасить узор заливки, то в открывающемся списке
Штриховка нужно выбрать цвет узора, а в списке Фон нужно выбрать цвет фона
для узора. Щелкните мышью на ярлычке Рисунок, чтобы перейти на последнюю
вкладку диалога настройки заливки (Рис. 2.72, справа).
Нажав кнопку Рисунок на данной вкладке, вы откроете диалог, в котором
нужно выбрать папку и файл, содержащий рисунок. После закрытия диалога вы-
бранный рисунок появится в поле просмотра на вкладке. Если размер рисунка,
используемого для заливки, отличается от объекта, к которому применяется за-
ливка, рисунок будет сжат или растянут, чтобы покрыть весь объект заливки. Ес-
ли установить флажок Сохранять пропорции рисунка, изменение размера рисунка
для заливки будет пропорциональным. В заключение нажмите кнопку ОКдиало-
га настройки заливки, чтобы закрыть диалог и вернуться к диалогу настройки
цвета и линии.
129
5-5458
Особенности Excel, полезные бухгалтеру
Рисунок
ропорции
исходного размера
Рис. 2.73.
Настройка размера
Группа элементов управления Линия
предназначена для настройки оформления
линии обрамления. В списке Цвет вы може-
те выбрать цвет для линии. Выбрав элемент
Другие цвета, вы откроете диалог настройки
дополнительных цветов (Рис. 2.70), а, вы-
брав элемент Узорные линии, вы откроете ди-
алог выбора и настройки узора аналогич-
ный рассмотренному выше (Рис 2.72, сле-
ва). В списке Шаблон вы можете выбрать
один из вариантов сплошной или пунктир-
ной линии, а в списке Тип линии вы можете
выбрать различные варианты одинарной или
двойной линии. В списке Размер следует вы-
брать толщину линии в пунктах. Группа эле-
ментов управления Стрелки предназначена
для оформления линий в виде стрелок. В списках Начало и Конец вы выбираете
вид стрелки. После настройки линий и цвета щелкните мышью на ярлычке Раз-
мер, чтобы перейти на соответствующую вкладку (Рис. 2.73).
В группе элементов управления Размер и поворот задаются абсолютные ве-
личины высоты и ширины рисунка, а также угол поворота. Отметим, что вы не
меняете размер самого рисунка, вы меняете его размер в таблице. В полях ввода
Высота и Ширина, нужно ввести требуемые размеры рисунка в сантиметрах, а в
поле ввода Поворот нужно ввести угол поворота в градусах. Отметим, что пово-
рот любых рисунков возможен только в Excel 2002. В предыдущих версиях про-
граммы можно поворачивать рисунки, созданные в самой программе. О созда-
нии таких рисунков вы узнаете ниже.
В группе элементов управления Мас-
штаб можно менять масштаб отображения
рисунка в таблице. Горизонтальный и верти-
кальный масштабы задаются в полях ввода
По ширине и По высоте данной ]руппы эле-
ментов управления. Если установить флажок
Относительно исходного размера, масштаб
вычисляется относительно размера ориги-
нального рисунка, вставленного в документ.
Если убрать флажок, вычисляется масштаб
относительно текущего размера рисунка.
Флажок Сохранить пропорции позволит авто-
матически сохранять соотношение высоты и
ширины рисунка.
В группе Исходный размер вы можете
видеть размер исходного рисунка, а нажав
Рис. 2.74.
Настройка рисунка
130
Работа с рисунками и диаграммами
защите чясга. Для '.эщ!«ь. i.trra е^;>£-риге "команду
а" в меню "Сервис", а затеи команду
ить лист1'- При этом можно установить парень.
Рис. 2.75.
Настройка защиты
кнопку Сброс, вы уберете все изменения
и вернете исходные параметры рисунка.
Щелкните мышью на ярлычке Рисунок, что-
бы перейти на следующую вкладку диалога
(Рис. 2.74)
В группе полей Обрезка задается види-
мая часть рисунка. Если вы проводили об-
резку с помощью соответствующей кнопки
на панели инструментов настройки рисун-
ка, в этих полях будут введены величины об-
резки. Введя значения в поля, вы зададите
поля, которые следует отрезать от рисунка.
Отрицательные значения в полях создают
дополнительные поля в рисунке.
Группа полей Изображение позволяет
выбрать яркость и контрастность рисунка, а
также количество цветов в нем. В списке Цвет вы можете выбрать один из вари-
антов преобразования цветов в изображении. Элементы списка совпадают с ко-
мандами вспомогательного меню, открываемого при нажатии кнопки ||Ц на па-
нели инструментов настройки изображения, рассмотренного выше. Ползунки
Яркость и Контрастность используются для изменения соответствующих пара-
метров изображения. Перемещая ползунок вправо, вы увеличиваете параметр, а
перемещая ползунок влево - уменьшаете параметр изображения.
Нажав кнопку Сброс, вы уберете все изменения и вернете исходные параме-
тры рисунка, а нажав кнопку Сжать, вы откроете диалог настройки сжатия ри-
сунков (Рис. 2.68), рассмотренный выше. Щелкните мышью на ярлычке Защи-
та, чтобы перейти на следующую вкладку диалога настройки (Рис. 2.75).
Данная вкладка содержит только один
флажок, установив который, вы скажете
программе, что данный рисунок следует за-
щищать, если это необходимо. О защите
при работе с программой Excel вы узнаете
ниже, а пока отметим, что, установив защи-
ту листа, вы ограничите возможность его
просмотра и редактирования другими людь-
ми. Защитить можно как таблицу, так и ри-
сунки и другие объекты на листе. Защита
объектов будет действовать, если для объек-
та установлен флажок на этой вкладке
диалога настройки. Щелкните мышью на
ярлычке Свойства, чтобы перейти на соот-
ветствующую вкладку диалога настройки
(Рис. 2.76).
цзетаилинии | Размер \ Рисунок | Защита [Свойство jj веб j
перемещать и изменять объект вместе с якейн
• перемещать, но не изменять размеры
а* перемещать » не сз.-ч'инть размеры.
Р' ёыводить объект н
Рис. 2.76.
Настройка свойств
131
Особенности Excel, полезные бухгалтеру
\ Размер ; Рисунок } 'Защита 1 Свойсп
Обозреватели отображают замсщв!
загружается, ипи если они отсутсп
йкгернеге используют замещающш
Кроме того, завещающий Т'
нарта муха.
Я ПОМОЩИ ЛЮДЯМ С
Рис. 2.77.
Настройка замещения рисунка
На данной вкладке вы можете настро-
ить привязку рисунка или другого объекта к
фону, то есть к таблице. Если установить
переключатель в положение Перемещать и
изменять объект вместе с ячейками, при
модификации таблицы рисунок также бу-
дет меняться. Если переключатель установ-
лен в положение Перемещать, но не менять
размеры, при копировании или перемеще-
нии ячеек таблицы объект также будет пе-
ремещаться. Но при изменении размеров
ячеек, размер вставленного в это место объ-
екта меняться не будет. Если установить пе-
реключатель в нижнее положение, при мо-
дификации таблицы объект не будет ни пе-
ремещаться, ни менять свои размеры.
Если установлен флажок Выводить объект на печать, данный рисунок или
другой объект будет распечатан вместе с таблицей. Если данный флажок сбро-
шен, объект будет только на экране и не будет распечатан вместе с таблицей.
В Excel 2000 и 2002 в диалоге настройки появилась еще одна вкладка, отсутству-
ющая в Excel 97. Щелкните мышью на ярлычке Веб, чтобы перейти на эту вклад-
ку (Рис. 2.77).
Обозреватель Интернета в современных версиях Windows позволяет загру-
жать таблицы Excel для просмотра. Во время загрузки таблицы на месте рисун-
ков появляется замещающий текст. На данной вкладке диалога настройки вы
можете указать в поле ввода Замещающий текст текст, который будет отобра-
жаться в обозревателе на месте рисунка в таблице во время ее загрузки. После на-
стройки параметров рисунка нажмите кнопку ОК, диалог настройки закроется, и
параметры изображения изменятся.
Если к вашему компьютеру подключен сканер или цифровая камера, рабо-
тая в Excel 2000 или 2002, кроме вставки рисунка из файла вы можете получить
изображение с них прямо в программу Excel. Для этого следует выбрать команду
меню Вставка з£> Рисунок ^> Со сканера или камеры. На экране появится диалог
вставки изображения.
В списке, расположенном в верхней части диалога, нужно выбрать устройст-
во, после чего нажать кнопку Вставить. Рисунок будет отсканирован и вставлен
в таблицу. Если требуется настроить параметры сканирования или ваш сканер не
поддерживает автоматическое сканирование, нажмите кнопку Специальная
вставка. На экране появится диалог драйвера сканера, в котором вы можете на-
строить параметры, выбрать область сканирования и получить изображение.
Аналогично, если вы используете цифровую фотокамеру, в драйвере выбирается
нужный фотоснимок, хранящийся в памяти камеры, и передается в компьютер
для вставки в таблицу.
132
Работа с рисунками и диаграммами
]*• - а • • : Щи Ш1 а-
| iS|l!MfTOi>T «литое рулили еИнтерметв. л§>Спр:д
Жесты Хиаотиеме Загаужавм. Заония э до ватина.
,=А, ВЦЩ
Рис. 2.78. Вставка рисунка из коллекции
В поставку пакета программ Microsoft Office, частью которого является
Excel, входит множество оригинальных рисунков, созданных профессиональны-
ми художниками, которые вы можете вставлять в свои рабочие листы. Чтобы до-
бавить эти рисунки в таблицу, выберите команду меню Вставка з£> Рисунок Х£>
Картинки. Если вы работаете в Excel 97 или 2000, будет открыто окно вставки ри-
сунка (Рис. 2.78, слева).
Щелкнув мышью на ярлычке Рисунки или Картинки, вы откроете список ка-
тегорий рисунков. Щелкнув мышью на категории, вы откроете список эскизов
картинок, относящихся к этой категории. Чтобы вставить рисунок в таблицу,
щелкните мышью на нужной картинке. В Excel 97 нужно нажать кнопку Доба-
вить, а в Excel 2000 нужно нажать кнопку ,Щ и картинка будет вставлена в таб-
лицу. Можно также просто перетащить картинку из окна вставки в таблицу.
Если вы работаете с Excel 2002, вставка картинок немного отличается. Если
вы выбрали команду вставки картинки в первый раз, появится диалог, предлага-
ющий просмотреть диски вашего компьютера и создать коллекцию из найден-
ных картинок. Сейчас не стоит этого делать, поэтому нажмите кнопку Позднее,
но помните, этот диалог будет появляться каждый раз, пока вы не согласитесь
создать коллекцию картинок.
После того, как диалог создания коллекции будет закрыт, в правой части
рабочего окна будет открыта панель задач с элементами управления вставки
картинки. Чтобы вставить картинку из коллекции, поставляемой вместе с про-
граммой, выберите команду Коллекция картинок в нижней части панели задач.
Будет открыто окно вставки картинок (Рис. 2.78, справа). В левой части окна
располагается список коллекций. Если в левой части отображаются элементы
управления для поиска, нажмите кнопку Список коллекций в верхней части ок-
на вставки.
Выбрать коллекцию можно, дважды щелкнув на ней мышью. При этом ни-
же, в списке коллекций появится список категорий выбранной коллекции.
Дважды щелкнув на категории, вы отобразите в правой части окна список эски-
зов картинок данной категории. Для вставки картинки в таблицу следует перета-
щить ее мышью из окна вставки в таблицу. Картинка будет вставлена, и вы мо-
133
Особенности Excel, полезные бухгалтеру
* ••" Вставка картинки
Выдечемиые коллекции
и везде
г D Коллекции Microsoft Offiaf
* il Автофигуры
- lj(| Времена года
,+. а геогоа&ические кчоть .s
Искать объект
I Некоторые TI
'- О Все типы мультимедиа
ЁЗ Картинки
И Фотографии
О Фильмы
Л] Коллекция картинок...
(jfc Когшекция картинок в Интернете
СО Советы по поиску клипов
+ * Вставка картинки
Результаты:
fl
См. также
BG Коллекция картинок...
ф Коллекций картинок в Интерне
I?) Советы по поиску клипов
Рис. 2.79.
Поиск картинок
жете закрыть окно выбора картинки, на-
жав кнопку |2 в правом верхнем углу
этого окна.
Программа позволяет искать кар-
тинки в коллекции по ключевым словам.
Для поиска картинок в Excel 2002 удобно
воспользоваться панелью задач, которая
появляется после выбора команды
вставки картинки (Рис. 2.79, слева).
В поле ввода Искать текст вам
предлагается указать фразу, которая опре-
делила бы область, к которой относится
вставляемая вами картинка. В картинки
коллекции Microsoft Office встроено не-
сколько ключевых слов, определяющих
категорию, к которой относится картин-
ка. Также поиск идет по названиям кате-
горий коллекции. Если оставить это поле
пустым, то будут найдены все картинки.
Открывающийся список Просматривать позволяет выбрать коллекции, ко-
торые нужно просматривать в поиске картинок. Чтобы включить коллекцию в
поиск, установите флажок слева от названия коллекции. Если флажок у имени
коллекции сброшен, она не участвует в поиске.
Открывающийся список Искать объекты предназначен для выбора типов объ-
ектов, которые нужно найти. Откройте список и сбросьте флажки у всех элементов
списка, кроме элемента Картинки. Если кроме картинок из коллекций нужно най-
ти и произвольные изображения, установите флажок и у элемента Фотографии.
Нажмите кнопку Найти, и программа просмотрит коллекции в поисках
нужных вам картинок. Результаты поиска отображаются в средней части панели
задач и представляют собой список эскизов картинок (Рис. 2.79, справа). Щелк-
нув мышью на эскизе нужной картинки, вы вставите ее в таблицу, в то место, где
находится активная ячейка. Нажав кнопку Изменить, вы вернетесь к поиску
картинок. Можете настроить дополнительные параметры и задать новое слово
для поиска, после чего снова нажать кнопку Найти. В панели задач появится но-
вый список найденных картинок.
Рисунки и другие объекты, вставленные в таблицу, могут значительно увели-
чить ее объем. В программе есть возможность вставлять в таблицу не изображе-
ния, а ссылки на них. В этом случае при открытии таблицы, в которой есть такие
ссылки, программа прочитает информацию из файла, где хранится изображение
или другой объект, и покажет его в таблице. При сохранении таблицы изображе-
ние не будет включено в нее. Такой способ вставки объектов хорош еще тем, что
при изменении объекта с помощью других программ, он автоматически обнов-
ляется и в таблице, в которую вставлена ссылка на него.
134
Работа с рисунками и диаграммами
^*
Диагрм ив Mirros-sft Graph
Докрмиг Microsoft Word
Докуиект WordPed
Звукозапись
Клип мультимедиа
Пакет
Презентация Microsoft PowerPoint
Рисунок Microsoft Word
Вставив нового объекта, в документ.
•
Результат
Всгввка содерх импгп фаипп в документ так,
что его можно кл--«>и>-
в коюрси rj.f fsj'i ..издан,
Рис. 2.<У0. Вставка объекта
Различают два вида объектов, вставляемых подобным образом. Это так на-
зываемые внедренные объекты и связанные объекты. Внедренный объект, на-
пример изображение, не существует в виде файла. Он создается в программе для
работы с этим типом объектов и внедряется в таблицу Excel. Когда вы хотите из-
менить данный объект, вы просто дважды щелкаете на нем мышью. Будет запу-
щена программа для работы с данным типом объектов, например, в случае изоб-
ражения, это будет графический редактор. Вы меняете объект в программе, и по-
сле завершения ее работы измененный объект снова внедряется в таблицу.
Связанный объект, например изображение, хранится отдельно в виде файла,
и вы в любой момент можете изменить его в программе, предназначенной для
работы с данным типом объектов. В таблицу вставляется не сам файл, а ссылка
на него, тем самым уменьшается объем, занимаемый таблицей.
Чтобы вставить связанный или внедренный объект, выберите команду меню
Вставка Х£> Объект. На экране появится диалог вставки. Если нужно вставить
внедренный объект, щелкните мышью на ярлычке Новый, и будет открыта соот-
ветствующая вкладка диалога (Рис. 2.80, слева).
В списке Тип объекта перечислены программы, которые можно использо-
вать для вставки объектов. Выбрав тип объекта из списка, в нижней части вы
увидите краткое описание вставляемого объекта. Если вы установите флажок
В виде значка, то объект в листе рабочей книги будет изображаться в виде значка,
если же убрать флажок, то объект будет вставлен в натуральном виде, то есть в
виде картинки.
После выбора типа объекта из списка нажмите кнопку ОК, чтобы закрыть
диалог. При этом будет запущена та программа, которая предназначена для со-
здания объектов выбранного вами типа. В этой программе вы можете создавать
и редактировать объект, предназначенный для вставки в таблицу Excel. После за-
вершения редактирования объекта вы закрываете соответствующую программу,
и объект помещается в таблицу Excel, в место, указываемое активной ячейкой.
Если вы хотите вставить связанный объект, щелкните мышью на ярлычке
Из файла. Будет открыта соответствующая вкладка диалога вставки объекта
135
Особенности Excel, полезные бухгалтеру
(Рис. 2.80, справа). В поле ввода Имя файла нужно указать файл, в котором на-
ходится вставляемый связанный объект. Нажав кнопку Обзор, вы откроете диа-
лог вставки файла, описанный выше. Выберите в этом диалоге папку и файл, и
нажмите кнопку Открыть. Диалог вставки будет закрыт, а выбранный файл по-
явится в поле Имя файла.
Если вы хотите, чтобы сам объект не внедрялся, а была вставлена только
ссылка на него, установите флажок Связь с файлом. Если установить флажок В ви-
де значка, объект в листе рабочей книги будет изображаться в виде значка, в про-
тивном случае будет вставлен сам объект. После указания имени файла нажмите
кнопку ОК, диалог будет закрыт, а объект вставлен в таблицу.
Кроме рисунков, созданных в других программах или полученных с уст-
ройств ввода изображений, при создании красиво оформленной таблицы можно
создавать простые рисунки самостоятельно. Чтобы рисовать красивые изобра-
жения надо не только обладать талантом художника, но и хорошо уметь рисовать
мышью. Часто это бывает сложно. Гораздо проще воспользоваться средством ав-
томатического рисования различных фигур.
Выберите команду меню Вставка э£> Рисунок Х£> Автофигуры, и на экране
появится панель инструментов Автофигуры. Эта панель в виде кнопок отобража-
ет доступные группы фигур, которые вы можете использовать для рисования.
Нажав одну из кнопок в панели инструментов, вы отобразите список фигур в
данной группе. Чтобы выбрать фигуру, достаточно щелкнуть на ней мышью. При
этом указатель мыши изменит свою форму на -|-.
Теперь, чтобы нарисовать выбранную фигуру, необходимо подвести указа-
тель мыши к выбранному месту и щелкнуть мышью. Фигура будет вставлена в
таблицу и выделена. Если вы хотите вставить рисунок иного размера, то следует
установить указатель мыши на свободном месте, нажать кнопку мыши и пере-
двинуть мышь. Для создания правильной фигуры следует при этом держать на-
жатой клавишу | ctri |. После того, как вид фигуры вас устроит, отпустите кнопку
мыши. Создание фигуры будет завершено (Рис. 2.81).
По умолчанию фигуры создаются не-
прозрачными, что иногда бывает неудобно.
Чтобы сделать фигуру прозрачной, нужно
убрать заливку в этой фигуре. Дважды
щелкните мышью на фигуре, и будет отрыт
диалог настройки. Щелкните мышью на
ярлычке Цвета и линии на этой вкладке, в
списке Цвет группы элементов управле-
ния Заливка выберите элемент Нет залив-
ки. Нажмите кнопку ОК, чтобы закрыть ди-
алог, и фигура станет прозрачной.
Как уже отмечалось, на панели инст-
рументов Автофигуры в виде кнопок пред-
ставлены различные группы фигур. На-
В
о
Рис. 2.81.
Созданная автофигура
136
Работа с рисунками и диаграммами
Рис. 2.82.
Выбор объекта WordArt
жав кнопку fjg, вы откроете список раз-
личных линий, а если вы нажмете кнопку
%], то откроете список соединитель-
ных линий. При нажатии на кнопку
^ открывается список основных фигур.
Если вам нужны фигурные стрелки, нажи-
майте кнопку ̂ , а если вы хотите вставить
элемент блок-схемы, нажимайте кнопку
^д. Нажав кнопку ̂ , вы откроете список
звезд и лент, а чтобы увидеть какие можно
вставить выноски, нажмите кнопку и}.
Если вы не нашли среди предлагаемых
вариантов автофигур нужный вам, можно
воспользоваться фигурами, входящими в
состав коллекции картинок Microsoft Office.
Нажмите кнопку Ц^, и в Excel 97 и 2000 будет открыто окно вставки картинки с
выбранной категорией автофигур. Выберите автофигуру и вставьте ее, как это
рассмотрено выше. В Excel 2002 в правой части рабочего окна будет открыта па-
нель задач, содержащая найденные фигуры. Щелкнув на фигуре мышью, вы до-
бавите объект в таблицу.
Для создания красивых текстовых надписей в программе предусмотрено ис-
пользование средства, называемого WordArt. С помощью этого средства с мини-
мальными усилиями создается высокохудожественная надпись, не уступающая
работе профессионального дизайнера. Чтобы вставить объект WordArt в таблицу,
следует выбрать команду меню Вставка Х£> Рисунок з£> Объект WordArt. Появит-
ся диалог с коллекцией надписей, предлагающий выбрать стиль фигурного тек-
ста (Рис. 2.82).
Все варианты начертания фигурного текста представлены в виде кнопок с
изображением стиля, который получается при применении этого варианта. Для
выбора одного из вариантов нужно щелкнуть на нем мышью и нажать кнопку
ОК данного диалога. Диалог будет закрыт и появится диалог изменения текста
(Рис. 2.83, слева).
Этот диалог содержит поле ввода для задания выводимого фигурного текста.
Щелкните мышью на поле ввода и набирайте нужный текст. В открывающемся
Втер;
~31« ,.d j«j _*J
Заголовок таблицы
ti
Puc. 2.83. Создание фигурного текста
137
Особенности Excel, полезные бухгалтеру
списке Шрифт вы можете выбрать нужный вам вид шрифта, а в списке Размер
можно выбрать размер создаваемой надписи в пунктах. Правее расположены
кнопки форматирования текста, такие как выделение курсивом и полужирное
выделение. После окончания ввода текста нажмите кнопку ОК, чтобы закрыть
диалог и вставить в таблицу фигурный текст (Рис. 2.83, справа).
При этом объект будет выделен, и появится панель инструментов WordArt,
с помощью которой можно изменять вставленный объект. Нажав кнопку ̂
на панели WordArt, вы можете вставить еще один фигурный текст, а кнопка
[Щ позволяет изменить стиль для созданного объекта. Нажав любую из этих
кнопок, вы снова откроете диалог выбора стиля (Рис. 2.82), только в первом слу-
чае будет создан новый объект, а во втором случае изменен уже существующий.
Нажав кнопку Щ$, вы откроете диалог настройки параметров объекта, который
мы рассмотрели выше. Чтобы изменить текст, нажмите кнопку Изменить текст,
и будет открыт диалог изменения (Рис. 2.83, слева).
Нажав кнопку AgjB, вы откроете вспомогательную панель с множеством
вариантов размещения символов вдоль кривых. Щелкнув мышью на одном из
вариантов, вы измените форму фигурного текста. Нажав кнопку дд, вы пре-
вратите все символы фигурного текста в прописные. Повторное нажатие
кнопки отменяет эту операцию. Кнопка •=• открывает меню выравнивания
рисунка. Эти операции не отличаются от аналогичных действий, рассмотрен-
ных нами в предыдущей главе при изучении форматирования текстов. Выбрав
вариант из списка, вы примените выравнивание к фигурному тексту. Нажав
кнопку |̂ , вы преобразуете горизонтальный фигурный текст в вертикаль-
ный. При этом все остальные эффекты останутся на месте. Кнопка
Л2/ открывает вспомогательное меню настройки межсимвольного интервала.
Вы можете выбрать разные интервалы, что сильно изменит внешний вид фи-
гурного текста.
Чтобы снять выделение с фигурного текста, щелкните мышью в любом мес-
те таблицы вне объекта. При этом панель инструментов WordArt будет убрана.
Для работы с объектами после их создания в нижней части рабочего окна по-
является панель инструментов рисования. С помощью кнопок на панели инст-
рументов Рисование вы можете вращать объекты, трансформировать их, делать
объемными, добавлять тени, создавать текстовые объекты. Если вы создали не-
сколько фигур, то можете объединить их в одну или указать порядок их отобра-
жения, если они накладываются друг на друга.
Для рисования простейших фигур на панели есть ряд кнопок. Нажмите
кнопку N^ на панели Рисование, затем подведите указатель мыши к месту в таб-
лице, где должна начинаться линия. Нажмите левую кнопку мыши и, не отпус-
кая ее, передвиньте мышь, после чего отпустите кнопку. На экране останется
отрезок, выделенный с помощью маркеров. Как и для других выделенных
объектов, перетаскивая мышью маркеры, вы можете менять размеры и наклон
отрезка. Нажав кнопку ̂  и выполнив те же действия, вы создадите линию со
стрелкой.
138
Работа с рисунками и диаграммами
Нажмите кнопку [_ J, установите указатель мыши на свободном месте в таб-
лице, нажмите кнопку мыши, передвиньте мышь и отпустите кнопку. Теперь вы
нарисовали прямоугольник. Если нажать кнопку (*~̂  и выполнить такие же дей-
ствия, то можно нарисовать эллипс.
Если во время создания или изменения размеров фигуры держать нажатой
клавишу |tshift], будут сохранены пропорции изображения. Центр изменяемого
рисунка будет оставаться неподвижным в том случае, если держать нажатой кла-
вишу |ctri~|. Можно держать нажатыми обе клавиши. В этом случае центр останет-
ся на месте, и будут сохранены пропорции.
Если нужно вставить в таблицу как объект простую текстовую надпись, на-
жмите кнопку [Д] на панели Рисование. Щелкните мышью в нужном месте таб-
лицы и вводите текст с помощью клавиатуры. Если нужно изменить шрифт и
размер текстовой надписи, во время создания объекта щелкните правой кнопкой
мыши и во вспомогательном меню выберите команду Формат надписи. В по-
явившемся диалоге выберите нужные характеристики шрифта и нажмите кноп-
ку ОК, чтобы продолжить создание текстового объекта. Чтобы закончить созда-
ние объекта, щелкните мышью вне рамки выделения. Нажмите кнопку А^, если
вам нужно изменить цвет текста в объекте. Для выбора другого цвета нажмите
кнопку w правее кнопки А^ и выберите нужный цвет в палитре.
Чтобы вставить в таблицу объект \\brdArt, нажмите в панели Рисование кнопку
|̂. Будет открыт диалог выбора стиля, рассмотренный выше. Нажав кнопку Ц|,
вы вставите в таблицу картинку, а вставить рисунок можно, нажав кнопку
Щ. Выделив объект в таблице и нажав кнопку ^j, вы зальете объект выбран-
ным по умолчанию цветом. Чтобы выбрать другой цвет заливки, нажмите кнопку ж
правее кнопки ̂  и в появившейся палитре выберите нужный цвет заливки. В этой
же палитре можно выбрать элемент Нет заливки, и заливка объекта будет удале-
на. Нажав кнопку «£, вы окрасите контурную линию объекта выбранным ранее
цветом. Чтобы выбрать другой цвет, нажмите кнопку т справа от кнопки
!̂ [ и выберите цвет в палитре.
Для выбора толщины контурной линии используется кнопка
JJJ. Нажав эту кнопку, вы откроете список возможных вариантов, выбрав один
из них, вы измените контур предварительно выделенного объекта. Если нужно
изменить стиль линии, нажмите кнопку ЕЛЕ на панели Рисование и в списке вы-
берите нужный стиль линии. Если вы создаете линии в виде стрелок, нажмите
кнопку J^ и выберите в списке стиль стрелки.
Список доступных вариантов наложения тени на объект можно открыть на-
жав кнопку Щ. Выбрав вариант тени, вы примените его к выделенному предва-
рительно объекту. Если вы хотите придать объекту эффект объема, нажмите
кнопку ^р и выберите вариант в списке.
Многие операции с объектами требуют, чтобы объекты были выделены. Ес-
ли объекты не выделять, то операция будет применена к объекту, который был
создан последним. Для выделения объектов используется кнопка ̂ . Чтобы вы-
делить объект, нажмите эту кнопку и щелкните мышью на нужном объекте. Ес-
139
Особенности Excel, полезные бухгалтеру
ли нужно выделить сразу несколько объектов, нажмите клавишу [[см] и, не отпу-
ская ее, щелкайте мышью на нужных объектах.
Для трансформации объектов можно воспользоваться кнопкой Действия в
левой части панели Рисование. Нажав эту кнопку, вы откроете список действий.
Выбрав команду Повернуть/Отразить, вы откроете вложенное меню со списком
команд поворота. Если нужно изменить взаимное расположение объектов, выбе-
рите команду Порядок и во вложенном меню выберите команду расположения.
Удобно бывает работать с несколькими объектами как с одним объектом.
Чтобы сделать это, выделите несколько объектов, а затем нажмите кнопку Дей-
ствия на панели Рисование. В появившемся списке действий выберите коман-
'ду Группировать. Теперь при изменении любого объекта группы изменятся и
другие объекты в этой группе. Чтобы отменить группировку, нужно выбрать
команду Разгруппировать, нажав предварительно кнопку Действия на панели
Рисование.
2.8.2. Создание диаграмм
Числовые данные воспринимаются не так хорошо, как графики и диаграм-
мы, поэтому при создании документов результаты вычислений часто оформля-
ются в графическом виде. Excel предлагает для создания графиков и диаграмм
мощные средства. С помощью специального мастера диаграмм вы можете по-
этапно сформировать изображение нужного типа, наблюдая, как выбранные па-
раметры влияют на внешний вид диаграммы. Диаграмма может быть внедрена на
текущий лист рабочей книги, а может быть построена на отдельном листе. Для
построения диаграммы необходимо иметь исходную электронную таблицу, на
основе которой и будет строиться диаграмма. Диаграмма в Excel строится на ос-
нове заранее приготовленной таблицы данных. Составляющие этой таблицы, то
есть строки и столбцы, формируют ряды данных в диаграмме.
Создать диаграмму в Excel можно с помощью мастера диаграмм, с помощью
панели инструментов Диаграммы, а также с помощью инструментов быстрого
создания диаграмм, которые используют стандартные типы диаграмм и параме-
тры форматирования. Кроме того, возможно также создание диаграммы для
сводной таблицы. Способ создания сводной диаграммы несколько отличается от
способа построения обычных диаграмм Excel. Рассмотрим эти способы создания
диаграмм.
Если вы хотите построить диаграмму из данных вашей таблицы, то заголов-
ки строк и столбцов будут использованы для названия осей и обозначения рядов
данных на диаграмме. После того, как диапазон ячеек выделен, выберите коман-
ду меню Вставка Х£> Диаграмма. Будет запущен мастер диаграмм, и на экране
появится первый диалог этого мастера (Рис. 2.84, слева).
Всего в Excel имеется 14 типов стандартных диаграмм, а также порядка двад-
цати типов нестандартных встроенных диаграмм. Каждый тип содержит от одно-
140
Работа с рисунками и диаграммами
Стандартные Нестандарта
Линейчатая
График
<Э Круговая
;/> Точечная
I С областями
I Копьцевзя
( Лепестковая
3 Поверхность
; Пузырьковая
[ Биржевая
| Цилиндрическая
Стандартные Нестандартнее I
Блоки с областями
Вырезанные сектора
Гистограмма i области
Гладкие графики
Голубая круговая
И1 Грвфик|гистограмма
График) гистограмма 2
Графики (2 оси)
* " ' дополни! ельн
• (• встроенные
по ОС Поступило ОС
скость, запопнемная конусам!
Рис. 2.<У4. Выбор типа диаграммы
го до семи видов диаграмм. По умолчанию вам предлагается выбрать стандарт-
ный тип диаграммы, и диалог открыт на вкладке Стандартные. В списке Тип вы
можете выбрать один из стандартных типов. По умолчанию в Excel используют-
ся гистограммы, то есть диаграммы в виде столбцов. Если вы выбрали тип диа-
граммы, то в правой части диалога, в списке Вид можно выбрать один из видов
диаграммы данного типа.
Каждый вид диаграммы имеет пояснения в нижней части диалога, и это
должно значительно облегчить вам процедуру выбора диаграммы. Кроме того,
нажав кнопку Просмотр результата, вы можете увидеть, как будет выглядеть ди-
аграмма с вашими данными. Пока вы удерживаете нажатой эту кнопку, в облас-
ти для просмотра отображается диаграмма, полученная из ваших данных.
Если вас не устраивает набор стандартных диаграмм, щелкните мышью на
ярлычке Нестандартные, чтобы перейти на вторую вкладку диалога (Рис. 2.84,
справа).
Так же как и для стандартных диаграмм в списке Тип вы выбираете тип диа-
граммы, а в списке Вид вы выбираете один из видов данного типа. Если переклю-
чатель Вывести установлен в положение Встроенные, в списке Тип показаны не-
стандартные диаграммы, предлагаемые Excel. Если переключатель установлен в
положение Дополнительные, то отображаются шаблоны диаграмм, созданные ва-
ми. По умолчанию этот список пуст.
После того, как тип и вид диаграммы выбраны, нажмите кнопку Далее, что-
бы продолжить процесс создания диаграммы. Появится второй диалог мастера
диаграмм (Рис. 2.85, слева).
Во втором диалоге мастера по умолчанию открывается вкладка Диапазон
данных. На этой вкладке нужно указать диапазон ячеек, которые содержат дан-
ные для построения диаграммы. Для корректировки диапазона ячеек предназна-
141
Особенности Excel, полезные бухгалтеру
>й фо-1Л ГОвсгутг.тЛо ОС Поступило ОС Бма«"!0 •
пчци* ОС Видано с *«и«,у*т»ц,'..о ОС Вкшд i
.яой фонд вкЛ*Д е уставной фо«д Посту""""
Вклад | устаансЛ фонд Вглад ж устной фсяд акпад I
уставной фопд Посеяло ОС поступило ОС Ваадано1 :;;:';!•!•;
»кспл/атац*п ОС Видено 1 акеллуатацию <ОС Вклад I
уставной фонд Вкгвд в уставной Ф5ИЗ Поступит
Передан
Диапазон: : ^"Журнал операчий'!$А$25:50556
Ряды в: Г строках
Рис. 2.(У5. Выбор источника данных
чено поле ввода Диапазон. В этом поле уже должен быть указан диапазон ячеек,
если вы предварительно выделили его перед запуском мастера. В правой части
диалога есть кнопка ^g, нажав которую, вы свернете этот диалог и сможете без
помех выбрать новый диапазон ячеек для отображения на диаграмме. Чтобы
вновь открыть диалог, нажмите кнопку [с Щ. В нижней части диалога расположен
переключатель, который выбирает, как расположены ряды данных: в строках или
столбцах. Устанавливая этот переключатель в разные положения, можно про-
сматривать в виде диаграмм разные зависимости данных в таблице.
Щелкните мышью на вкладке Ряд, чтобы открыть вторую вкладку диалога
мастера. На этой вкладке вы можете изменить адреса ячеек, участвующих в ря-
дах, а также количество самих рядов диаграммы. В списке Ряд перечислены ря-
ды данных. Нажав кнопку Добавить, вы добавите в список рядов еще один ряд,
а выбрав ряд в списке и нажав кнопку Удалить, вы удалите ряд из списка. В по-
ле Значение указан диапазон ячеек для выбранного в списке ряда. В поле Подпи-
си по оси А1 указывается диапазон, из которого мастер будет получать подписи для
оси X. Наконец, в поле Имя указываются названия рядов данных.
Если вы не ошиблись в выделении ячеек, то, скорее всего, ничего менять на
этой вкладке вам не придется. После того, как вы убедитесь, что диапазон ячеек
выбран правильно, нажмите кнопку Долее, чтобы продолжить процесс создания
диаграммы. Появится третий диалог мастера диаграмм (Рис. 2.86).
Этот диалог содержит ряд вкладок для настройки общих параметров диа-
граммы. Щелкните мышью на ярлычке Заголовки, чтобы открыть одноименную
вкладку диалога. На этой вкладке в полях ввода нужно указать название диаграм-
мы в целом и название ее осей. Щелкните мышью на ярлычке Оси, чтобы от-
крыть следующую вкладку диалога. На этой вкладке настраивается показ или
142
Работа с рисунками и диаграммами
Рис. 2.86.
Настройка параметров диаграммы
скрытие главных осей диаграммы.
Щелкните мышью на ярлычке Линии
сетки, чтобы перейти на одноименную
вкладку диалога. На этой вкладке нужно
определить отображение или скрытие
сетки на диаграмме. Для каждой оси с
помощью переключателей можно вклю-
чать или выключать как основные, так
дополнительные линии сетки. Щелкни-
те мышью на ярлычке Легенда, чтобы
перейти на следующую вкладку диалога.
На этой вкладке задается расположение
списка условных обозначений диаграм-
мы, который называется легендой. С по-
мощью переключателя Размещение, вы можете поместить легенду справа, слева,
внизу, вверху и в правом верхнем углу диаграммы.
Щелкните мышью на ярлычке Подписи данных, чтобы перейти на следую-
щую вкладку диалога. На этой вкладке нужно настроить отображения подписей
к данным диаграммы. Устанавливая флажки в группе Включить в подписи, вы мо-
жете включить в подписи диаграммы имена рядов, имена категорий или значе-
ния. Открывающийся список Разделитель служит для выбора символа разделе-
ния подписей. Вы можете выбрать в качестве разделителя пробел, точку, точку с
запятой или запятую.
Щелкните мышью на ярлычке Таблица данных, чтобы перейти на одноимен-
ную вкладку диалога, на которой разрешается или запрещается отображать вме-
сте с диаграммой выделенные вами ячейки таблицы. Это делается установкой
или сбросом флажка Таблица данных. Если флажок установлен, ниже диаграммы
появляются ячейки с данными, образующими диаграмму.
Обращаем ваше внимание, что если вы вносите изменения на вкладках
этого диалога, то они сразу же отображаются в окне просмотра. После на-
стройки параметров диаграммы нажмите кнопку Далее, чтобы продолжить
процесс создания диаграммы. Появится четвертый диалог мастера диаграмм
(Рис. 2.87).
Данный диалог предназначен для
указания места размещения диаграммы.
Установив переключатель в положение
Отдельном, вы разместите диаграмму на
отдельном листе. При этом в поле ввода,
расположенном правее положения пе-
реключателя, нужно ввести имя листа.
Если вы введете имя одного из сущест-
вующих листов, диаграмма будет разме-
щена на этом листе. Если же указать имя
Поместить:',
<* имеющейся:
Отмела j
Рис. 2.87.
Размещение диаграммы
143
Особенности Excel, полезные бухгалтеру
I
S
i
01
1
08
1
1
I
10
11
™ 1
ct
19
''•%
s i
20
•HI
1
8 "
i
26
:%i
IE
|!
40
1
1
2
1
i-
41
й
|
P
43
И
ii
!i 5
r '"
46
1
1
50
|
|
1
|
' •' " f
1
CL
60
|
5
I!
s.
2
4(1
1
fl
1 5
68
^ ;"Л-
^ 1
69
Ш
0 g
"- S
70
" 1
f t
l\
1\
\
a
75
il-
^
a
76
1
*
I
8(1
I
90
M
1
S
 
П
р
и
б
ы
ли
 и
 i
• Кредит
D Дебет
Рис. 2.<?<У. Пример диаграммы
нового листа, в рабочей книге будет создан лист с указанным именем и диаграм-
ма будет помещена в нем.
Позднее вы в любой момент можете открыть этот диалог, щелкнув правой
кнопкой мыши на диаграмме и выбрав команду вспомогательного меню Разме-
щение. После того, как место для диаграммы выбрано, нажмите кнопку Готово,
чтобы завершить работу мастера. Диаграмма будет создана и отображена в нуж-
ном месте рабочего листа (Рис. 2.88).
Многие промежуточные операции при создании диаграммы можно обойти,
если пользоваться панелью инструментов Диаграммы. Чтобы отобразить эту па-
нель на экране, выберите команду меню Вид Х£> Панели инструментов, и во вспо-
могательном меню выберите команду Диаграммы. Далее выберите диапазон яче-
ек, которые должны образовывать диаграмму и нажмите кнопку ̂  на панели
инструментов Диаграмма. Будет построена диаграмма и отображена в текущем
листе как объект. Если нужно выбрать другой тип диаграммы, нажмите кнопку w
правее кнопки |Д, и в открывшемся списке выберите нужный тип диаграммы.
Если нужно задать построение рядов данных по строкам, нажмите кнопку
fcrj на панели Диаграмма, или нажмите кнопку QJ если нужно, чтобы ряды дан-
ных располагались по столбцам. Внешний вид диаграммы изменится. Если, кроме
диаграммы, в лист должна быть вставлена таблица данных, нажмите кнопку cffl.
Повторное нажатие этой кнопки, скроет таблицу данных. Если нужно, чтобы ди-
аграмма была снабжена легендой, нажмите кнопку [J Ц, а нажав эту кнопку еще
раз, вы опять скроете легенду. О том, как изменить другие параметры диаграммы,
вы узнаете ниже.
Работая в программе Excel, можно создать диаграмму буквально за один шаг.
Для этого выделите нужный диапазон данных и нажмите клавишу (Ш. На осно-
144
Работа с рисунками и диаграммами
ве выделенного диапазона данных, программа создаст стандартный тип диаграм-
мы, и разместит диаграмму на отдельном листе. По умолчанию стандартным ти-
пом диаграммы является гистограмма с накоплением значений.
Если требуется изменить стандартный тип диаграммы, создаваемой быст-
рым способом, щелкните мышью на диаграмме, чтобы выделить ее, а затем вы-
берите команду меню Диаграмма Х£> Тип диаграммы. Будет открыт диалог выбо-
ра типа диаграммы, рассмотренный выше (Рис. 2.84). В появившемся диалоге
выделите нужный вид диаграммы, нажмите кнопку Сделать стандартной и за-
кройте диалог, нажав кнопку ОК. Теперь создаваемые диаграммы будут иметь вы-
бранный вами вид.
Правильное определение стандартного типа диаграммы упрощает рутинные
операции по созданию диаграмм. Если вы обрабатываете однотипные массивы
данных и иллюстрируете их диаграммами одного типа, то лучше сделать этот тип
стандартным. Тогда для построения очередной диаграммы достаточно будет вы-
делить таблицу и затем нажать клавишу flmj.
2.8.3. Работа с диаграммами
После того, как диаграмма создана, вам может потребоваться дополнить ее
новыми данными или сделать представленные данные более наглядными. Для
модификации диаграмм в Excel предусмотрены многочисленные средства, кото-
рые мы рассмотрим.
Если вы создали диаграмму, а затем решили изменить ее тип или вид, то вам
не нужно перестраивать ее заново. Чтобы изменить тип диаграммы в целом, вы-
делите диаграмму и выполните команду меню Диаграмма :£> Тип диаграммы. Бу-
дет открыт диалог выбора типа диаграммы (Рис. 2.84). В появившемся диалоге
выделите нужный вид диаграммы и нажмите кнопку ОК.
Если же вам нужно изменить не всю диаграмму, а только видоизменить
представление какого-либо ряда данных, выделите нужный ряд данных, щелк-
нув мышью по любому маркеру этого ряда или выбрав название ряда в открыва-
ющемся списке на панели инструментов Диаграммы. Далее откройте список ти-
пов диаграмм, нажав кнопку ж правее кнопки уц па панели инструментов. Вы-
берите в списке для выделенного ряда новое графическое представление, и вид
диаграммы изменится.
Изменить данные, на основе которых построена диаграмма, можно либо
внося изменения в исходную таблицу, либо меняя конфигурацию маркеров дан-
ных непосредственно на самой диаграмме. Чтобы ввести новые данные в ячейку
таблицы, выделите ячейку, в которую необходимо ввести изменения, и с помо-
щью клавиатуры введите данные. Диаграмма при этом автоматически будет из-
менена в соответствии с новыми данными.
Данные на диаграммах отображаются маркерами данных. Каждый маркер
данных на диаграмме представляет собой графический объект, который можно
145
Особенности Excel, полезные бухгалтеру
модифицировать независимо от остальных. Можно изменить размер маркера
данных, перетащив элементы маркера в нужную сторону с помощью мыши. До-
бившись нужного значения, отпустите кнопку мыши, после чего данные в ис-
ходной таблице будут откорректированы в соответствии с новым размером или
положением маркера данных.
Если в исходной таблице появились новые данные, и вы хотите добавить их
в диаграмму, можно выделить диапазон новых данных в таблице и перетащить
этот диапазон на диаграмму с помощью мыши. Программа проведет анализ до-
бавляемого ряда данных и сопоставит их с суще-
ствующими рядами на диаграмме. В результате
появится новый ряд данных, и вся диаграмма бу-
дет перестроена. Для добавления данных в диа-
грамму можно использовать и буфер обмена
Windows. Выделите в таблице диапазон добавляе-
мых данных и скопируйте его в буфер, нажав
кнопку [̂ 5] на панели инструментов Excel. Затем
перейдите на диаграмму и нажмите кнопку
j^. Для вставки элементов диаграммы удобнее
пользоваться специальной вставкой. Выберите
Специальная вставка, и будет открыт диалог настрой-
. Добздю» значении *и - -, .-Значения (У) }
(«'новыеаады ' | :Г'^4зщвх |
С .новые глеменгы рядов ; i * -
F Щмена рядов а первой строке : ••'
Г Категории (подписи ос» X) в дерном столбце
Рис. 2.89.
Вставка данных
в диаграмму
команду меню Правка
ки вставки (Рис. 2.89)
Переключатель Добавить новые значения как определяет, куда помещать
вводимую информацию. Установив переключатель, вы можете выбрать встав-
ку информации как рядов диаграммы или как элементов рядов. Переключа-
тель Значения определяет, где расположена вертикальная ось диаграммы: в
строках или столбцах. Если установлены флажки Имена рядов в первой строке
и Категории в первом столбце, информация из первых строк и столбцов ис-
ходной таблицы будет использована для подписей к диаграмме. Нажмите
кнопку ОК, и данные будут добавлены к диаграмме в соответствии с вашими
настройками.
Если нужно изменить диапазон данных, используемых в диаграмме, выдели-
те изменяемую диаграмму и выполните команду Диаграмма ;£> Исходные дан-
ные. Будет открыт диалог настройки исходных данных диаграммы. Щелкните
мышью на ярлычке Диапазон, чтобы перейти на одноименную вкладку диалога
(Рис. 2.90, слева).
В поле ввода Диапазон задается полный диапазон исходных данных. Можно
указать диапазон с помощью клавиатуры, введя адреса ячеек, а можно свернуть
;, и выбрать диапазон с помощью мыши. Кнопку (31диалог, нажав кнопку
нажмите для того, чтобы вновь развернуть диалог. В нижней части диалога рас-
положен переключатель, который выбирает, где расположены ряды диаграм-
мы - в строках или столбцах таблицы. В верхней части диалога расположено
поле просмотра, в котором отображается получающаяся в результате ваших на-
строек диаграмма.
146
Работа с рисунками и диаграммами
13 14 16 18 22 2В *8 Л 34 3? 40
" стрелах .
стоках
'ок . ! : ' : - отмен» ш
Рис. 2.90. Изменение исходных данных
Щелкните мышью на ярлычке Ряд, чтобы перейти на вторую вкладку диало-
га (Рис. 2.90, справа). На этой вкладке вы настраиваете название для каждого из
рядов диаграммы, а также определяете диапазон ячеек, участвующих в каждом
ряду. В списке Ряд выберите ряд данных, после чего в поле Имя введите имя для
выбранного ряда. Можно выбрать имя прямо из таблицы, или ввести его с помо-
щью клавиатуры. В поле ввода Значение для выбранного ряда назначается диапа-
зон ячеек, образующий ряд.
Можно менять количество рядов диаграммы. Чтобы добавить ряд, нажмите
кнопку Добавить, и в списке Ряд появится новый ряд диаграммы. Если выбрать
ряд в списке и нажать кнопку Удалить, выбранный ряд исчезнет из диаграммы.
После настройки параметров исходных данных нажмите кнопку ОК, чтобы за-
крыть диалог. Внешний вид диаграммы изменится в соответствии с вашими на-
стройками.
Большинство параметров диаграммы можно менять в диалоге настройки
параметров. Выберите команду меню Диаграмма :£> Параметры диаграммы,
чтобы отобразить диалог настройки. Отметим, что данный диалог мы уже
рассматривали, когда изучали работу мастера создания диаграмм. Сейчас мы
рассмотрим, как с помощью элементов управления этого диалога менять пара-
метры.
Если вам не нужны оси диаграммы, щелкните мышью на ярлычке Оси и
сбросьте соответствующие флажки. При скрытии осей автоматически удаляются
и подписи к ним. Обратите внимание, что оси для кольцевых и круговых диа-
грамм никогда не отображаются, и соответствующие флажки недоступны.
Если вы хотите, чтобы диаграмма содержала сетку или, наоборот, чтобы
сетки не было, щелкните мышью на ярлычке Линии сетки и установите флажки
147
Особенности Excel, полезные бухгалтеру
явждунврадкыв ; Сохранение J Проверка ощибик | Орфография
Вид ! Вычисления 1 Правде | Общие ' Переход j Списки Г Диаграмма j i Цвет
Рис. 2.91.
Настройка программы
тех линий сетки, которые необхо-
димо отобразить. Кольцевые и
круговые диаграммы изначально
не имеют сетки.
Если вы хотите, чтобы в диа-
грамме был заголовок и названия
осей, щелкните мышью на ярлычке
Названия элементов диаграммы. В
поле Название диаграммы введите
необходимый текст заголовка, а в
поля ОсьХ, Ось Y, введите, если не-
обходимо названия осей. Остальные параметры диаграммы можно изменить с по-
мощью кнопок на панели инструментов Диаграммы, которые рассмотрены выше.
Нажмите кнопку ОК, чтобы закрыть диалог настройки параметров диаграммы.
Можно настроить программу так, чтобы при наведении указателя мыши на
элемент диаграммы отображались всплывающие подсказки. Для этого выберите
команду меню Сервис :£> Параметры. Будет открыт диалог настройки, в котором
щелкните мышью на ярлычке Диаграмма. Будет открыта одноименная вкладка
диалога (Рис. 2.91).
В зависимости от вашего желания или нежелания видеть всплывающие под-
сказки установите или снимите флажки Названия и Значения. Если установлен
флажок Значения, в подсказках могут выводиться значения маркеров данных,
что иногда бывает удобно. Нажмите кнопку ОК, чтобы закрыть диалог настрой-
ки программы.
Если вас не устраивают параметры осей диаграммы, например, шкала или
цена деления, выбранные мастером создания диаграмм, вы можете изменить эти
Г наружу
! С внутрь Г прресека
] \ ;-йегки делений - - -
, ' ; Г нет Г вверху
{• рядом с {
э :| Шрифт ] Чисто | Выравнивание |
ала по оси ¥ (зчачемий)
о
максимальное значение: jI6000О
цена дсновных делений: j 20000
цена промеж'/гонких дстечий: J4000
Ось X (категорий)
пересекается в значении:
Г догарнфйичеснгй шкмъ
Г" обратный поррщок значений
Г оерестчеиие с осью X (категорий) в мэксямалькон зиаченж
Рис. 2.92. Параметры оси диаграммы
148
Работа с рисунками и диаграммами
параметры вручную. Выберите ось диаграммы, щелкнув на ней мышью или вы-
брав в списке на панели инструментов Диаграммы. Затем нажмите кнопку [̂  на
этой панели инструментов. Будет открыт диалог настройки параметров оси диа-
граммы на вкладке Вид (Рис. 2.92, слева).
Группа элементов управления Ось настраивает вид оси диаграммы. С помо-
щью переключателя вы можете выбрать обычную, невидимую ось, а также наст-
роить вид оси по своему выбору, установив переключатель положение Другая.
В поле образец вы можете видеть текущий вариант оси. Группа переключателей
в правой части диалога определяет положение сетки и меток делений относи-
тельно оси диаграммы.
Щелкните мышью на ярлычке Шкала, чтобы перейти на одноименную
вкладку диалога (Рис. 2.92, справа). На этой вкладке можно, устанавливая флаж-
ки и вводя информацию в поле ввода, указать максимальное, минимальное зна-
чения шкалы, а также цену делений шкалы. Также можно задать логарифмичес-
кую шкалу и шкалу с обратным порядком значений.
Вкладки Число, Шрифт и Выравнивание определяют формат чисел на оси
диаграммы, а также начертание символов и их ориентацию. Мы не будем рас-
сматривать эти вкладки, поскольку они повторяют аналогичные вкладки для
форматирования ячеек таблицы, рассмотренные нами выше. Состав вкладок ди-
алога форматирования зависит от типа элемента диаграммы, который вы выбра-
ли перед тем, как нажать кнопку [*§* на панели инструментов Диаграммы. Так,
при форматировании текста диаграммы состав вкладок будет совсем другим
(Рис. 2.93).
Вкладка Вид (Рис. 2.93, слева) присутствует при форматировании любого
объекта диаграммы. С помощью переключателя Рамка вы можете задать пара-
метры рамки, выбирая обычную, невидимую или произвольную рамку. В груп-
Способы заливки.., |
- ----- m-~- IU-J
Шриф
AOMUBSm
Подчеркивание:
.1 Авто .."J 1ABTO
Образец ......
АаВЬБбЯя
мнение' ; -
:| Г" зачеркнутый.
I \~ верхний индекс
i Г~ нижний индекс
.р* Двтомосштабироеоние . '
" Шрифт не найден. Для печати будет использован наиболее подходящий
Рис. 2.93. Форматирование элементов диаграммы
149
Особенности Excel, полезные бухгалтеру
пе элементов управления Заливка вы можете задать цвет заливки элемента ди-
аграммы, выбрав его из предложенной палитры. Нажав кнопку Способы залив-
ки, вы откроете диалог настройки заливки. Вкладки этого диалога рассмотре-
ны выше, при изучении форматирования объектов, вставляемых в таблицу.
Сейчас мы напомним, что вы можете задать текстуру или узор, сделать залив-
ку с переходом от одного цвета к другому, сделать заливку прозрачной, задать
толщину и цвет линии в контурной рамке объекта диаграммы, придать ей эф-
фект тени.
Если в элементе диаграммы есть текстовые данные, в диалоге форматирова-
ния будет присутствовать соответствующая вкладка. Щелкните мышью на яр-
лычке Шрифт, чтобы перейти на одноименную вкладку диалога. На этой вклад-
ке вы можете выбрать наименование шрифта, его начертание и размер. Это де-
лается в открывающихся списках Шрифт, Начертание и Размер, соответствен-
но. Кроме того, в этом диалоге можно выбрать вариант подчеркивания текста,
цвет и фон символов. По окончании настройки параметров форматирования на-
жмите кнопку ОК, чтобы закрыть диалог.
Вид диаграммы можно значительно улучшить, если вместо обычных марке-
ров данных использовать рисунки. Создайте диаграмму одним из рассмотренных
выше способов. Лучше, если диаграмма будет представлена в виде гистограммы.
Откройте список типов диаграмм, нажав кнопку ж правее кнопки |Д на пане-
ли инструментов Диаграммы. Выберите в списке нужный вид диаграммы, и
представление диаграммы на экране изменится.
Объемы продаж за неделю
120000
01,07.2002 02.07.2002 03,072002 04.072002 05.072002 0607.2002
Рис. 2.94. Рисунки в качестве элементов диаграммы
150
Повышение эффективности работы
Щелкните правой кнопкой мыши на маркере данных в диаграмме. В по-
явившемся вспомогательном меню выберите команду Форматирование рядов
данных, и будет открыт диалог форматирования. Щелкните мышью на ярлычке
Вид данного диалога, чтобы перейти на нужную вкладку. Нажмите кнопку Спосо-
бы заливки, чтобы открыть диалог настройки. В этом диалоге щелкните мышью
на ярлычке Рисунок, чтобы перейти на одноименную вкладку диалога. Нажмите
кнопку Рисунок на этой вкладке, и будет открыт стандартный диалог открытия
файла. Выберите папку и файл, содержащий рисунок, а затем нажмите кнопку
Вставить.
Диалог вставки будет закрыт, и вы вернетесь к диалогу настройки заливки.
С помощью переключателя Заполнение укажите, будет ли значение величины
отображаться путем растягивания маркера или путем его размножения. Нажми-
те кнопку ОК, чтобы закрыть диалог настройки заливки. Теперь нажмите кноп-
ку ОК, чтобы закрыть диалог форматирования. Внешний вид таблицы изменит-
ся, и маркеры данных будут представлены в виде рисунка (Рис. 2.94).
Для придания еще более красивого вида диаграмме вы можете, например,
убрать фоновую заливку или удалить границы столбиков. Для этого выберите на
панели инструментов Диаграммы, в списке элементов элемент Область диаграм-
мы и нажмите кнопку [jffi. В появившемся диалоге форматирования на вкладке
Вид удалите фоновую заливку и границы. В заключение нажмите кнопку ОК,
чтобы закрыть диалог форматирования.
2.9. Повышение эффективности работы
В программе Excel есть ряд возможностей для облегчения работы. Вы може-
те запомнить последовательность команд во время работы и затем выполнять эту
последовательность одним нажатием клавиши. Также можно быстро выполнять
простые вычисления, не записывая формулы в ячейки. Если вы допускаете мно-
го ошибок при вводе информации, вам поможет средство автозамены. Также
можно искать информацию в таблицах и производить замену одних символов на
другие. Если с таблицей работают несколько человек, вы можете настроить про-
грамму для совместной работы.
2.9.1. Автоматизация работы
Удобной возможностью программы является быстрое выполнение некото-
рых математических операций в автоматическом режиме. Если выделить ряд
ячеек, содержащих числовые значения, программа автоматически рассчитает
сумму значений в них или произведет другие действия в зависимости от наст-
ройки. Результат вычисления будет отображен в строке состояния, располо-
151
Особенности Excel, полезные бухгалтеру
Сумиа=21
Рис. 2.95.
Автоматические
вычисления
женной внизу рабочего окна программы. Введите
числа в различные ячейки таблицы. Затем выделите
эти ячейки одним из способов, описанных выше.
В строке состояния вы увидите результат вычислений
(Рис. 2.95).
По умолчанию автоматически вычисляется сумма
значений выделенных ячеек, однако вы можете выпол-
нять и другие операции. Щелкните правой кнопкой
мыши в строке состояния, чтобы открыть вспомога-
тельное меню. Это меню содержит ряд операций, ко-
торые программа может автоматически выполнять.
При необходимости вы можете быстро найти среднее
значение, узнать количество чисел или количество вы-
деленных ячеек, определить минимальную и макси-
мальную величины. Для выбора нужного действия
щелкните мышью на соответствующей команде этого
меню. При этом программа запомнит выбранную вами
операцию и в дальнейшем будет выполнять именно ее.
Чтобы сменить автоматически выполняемую опера-
цию, следует снова открыть вспомогательное меню и выбрать новую операцию
в списке.
Если при работе с таблицей вы часто выполняете одни и те же операции,
возможно, вам лучше сохранить последовательность выполнения операций в
виде макроса, а затем вызывать его для работы. Макрос представляет собой
набор команд, используемых для автоматического выполнения некоторых
операций.
Перед тем как пользоваться макросами, нужно настроить программу. По
умолчанию использование макросов запрещено, так как использование мак-
росов, полученных от других людей или из Интернета, может заразить ваш
компьютер вирусом. Но если вы создаете макрос самостоятельно, вам нечего
бояться.
Выберите команду меню Сервис :£> Параметры. Будет открыт диалог наст-
ройки, в котором щелкните мышью на ярлычке Диаграмма. Будет открыта одно-
именная вкладка диалога настройки. Щелкните мышью на ярлычке Безопас-
ность и в открывшейся вкладке нажмите кнопку Безопасность макросов. Будет
открыт диалог установки безопасности. Отметим, что если вы работаете в Excel
2000 или 2002, можно выбрать команду меню Сервис э£> Макрос 5̂ > Безопас-
ность, чтобы открыть этот диалог.
Установите переключатель в этом диалоге настройки безопасности макросов
в положение Средняя и нажмите кнопку ОК, чтобы закрыть диалог. Также нажми-
те кнопку ОК, чтобы закрыть диалог настройки. Теперь вы можете использовать
макросы, и при каждом открытии рабочей книги, в которой есть макросы, будет
появляться диалог подтверждения использования макросов.
152
Повышение эффективности работы
||М»«РОС1
Рис. 2.96.
Запись макроса
Чтобы создать макрос, нужно записать последо-
вательность выполняемых вами команд. Выберите
команду меню Сервис ^> Макрос Х£> Начать запись.
Появится диалог записи макроса (Рис. 2.96).
В поле ввода Имя макроса вы можете указать про-
извольное имя, которым будет называться макрос.
Программа предлагает вам имя автоматически, и вы
можете оставить его без изменения. Поле Сочетание
клавиш определяет комбинацию клавиш, которая бу-
дет использоваться для вызова макроса. Используется
одновременное нажатие клавиши jfcuT) и клавиши,
которую вы укажете, щелкнув мышью на поле и нажав ее на клавиатуре.
Список Сохранить в указывает место, где будет сохранен создаваемый вами
макрос. По умолчанию используется текущая рабочая книга и чаще всего менять
значение в этом списке не нужно. Однако если вы хотите, чтобы макрос можно
было использовать и с другими книгами, выберите в списке элемент Личная кни-
га макросов. Поле Описание предназначено для ввода комментария к создаваемо-
му макросу, и его заполнение не обязательно. После настроек нажмите кнопку
ОК, чтобы закрыть диалог.
Теперь вы можете выполнять различные действия в программе, и они бу-
дут запоминаться. Чтобы остановить запись макроса, нажмите кнопку Щ на
панели инструментов, которая появляется при начале записи макроса. Чтобы
выполнить макрос, нажмите на клавиатуре указанную при создании макро-
са комбинацию клавиш. Записанная последовательность действий будет вы-
полнена.
Для работы с макросами выберите команду меню Сервис ^> Макрос Х£> Ма-
кросы. Будет открыт диалог диспетчера макросов (Рис. 2.97).
В списке Имя макроса отображаются все созданные вами макросы. В списке
Находится в можно выбрать место, где искать макросы. По умолчанию в список
макросов попадают макросы, находящиеся во всех открытых в настоящее время
рабочих книгах. Выбрав макрос в списке и
нажав кнопку Удалить, вы удалите макрос, а
нажав кнопку Параметры, вы откроете диа-
лог, в котором можно изменить сочетание
клавиш для вызова макроса и текст коммен-
тария. Чтобы выполнить макрос, выберите
его в списке и нажмите кнопку Выполнить.
Диалог будет закрыт, а макрос выполнен. Для
выхода из диспетчера макросов нажмите
кнопку Отмена.
:! Макрос записан 01.08.2002 (Sergey)
Рис. 2.97.
Диспетчер макросов
153
Особенности Excel, полезные бухгалтеру
" выделение незв&гокиро ванных ячеек
'форматирование ячеек
~ форматирование столбцов
" форматирование строк
* вставку столбцов
вставку строк
' вставку ги пер ссылок
удаление столбцов
" удаление строк
Рис. 2.98.
Настройка
защиты листа
2.9.2. Защита информации
Программа Excel предоставляет вам возмож-
ность защитить информацию в таблицах путем ог-
раничения доступа к информации. Выберите ко-
манду меню Сервис :£> Защита, и будет открыто
вспомогательное меню, предлагающее варианты за-
щиты. Выберите команду Защитить лист этого ме-
ню, и будет открыт диалог настройки защиты листа
(Рис. 2.98).
Флажок в верхней части диалога управляет вклю-
чением или выключением защиты рабочего листа.
Кроме того, вы можете защитить рабочий лист с по-
мощью пароля, который необходимо ввести в соот-
ветствующем поле ввода, расположенном ниже
флажка включения защиты. Ниже расположен список действий, которые вы може-
те разрешить или запретить выполнять для заблокированного листа. С помощью
установки или сброса флажков вы можете задавать различные варианты защиты
листа, например, защиту содержимого ячеек или формул в них. Можно запретить
выделять ячейки, вставлять их или удалять. Если флажок установлен, то соответст-
вующее действие разрешено, а если флажок сброшен - действие запрещено.
После установки параметров защиты нажмите кнопку ОК, чтобы закрыть
диалоги и применить защиту рабочего листа. Если вы ввели пароль, появится ди-
алог для подтверждения пароля (Рис. 2.99).
Если вы забыли пароль, то способа узнать ваш пароль не существует, и ин-
формация в таблице для вас будет потеряна. Поэтому лучше не устанавливать па-
роль на таблицу без крайней необходимости.
Если вы работаете в Excel 2002, у вас появляется возможность защиты, отсут-
ствующая в предыдущих версиях программы. Вы можете дать разным пользова-
телям вашей таблицы разные права по использованию ячеек и диапазонов ячеек.
Выберите команду меню Сервис т& Защита Х£> Разрешить изменение диапазона,
и будет открыт соответствующий диалог (Рис. 2.100,
^̂ ^̂ ^̂ ^̂ ^̂ ^ слева).
В этом диалоге отображается список защищен-
ных диапазонов ячеек. Чтобы создать защищенный
диапазон, нажмите кнопку Создать, и будет открыт
диалог создания диапазона (Рис. 2.100, справа). В по-
ле ввода Имя укажите имя создаваемого диапазона.
А в поле ввода Ячейки укажите адреса ячеек, образую-
щих диапазон. Это можно сделать с помощью клави-
атуры, или выбрав нужный диапазон ячеек мышью.
В нижней части диалога в поле ввода следует указать
пароль для защиты диапазона.
1
енШАНИЙ Сгнхяба узнать забытый
етаует. I- . .i-viTbL
'Лей и иней •. -ir и листов
и хранить его s надежной месте. Помните, что в
паролях рвзянчаклы прошн-нир и строчные букв*.-.
Рис. 2.99.
Подтверждение
ввода пароля
154
Повышение эффективности работы
Г" вставить сведения о разрешениях в новую-книгу
Защитить лист». | М | Отиева
Рис. 2.100. Защита изменения диапазона
После определения диапазона и пароля нажмите кнопку ОК, чтобы закрыть
диалог. Будет открыт диалог для подтверждения пароля (Рис. 2.99). Введите па-
роль еще раз и нажмите кнопку ОК, чтобы закрыть диалог подтверждения. Со-
зданный защищенный диапазон появится в списке. Чтобы изменить параметры
диапазона, выберите его в списке и нажмите кнопку Изменить, а если вы хотите
удалить диапазон, нажмите кнопку Удалить. В заключение нажмите кнопку ОК,
чтобы закрыть диалог.
Рабочую книгу, как и листы можно также защитить паролем. При попытке
изменить защищенную информацию вы получите сообщение программы, что
информация защищена. Выберите команду меню Сервис :£> Защита ;£> Защи-
тить книгу, и будет открыт диалог настройки защиты (Рис. 2.101).
Группа флажков Защитить книгу определяет, какую информацию нужно
защитить. Установив флажок Структуру, вы предотвратите удаление, пере-
нос, скрытие, открытие, переименование и вставку новых листов. Если уста-
новлен флажок Окна, то запрещается перемещение, изменение размеров,
скрытие, показ и закрытие окон. Также можно ввести пароль для защиты кни-
ги. В заключение нажмите кнопку ОК, чтобы закрыть диалог настройки защи-
ты книги.
Кроме целой книги и ее отдельных листов, дополнительно вы можете за-
щитить или снять защиту с отдельных ячеек таблицы.
В программе Excel защита ячейки отнесена к одному
из элементов форматирования, поэтому и настройку
защиты ячейки следует искать в параметрах форма-
тирования. Выделите защищаемую ячейку и выбери-
те команду меню Формат Х£> Ячейки. Щелкните мы-
шью на ярлычке Защита, чтобы перейти на соответ-
ствующую вкладку (Рис. 2.102).
На этой вкладке с помощью установки и сброса
флажков можно указать, например, что при защите Рис. 2.101.
всего листа, данная ячейка может быть оставлена не- Защита книги
Защитить книгу
F структуру
Г 2К(«
Пароль (не обязателен):
Огиеи
155
Особенности Excel, полезные бухгалтеру
Защита ячеек или скрьп-це формул действуют только после защиты
листа. Для защиты листа выберите команду "Защита" в меню
'•Сервис", затеи выполните команду "Защитить ma". При этой
.>1<жнч установи пароль.
Рис. 2.102.
Защита ячеек
защищенной. Если вы установите флажок
для сокрытия формул, то они не будут ото-
бражаться при двойном щелчке на этой
ячейке. Обратите внимание, что отмена за-
щиты и сокрытие формул работают только
после защиты всего листа рабочей книги.
После настройки параметров защиты
ячейки нажмите кнопку ОК, чтобы закрыть
диалог.
2.9.3. Совместная работа
Программа Excel позволяет работать с одной рабочей книгой нескольким
пользователям. Для этого нужно разрешить совместный доступ к книге и уста-
новить права доступа для каждого пользователя. Выберите команду меню
Сервис :£> Доступ к книге. Появится диалог настройки совместного доступа
(Рис. 2.103, слева).
Если флажок в верхней части диалога сброшен, монопольное право работы
с книгой принадлежит текущему пользователю. Установив флажок, вы разреша-
ете доступ к рабочей книге и другим пользователям. Список пользователей, ко-
торые работают с данной рабочей книгой, отображается в средней части диало-
га. Выбрав пользователя и нажав кнопку Удалить, вы запрещаете пользователю
работу с книгой. Щелкните мышью на ярлыке Подробнее, чтобы перейти на со-
ответствующую вкладку диалога (Рис. 2.103, справа).
Данная вкладка служит для настройки параметров отслеживания изменений
в рабочей книге, а также настройки метода разрешения конфликтов. Переклю-
чатель Регистрация изменений используется для работы с журналом изменений
Пр»»«о | подробнее |
«к файлу
правка
Регистрация измене
Обновлять изменения
Дня противоречивых изменений
ь в личное предсга!
'. j OK ] Отмени ; [:
Рис. 2.103. Настройка совместного доступа
156
Повышение эффективности работы
в книге. Если регистрация включена, любое изменение рабочей книги фиксиру-
ется в журнале.
Группа элементов управления Обновлять изменения определяет момент,
когда необходимо обновлять изменения, внесенные разными пользователями.
Это может быть заданный интервал времени или момент, когда вы сохраняете
рабочую книгу на диске. При этом можно также выбрать, сохранять изменения
или нет.
При работе нескольких пользователей над одной рабочей книгой может
возникнуть ситуация, когда они вносят противоречивые изменения, например,
изменяют одну и ту же ячейку. Такая ситуация называется конфликтом и требу-
ет решения. Группа элементов управления Для противоречивых изменений позво-
ляет указать, как будет решаться конфликт. Либо изменения выбираются в спе-
циальном диалоге, либо оставляются изменения внесенные первым рецензен-
том. После настройки совместного доступа нажмите кнопку ОК,.чтобы закрыть
диалог.
Каждому пользователю присваивается свой цвет, и измененные им ячейки
будут иметь в левом нижнем углу треугольный маркер определенного цвета.
Если подвести указатель мыши к этому маркеру, то появится окно, содержащее
информацию о том, кто и когда сделал изменения в этой ячейке.
Вы можете увидеть все внесенные в книгу изменения, выбрав команду меню
Сервис :£> Исправления з£> Выделить исправления. Появится диалог для настрой-
ки параметров отслеживания исправлений (Рис. 2.104).
С помощью установки переключателя в верхней части диалога вы можете
включить отслеживание изменений. Три флажка и списки, расположенные
правее флажков, позволяют установить, какие изменения вы собираетесь от-
слеживать (например, по времени, по имени пользователя) или выбрать диапа-
зон ячеек.
Флажки, расположенные в нижней части диалога определяют вид отобража-
емых результатов: выделения в том же листе, или создание нового листа для из-
менений. Если вы используете для отображения
изменений отдельный лист, то можно построить в
нем список и применить к нему сортировку и
фильтры, как описано выше. После настройки па-
раметров нажмите кнопку ОК, чтобы закрыть
диалог.
Вы можете принять или отклонить изменения
в рабочей книге, не дожидаясь наступления вре-
мени сохранения исправлений. В произвольный
момент времени выберите команду меню Сервис
^> Исправления :£> Принять/Отклонить исправ-
ления. Появится диалог настройки, элементы уп-
равления которого дублируют элементы в диалоге
настройки параметров отслеживания изменений
Г^Щтйехивать'ишравпеняя (KHIT
исправления, внесенные;
Р" по времени;
Г" пользователем
Г вдизтонг.
I** Вмде.'Ьпь исправления ни зкроне
; . . . . . . . . . . . . .
Рис. 2.104.
Настройка параметров
отслеживания
исправлений
157
Особенности Excel, полезные бухгалтеру
(Рис. 2.104). После установки параметров нажмите кнопку ОК, чтобы закрыть
диалог. Будет произведен поиск исправлений в рабочей книге, и на каждое най-
денное исправление появится диалог, предлагающий или принять, или откло-
нить его.
2.9.4. Примечания и прочие средства
повышения эффективности
Примечание представляет собой какие-либо замечания, относящиеся к
ячейке и хранящиеся независимо от содержимого этой ячейки. Примечания
удобны для напоминания о чем-либо самому себе, например, о принципе рабо-
ты сложной формулы, а также для добавления отзывов в книги других пользо-
вателей.
Чтобы добавить примечание к какой-либо ячейке, выделите ее и затем выбе-
рите команду меню Вставка з£> Примечание. Правее ячейки появится рамка для
ввода текста примечания (Рис. 2.105).
Введите текст примечания и, чтобы завершить ввод, щелкните мышью вне
рамки выделения замечания. Так можно добавить примечания к разным ячейкам
таблицы. Ячейки с примечаниями помечаются треугольником в правом верхнем
углу. При наведении указателя на ячейку, помеченную таким образом, отобража-
ется примечание. Также с примечаниями можно работать, используя панель ин-
струментов Рецензирование. Чтобы отобразить эту панель, выберите команду ме-
ню Вид ^> Панели инструментов :£> Рецензирование.
Чтобы изменить примечание, выделите ячейку,
в которой есть примечание и нажмите кнопку [3j| на
панели инструментов. Примечание будет отображе-
но рядом с ячейкой, и вы можете внести в него
2"-1 ^Sergey:
з" ~ ~
"5
Здесь нужно вставить
формулу. исправления. Нажмите кнопку |*g для перехода
к следующему замечанию, а чтобы вернугься к пре-
дыдущему замечанию, нажмите кнопку fej. Чтобы
Рис. 2.105. отобразить все замечания на листе таблицы, нажми -
Вставка примечания те кнопку f|j^. Если требуется удалить примечание,
выберите ячейку, в которой оно содержится, и нажми-
те кнопку У^Э. а для того чтобы скрыть примечание, нажмите кнопку LXpl
Отметим, что примечания различаются по именам пользователей, поэтому
всегда можно сказать, кто ввел какое-либо примечание в общей книге или в кни-
ге, последовательно рецензированной несколькими пользователями.
Программа может автоматически исправлять типичные ошибки, проводя за-
мену одних символов на другие. Чтобы настроить автоматическую замену, выбе-
рите команду меню Сервис ^> Параметры автозамены. В некоторых версиях
программы команда называется Автозамена. В любом случае, после выбора ко-
манды появится диалог настройки. В Excel 97 и 2000 в этом диалоге только одна
158
Повышение эффективности работы
Автозамена | датофармаг ^Р" вводе j Сиаргчеги j
(V ПОКР-. . i сманены
Р' Исправлять ДВе ПРрлисиые буквы в начале слова
р' Делать первые буквы предложений прописными
р" Вазаэнад дней с прописной бумы
F" Устранять последствия сиучэйкиг^ нажагйя CAPS LOCK
f7 Заменять при вводе
1 заменять: на:
Ли:. Z/06.
Настройка автозамены
вкладка, а в Excel 2002 в этом диалоге нахо-
дятся несколько вкладок, но выбранной
будет вкладка Автозамена (Рис. 2.106).
С помощью установки и сброса флаж-
ков вы устанавливаете, какие правила за-
мены следует использовать. Можно заме-
нять две прописные буквы в начале слова
на одну прописную букву, делать первые
буквы предложений прописными, устано-
вить, чтобы названия дней также начина-
лись с прописной буквы и так далее.
Кроме применения правил русского
языка, можно указать часто встречающие-
ся синтаксические ошибки при вводе. Ус-
тановите флажок Заменять при вводе, и
станет доступным список часто встречающихся ошибок и, соответственно, пра-
вильно написанных слов, например, блондин — блондин.
Если у вас при вводе текста с клавиатуры есть характерные ошибки, вы мо-
жете добавлять свои собственные слова и сочетания символов, которые требу-
ют замены. Часто ошибки делаются не из-за того, что вы не знаете, как пра-
вильно пишется слово, а просто в спешке или по невнимательности вы нажи-
маете не те клавиши на клавиатуре, например, вместо слова кнопка, вы вводите
слово кнокпа.
Щелкните мышью на поле ввода Заменить и введите слово, которое являет-
ся неправильным, например кнокпа. Теперь в поле На введите правильный вари-
ант, например, кнопка. Теперь следует нажать кнопку Добавить, чтобы наши но-
вые правила замены попали в список. Если вы не хотите, чтобы какое-либо пра-
вило автозамены применялось в дальнейшем, выберите его в списке и нажмите
кнопку Удалить.
Можно настроить исключения из правил, при которых автозамена произво-
диться не будет. Для этого нажмите кнопку Исключения, и будет открыт диалог
настройки. Щелкните мышью на ярлычке Первая буква, и вы перейдете на соот-
ветствующую вкладку диалога (Рис. 2.107, слева).
На этой вкладке можно указать сокращения с точкой, после которых не нуж-
но писать слово с большой буквы. Например, после сокращений руб. и коп. не
нужно начинать новое предложение. Чтобы добавить новое сокращение, введи-
те его в поле ввода и нажмите кнопку Добавить. Если вы хотите удалить сокра-
щение из списка, выберите его и нажмите кнопку Удалить.
Щелкните мышью на ярлычке Две прописные, чтобы перейти на следующую
вкладку диалога настройки исключений (Рис. 2.107, справа). На этой вкладке вы
можете указать, какие слова и словосочетания должны содержать несколько про-
писных букв и их не нужно исправлять при вводе. Чаще всего это бывают различ-
ные сокращения или аббревиатуры. Чтобы добавить слово или словосочетание в
159
Особенности Excel, полезные бухгалтеру
Первая букев | две приписные J
не заменять прописной буквой после:
первая буква Две ПРопишые
Рис. 2.107. Настройка исключений
список, введите его в поле ввода и нажмите кнопку Добавить. Чтобы удалить сло-
во из списка, выберите его и нажмите кнопку Удалить. После того, как исключе-
ния настроены, нажмите кнопку ОК, чтобы закрыть диалог и вернуться к диалогу
настройки автозамены.
Средства автозамены не могут обнаружить и исправить все синтаксические
ошибки, которые вы будете допускать при составлении таблицы. В программе
Excel есть средство проверки орфографии для тщательной проверки вводимой
информации. Выберите команду меню Сервис з£> Орфография, и начнется про-
верка всей таблицы. Если будет найдено слово с ошибками, появится диалог
проверки (Рис. 2.108).
В поле ввода Нет в словаре отображается слово, которое программа считает
ошибочным. Ниже расположен список Варианты, в котором вам предлагаются
похожие слова, которые имеются в словаре. Слово, которое,,по мнению про-
граммы, наиболее подходит для замены, стоит первым в списке. Однако вы мо-
жете выбрать другое слово в списке или ввести новое слово. Чтобы ввести новое
слово, щелкните мышью на поле ввода Нет в словаре и исправьте ошибочное
слово. Ели вы хотите, чтобы исправленное вами слово было помещено в словарь
и в дальнейшем предлагалось как ва-
риант исправления ошибки, нажмите
кнопку Добавить в словарь.
Если вы нажмете кнопку Заме-
нить, ошибочное слово будет замене-
но, а если нажать кнопку Заменить
все, то в тексте все такие же слова, как
текущее, будут автоматически замене-
ны. Чтобы пропустить ошибочное сло-
во, нажмите кнопку Пропустить, и
программа его проигнорирует. Нажа-
тие кнопки Пропустить все приводит
к тому, что если данное ошибочное
[русский (Росси
Рис. 2.1 OS.
Ошибка при проверке орфографии слово встретится еще раз, оно будет
160
Повышение эффективности работы
Орфография
1 ь г опыта из основного словаря
Г" пропускать слова из ПРОПИСНЫЕ букв
р1 лропуояпъ сады С цифрами -.
Р" пропускать адресе Интернета и' имена файлов
Рис. 2.109.
Настройка параметров
проверки орфографии
проигнорировано. Если вы хоти-
те, чтобы программа сама испра-
вила все ошибки, нажмите кнопку
Автозамена.
Если вы используете русскую
версию Windows, программа счи-
тает, что по умолчанию информа-
ция в ячейках набрана на русском
языке. Если в таблице встретятся
слова, набранные латинскими
буквами, программа будет считать
это ошибкой. Чтобы изменить
язык проверки, его нужно вы-
брать в списке Язык словаря. По-
сле исправления ошибочного сло-
ва или его игнорирования, программа продолжит проверку таблицы. Чтобы пре-
кратить проверку, нажмите кнопку Отмена. Проверка будет остановлена, а диа-
лог закрыт. Чтобы настроить параметры проверки орфографии, нужно во время
появления диалога проверки нажать кнопку Параметры. Будет открыт диалог
настройки (Рис. 2.109).
В открывающемся списке Язык словаря можно выбрать один из доступных
языков для проверки орфографии, который будет использоваться по умолчанию.
Список, расположенный ниже, предназначен для выбора словаря, в который по
команде Добавить в словарь будут добавляться неизвестные слова. С помощью
установки переключателей в левой части диалога вы можете включить или вы-
ключить проверку слов, которые написаны правильно, но являются ошибочны-
ми с точки зрения грамматики. К таким словам относятся имена, названия, ад-
реса в Интернете и так далее.
Правая часть диалога посвящена особенностям грамматики некоторых язы-
ков, и при проверке русскоязычных документов не используется. Нажав кнопку
Параметры автозамены, вы откроете диалог настройки, который рассмотрен
выше. Нажмите кнопку ОК, чтобы закрыть диалог настройки параметров и вер-
нуться к проверке орфографии.
При работе с книгой бывает непросто найти нужную информацию в ячей-
ках. Чтобы облегчить вам решение этой задачи, в программе есть встроенные
средства поиска. Выберите команду меню Правка з£> Найти, и будет открыт
диалог настройки параметров поиска. В диалоге есть две вкладки. Замену мы
рассмотрим ниже, поэтому сейчас щелкните мышью на ярлычке Поиск, что-
бы перейти на соответствующую вкладку. Чтобы увидеть все настройки данно-
го диалога, нажмите кнопку Параметры, и внешний вид диалога изменится
(Рис. 2.110).
Поле ввода Найти используется для указания слова или части слова, которое
нужно найти. При этом, нажав кнопку >• в правой части этого поля, вы открое-
161
6-5458
Особенности Excel, полезные бухгалтеру
Hag™ i замени̂  }
Найтц: |
Метать: [на листе
Пр(ХЕ^трнавгь: |™ строкам
Офйсть поиста; ^формулы
'
3 | Фо^и.»*»* 1
v | Г" Учитывать регистр
-П" Г Ячейка иелмюи
"3
найти а« | {найти даам
•Ч.Н.1... -|
V! « j
~| Закрыть ]
Рис. 2.110.
Настройка поиска
те список фраз, поиск которых осуще-
ствлялся ранее, и сможете выбрать нуж-
ную для повторного поиска. Список Ис-
кать определяет, где будет производить-
ся поиск: в текущем листе или во всей
рабочей книге. Отметим, что данное по-
ле есть только в программе Excel 2002,
в предыдущих версиях программы по-
иск идет только по текущему листу.
Открывающиеся списки Просмат-
ривать и Область поиска конкретизиру-
ют параметры поиска, в частности задают направление просмотра листов и оп-
ределяют тип искомой информации — формулы, значения ячеек или примеча-
ния. Если установлен флажок Учитывать регистр, то при поиске будет важно,
какими буквами, строчными или прописными, набрана искомая фраза. Если
установить флажок Целиком, будет искаться точное совпадение фразы. В про-
тивном случае будут найдены все ячейки, содержащие искомую фразу как часть
содержимого ячейки.
В Excel 2002 можно искать не только данные в ячейках, но и элементы
оформления ячеек. Про оформление ячеек вы узнаете ниже, а пока отметим, что,
нажав кнопку Формат, вы откроете диалог настройки, в котором уточняется, ка-
кие элементы оформления ячеек нужно найти. В версиях Excel 97 и 2000 такой
возможности нет.
Чтобы начать поиск, следует ввести текст в поле Найти, выбрать направле-
ние в списке Просматривать, потом нажать кнопку Найти этого диалога. В ре-
зультате поиска ячейка, содержащая нужные данные, станет активной. Можно
продолжить поиск, нажав кнопку Найти далее.
Если нужно найти все ячейки, в которых есть нужная информация, введи-
те информацию для поиска и нажмите кнопку Найти все. Будет осуществ-
лен поиск, и в нижней части диалога появится список ячеек с их адресами
и информацией в них. Выбрав ячейку в списке, вы сделаете ее активной. Что-
бы окончить поиск, нажмите кнопку Закрыть.
Кроме поиска информации в ячей-
ках, программа может производить и ее
замену. Щелкните мышью на ярлычке
Заменить диалога поиска. Будет откры-
та вкладка замены (Рис. 2.111).
Появившийся диалог является мо-
дификацией только что рассмотренно-
го диалога настройки поиска. В поле
Найти вы указываете строку для поис-
ка, а в поле Заменить на нужно указать
строку, на которую будет заменена
Искать:
Flpoci.Wf ривлты jno crpoi
Обчасгь поиска: [форму;
Заменить ё£ч j
Рис. 2.111.
Настройка замены
162
Повышение эффективности работы
* * Обычный поиск
Искать:
Текст:
[ Найти | \ й
(0 Подсказки..
Другие параметры г
Область поиска:
Выбранные размещения
Типы файлов результатов:
Выбранные типы файлов
Быстрый поиск отключен
Параметры поиска...
Расширенный поиск
Найти в документе,..
Рис. 2.112.
Панель задач
для поиска
найденная строка. Нажав кнопку ; •*£: в правой части
этих полей, вы откроете список фраз и строк, поиск
которых осуществлялся ранее для замены. Осталь-
ные элементы управления совпадают с элементами,
рассмотренными в диалоге настройки поиска. Чтобы
заменить информацию в ячейках, нажмите кнопку
Заменить. Будет найдено первое вхождение искомой
строки и произведена замена. Чтобы провести гло-
бальную замену информации во всей таблице, на-
жмите кнопку Заменить все. По окончании поиска
или замены нажмите кнопку Закрыть, чтобы завер-
шить поиск и закрыть диалог.
Если вы используете Excel 2002, кроме поиска в
рабочей книге, можно искать информацию и в других
файлах. Для этого используется панель задач. Если эта
панель не отображается в правой части окна програм-
мы, выберите команду меню Вид Х£> Область задач,
чтобы отобразить ее. Нажмите кнопку ж в правом
верхнем углу панели, и будет открыто вспомогательное меню. В этом меню вы-
берите команду Поиск, и вид панели задач изменится (Рис. 2.112).
Элементы управления в этой панели используются для поиска информации
по всем папкам и файлам вашего компьютера. Группа элементов управления Ис-
кать содержит поле Текст, используемое для ввода фразы, которую нужно най-
ти, а также кнопки Поиск и Восстановить, соответственно для начала и отмены
поиска. Получить подсказку о поиске информации вы можете, если щелкните
мышью на ссылке Советы для поиска.
Группа элементов управления Другие параметры поиска позволяет с помо-t
щью списков Область поиска и Типы файлов результатов выбрать место для по-
иска на дисках вашего компьютера, а также конкретизировать, в каких типах
файлов нужно искать. Чтобы начать поиск, введите фразу в поле Текст и на-
жмите кнопку Найти. Результаты поиска будут отображены в панели задач в
виде ссылок на документы. Щелкнув мышью на ссылке, вы загрузите документ
в программу или запустите другую программу для работы с этим типом доку-
ментов.
Если вам нужно искать информацию в текущей рабочей книге, среди рабо-
чих листов, следует выбрать ссылку Найти в документе. Появится диалог для на-
стройки поиска, рассмотренный выше.
Если при работе с листом рабочей книги вам постоянно приходится после
открытия книги скрывать одни и те же строки и столбцы, удобно использовать
представления. Представление — это вид таблицы, который вы настраиваете по
своему вкусу. Перед тем, как создавать представление, создайте таблицу и офор-
мите ее как вам нужно. Далее выберите команду меню Вид Xt> Представления.
Будет открыт диалог настройки представлений (Рис. 2.113, слева).
163
Особенности Excel, полезные бухгалтеру
Рис. 2.113. Создание представлений
В левой части диалога располагается список созданных представлений.
Чтобы создать новое представление, нажмите кнопку Добавить, и будет открыт
диалог добавления (Рис. 2.113, справа). В поле Имя нужно указать название со-
здаваемого представления, которое будет отображено в списке. Группа флаж-
ков Включить в представление определяет, какие параметры форматирования
включать в представление. Отметим, что представления хранят не только пара-
метры печати и информацию о том, какие строки и столбцы нужно скрывать,
но и установки высоты строк и ширины столбцов, размеров окна, расположе-
ния панелей и выделения диапазонов. После установки параметров нажмите
кнопку ОК, чтобы закрыть диалог и создать представление, которое появится
в списке.
Представление - это как бы снимок с оформления таблицы, каким оно бы-
ло в момент создания представления. После того как представление создано, вы
можете менять оформление таблицы как вам нужно, не боясь потерять исходное
оформление. Чтобы вернуться к исходному оформлению таблицы, откройте ди-
алог представлений, выберите нужное представление в списке и нажмите кноп-
ку Применить. Диалог будет закрыт, и оформление таблицы вернется к тому,
которое было на момент создания представления.
Во время описания возможностей программы мы уже несколько раз упоми-
нали о том, что для выполнения некоторых действий в программе нужно уста-
новить пакет анализа. Теперь давайте рассмотрим, а для чего же предназначен
этот пакет. Пакет анализа - это набор средств анализа данных, предназначен-
ный для решения сложных статистических и инженерных задач. Для проведе-
ния анализа в ячейках таблицы вы указываете входные данные, а в диалогах на-
стройки указываете параметры анализа. Анализ проводится с помощью нужной
статистической или инженерной функции, а результат будет помещен в выход-
ной диапазон.
Чтобы воспользоваться пакетом анализа, выберите команду меню Сервис :£>
Анализ данных. Если данной команды в меню нет, значит пакет анализа не уста-
новлен. Чтобы установить этот пакет, выберите команду меню Сервис :£> Над-
стройки, в появившемся диалоге установите флажок у элемента Пакет анализа
и закройте диалог, нажав кнопку ОК. Теперь еще раз выберите команду меню
Сервис ^> Анализ данных. Будет открыт диалог для выбора инструмента анализа
(Рис. 2.114, слева).
164
Повышение эффективности работы
инструменты шали» | пк | |;
• Описательная статистика * j *" — 1.1— J j;
Экспоненциальное стэживзние " Отмене j |;
Двухвыборочный F-тесг для дисперсии
Анализ Фурье j [!
Гистограмма '£' '--'..-SSS&J f
. Скользящее среднее
. Ранги переентиль
Регрессия -.--.;,' 'I
;'Вя.дныеданные -•• • •"• '
' Вводной интервал: J
- Г" Метки
, Метод выборки . . . .
f Периодический
1
; Период: j
j \ <* Случайна
Числе выборок: j
. Параметры кывода
; <" Вмходной йнгереая: J 3
\ <* Новый рабочий аист: j
• С Новая рабочая книга
Рис. 2.114. Настройка анализа данных
В левой части диалога располагается список инструментов для проведения
анализа. Бухгалтеру в большей степени может быть интересен статистический
анализ, инструменты которого также есть в списке. Выберите инструмент и на-
жмите кнопку ОК, чтобы закрыть диалог. Будет открыт диалог настройки выбран-
ного инструмента анализа (Рис. 2.114, справа). Обычно в этом диалоге следует
указать, какие ячейки используются в качестве исходных данных, а также указать
параметры выбранного инструмента анализа. После настройки параметров на-
жмите кнопку ОК, чтобы закрыть диалог. Начнется выполнение анализа, по окон-
чании которого будет создан новый лист Excel, отображающий результаты.
В заключение кратко рассмотрим, какие инструменты анализа есть в про-
грамме. Однофакторный дисперсионный анализ, используется для проверки гипо-
тезы о сходстве средних значений двух или более выборок данных. Двухфактор-
ный дисперсионный анализ представляет собой более сложный вариант однофак-
торного анализа с несколькими выборками для каждой группы данных. Корре-
ляционный анализ применяется для количественной оценки взаимосвязи двух
наборов данных. Ковариационный анализ является мерой связи между двумя ди-
апазонами данных и используется для вычисления среднего произведения от-
клонений точек данных от средних значений. Описательная статистика слу-
жит для создания одномерного статистического отчета, содержащего информа-
цию о центральной тенденции и изменчивости входных данных. Экспоненциаль-
ное сглаживание применяется для предсказания значения на основе прогноза
для предыдущего периода, скорректированного с учетом погрешностей в этом
прогнозе.
Двухвыборочный f-mecm применяется для сравнения дисперсий двух гене-
ральных совокупностей. Анализ Фурье предназначается для решения задач анали-
за периодических данных на основе метода быстрого преобразования Фурье. Ги-
стограмма используется для вычисления выборочных и суммарных частот попа-
дания данных в указанные интервалы значений. Скользящее среднее использует-
ся для расчета значений в прогнозируемом периоде на основе среднего значения
переменной для указанного числа предшествующих периодов. Генерация случай-
ных чисел используется для заполнения диапазона случайными числами, извле-
165
Особенности Excel, полезные бухгалтеру
ченными из одного или нескольких распределений. Ранг и персентилъ использу-
ется для вывода таблицы, содержащей порядковый и процентный ранги для каж-
дого значения в наборе данных.
Линейный регрессионный анализ заключается в подборе графика для набора
наблюдений с помощью метода наименьших квадратов. Выборка извлекает часть
данных из целого набора данных. Двухвыборочный t-mecm с одинаковыми диспер-
сиями служит для проверки гипотезы о равенстве средних для двух выборок.
Двухвыборочный t-mecm с разными дисперсиями используется для проверки гипо-
тезы о равенстве средних для двух выборок данных из разных наборов данных.
Парный двухвыборочный t-mecm для средних используется для проверки гипотезы
о различии средних для двух выборок данных. Двухвыборочный z-mecm для сред-
них с известными дисперсиями используется для проверки гипотезы о различии
между средними двух генеральных совокупностей.
ГЛАВА 3.
ПРИМЕРЫ ИСПОЛЬЗОВАНИЯ EXCEL
В БУХГАЛТЕРИИ
В этой главе подробно рассмотрены различные примеры использования
Excel в бухгалтерии. Известно, что лучше изучать приемы работы с программой
на примерах, и бухгалтеру понятнее примеры из его профессиональной области.
Кроме того, многие примеры являются законченными проектами, которые мож-
но использовать в повседневной работе бухгалтера. Вы также можете использо-
вать некоторые приемы или фрагменты для создания своих электронных таблиц,
например, добавить в них автоматический вывод суммы прописью.
3.1. Бухгалтерские бланки и отдельные расчеты
Часто бухгалтер для ведения учета использует специализированную про-
грамму и не выполняет сложные расчеты в Excel. Однако даже в этом случае
Excel может оказаться чрезвычайно полезным, так как с его помощью можно вы-
полнять простые, но нужные расчеты, а также оформлять таблицы, чтобы они
были похожи на стандартные бланки.
3.1.1. Оформление стандартных бухгалтерских бланков
Хотя Excel позволяет создать практически любой бланк, это может потребо-
вать достаточно больших усилий. Перед тем, как приступить к созданию любого
167
Примеры использования Excel в бухгалтерии
бланка, нужно проверить, не можете ли вы достать готовую таблицу с нужным
бланком. Проще всего это сделать с помощью одной из информационно-спра-
вочных систем или Интернета.
Используемые бухгалтерами информационно-справочные системы, такие
как Консультант, Гарант и тому подобные, имеют в своем составе бланки доку-
ментов в формате Excel. Найдя соответствующую ссылку в системе, вы откроете
в Excel нужную таблицу. Сохраните ее в любом файле, и у вас уже есть готовый
бланк. Данный способ самый быстрый и удобный, хотя этими бланками не очень
удобно пользоваться, так как таблицы в справочных системах разрабатывались в
большей степени для точного соответствия оригиналу, а не для расчетов. Хотя,
естественно, расчетные формулы также можно использовать. Кстати, в Интер-
нете по адресу www.consultant.ru/Online расположены информационные базы, в
том числе в бесплатном круглосуточном доступе имеется база Консуль-
тантПлюс:НалогиБухучет. Вы можете получить большинство необходимых доку-
ментов, обратившись к этой базе.
Если вы не нашли нужный бланк, или у вас нет нужной справочной систе-
мы, можно попробовать найти бланк в Интернете. Это достаточно непростое за-
нятие, но при некотором умении в Интернете можно найти почти все. Вначале
попробуйте найти бланк на сайте Министерства по налогам и сборам по адресу
www.nalog.ru. Если на этом сайте нужного бланка нет, попытайтесь найти его на
одном из бухгалтерских сайтов, например buhgalte.ru, www.buhgalteria.ru, audit-
it.ru, www.blanki.ru, buhpages.aiq.ru, www.vb.spb.ru или на каком-то другом.
Далее можно попытаться найти нужную форму, выполнив поиск с помощью
встроенных средств обозревателя Internet Explorer, которые используют для по-
иска системы Яндекс, Рамблер и Апорт. Можно попытаться найти нужную ин-
формацию также с помощью каталогов, собирающих информацию о популяр-
ных сайтах. Наиболее популярные каталоги расположены по адресам toplOO.ram-
bler.ru, dir.spylig.ru и top.mail.ru/Rating.
Наконец, может быть, вы найдете нужный бланк среди шаблонов Excel. Вы-
берите команду Файл з£> Создать и выберите среди шаблонов Финансовые шабло-
ны для Excel 2002 или один из шаблонов на вкладке Решения для Excel 2000 и 97.
Будет создана новая рабочая книга с несколькими листами, каждый из которых
является бланком какого-то документа. Однако большинство бланков устарело,
так что не стоит слишком рассчитывать на то, что вы сможете воспользоваться
шаблонами Excel.
Если вы все же не нашли нужный бланк, а он вам нужен, придется самосто-
ятельно его оформить. В принципе, это не такая сложна процедура, просто не-
сколько утомительная. Вкратце опишем оформление бланка на примере второй
страницы формы № Т-51гто есть последней страницы расчетной ведомости.
Для ввода и оформления нужно взять готовый напечатанный на бумаге
бланк и создать свой, похожий на стандартный. Вначале нужно ввести в ячейки
все нужные слова. Так как в расчетной ведомости все столбцы пронумерованы,
вначале введем эти номера. В заголовке таблицы перед номерами может распо-
168
Бухгалтерские бланки и отдельные расчеты
Рис. 3,1. Ввод слов в нужные ячейки
лагаться от одной до трех ячеек заголовка. Поэтому вводим номера в четвертую
строку, в ячейки с А4 до R4. После этого нужно ввести все заголовки верхнего
уровня в первую строку. При этом следует ориентироваться на номера столбцов.
Например, в первые шесть ячеек, с Al no F1, вводятся соответствующие назва-
ния, но следующее название вводится не в седьмой столбец, а в восьмой. Это
объясняется тем, что заголовок Отработано дней (часов) объединяет столбцы с
номерами 6 и 7. Следующий заголовок, Начислено, руб. объединяет пять столб-
цов, начиная с восьмого. Соответственно, следующий заголовок, Удержано и за-
чтено, руб., нужно ввести в ячейку Ml. После того, как вы ввели информацию в
первую строку, нужно ввести подзаголовки во вторую и третью строки. При этом
третью строку нужно использовать только там, где есть заголовок в первой и вто-
рой строках. В итоге вы получите примерно такую таблицу (Рис. 3.1). Возможно,
у вас она не поместилась полностью на экране, и для перехода к нужной ячейке
нужно воспользоваться полосой прокрутки.
Обратите внимание, что большинство названий не помещаются в ячейки и
скрыты следующими названиями. На этом этапе данная ситуация вполне нор-
мальна. Не надо пытаться изменить размеры ячеек или поменять шрифт. Этим
мы займемся дальше.
В случае, когда вы хотите оформить более сложный бланк, ввод текста в
нужные ячейки может занять много времени, причем вы обязательно допустите
ошибки. Именно по этой причине мы не рекомендуем самостоятельно создавать
сложные бланки. В случае крайней необходимости можно сосканировать бланк
и распознать его специальной программой, например FineReader. Даже если
оформление будет неверным, вы можете взять текст, и, перенося его с помощью
буфера обмена, вставить в нужные ячейки таблицы.
После ввода текста, нужно его отформатировать. Вначале выделите все вве-
денные ячейки и выберите шрифт Times New Roman размера 8, а также выберите
выравнивание по центру, нажав кнопку ^Ё. на панели форматирования. Мы сде-
лаем в заголовке достаточно мелкие надписи. Далее объедините ячейки там, где
это необходимо. Например, нужно объединить ячейки с А1 по А?. Выделите их и
нажмите кнопку [ни] на панели форматирования. Аналогично объедините ячей-
ки в следующем столбце и так далее. Столбцы Fn G объединяются иначе. Нуж-
но объединить ячейки F1 и G1, после чего объединить вместе F2 и F3, а также G2
и G3. Далее объедините в единое целое ячейки с HI no L1, и так далее.
После того, как все нужные объединения выполнены, выделите первые три
строки и выберите команду меню Формат >£> Ячейки. Появится диалог настрой-
ки формата, в котором перейдите на вкладку Выравнивание. Установите флажок
169
Примеры использования Excel в бухгалтерии
Рис. 3.2. Предварительное форматирование
переносить по словам и в списке вертикального выравнивания выберите по цент-
ру. После перейдите на вкладку Границы и выберите внешние и внутренние гра-
ницы ячеек, установив среднюю толщину линий, после чего нажмите кнопку
ОК. В результате вы должны получить примерно такой внешний вид заголовка
таблицы (Рис. 3.2).
Перед тем, как подбирать нужные размеры строк и столбцов, нужно повер-
нуть на 90 градусов некоторые надписи в заголовке. Выделите ячейки НЗ и 13,
после чего выберите команду меню Формат з£> Ячейки. В появившемся диалоге
снова перейдите на вкладку Выравнивание и в поле угла поворота введите 90, по-
сле чего нажмите кнопку ОК. Надписи в выделенных ячейках теперь будут рас-
положены вертикально, а не горизонтально.
После того, как все ячейки заполнены и выбраны правильные форматы,
нужно задать размеры ячеек. Перетащите мышью границы столбцов, ориентиру-
ясь на соотношение столбцов в оригинале и на размеры надписей в заголовках.
Возможно, вам потребуется изменить и высоту строк. В конце работы можно вы-
делить строки под заголовком и также выбрать для них границы из линий сред-
ней толщины. Чтобы посмотреть, что у вас получилось, выберите команду меню
Вид ^> Разметка страницы. Вы увидите бланк с учетом того, как он будет распе-
чатан на принтере (Рис. 3.3).
Если некоторые столбцы у вас попали не на ту страницу, измените шири-
ну столбцов. Вы также можете изменить поля страницы, выбрав команду ме-
ню Файл ^> Параметры страницы и настроив размеры полей в появившемся
диалоге. Для возврата к прежнему виду выберите команду меню Вид з£> Обыч-
ный. Возможно, вам больше нравится вертикальное выравнивание не по цен-
тру, а по верхней границе. Можете выделить ячейки в заголовке и изменить
выравнивание, как это делалось ранее. В конце работы можно выделить ячей-
ки бланка, расположенные ниже заголовка, и выбрать шрифт, отличающийся
— * *£Г
Ртп
—JEST
_ _.
и тент* икхщ (ив п̂  ааЩ
1 № î Er
™
^ТР1
SS
зци Ifl
т
„, -г- ,™
Рис. 3.3. Разметка страницы
170
Бухгалтерские бланки и отдельные расчеты
от шрифта в заголовке. Если вы хотите добавить текст 2-я страница формы
№ Т-51 в верхний правый угол формы, вставьте строку перед первой строкой
таблицы и введите текст в нужное поле. Так можно добавить и подписи в ниж-
ней части формы. Под конец необходимо сохранить созданный бланк доку-
мента в файле.
Аналогично вы можете оформить любой нужный бланк. Следует только при-
держиваться верного порядка: вначале вводите текст, после этого меняете фор-
мат, объединяете ячейки и задаете границы, и, наконец, выбираете ширину
столбцов и высоту строк.
3.1.2. Использование программы печати суммы прописью
В бухгалтерских документах очень часто возникает необходимость ввода
суммы прописью. Эта операция отнимает лишнее время и отвлекает от более
важных дел. При использовании Excel достаточно легко автоматизировать пе-
чать суммы прописью, и мы предлагаем вашему вниманию два варианта выпол-
нения этой операции. Лучше всего подключить к Excel дополнительную про-
грамму, работающую как обычная функция. Введя в ячейку электронной табли-
цы формулу с использованием этой функции, вы вставите в данную ячейку сум-
му прописью, причем сумма будет определяться на основании информации из
другой ячейки, в которой выведена сумма числами.
Чтобы подключить программу печати суммы прописью, нужно выполнить
несколько несложных действий. Вначале включите возможность выполнения
макросов, то есть программ, разработанных для использования в Excel. При этом
следует помнить, что включение выполнения макросов может создать потенци-
альную угрозу безопасности, если вы откроете таблицу Excel, созданную злоумы-
шленником. Если вы работаете с версией Excel 2002, входящей в состав пакета
программ Microsoft Office XP, нужно выбрать команду меню Сервис, после чего
выбрать во вложенном меню команду Параметры. Появится диалог настройки с
множеством вкладок. Перейдите на вкладку Безопасность, и нажмите кнопку Бе-
зопасность макросов. Будет открыт диалог настройки безопасности. С помощью
переключателя установите низкий уровень безопасности, чтобы выполнялись
все макросы. Далее закройте оба диалога, нажимая кнопки ОК. В Excel 2000 для
вызова такого же диалога нужно выбрать команду меню Сервис :а£> Макрос Х£>
Безопасность. Выберите низкий уровень безопасности и закройте диалог, нажав
кнопку ОК. Если же вы используете Excel 97, выберите команду меню Сервис :£>
Параметры. В диалоге настройки перейдите на вкладку Общие и снимите фла-
жок Защита от макровирусов. Отметим, что если вы не снимите защиту от мак-
ровирусов в Excel 97 или установите средний уровень безопасности в других вер-
сиях, при запуске программы вам будет задан вопрос, хотите ли вы выполнять
макросы. Чтобы работать с программой печати суммы прописью, вы должны
разрешить выполнение макросов.
171
Примеры использования Excel в бухгалтерии
Далее нужно переписать из Интернета таблицу Excel с программой печати
прописью. Введите в обозревателе Интернета адрес http://www.glavbukh.ru/soft/
sum.prop.xk и перепишите на свой компьютер нужный файл. Если у вас возникли
проблемы при получении программы, напишите авторам книги по адресу super-
book@nm.ru. После того, как вы получите файл, его нужно поместить в папку ав-
тозапуска Excel. Эта папка называется XLStart, и находится она в папке, в которой
установлен пакет программ Microsoft Office. Найдите папку Program Hies. Скорее
всего, она расположена на диске С вашего компьютера. В этой папке найдите
папку Microsoft Office, а в ней папку Office 10 или Office, в зависимости от версии
Excel. Возможно, названия папок будут немного другими, но в любом случае, в
последней папке должна находиться папка XLStart. Поместите полученный файл
sum.prop.xk в эту папку. Теперь при каждом запуске Excel будет открываться табли-
ца, в которой располагается программа печати суммы прописью.
Далее можно использовать программу в любой таблице Excel. Запустите Excel,
и в первую ячейку второй строки введите формулу =СуммаПрописью(А1). Так как
в ячейке А1 нет никакого числа, результатом вычисления будет Ноль рублей 00 ко-
пеек. Введите в первую ячейку число, например, 412202,31. В результате вычисле-
ний вы увидите строку Четыреста двенадцать тысяч двести два рубля 31 копейка.
Введите другое число, и результат снова изменится. Аналогично вы можете встав-
лять сумму прописью в любые таблицы. Также доступной стала еще одна функция.
Введите в любую ячейку формулу =ЧислоПрописью(А1), и вы увидите в этой ячей-
ке результат — четыреста двенадцать тысяч двести два. То есть, первая буква ос-
талась строчной, и отсутствуют названия денежных единиц в конце строки.
Как и любую другую функцию, печать суммы прописью можно вставить с
помощью мастера функций. Щелкните мышью на пустой ячейке, в которую вы
хотите вставить сумму прописью. Для вызова мастера функций при работе с
Excel 2002 нажмите кнопку ж, расположенную справа от кнопки J]
в панели инструментов, и в появившемся списке выберите Другие
функции. Также можно нажать кнопку fx, расположенную в левой части
строки формул. В предыдущих версиях Excel нужно нажать кнопку
fx, расположенную на панели инструментов или такую же кнопку в левой час-
ти строки формул. В любом случае будет запущен мастер функций и на экране
появится его первый диалог.
В открытом диалоге вы должны выбрать нужную функцию. Выберите кате-
горию Определенные пользователем, и в списке функций данной категории выбе-
рите СуммаПрописью, после чего нажмите кнопку ОК. Во втором диалоге масте-
ра функций нужно задать аргументы выбранной функции. У данной функции
только один аргумент — сумма числами. Вы можете указать ячейку с исходными
данными, щелкнув на ней мышью или введя нужный адрес в поле ввода диалога.
Также вы можете ввести число прямо в диалоге, если в дальнейшем сумма не бу-
дет меняться. Нажав кнопку ОК, вы закроете диалог и вставите сумму прописью
в нужную ячейку.
172
Бухгалтерские бланки и отдельные расчеты
Как и при использовании других функций, сумму прописью можно вклю-
чать в сложные формулы, содержащие несколько функций и операторов, напри-
мер =СуммаПрописъю(СУММ(А1:А9)/2+300) или =СЦЕПИТЬ( "Сумма прописью:
";СуммаПрописъю(А1)). В первом случае будет выведена сумма, получившаяся в
результате расчетов, а во втором случае перед суммой будут выведены слова
«Сумма прописью:».
Если вы хотите немного изменить выводимое значение, можете использо-
вать функцию вывода числа прописью и встроенные средства обработки симво-
лов Excel. Например, если вместо текста Четырнадцать рублей 45 копеек вы хо-
тите получить текст Четырнадцать руб. 00 коп., нужно ввести в ячейку такую
формулу
=ЗАМЕНИТЬ(ЧислоПрописью(А1);1;1;
ПРОПИСН(ЛЕВСИМВ(ЧислоПрописъю(А1);1))) & "руб. 00коп. "
Хотя в книге формула расположена на двух строках, в таблицу Excel вы
должны ввести ее в одной строке. Функция ЧислоПрописъю вернет нужное значе-
ние, с помощью функции ЛЕВСИМВ будет взята первая буква, а функцией ПРО-
ПИСНэча буква изменена из строчной в прописную. Функция ЗАМЕНИТЬ заме-
нит первый символ строки, поставив в это место прописную букву. И, наконец,
к концу строки с помощью оператора & будет добавлено «руб. 00 коп.». Обрати-
те внимание, что копейки в данном случае отбрасываются, и всегда выводятся
целые значения рублей.
Если вы по каким-либо причинам не хотите включать выполнение макро-
сов, или у вас не получилось подключить программу, а также, если у вас нет воз-
можности получить программу из Интернета, ниже мы рассмотрим другой спо-
соб получения суммы прописью, с помощью ввода расчетных формул в лист
Excel. Однако использование макросов удобнее и легче, так что по возможности
лучше работать именно с ними.
При втором способе вычисления суммы прописью вы должны ввести на от-
дельном листе рабочей книги Excel формулы для расчета. При этом исходные дан-
ные будут браться из ячейки А1 этого листа, а результат помещен в ячейку А2. Да-
лее этот лист можно скопировать в любую таблицу, и поместить в ячейку А1 ссыл-
ку на сумму, которую вы хотите записать прописью. После этого в ячейку, в кото-
рой должна располагаться сумма прописью, поместите ссылку на ячейку ̂ добав-
ленного листа. Основной недостаток такого способа — вы можете вставить только
одно значение суммы прописью. Если вам понадобится вторая сумма, записанная
буквами, нужно будет вставить в рабочую книгу еще один лист с вычислениями.
Однако у такого способа есть и достоинства. Вы можете произвольно модифици-
ровать алгоритм вычислений, например, изменив название денежной единицы.
Создайте новую таблицу Excel и оставьте в ней только один лист. Как вы по-
мните, в ячейке А1 будут помещаться исходные данные, а в ячейку А2 помещен
результат. Вначале введем в таблицу все нужные для получения суммы прописью
слова. Нужно заполнить строки с третьей по девятую, введя слова в первые де-
сять столбцов (Рис. 3.4).
173
Примеры использования Excel в бухгалтерии
-I А г в • с • о ".- .J ' .....Е : F :_;_ j;. ; G :..:..:...!.' .;'..iH.i.:l: _i---
: ~ ---- 1 »-----J ^
3 '"• 'один "два три четыре пять шесть семь восемь девять
Г"4';десять одиннадцать двенадцать 'тринадцать четьфивдцать пятнадцать -шестнадцать семнадцать восемнадцать девятнадцать
:5"."': двадцать ^тридцать '.сорок пятьдесят "шестьдесят семьдесят "восемьдесят девяносто
6 • сто двести триста четыреста .пятьсот ;шестъсот семьсот восемьсот ;девятьсрт
одна тысяча две тысячи три тысячи четьре тысячи пять тьюяч шесть тысяч семь тысяч восемь тысяч девять тысяч
8 • одинмиплиок деамиппиона тримиппиома четыремиппиона пять митионов шесть миллионов семьмиллионов восемьмиллионов девять мигтлионов
9 5рублей рубль рубля рубля рубля рублей рублей рублей рублей 'рублей
Рис. 3.4. Все используемые слова
Начнем заполнение с третьей строки. В ячейку ВЗ введите один, в СЗ введи-
те два, в D3 — три, и так далее. В последний столбец, в ячейку J3, нужно ввести
девять. В следующую строку нужно ввести названия чисел более десяти. В ячей-
ку А4 введите десять, в ячейку В4 введите одиннадцать, в С4 введите двенадцать
и так далее, до девятнадцати. В пятой строке вводятся названия десятков, и на-
чинается ввод с третьего столбца. В ячейку С5 введите двадцать, в ячейку D5
введите тридцать и так далее. Сотни вводятся в шестую строку. В ячейку В6 вве-
дите сто, в С6 введите двести и так далее. В следующую строку нужно ввести
названия тысяч. В ячейку В7 введите одна тысяча, в С7 введите две тысячи,
в D7 введите три тысячи и так далее до слов девять тысяч в ячейке /7. Если вы
не планируете писать прописью суммы более 999 тысяч, следующую строку
заполнять не надо. В противном случае введите в ячейку В8 слово один миллион,
в С8 — два миллиона и так далее. Следующая строка предназначена для склоне-
ния названия денежных единиц. Если вы не хотите писать «рублей», «рубля» и
«рубль»), а ограничитесь словом «руб.», можете ее не заполнять. Если же вы
хотите использовать полное слово, в ячейку А9 введите рублей, ячейку В9 вве-
дите рубль. В ячейки С9, D9 и Е9 введите рубля, а в остальные ячейки F9, G9, Н9,
19, J9 введите рублей. Вы ввели все нужные слова, и пора добавить расчетные
формулы.
В ячейку АИ введите число 10, а в ячейку А12 введите формулу =А11*10.
В ячейке А12 появится результат — 100. С помощью автозаполнения скопируйте
формулу из А12 в ячейки до девятнадцатой строки. Для этого щелкните мышью
на ячейке А12, чтобы сделать ее активной. Подведите указатель мыши к маркеру
заполнения, расположенному в правом нижнем углу рамки выделения ячейки.
Нажмите и не отпускайте левую кнопку мыши, после чего начните перемещать
указатель. При этом область выделения ячеек будет увеличиваться. После выде-
ления ячеек до А19 включительно, отпустите кнопку мыши. Все выделенные
ячейки будут заполнены нужной формулой. При этом каждая следующая ячейка
будет ссылаться на предыдущую, умножая ее значение на 10.
Далее нужно выделить отдельные цифры из исходного числа. Введите в
ячейку В11 формулу =ЦЕЛОЕ($А$1/А11*10)-(ЦЕЛОЕ($А$1/А11))*10. В этой
ячейке будет отображаться крайняя правая цифра числа. Например, если ввести
в ячейку Л/ число 326, вы увидите в ячейке В11 цифру 6. Поясним, как это полу-
чилось. Формула $А$1/А11*10леяит число на 10 и умножает тоже на 10, то есть в
результате остается число 326. Функция ЦЕЛОЕ также не меняет это число.
В правой части формула $А$1/А11 делит число на 10, то есть получается 32,6.
174
Бухгалтерские бланки и отдельные расчеты
Функция ЦЕЛОЕ оставляет целую часть, то есть 32. Умножаем на 10 и получаем
320. Наконец, вычитая 320 из 326, мы получаем 6, что и требовалось. В формуле
ссылка на ячейку А1 использует абсолютную адресацию — $А$1, чтобы при копи-
ровании формулы эта ссылка не менялась.
После того, как вы ввели формулу в ячейку В11, нужно ее размножить в рас-
положенные ниже ячейки. С помощью автозаполнения, описанного выше, раз-
множьте формулу из ячейки В11 во все ячейки до В19 включительно. В каждой
ячейке появится своя цифра. Например, если вы ввели в ячейку А1 число 326, в
ячейке В12 появится цифра 2, а в В13 появится цифра 3. Логика вычислений та-
кая же, как и при определении единиц, но в каждом случае выполняется деление
на свое число - 100, 1000 и так далее.
В результате выполненных действий у нас есть все цифры, входящие в ис-
ходное число. Теперь настала пора описать самую ответственную часть расче-
тов — преобразование цифры в нужное слово. Для каждого разряда числа нуж-
но ввести свою формулу, и начнем мы с единиц. В ячейку СИ введите форму-
лу =ИНДЕКС(АЗ:Н;В11+1). Функция ИНДЕКС извлекает значение нужной
ячейки из нескольких. Диапазон просматриваемых ячеек задается первым аргу-
ментом — A3:J3. Напоминаем, что в эти ячейки ранее были введены названия
цифр — один, два и так далее. Второй аргумент указывает на конкретную ячейку.
Введя В11+1, вы получите слово из ячейки ВЗ, если в ячейке В11 расположена
единица, и слово из ячейки 13, если в В11 выводится 8. Попробуйте ввести в
ячейку А1 разные числа, и вы увидите, как в СИ появляются названия последней
цифры числа.
Вы можете заметить, что числа от 11 до 19 преобразуются неверно. Чтобы ис-
править этот недостаток, следует усложнить формулу. Если вы введете в ячейку
СИ формулу =ИНДЕКС(А4:/4;ВП+1), правильно будут вычисляться суммы от
11 до 19, но остальные суммы будут неверно вычисляться. Обратите внимание,
что новая формула отличается от первой только тем, что указана четвертая, а не
третья строка таблицы. Именно в четвертую строку вводились слова одиннад-
цать, двенадцать и так далее. Чтобы выводить разные слова, нужно использовать
условную функцию ЕСЛИ. Исправьте формулу в ячейке СП, чтобы получилось
такое выражение:
=ЕСЛИ(В12=1;ИНДЕКС(А4:М;ВП+1);ИНДЕКС(АЗ:Л;ВП+1))
Если в ячейке В12 единица, то есть число от 10 до 19, будет использоваться
формула ИНДЕКС(А4:/4;В11+1), а во всех остальных случаях используется фор-
мула ИНДЕКС(АЗ:/3;ВП+1). Теперь последняя цифра переводится в текст почти
правильно. Единственным неудобством является то, что если эта цифра равна
нулю, ноль и появляется в ячейке. Чтобы исправить эту ошибку, введите в ячей-
ку A3 один пробел. Теперь вместо нуля в итоговую ячейку будет вставляться про-
бел. Аналогично добавьте пробелы в ячейки А5, А6 и В5, чтобы в дальнейшем не
допускать таких ошибок.
Десятки и сотни вычисляются примерно так же. Введите в ячейку С12
формулу =ИНДЕКС(А5:Н;В12+1). Берется значение десятков и находится
175
Примеры использования Excel в бухгалтерии
нужная ячейка в пятой строке. С помощью автозаполнения скопируйте фор-
мулу из ячейки С12 в С13. В последней ячейке появится формула =ИН-
ДЕКС(А6:}6;В13+1), описывающая получение сотен.
Для вычисления тысяч нужно выполнить немного более сложные действия.
Вначале введите в ячейку С14 формулу =ЕСЛИ(В15=1;ИНДЕКС(А4:М;В14+1) &
А 7;ИНДЕКС(А 7:J7;B14+1))
Эта формула очень похожа на используемую для единиц, только к ней добав-
ляется слово «тысяча». Оператор & сцепляет строки, чтобы получилось число ти-
па «одиннадцать тысяч». Однако в ячейку А 7 мы не ввели слово «тысяч». Ведь ес-
ли исходное число типа 50000 или 112234, то слово «тысяч» нужно выводить, а в
числе 5000000 или 565 слово «тысяч» отсутствует. Добавим в ячейку Л 7 условие.
Введите в нее формулу
=ЕСЛИ(И((А1>1000);ИЛИ((В14< >0);(В15< >0);(В16< >0)));
"тысяч";"")
Естественно, в Excel эта формула также располагается на одной строке. Те-
перь, если число меньше тысячи, в ячейке Л7 располагается пробел. Пробел же
располагается, если в большом числе нет разрядов тысяч, а только миллионы.
В остальных случаях в ячейке А 7располагается слово «тысячи». Обратите внима-
ние, что перед первой буквой слова добавлен пробел, чтобы получилось «один-
надцать тысяч», а не «одиннадцатьтысяч».
Десятки и сотни тысяч вычисляются так же, как и просто десятки и сотни.
Введите в ячейку CIS формулу =ИНДЕКС(А5:/5;В15+1), и скопируйте ее в ячей-
ку С16 с помощью автозаполнения, чтобы в ней получилась формула =ИН-
ДЕКС(А6^6;В16+1). Кстати, сразу аналогично введите в ячейку CIS формулу
=ИНДЕКС(А5:Н;В18+1), а в ячейку С19 формулу =ИНДЕКС(А6:М;В19+1). Те-
перь осталось добавить только единицы миллионов.
Вначале введем условие в ячейку AS. Введите в эту ячейку формулу =БС-
ЛЩА1 >1000000; "миллионов ";" "), чтобы не добавлять слово «миллионов» для ма-
леньких чисел. Далее, как и для тысяч, введите в ячейку С17 формулу
=ЕСЛИ(В18=1;ИНДЕКС(А4:Ы;В17+1)&А8;ИНДЕКС(А8:М;В17+1))
Все точно так же, как и для тысяч, но используется не седьмая, а восьмая
строка таблицы. Кстати, при необходимости вы можете аналогично добавить
перевод миллиардов в текст. Отдельные части суммы прописью готовы. По-
пробуйте вводить разные числа в ячейку А1 и проверьте правильность вычис-
лений. Если что-то считается неверно, проверьте правильность ввода всех
формул.
В ячейку С20 введите формулу для склонения названия денежной единицы
=ЕСЛИ(В12=1;А9;ИНДЕКС(А9:М;В11+1)). Если число оканчивается на 11, 12, и
тому подобное, то используется слово «рублей», в противном случае берется сло-
во из девятой строки таблицы. Если вы не хотите писать полностью это слово,
можете вместо формулы ввести в ячейку руб.
Далее в ячейку С21 введите формулу для вычисления копеек:
=ТЕКСТ(ОКРУГЛ((А1-ЦЕЛОЕ(А1)) *100;0); "00")
176
Бухгалтерские бланки и отдельные расчеты
Вычисляются копейки, после чего преобразуются в текст, причем числа ме-
нее десяти выводятся с первым нулем, например «04». При желании можно скло-
нять и копейки, как и рубли, но мы в примере добавим слово «коп.», как это ча-
ще всего принято.
Все части готовы, и осталось только сцепить их. В ячейку А23 введите:
=СЖПРОБЕЛЫ(С19& " "&С18& " "&С17& " "&С16& " "&
С15& " "&С14& " "&С13& " "&С12& " "&С11& " "&С20
&" "&С21&"коп.")
Функция СЖПРОБЕЛЫуберет лишние пробелы, а длинная формула сцепит
все части, добавив между них пробелы. Полученный результат имеет два недо-
статка — сумма начинается со строчной буквы и при описании числа менее од-
ного рубля, не пишется «Ноль рублей». Чтобы исправить это, введите в ячейку А2
формулу
=ЕСЛИ(ЦЕЛОЕ(А1) =0; "Ноль " &
А23;ЗАМЕНИТЬ(А23;1;1;ПРОПИСН(ЛЕВСИМВ(А23;1))))
Все формулы введены, и вы можете проверить правильность вывода суммы
прописью. Вначале лучше изменить формат ячейки А1 на финансовый, щелкнув
на ней мышью и нажав кнопку на панели инструментов. После увеличь-
те ширину первого столбца, и приступайте с проверке. Введите разные числа,
от 0 до 999999999, в ячейку А1, и в ячейке А2 появится результат. Копейки при
вводе следует отделять запятой, например 24,73.
Если все вычисляется правильно, можете скрыть строки с вспомогательны-
ми формулами. Для этого выделите строки с третьей по двадцать третью и выбе-
рите команду меню Формат з£> Строка з£> Скрыть. На листе останутся только
исходная сумма и сумма прописью. Сохраните электронную таблицу, чтобы ис-
пользовать ее в дальнейшем.
Чтобы вставить в любую таблицу вывод числа прописью, добавьте еще
один лист, и скопируйте на него первые 24 строки из только что созданной таб-
лицы. Назовите этот лист Пропись. Далее следует добавить нужные ссылки. На-
пример, в таблице на листе Лист! в ячейке D12 выводится сумма, которую
нужно вывести в виде текста в ячейке D13. Перейдите на лист Пропись и в ячей-
ку А1 введите ссылку =Лист1!В12. После этого перейдите на лист Лист! и
ячейку D13 введите ссылку =Пропись!А2. В последней ячейке сразу появится
сумма прописью.
3.1.3. Расчет покупки товара в кредит
Рассмотрим полезные приемы работы с Excel, которые можно использовать
в разных случаях. И начнем с расчета покупки товара в кредит. Допустим, вы хо-
тите приобрести какой-то товар в кредит, или предлагаете товары населению с
рассрочкой платежа. Важно быстро рассчитать, какие суммы должны ежемесяч-
но выплачиваться и какова общая стоимость товара, с учетом процентов.
177
Примеры использования Excel в бухгалтерии
, в L с в { Исходными данными для расчета
IT являются стоимость товара, процент
jgJkJP первоначального взноса, годовая
рок кредитования ставка кредита, дата оформления кре-
i Дита и срок кредитования в месяцах, а
нужно рассчитать дату последней вы-
с- 5,5. платы, сумму выплаченных процен-
Заголовки и исходные данные тов и общую сумму покупки. Введите
в ячейки первого столбца таблицы на-
звания ячеек, а также заполните произвольными значениями ячейки с первой до
пятой строки второго столбца. В третьем столбце будут выводиться даты погаше-
ния частей кредита, а в четвертом - выплачиваемые суммы. Введите заголовки
этих столбцов в первой строке (Рис. 3.5). Чтобы таблица выглядела лучше, выбе-
рите наиболее подходящие форматы для дат и процентов.
Вначале введем самые простые формулы. Чтобы узнать дату последней вы-
платы, нужно добавить к дате оформления кредита количество месяцев, на кото-
рые выдан кредит. Введите в ячейку .в/формулу =ДАТАМЕС(В4;В5). Чтобы рабо-
тала функция ДАТАМЕС, должен быть установлен пакет анализа. Для установки
пакета анализа нужно выбрать команду Сервис ^> Надстройки и установить в по-
явившемся диалоге флажок рядом с названием Пакет анализа. В случае, когда
данного названия нет в диалоге, нужно выполнить дополнительную установку
Excel, чтобы добавить в систему нужную надстройку. Если вы не можете или
не хотите устанавливать пакет анализа, введите в ячейку В7 формулу
=ДАТА(ГОД(В4);МЕСЯЦ(В4)+В5;1). Для простоты мы вычисляем первое число
месяца, так как нужен только месяц, а не дата.
В ячейку В8введите формулу =СУММ(О2:О100)-В1*(1-В2). То есть, из суммы
всех выплат, которые будут рассчитаны и помещены в четвертый столбец, нужно
вычесть сумму кредита. А эта сумма вычисляется как разница между стоимостью
товара и первоначальным взносом. В ячейку В9 введите формулу =В1+В8, то есть
общая сумма складывается из стоимости товара и выплаченных процентов.
Далее нужно заполнить ячейки в столбцах С и D, но вначале поясним ис-
пользуемый при расчетах алгоритм. Считается, что кредит возвращается в тече-
ние всего срока равными долями. Каждый месяц погашается часть кредита, и
вместе с нею выплачиваются проценты за пользование этой частью. В первый
месяц возвращается часть суммы с процентами за пользование кредитом в тече-
ние одного месяца. Во втором месяце процент больше, так как пользовались кре-
дитом уже два месяца. С каждым следующим месяцем проценты вырастают, по-
этому возвращать нужно все больше и больше.
Вначале нужно вывести месяцы выплат по кредиту. Если вы работаете с ус-
тановленным пакетом анализа, введите в ячейку С2 формулу
=ЕСЛИ(СТРОКАО-1<=$В$5;ДАТАМЕС($В$4;СТРОКА()-1);"")
Рассмотрим, какие вычисления выполняются с помощью данной формулы.
Функция CTPOKAQ возвращает номер текущей строки, то есть 2 для ячейки С2,
178
Бухгалтерские бланки и отдельные расчеты
и выражение CTPOKAQ-1 позволяет определить порядковый номер месяца. Ес-
ли номер месяца меньше или равен сроку кредитования, выводится дата, а в
противном случае ячейка будет пуста. Далее вы поймете, зачем используется ус-
ловие, а не просто выводится дата. Для вычисления очередного месяца исполь-
зуется почти такая же формула, что и для определения даты последней выпла-
ты, но добавляется не общее количество месяцев, а порядковый номер месяца.
В итоге, в ячейке появится дата первого месяца погашения кредита. Конечно,
нужно выбрать соответствующий формат, чтобы дата выводилась как дата, а не
как число.
Если вы работаете без установленного пакета анализа, все рассуждения точ-
но такие же, но функция ДАТАМЕС не работает, поэтому введите в ячейку С2
формулу
=ЕСЛИ(СТРОКА()-К=$В$5;
ДАТА(ГОД($В$4);МЕСЯЦ($В$4) +СТРОКА()-1;1);"")
Далее нужно вычислить сумму, возвращаемую в каждом месяце. Введите в
ячейку D2 формулу
=ЕСЛИ(СТРОКА()-1< =$В$5;
$В$1*(1-$В$2)/$В$5*(1+(СТРОКА()-1)*$В$3/12);"")
Как и дата, сумма выводится только для месяцев погашения кредита, а для
следующих месяцев выводятся пустые значения. Выражение $В$1*(1-$В$2) вы-
числяет сумму кредита, а разделив ее на содержимое ячейки В5, можно получить
месячную долю погашения. Выражение $В$3/12 определяет месячный процент
кредита, а с помощью выражения 1+(СТРОКА()-1)*$В$3/12 вычисляются про-
центы, выплачиваемые именно в этом месяце, и они добавляются к погашаемой
части кредита. В итоге мы получаем сумму, которую нужно выплатить в конкрет-
ном месяце.
Размножьте формулы из ячеек С2 и D2 с помощью автозаполнения на не-
сколько десятков строк, до ячеек С50 и D50. При этом выведены значения будут
только в начальных ячейках, а остальные останутся пустыми, хотя формулы в
них работают правильно. Именно
для того, чтобы не отображать не-
нужную информацию, в формулах
используются условия.
Чтобы выполнить расчеты, вве-
дите исходные данные в таблицу, и
слева появятся даты и суммы, кото-
рые нужно выплатить в эти месяцы
(Рис. 3.6). Уменьшите срок кредито-
вания, и заполненными окажутся
меньше строк.
Использование условий и при-
менение в вычислениях номера
строки помогает создавать достаточ-
1 ; Стоимость товара
2 j Первоначальный взнос
j*J Годовая ставка крадота
4 |Дата оформления кредита
5 i Срок кредитования
тп
7 : Последняя выплата
В
"зоооооооо
25%
45%
[ С J D
Дата Выплаты
Ноябрь 2002 12968750
Декабрь 2002 13437500
Октябрь 2002 Январь 2003 13906250
'
' 18 '
Апрель 2004
8 ;Всего выплачено процентов 80156250
9~ Общая сумма 380156250изтл_,
'шщ
т
17 j
Й
"
Февраль 2003 14375000
Март 2003 14843750
Апрель 2003 15312500
Май 2003 15781250
Июнь 2003 16250000
Июль 2003 16718750
Август 2003 17187500
Сентябрь 2003 17656250
Октябрь 2003 18125000
Ноябрь 2003 18593750
Декабрь 2003 19062500
Январь 2004 19531250
Февраль 2004 20000000
Март 2004 20468750
Апрель 2004 : 20937500
Рис. 3.6.
Результаты расчетов
179
Примеры использования Excel в бухгалтерии
но сложные таблицы, поэтому хорошо разберитесь с принципами работы опи-
санной таблицы. Они могут вам пригодиться в будущем.
3.1.4. Объединение таблиц
с автоматизацией расчетов
Часто приходится заполнять несколько однотипных документов, несколько
раз повторяя ввод одних и тех же данных. В этом случае удобно ввести текст и
числа один раз, а во всех остальных документах просто вставить данные из пер-
вого документа. Рассмотрим эту операцию на примере заполнения счета-факту-
ры, счета и приходного кассового ордера. Вы заполняете только счет-фактуру, а
остальные документы заполняются автоматически.
Вначале вам нужно где-то достать или самостоятельно оформить счет-фак-
туру. Подробно об оформлении бухгалтерских бланков рассказано выше, на при-
мере расчетной ведомости. При этом активно используйте форматирование. На-
пример, чтобы вывести дату в виде 01 октября 2002 г., нужно задать дату 1.10.2 и
выбрать нужный формат представления данных. После того, как бланк готов,
можно заполнять все поля вручную, но удобнее автоматизировать заполнение
некоторых полей.
Если вы при заполнении используете только сегодняшнюю дату, в поле да-
ты вставьте формулу —СЕГОДНЯ(). В ячейки стоимости товаров введите произ-
ведение количества на цену единицы, например =C11*D11. Возможно, в вашей
таблице адреса конкретных ячеек будут другими. Аналогично можно вычис-
лить сумму налога с помощью формулы =E11*G11 и общую сумму по форму-
ле =Е11+Н11. Также можно ввести в нужную ячейку ставку НДС. Введя фор-
мулы в первую ячейку счета-фактуры, размножьте их с помощью автозаполне-
ния на остальные строки. Чтобы в таблице не отображались нулевые суммы,
можно применить особый формат ячеек. Выделите ячейки с формулами, вы-
берите команду меню Формат Х£> Ячейки, и на вкладке Число появившего-
ся диалога выберите в списке форматов все форматы. Введите в поле формат
# ##0,00;#;#. Точками с запятой разделяются варианты числа — положитель-
ное, отрицательное и нулевое. Символ # указывает, что нули не выводятся.
Первые символы описывают вывод числа в виде 7 876,00. Кстати, если заме-
нить последний символ # в формате на тире, вместо нулей в таблице будут про-
ставляться прочерки.
Суммирование и вычисление налога с продаж выполняется предельно про-
сто. Чтобы вставить в счет-фактуру сумму прописью, воспользуйтесь одним из
описанных выше способов. Вы можете подключить макрос и вызвать функ-
цию, или добавить в таблицу лист с вычислением суммы прописью. Можете за-
полнить для примера нужные ячейки в таблице, и просмотреть, все ли правиль-
но выводится и рассчитывается. В результате вы получите примерно такую таб-
лицу (Рис. 3.7). Возможно, у вас она получилась еще лучше.
180
Бухгалтерские бланки и отдельные расчеты
3 : Продавец
4 Адрес
5 ИНН продавца
6 Грузоотправитель и его адрес
СЧ ЕТ-ФАКТУ РА №
ЗАО "Мебельный салон"
Москва. Мебельная ул. д.5
F > G ; Н I
от 01 октября 2002 г.
ООО "Компьютер"_ Покупатель
_Адрес
_инн покупателя 467382956?
_ Грузополучатель и его адрес
Москва. Компьютерный переулок, д 56
7 К платежно-расчетному документу №
"в"'- " '
наименование товара (описание
1 вьлопненных рзОот, оказанных услуг)
Ш
10 1
11 'Стол компьютерный
-по рабочее
13'
14
15
16:
Ед мэм.
2
ШТ.
шт.
55 от 01.10.2002
Кол-во
3
1
2
цена за
ед нам.
4
7546,00
3 548 00
товаров
(раОот. услуг),
всего oes
5
7 546,00
7096,00
Дополнение (условия оплаты,
способ отправления и т п.)
ВТОМ
акциз
6
Налоговая
ставка
7
20%
20%
20%
20%
20%
20%
17 'Всего к оплате:
18 : Налог с продаж:
19 'Всего к оплате, включая НСП
20 Руководитель организации
21 !
Сумма
8
1 509,20
1 419,20
Стоимость
товаров (работ,
услуг), всего с
Q
9 055,20
8 5(5,20
17 670,40
Страна
проиоамедения
10
номер
грузовой
таможенной
декларации
11
878,52
13 448,92 (Восемнадцать тысяч четыреста сорок восемь рублей 92 копейки)
Иванов И И Главный бухгалтер Петрова П П
М П
го лица от продавца)
Примечание
.1 Без печати i
•2 Первый жк ip - покупателю, второй Э(
ЗАО "Мебельный салон"
Носила, Мебельная jfn., 3.5
Рис. 3.7. Счет-фактура
Далее на основе информации из счета-фактуры составляем счет. Это сделать
очень просто, так как информация в счете почти полностью повторяет информа-
цию из счета-фактуры. Для счета рекомендуется использовать отдельный лист
рабочей книги. После того, как вы сделаете или найдете бланк счета, вставьте в
используемые ячейки ссылки на соответствующие ячейки листа счета-фактуры.
При этом можно сослаться и на название и адрес продавца, вставив эти данные
в заголовок счета (Рис. 3.8).
Если сумма прописью не помеща-
ется на одной строке, выберите пере-
нос по словам при установке формата.
Кстати, чтобы сцепить сумму цифрами
и сумму прописью, используйте фор-
мулу =Лист1!В19&" "&ЛистНП19,
конечно введя название листа со
счетом-фактурой и указав нужные
ячейки, содержащие соответствующие
суммы.
На третьем листе рабочей книги
создайте бланк приходного кассового
ордера (Рис. 3.9). Некоторые поля в
этом бланке заполнить очень просто,
достаточно вставить ссылку на нуж-
ную ячейку счета или счета-фактуры.
Мы же остановимся на заполнении
нескольких ячеек, которые отсутству-
ют в этих документах.
тЧПлательшмк:
_8 'Договор №
9 i Получатель:
СЧЕТ Jft 77
от 01.10.2002
ООО "Компьютер"
11 >« И/1!
12 1
13 '2.
•:1*'3-
15:4.
-к; 5.
Предмет счет»
Стол компьютерный
Кресло рабочее
17
1В
19
Кол.
1
2
lena IB единиц;
7 546,00
3 548,00
Всего:,
НДС- 20%
ИТОГО к о плате -
Сумма
7 546.00
7096,00
14 642,00
2 928,40
17 570,40
'20!
"и] Итого к оплате с учетом НДС и НСП
23 1844S.92 (Восемнадцать тиа
24 92 копейки)
25 Сч« действителен к оплате в течение
27 Руководитель организации
J»|
]&}Главный бухгалтер
чшреста серок восемь рублей
3-х банковских дней
Иванов И. И.
Петрова П.П.
Рис. 3.8. Счет
181
Примеры использования Excel в бухгалтерии
ЗДО "Мебельный и
JMW.M (Восемнадцать тысяч четыреста
сором восввяиоубпец Si ио
878,52
п OOP 'Компьютер"
Л*с. J.9.
Приходный кассовый ордер
В приходном кассовом ордере
рубли и копейки выводятся в разных
ячейках. Если сумма из счета-факту-
ры расположена на листе Лист! в
ячейке В19, то формула для выделе-
ния рублей будет следующей: =ЦЕ-
ЛОЕ(Лист!!В19). Поместите ее в
нужную ячейку, например в F18, как в
нашем случае. Для выделения копеек
в следующую ячейку нужно ввести
= ТЕКСТ(ОКРУГЛ((Лиcm ИВ 19-
F18) *100;0); "00 "). Сумма в рублях вы-
читается из общей суммы и умножа-
ется на сто, после чего выводится в
виде двух цифр, например 78 или 09.
В поле основания нужно перечислить все товары, для чего можно применить
операцию сцепления, например =Лист2!В12&" "&Лист2!В13&" "&Лист2!В14.
Обратите внимание, что между отдельными названиями вставляются пробелы.
Это не совсем удобно, но если поставить запятые, в случае пустой строки полу-
чатся несколько запятых, расположенных подряд. Можно при заполнении сче-
та-фактуры в конце каждого названия ставить точки. В этом случае названия в
приходном кассовом ордере будут разделены точками.
Сохранив заготовку созданного документа, вы можете открывать ее при
необходимости заполнения соответствующих документов. Заполнять нужно
только поля в счете-фактуре, а остальные документы будут заполняться автома-
тически. Вы можете распечатать нужное количество копий каждого документа.
После заполнения можно сохранить таблицу в другом файле, чтобы оставить
созданные документы в электронном виде.
3.1.5. Расчет авторского вознаграждения
Выплата гонораров
Фамилия Сумин
Рис. 3.10.
Описание продаж и выплат
При выпуске различных произведений
расчет авторских отчислений может ока-
заться достаточно сложным, если автору
выплачивается процент от проданных эк-
земпляров произведения. Рассмотрим про-
стой пример определения выплат издатель-
ством гонораров авторам нескольких книг.
Вся нужная информация размещается
на двух листах рабочей книги Excel. Внача-
ле заполним лист с информацией о продаже
книг и о выплатах авторам (Рис. 3.10). На
182
Бухгалтерские бланки и отдельные расчеты
этом листе никаких формул нет, просто ведутся два списка. Списки можно рас-
ширить, например, добавив дату операции и количество проданных книг. Одна-
ко для расчетов эта информация не нужна, и мы не будем ее добавлять, чтобы не
усложнять таблицу.
Введите заголовки столбцов, после чего введите в строки, начиная с пятой,
тестовые исходные данные. В списке продаж указывается название книги и об-
щая стоимость проданной партии книг. В списке выплат вводится фамилия и
инициалы автора, а также выплаченная ему сумма. Переименуйте текущий лист
Excel, назвав его Операции. Далее перейдите на другой лист рабочей книги, что-
бы ввести дополнительные исходные данные и формулы для расчетов.
Кроме заголовка, на втором листе располагается информация обо всех
авторах, работающих с издательством. В нашем примере описаны два автора
(Рис. 3.11), но их количество может быть любым. В ячейки с A3 по А7 введите
названия полей. В ячейку ВЗ введите фамилию и инициалы одного из авторов,
а в ячейку В4 введите сальдо на начало периода. Если автор должен издательст-
ву, сальдо вводится отрицательным, а если издательство должно автору, сальдо
будет положительным. Отметим, что для каждой книги далее будет введено соб-
ственное начальное сальдо, а пока нужно ввести долги, не связанные с перечис-
ленными книгами, например за книгу, полностью распроданную в предыдущем
периоде.
В ячейку В5 введите формулу =СУММ(С10:С12). В нашем примере у автора
три книги. Если в вашем случае количество иное, нужно просуммировать другое
количество ячеек, например G10:G15. Далее в ячейку В6 введите формулу
=СУММЕСЛИ(Операции!$О$5:$О$100;ВЗ;Операцш!$Е$5:$Е$100)
1 :
jfJLl IIIIZIII77j
3 I Фамилия, инициалы
4 | Сальдо на начало периода
5 \ Всего начиспено__
6 |Всего выплачено
1 ' К выдаче
В ; ....!.;.. ...С;_.;;...L ..„О !.,,_„„.:§.:
Расчет авторских вознаграждений
Иванов И.И.
-3400!
28918
" 9*22 [
16098!
Название книги
9 i
10 i Книга 1
11 'Книга 2
12 | Книга 3
Фиксированная
выплата
2000
0
3000
Процент
от продаж
7%
10%
0%
Аванс
3000
6500
0
Сальдо на
начало периода
2000
0
-1500
Начислено
процентов
13714
9703
0
Всего
начислено
17714
9703
1500
13 i . . : :
14 i Фамилия, инициалы Петров П.П.
15 ! Сальдо на начало периода i _ 200:
16 : Всего начислено 11878J
171Всего выплачено 7733
18 i К выдаче ^ _J*t6j
i Название книги
го!
21 .' Книга 1
22 Книга 3
Фиксированная
выплата
1000
0
Процент
от продаж
3%
5%
/Аванс
500
5000
Сальдо на
начало периоде
0
0
Начислено
процентов
5878
1712
Всего
начислено
6878
5000
Рис. 3.11. Расчет вознаграждений
183
Примеры использования Excel в бухгалтерии
Функция условного суммирования СУММЕСЛИ проверяет на листе Опера-
ции ячейки $D$5:$D$WO. В этих ячейках расположена фамилия в списке выплат.
Если значение в какой-то строке равно значению из ячейки ВЗ, то есть фамилии
автора, значение из соответствующей строки столбца Е используется при сумми-
ровании. То, что используется именно столбец Е, описано выражением Опера-
ции!$Е$5:$Е$100. В результате суммируются все выплаты данному автору, вне-
сенные в список на листе Операции. В этой и других формулах считается, что про-
веряются строки до сотой включительно. Если у вас списки большего размера,
вставьте в формулу большее число.
В ячейку В6 введите формулу =В4+В5-В6. К начальному сальдо добавляют-
ся все начисления и вычитаются произведенные ранее выплаты. Получаем сум-
му, которую нужно выплатить автору. Теперь нужно рассчитать конкретные сум-
мы начислений.
Введите в девятую строку таблицы заголовки столбцов. Далее нужно ввести
строки с описанием расчетов по определенным книгам. Вначале введите назва-
ния книг в столбце А. Будьте внимательны, так как, если названия будут отли-
чаться от названий книг в списке продаж, расчеты будут неверными. Далее в
ячейки столбца В введите сумму фиксированной выплаты за книгу. Эта сумма не
зависит от тиража, стоимости и тому подобного. В следующем столбце вводится
процент авторского вознаграждения от отпускной цены издательства. Этот про-
цент выплачивается после продажи соответствующей части тиража. В ячейки
столбца D введите сумму аванса. В отличие от фиксированной выплаты, аванс
является частью выплаты процентов. До тех пор, пока проценты от проданных
книг не превысят аванс, автор не будет получать деньги за проданные книги.
После того, как аванс полностью погашен, автор получает выплаты процентов
за каждую проданную партию. В следующую ячейку вводится начальное сальдо.
В следующие два столбца вводятся расчетные формулы. Введите в ячейку F10
формулу
=(СУММЕСЛИ(Операции!$А$5:$А$100;А10;
Операции!$В$5:$В$100)) *С10
Естественно, формула вводится в одной строке. Функция СУММЕСЛИ сум-
мирует значения из ячеек Операции!$В$5:$В$100, то есть суммы продаж партий
книг. При этом для суммирования отбираются только строки, в которых зна-
чение в столбце А листа Операции совпадает со значением в ячейке А10, то есть с
названием нужной книги. Это как раз и описано с помощью первого и второго
аргумента функции. Результатом суммирования является общая сумма всех про-
данных книг заданного наименования. Выражением *С10 данная сумма умножа-
ется на процент, причитающийся автору. В итоге получается начисленное автор-
ское вознаграждение без учета аванса, фиксированной выплаты и сальдо на на-
чало периода.
Для вычисления окончательной суммы введите в ячейку G10 формулу =ЕС-
JIH(F10<D10;D10;F10)+E10+B10. Если выплаты по процентам меньше аванса,
начисляется аванс. В противном случае начисляются выплаты с учетом продан-
184
Автоматизация составления документов
ных книг. К полученной сумме добавляются сальдо на начало периода и фикси-
рованная выплата. В итоге получается реально начисленная сумма по одной из
книг. Выделите ячейки F10 и G10. С помощью автозаполнения размножьте фор-
мулы из этих ячеек на расположенные ниже строки, чтобы вычислить начисле-
ния по всем книгам данного автора.
Все расчеты для одного автора закончены. В ячейке В7 выводится сумма,
причитающаяся автору. Выдав ему нужную сумму, опишите эту операцию в спи-
ске на листе Операции. После этого сумма к выдаче будет равна нулю. По мере
продажи книг и внесения соответствующих записей в список продаж, сумма к
выдаче будет увеличиваться.
Чтобы рассчитать выплаты другому автору, скопируйте строки с третьей по
двенадцатую в нижнюю часть листа. После этого нужно изменить исходные дан-
ные, описав другого автора. Если изменится количество книг, нужно будет также
изменить формулу в ячейке Всего начислено. Суммировать нужно начисленные
суммы по всем книгам. Если книга написана в соавторстве, учет должен вестись
для каждого автора отдельно. При этом указывается процент выплат по книге
для каждого из авторов.
Описанные приемы можно использовать при всех расчетах, в которых нуж-
но выплачивать определенный процент от полученного дохода. Ведя списки
продаж и выплат, вы легко сможете получить нужную сумму, воспользовавшись
функцией условного суммирования СУММЕСЛИ.
3.2. Автоматизация составления документов
Часто при составлении различных документов приходится постоянно вво-
дить одни и те же данные. В этом случае можно автоматизировать создание до-
кументов, облегчив заполнение некоторых полей и полностью автоматизировав
заполнение других.
3.2.1. Автоматическое составление сметы и расчет себестоимости
Перед рассмотрением примеров отметим, что все суммы и алгоритмы вы-
числений придуманы исключительно для учебных целей, так что не следует вос-
принимать эти примеры как реальные программы, показывающие стоимость
учебных курсов или выпуска книг.
При составлении сметы или расчете себестоимости для составляющих выби-
рается один из возможных вариантов, и на основе этого добавляются или вычи-
таются нужные суммы. Также возможно умножение на коэффициенты. В связи
с этим возникают две задачи — не вводить однотипные названия, а выбирать их
из списка, а также автоматизировать все расчеты.
185
Примеры использования Excel в бухгалтерии
4 Компьютврна^_6ухгал_и
5 -Программа и печетные
7 ;Бвэ предоплаты
31су™>
10:0 том числ. НДС
ш
13 250,00р.
2208,ЗЭр
Прейскурант
Курс бухучета
Курс налогообложения
Углубленное изучение бухучета
Компьютерная бухгалтерия
.'Учебник.
Справочник
i Справочник и учебник
Компьютерная программа
Прифамма и печатные материал!
С првдопл;
Бей предог
5000
7000
12000
9000
100%
125%
Рис. 3.12.
Составление сметы
А „ i в „ ?•-• [ ° г Вначале опишем пример состав-
смета обучения п ейскурант г
ления сметы обучения на бухгалтер-
ских курсах. Базовая стоимость разли-
чается для разных курсов, отдельно
оплачиваются дополнительные мате-
риалы. Постоянным клиентам предо-
ставляется скидка, а если не внесена
предоплата, общая сумма увеличива-
ется.
Мы не будем описывать создание
заголовков и выбор подходящих фор-
матов и сразу перейдем к содержа-
тельной части. Вначале нужно выбрать, что за курс предполагается прослушать.
В нашем примере (Рис. 3.12) эта информация вводится в ячейку Л4. Но вначале
нужно перечислить все возможные варианты курсов и расценки на них. Эта ин-
формация вводится в ячейки с СЗ по D6. Далее нужно указать, что в ячейку А4
можно вводить информацию только из ячеек СЗ, С4, С5 и Сб. Любая другая ин-
формация в этой ячейке недопустима.
Сделайте текущей ячейку А4, щелкнув на ней мышью, и выберите команду
меню Данные :£> Проверка, чтобы открыть диалог настройки проверки вводимых
значений. На вкладке Параметры этого диалога выберите в списке Тип данных
вариант Список. Этим вы укажите, что в данную ячейку можно вводить значения
только из определенного списка. Далее нужно указать, где расположен этот спи-
сок. Щелкните мышью на поле Источник и выделите с помощью мыши ячейки
с СЗ по Сб. Адреса ячеек появятся в поле. Вы также можете указать адрес списка
вручную, введя в поле выражение =$С$3:$С$6. Установите флажок Список допус-
тимых значений, и нажмите кнопку ОК. Диалог закроется, и теперь вы не сможе-
те ввести в ячейку неправильное значение.
Когда вы сделаете активной ячейку А4, правее ячейки появится кнопка -*.
Нажав ее, вы откроете список возможных вариантов (Рис. 3.13). Выберите ва-
риант, список закроется, и нужный вариант будет вставлен в ячейку. Попытай-
тесь ввести неверное значение, и Excel сообщит об ошибке. Вы сможете только
отменить неверный ввод, но никаким способом нельзя ввести ошибочную ин-
формацию.
Аналогично нужно задать проверку для ячеек А5, А6иА7. Единственное от-
личие в том, что для каждой ячейки задаются свои собственные списки. После
того как все списки заданы, введите в ячейки про-
извольную информацию. Конечно, вы сможете
ввести любую информацию, но только из спис-
ков. С первой задачей мы справились, теперь ввод
исходных данных для сметы стал значительно
Рис. 3.13. проще. Теперь нужно автоматизировать расчет
Выбор из списка сметы.
Курс налогообложения |Мг-
курс бухучете
Углубленное изучение бухучета
Компьютерная бухгалтерия
186
Автоматизация составления документов
Введите в ячейку В4 формулу =ВПР(А4;СЗ:О6;2;ЛОЖЬ). Функция ВПР
очень полезна и будет использоваться во многих примерах. Она позволяет най-
ти в таблице строку, содержащую нужное значение, и вернуть значение из дру-
гой ячейки этой же строки. В нашем случае мы ищем название курса, а хотим
узнать его цену, записанную в той же строке. Диапазон ячеек C3:D6 указывает
на область таблицы, в которой будет выполняться поиск. Поиск осуществляет-
ся по ячейкам первого столбца области, то есть по ячейкам столбца С. Значе-
ние, которое будет искаться, указано в ячейке А4, что и задается первым аргу-
ментом функции. Число 2 в качестве третьего аргумента указывает, что нужно
взять содержимое второго столбца найденной строки, то есть столбца D. Сло-
во ЛОЖЬ в формуле говорит, что список в указанном диапазоне ячеек может
быть не отсортирован. Теперь, если вы введете в ячейку А4 значение Курс буху-
чета, в ячейке В4 появится сумма из третьей строки столбца D, так как имен-
но в этой строке в прейскуранте находится данное название. В нашем примере
это будет число 5000. Аналогично, в ячейку В5 нужно ввести формулу
=ВПР(А5;С8:О13;2;ЛОЖЬ), чтобы вставить в смету стоимость дополнительных
материалов.
Так как остальные вычисления предполагают увеличение или уменьшение
базовой суммы, формулы получатся немного сложнее. В ячейку В6 введите фор-
мулу =(В4+В5)*(ВПР(А6;С15:В16;2;ЛОЖЬ)-1). Сумма В4+В5 вычисляет стои-
мость курса вместе с дополнительными материалами. Выражение
ВПР(А6;С15:О16;2;ЛОЖЬ) возвращает процент, который должен уплатить кли-
ент. Если вычесть из него единицу, то мы получим процент скидки, причем он
будет отрицательный. Умножив первую часть формулы на вторую, мы получим
размер предоставляемой скидки.
В ячейку В7 введите очень похожую формулу, вычисляющую наценку:
=(В4+В5+В6)*(ВПР(А7;С18:О19;2;ЛОЖЬ)-1). В отличие от скидки, наценка по-
лучается неотрицательной. Все составные части сметы рассчитаны, осталось их
только просуммировать. Введите в ячейку В9 формулу =СУММ(В4:В7). Коммен-
тарии тут не требуются. Далее вы можете добавить дополнительные вычисления,
например, рассчитать НДС и НСП. Потратив немного времени, вы составили
таблицу, существенно ускоряющую составление смет. Выбрав нужные значения
из четырех списков, вы мгновенно получаете готовую смету. Если воспользовать-
ся описанными выше приемами, можно автоматически вставить рассчитанные
суммы в счет или в приходный кассовый ордер.
Второй описанный нами пример очень похож на предыдущий, но в нем ис-
пользуется немного больше расчетов, кроме того, исходные данные расположе-
ны на другом листе рабочей книги. В этом примере мы опишем расчет себестои-
мости выпуска книги. Выбрав объем книги, ее формат, тираж и прочие исходные
данные, вы сразу узнаете себестоимость одного экземпляра. Конечно, для этого
нужно ввести реальные данные, а не те, что использованы в нашем примере.
Все исходные данные и результаты в примере расположены на одном листе
(Рис. 3.14, слева), а вспомогательная информация, нужная для расчетов, - на
187
Примеры использования Excel в бухгалтерии
3 Объем книги 320 Обложка
'̂ "•'"'Формат книги 70x100/17 Подготовка
5 ^Бумага Газетная Тираж
6 ^Переплет Бумажный Блок
"У- ]Коэффициемт ' Подготовка
8 ; гонорара авторов:115 Тираж
9 ;Тира* 7000 Гонорар авторам
10 : Подготовка к выпуску
11:
1]
14 Рассчитанная
• \, себестоимости
13 •
S
45
Редактору
Корректору, _
Верстка
Оборудование и материалы
Транспорт и склад
Прочие расходы
Налоги
ЕСН
НДС
15400
900
17500
65600
9600
56000
29440
1Е+05
3000
35000
28000
21000
35000
6300
5950
W741
41453
23288
JL] .
4 Бумажный
fi-'i
7 Типовой гонорар за страницу
Т: _ '.
9 :Скпад. и трансп. расх. на кю
Щ
11 ;Лрочяе расходы на книгу
13~С|йвкаЕСН
15i
17;
"1:8"; 60x90/1 6
1970x100/17
20184x108/18
V5
1
1,1
80
п "0.9
"; 6.85
35,6%
20%
---
Офсетная
Художнику
Редактору за страницу
Корректоц^ за страницу
Верстка за страницу
Оборудование и материалы
0.05
0.01
3000
5
4
3
5
Стоимость подготовки niicta
Стоимость подготовки обложки
Cm. : Cm. Расход бумаги
обл. леи.
2 0.01.0.77
2,5 0.015 1
3 0,02 1.3
30
900
Рис. 3.14. Расчет себестоимости
другом (Рис. 3.14, справа). В качестве исходных данных используется объем кни-
ги в страницах, формат книги, то есть ее размеры, используемая бумага, тип пе-
реплета, то есть обложки книги, тираж и коэффициент гонорара авторам. Услов-
но считается, что авторы получают фиксированную плату за каждый лист, но для
некоторых книг может использоваться повышающий или понижающий коэф-
фициент.
Введите заголовок таблицы и названия в столбцы Aw. С. Все исходные дан-
ные вводятся в ячейки столбца В. Если объем, тираж и коэффициент гонорара
вводится обычным способом, то остальные три ячейки заполняются данными из
списка. Однако если вы создадите список на другом листе, то не сможете просто
указать его для проверки, как в предыдущем примере. Для этого нужно выпол-
нить некоторые предварительные действия.
Перейдите на второй лист рабочей книги и введите варианты переплета кни-
ги. В нашем примере эта информация введена в ячейки с A3 до В5. Выделите эти
ячейки и введите в поле имени, расположенное в левой части строки формул,
имя Переплет. Далее вернитесь на первый лист и сделайте текущей ячейку В6.
Выберите команду меню Данные з£> Проверка, и на вкладке Параметры появив-
шегося диалога выберите в списке Тип данных вариант Список. В поле Источник
введите формулу =Переплет. Если данные для списка расположены на другом
листе, для ссылки нужно использовать имя. Установите флажок Список допусти-
мых значений и нажмите кнопку ОК. Диалог закроется, список значений будет
задан для данной ячейки. Аналогично задайте проверку ячеек В4 и В5. Сразу
можно ввести формулу для расчета окончательной суммы. Введите в ячейку В14
формулу =(D3+D6+D9+D10+D16+D17+D18)/B9. После сложения все расходы
делятся на размер тиража книги.
Далее нужно ввести формулы для расчета, и начнем мы с самых простых.
Введите в ячейку D3 формулу =D4+D5. Расходы на обложку состоят из двух
частей. Первая часть — расходы на подготовку к печати, например, на изготов-
ление диапозитивов, - не зависят от тиража. И для одной книги и для десяти
тысяч книг нужно изготовить одни и те же диапозитивы. Вторая часть зависит
188
Автоматизация составления документов
от тиража (например, стоимость печати и бумаги). Аналогично, стоимость ос-
новной части книги также состоит из двух частей, поэтому введите в ячейку D6
формулу =D7+D8, Так как некоторые другие составляющие также состоят из
нескольких частей, введите в D10 формулу =СУММ(О11:О15), а в ячейку D18
формулу =D19+D20.
Некоторые суммы в нашем примере фиксированы, и не зависят от вводимых
данных. Их можно просто ввести в нужные ячейки, но для единообразия лучше
вставить ссылки на ячейки второго листа. Введите в ячейку D4 формулу
=Лист2!Е14, а в ячейку D11 формулу =JIucm2!E7. Все простые формулы введены,
и настала пора вводить основные формулы для расчетов. При расчетах часто ис-
пользуется функция ВПР, описанная выше, так что мы не будем снова рассказы-
вать об особенностях ее применения. Введите в ячейку D5 формулу
=В9*ВПР(В4;Лист2!А18:В20;2;ЛОЖЬ)*ВПР(В6;Лист2!АЗ:В5;2;ЛОЖЬ)
Тираж книги умножается на стоимость печати обложки, различающейся для
разных форматов. Полученное число умножается на коэффициент, учитываю-
щий тип обложки, например, твердый переплет дороже мягкого.
В ячейку D7 введите формулу =ВЗ*Лист2!Е13, так как постоянные расходы,
не зависящие от тиража, все же зависят от объема книги. Далее введите наиболее
сложную формулу в ячейку D8:
=В9*ВЗ*(ВПР(В4;Лист2!А18:С20;3;ЛОЖЬ)+
ВПР(В5;Лчст2ЮЗ:Е4;2;ЛОЖЬ)*ВПР(В4;Лист2!А18:020;4;ЛОЖЬ))
Тираж книги умножается на количество страниц, на стоимость страницы,
которая в свою очередь состоит из двух частей - стоимости печати и стоимости
бумаги. Стоимость печати берется из таблицы со второго листа, в зависимости от
формата книги, то есть ее ширины и высоты. Стоимость бумаги определяется на
основе формата и типа используемой бумаги.
В ячейку D9 введите формулу =ВЗ*Лист2.'В7*В7. Гонорар авторам опреде-
ляется как произведение объема книги на базовую ставку и на коэффициент.
Примерно так же определяются затраты на других работников, только без уче-
та коэффициента. Все оставшиеся ячейки, кроме налогов, рассчитываются
как произведение соответствующего показателя со второго листа на объем
книги, хранящийся в ячейке ВЗ. А о том, как считаются налоги, можно и не
рассказывать.
После того, как введены все формулы и занесены справочные данные на
втором листе, можно выполнять расчет. Вводя разные значения в ячейки, можно
узнать себестоимость издания. Кстати, с помощью данной таблицы можно под-
бирать нужные варианты. Выберите команду меню Сервис :£> Подбор параметра,
и откроется диалог настройки подбора. В качестве ячейки, в которой нужно ус-
тановить заданное значение, выберите ячейку В14, в которой выводится рассчи-
танная себестоимость. Введите нужное вам значение, а для изменения укажите
ячейку В9, то есть тираж книги. Нажмите кнопку ОК, и Excel найдет тираж, при
котором можно получить нужную себестоимость. Аналогично можно при неиз-
менном тираже найти оптимальный объем книги.
189
Примеры использования Excel в бухгалтерии
Конечно, в нашем примере описана упрощенная схема расчета себестоимо-
сти, но, используя те же самые приемы, вы можете рассчитать себестоимость лю-
бого товара с учетом самых разных условий.
3.2.2. Автоматизация создания платежных поручений
Для создания платежных поручений разработано достаточно много про-
грамм, но часто можно обойтись и простой таблицей Excel, созданной самосто-
ятельно с учетом наших рекомендаций.
Вначале вам надо создать бланк платежного поручения или получить его из
любого источника. На этой простой операции мы не будем останавливаться.
Также вам понадобится программа печати прописью, описанная выше. Если вы
не получили из Интернета нужный макрос или не создали лист с формулами, вам
придется вручную вводить суммы прописью, что очень неудобно.
Для автоматизации создания платежных поручений вам понадобится рабо-
чая книга Excel с тремя листами. На одном листе будет находиться бланк платеж-
ного поручения, а на другом — список платежек, а на третьем — реквизиты пла-
тельщика. Если вы используете лист с расчетами для вывода суммы прописью,
этот лист будет четвертым. Вначале, как уже было сказано, создайте бланк пла-
тежного поручения. Он должен выглядеть примерно так (Рис. 3.15, слева). Обра-
тите внимание, что ячейки, предназначенные для вывода больших текстов, объ-
единены с соседними ячейками.
2 ' Постуг. 1 6»(.«гп»т ;
.3 1 ПЛАТЁЖНОЕ ПОРУЧЕНИЕ *
а^ : I '
•".." • 'прописью
5 ]
. .ИНН
•б ^ \
Ж}̂ .̂.._„
3 :
'И fca-if гиатепьщи»
12'
13.
14.!Ё*ик прпучателя
16 '
1Б
.17:
181 Получатель
Сумма
Сч.№
6ИК
СчМ
6ИК
Сч.№
Вид on.
H*s.fin
код
Срок плвт
Очад.пгат
Рва.поле
Информация о плательшике
3 ;ИНН
4 Название
5 ; Расчетный счет
6 i Бенк плательщика
7 |КорреСПОНДеНТСКИЙ СЧвТ 13236747623712
1*;|БИК 044585384
200148790
ООО "Ноя собственная фирма"
3574547604762
Банк "Банкиры рексмендуют"
Рис. 3.15. Бланк платежного поручения и реквизиты плательщика
190
Автоматизация составления документов
Далее перейдите на другой лист и введите реквизиты своего предприятия
(Рис. 3.15, справа). После этого снова вернитесь на лист с бланком и проставьте
в нужные места ссылки на ячейки листа с реквизитами. В принципе, можно вве-
сти эту информацию непосредственно в бланк, но при работе с несколькими
предприятиями или с несколькими расчетными счетами можно будет добавить
еще один лист с реквизитами и заменить только название листа, а не менять всю
информацию в ячейках. Кроме того, удобнее, когда вся информация сосредото-
чена в одном столбце, а не разбросана по разным ячейкам. Однако, еще раз по-
вторимся, что вполне допустимо ввести реквизиты плательщика непосредствен-
но в бланк платежного поручения. На этом подготовительная работа закончена,
и настала пора создавать базу платежных поручений.
Перейдите на чистый лист, на котором будет располагаться информация обо
всех платежках. В первой строке, в ячейках с Al no Ml введите заголовки полей
платежного поручения. При этом информацию о плательщике и сумму пропи-
сью вводить не надо. Начиная со второй строки, будут располагаться строки с
описанием разных платежных поручений. Заполните две—три строки, введя ин-
формацию о разных платежках. При этом вам потребуется изменить формат не-
скольких столбцов. Для суммы лучше использовать финансовый формат, для да-
ты — формат даты, а для остальных полей лучше использовать текстовый формат.
Если используется общий формат, то, например, в БИК не будут видны нули,
расположенные слева. В результате вы должны получить примерно такую табли-
цу (Рис. 3.16).
Далее перейдите на страницу с бланком платежного поручения и завершите
заполнение полей. Единственным полем, заполняемым вручную, будут номер
платежного поручения. У нас он расположен в ячейке ЕЗ. Все остальные поля за-
полняются автоматически. Так как почти все используемые формулы однотип-
ны, рассмотрим заполнение поля суммы платежа. В нашем бланке эта сумма
находится в ячейке Н6. Сумма должна быть взята из столбца С базы платежек,
расположенной у нас на листе JIucm2. Введите в ячейку Н6 формулу
=ВЛР(ЕЗ;Лист2!А2:М1000;3;ЛОЖЬ). Как вы помните, функция ВПР находит в
диапазоне ячеек Лчст2!А2:М1000, то есть в тысяче строк базы платежек, строку с
номером, совпадающим со значением ячейки ЕЗ, то есть находит нужное пла-
тежное поручение по его номеру. Результатом вычислений будет значение из тре-
тьего столбца найденной строки, то есть сумма платежа для платежки с указан-
ным номером. Абсолютно такие же формулы нужно ввести во все оставшиеся
поля бланка, кроме суммы прописью. Отличие будет только в том, что выбирать-
ся будут разные столбцы. Например, в ячейку Н12, где выводится БИК получа-
А ; В ! С i О i Е : Г ; G • И ; I J ; К : L [ М' [
Ч'неиее дата суынв HniuwMweплатеже : тст ; ИНН :Расчетныйеч*п ьани Иор.еч6о> БИИ вивяпят. Baaan. Очялалг
'~Тгг 20112002 45в8546856р Оплата комсупмафоиныхаАО'Бс* 457ЫЭ1Э4:Э5708478047ЫBat* "Сотый3244680045603 М4582319 апактромю 01 ^
'2 • успуг ссылаемо догсаору N» консупиацик" : : вам;"
Щ23 :22112002 S672800P От,™ 'с,кфо*,^< услуг ОАО Телефон** 3765435*4 346346S4B6044 КБ 'Тепв^см^й 39394980568666 047685619 электронно :01 6
Ц i : i "̂"•" ' ! — i ; ^ I i I
Рис. 3.16. База платежных поручений
191
Примеры использования Excel в бухгалтерии
теля, нужно ввести формулу =ВПР(ЕЗ;Лчст2!А2:М1000;10;ЛОЖЬ). В десятом
столбце, то есть в столбце /базы платежек, как раз и расположен БИК.
После того, как похожие формулы добавлены везде, где надо, осталось ввес-
ти сумму прописью. В нашем бланке она отображается в ячейке С5. Если у вас
установлен макрос, описанный выше, введите в ячейку формулу =СуммаПропи-
сью(Нб). Напоминаем, что в ячейке Н6 у нас находится сумма числом. Если же
вы используете дополнительный расчетный лист для получения суммы пропи-
сью, установите ссылку на нужную ячейку этого листа, не забыв сослаться с ли-
ста расчетов на ячейку Н6 листа бланка, для получения исходных данных преоб-
разования.
Теперь для создания платежного поручения вам нужно ввести его реквизиты
в строку базы платежек, после чего перейти на страницу бланка и ввести номер
платежки. Все поля будут автоматически заполнены, и вы сможете распечатать
готовое платежное поручение.
Для облегчения работы с множеством платежек удобно воспользоваться ав-
тофильтром. Перейдите на лист с базой платежек и щелкните мышью на любой
ячейке внутри списка, после чего выберите команду меню Данные ^> Фильтр з£>
Автофильтр^ В правой части каждой ячейки заголовка появится кнопка со
стрелкой чг. При нажатии этой кнопки открывается список со значениями,
по которым можно отфильтровать список. Например, нажмите кнопку
gig в столбце Имя, и будет открыт список получателей. Выберите нужную орга-
низацию, и в списке останутся только платежные поручения по платежам дан-
ной организации. Чтобы снова показать все строки, следует снова нажать кноп-
ку т в столбце Имя и выбрать элемент Все в открывающемся списке. Вы може-
те выбрать одновременную фильтрацию по нескольким значениям, например по
получателю и назначению платежа. Аналогично можно отобрать операции с нуж-
ными датами или суммами. Можно задать более сложное условие для фильтра-
ции, выбрав элемент открывающегося списка Условие. На экране появится диа-
лог, в котором вы можете задать любое условие, например сумма оплаты должна
быть больше 300 и меньше 40000 или дата больше 15 июня текущего года.
Создавать новые строки в списке удобнее на основе ранее созданных. Выде-
лите нужную строку и скопируйте ее в первую свободную строку в конце списка.
Исправьте номер и введите нужную информацию в другие поля, после чего мож-
но перейти на лист с бланком платежки и ввести новый номер. После этого вы
можете распечатать созданное платежное поручение.
3.3. Автоматизация отдельных направлений деятельности
Реализовать комплексный законченный учет с помощью Excel можно, но не
целесообразно, так как это займет слишком много времени. Однако автоматиза-
ция отдельных направлений деятельности вполне по силам любому человеку,
192
Автоматизация отдельных направлений деятельности
имеющему средние знания по работе с электронными таблицами Excel. Рассмо-
трим несколько полезных примеров автоматизации фрагментов деятельности
бухгалтера.
3.3.1. Автоматизация учета амортизации основных средств
Учет основных средств и расчет их амортизации является одним из важ-
нейших направлений работы бухгалтера, и эту деятельность можно автомати-
зировать. Отметим, что в примере не используются группы амортизируемого
имущества, а задается годовой процент амортизации для каждого конкретного
предмета. Если вы поймете, какие приемы использованы при создании табли-
цы, вы без труда сможете ее доработать, введя десять групп амортизируемого
имущества.
Все исходные данные, расчеты и результаты вычислений в нашем примере
находятся на одном листе. В левой части вводятся исходные данные, в центре
производятся расчеты и выводятся результаты, а в правой части листа выводятся
суммарные показатели (Рис. 3.17).
Введите заголовок таблицы и заголовки столбцов. Мы не будем на этом ос-
танавливаться, сконцентрировавшись на расчетной части. В ячейку G2 введите
дату расчета, и выберите формат, при котором выводится только месяц и год, без
числа. В ячейку М2 введите формулу =МЕСЯЦ(С2), вычисляющий номер меся-
ца. Далее сделаем так, чтобы при вводе информации в таблицу она автоматичес-
ки нумеровалась. В ячейкуА5введите формулу =ЕСЛИ(В5<>"";1;""). Если ячей-
ка с инвентарным номером пуста, номер в первом столбце отсутствует, в про-
тивном случае выводится единица. Введите в ячейку А6 формулу =ЕС-
ЛИ(В6< > "";А5+1;"") и с помощью автозаполнения скопируйте ее в расположен-
ные ниже ячейки. Теперь, если в какой-то строке введен инвентарный номер, в
ней появляется очередной порядковый номер, на единицу превышающий номер
в предыдущей строке.
Инвентарный номер, наименование, балансовую стоимость и амортизацию
вы должны ввести вручную, как и годовой процент амортизации для данного ос-
Учет амортизации основных средств (линейный метод)
\ •- На дату '. -- Октябрь 2002 ; Число месяцев 10
Ивбнтариззционняя опись по состоянию на
} 01-01.20029
} И*»™
JT, брный И
1й* »
балансовая
^именование стоимость
(сальдо счета 0 Г)
1 1 546 Компьютер 29320
1 2 47!СТОЛ _ _ " . _ . . ' " . . ....".. 2500
'1 3 777 Телевизор 50560
1
Дмортшац
ия (сальдо
счете 0?J
550;
. 2100
10456'.
ПрО1(емт
амортиз
ациив
10%
40%
• " " 50%
Амортизация за 2002 е.
Амортизация
с начале зода
2443
400
21067
за период гтоиыпгчп в "
эксплуатации и
2993 26327
2500 0:
31523 19037
ВСЕГО
втимция
есяые ; Не начало года
: Балансовая
244! стоимость 82380
0; Амортизация 13 106
2107: На текущую дату
. Амортизация за год 23 910
Общая амортизация 37 01в
Остаточная
J. стоимость. *WW
; 'Амортизация в
; , текущем. ьдасше . ; 2351.
Рис. 3.17. Амортизация основных средств
7-5458
193
Примеры использования Excel в бухгалтерии
новного средства. Эта информация является исходными данными для расчетов.
Заполните тестовыми данными две—три строки, чтобы при вводе формул сразу
видеть результат.
Для расчета амортизации с начала года введите в ячейку Н6 длинную формулу
=ЕСЛИ(В5< > "";ЕСЛИ(Е5+О5*С5*$М$2/12<О5;
D5*G5*$M$2/12;D5-E5);"")
В действительности эта формула просто длинная, но не сложная. Разберем
ее по частям. Первая функция ЕСЛИ выводит пустое место, если не задан инвен-
тарный номер, как и в случае порядкового номера. Если же инвентарный номер
задан, выводится результат вычисления второй функции ЕСЛИ. Коротко говоря,
если основное средство полностью амортизировано, дальше, в отрицательную
стоимость, вести расчеты не надо. Условие E5+D5*G5*$M$2/12<D5 и говорит,
что если амортизация на начало года плюс произведение балансовой стоимости
на годовой процент, поделенное на 12 и умноженное на количество месяцев,
меньше балансовой стоимости, то вывести нужно результат, подсчитанный по
формуле D5*G5*$M$2/12. Это как раз и есть амортизация за прошедшие месяцы.
Если же суммарная амортизация получается больше балансовой стоимости, рас-
чет ведется по формуле D5-E5, то есть выводится разница между балансовой сто-
имостью и амортизацией на начало года. Размножьте формулу на следующие
строки с помощью автозаполнения.
В следующую ячейку, в столбце амортизации за период эксплуатации, вво-
дится простая формула =ЕСЛИ(В5О"";Е5+Н5;""). Если введен инвентарный
номер, суммируются амортизация на начало года и амортизация за прошедшие с
начала года месяцы. Аналогично, в следующем столбце рассчитывается остаточ-
ная стоимость с помощью формулы =ЕСЛИ(В5О"";О5-15;""). Также размножь-
те формулы на расположенные ниже строки с помощью автозаполнения.
Чтобы вычислить амортизацию в текущем месяце, в ячейку К5 введите еще
более длинную, но не сложную, формулу
=ЕСЛЩВ5< > "";EOIM(E5+D5*G5*$M$2/12<D5;D5*G5*$M$2/12;
05-Е5)-ЕСЛИ(Е5+05*С5*($М$2-1)/12<05;
D5*G5*($M$2-1)/12;D5-E5);"")
Как и во всех остальных ячейках, информация выводится, только если вве-
ден инвентарный номер. Расчетная часть состоит из двух похожих фрагмен-
тов, таких же, как и в ячейке Н6. Только в первом фрагменте стоит $М$2, а во
втором — $М$2-1. В результате первый фрагмент считает амортизацию на теку-
щую дату, а второй - амортизацию на дату, отстоящую от текущей на месяц на-
зад. Вычтя из одной суммы другую, мы получим амортизацию за текущий месяц.
Эту формулу нужно тоже размножить с помощью автозаполнения.
Все сложные формулы введены, осталось только добавить суммарные пока-
затели. Они вводятся предельно просто, например для вычисления общей балан-
совой стоимости в ячейку N5 нужно ввести формулу =СУММ(О5:О1000). Анало-
гичные формулы нужно ввести и в другие ячейки, конечно указав другие столб-
цы для суммирования.
194
Автоматизация отдельных направлений деятельности
Введя информацию об объектах, вы можете задавать месяц и рассчитывать
амортизацию на указанный период. В данной модели не учитываются некоторые
особенности амортизации, но вы без труда сможете модифицировать формулы,
пользуясь описанными выше приемами.
3.3.2. Автоматизация расчета зарплаты
Расчет зарплаты в соответствии с действующим законодательством доста-
точно сложный процесс, учитывающий множество нюансов. В небольшом при-
мере невозможно описать все ситуации, которые могут возникнуть, но большин-
ство стандартных ситуаций учесть можно. Вы можете самостоятельно доработать
данный пример под особенности вашего предприятия, используя предлагаемые
нами приемы расчетов.
Для расчетов зарплаты предлагается использовать рабочую книгу Excel с
множеством листов. На отдельном листе расположены неизменные исходные
данные — список сотрудников и некоторые дополнительные данные. Расчеты в
каждом месяце ведутся на отдельных листах. Стандартные бланки — расчетная и
платежная ведомости также расположены на отдельных листах и заполняются
автоматически.
Вначале нужно ввести исходные данные, не меняющиеся от месяца к меся-
цу, то есть список сотрудников предприятия. Отметим, что при принятии на ра-
боту или увольнении работника, описанные формулы нужно усложнить, добавив
дополнительную проверку, но в нашем примере такие варианты не предусмотре-
ны. При поступлении нового сотрудника он просто добавляется в список, а при
увольнении можно удалить сотрудника из списка. В первой строке введите заго-
ловок списка, а во второй — заголовки столбцов. В остальных строках нужно вве-
сти данные о сотрудниках (Рис. 3.18).
Обязательно нужно ввести табельный номер, фамилию и оклад сотрудника.
Количество и состав остальной информации, помещаемой в следующие столбцы
таблицы, зависит от того, какую часть расчетов зарплаты вы хотите автоматизи-
ровать, а также от того, какой состав сотрудников на предприятии, то есть какие
особенности расчета зарплаты учитыва-
ются для сотрудников. Создайте список
сотрудников и введите информацию о
нескольких сотрудниках, чтобы исполь-
зовать ее в дальнейших расчетах. Чтобы
не путаться в дальнейшем с названиями
листов, переименуйте текущий лист, на-
звав его Сведения.
В правой части листа мы располо-
жили список праздников текущего года.
Он нужен для автоматического подсче-
*':\ Таб.
в г _£.. i Р .1 :f.
Слисок сотрудников
Сотрудник Оклад Год Детей
2 | № рождения
"1Г1 77 Иванов А,В. 2000 1954 1
Т": 20 Петров. О.Л 3000 1965 S
S'1 60 Сидоров С С. 10000 1972 С
в i 99 Иванидэе К К 10000 1963 3
F j G
Праздники
01 января
02 января
07 января
23 февраля
08 марта
01 мая
02 мая
09 мая
12 июня
07 ноября
12 декабря
Рис. 3.18.
Список сотрудников и праздники
195
Примеры использования Excel в бухгалтерии
та рабочих дней в любом месяце. Если вы не хотите определять автоматически
эту информацию, а введете ее вручную, вводить список праздников не нужно.
Для тех, кто решил автоматизировать определение рабочих дней, необходимо
учесть несколько правил. Все даты вводятся как дата, а не как текст! Хотя в
примере в ячейке вы видите 01 января, в действительности в ячейку введена да-
та 01.01.02, после чего применен формат [$-РС19]ДД ММММ. Совсем не обяза-
тельно применять именно этот формат, но вводить нужно именно дату, а не про-
сто текст. Даты необходимо вводить с учетом выходных дней в текущем году. Ес-
ли вы укажите, что, например, праздником является 1 января 2002 года, то это
не значит, что праздником будет считаться 1 января 2003 года. Также, если вы-
ходной день перенесен на другое число, программа не может самостоятельно
догадаться об этом. Вы должны ввести в список праздников все дополнитель-
ные выходные дни, чтобы Excel смог вычислить количество рабочих дней в нуж-
ном месяце.
Чтобы работало автоматическое определение количества рабочих дней, дол-
жен быть установлен пакет анализа, как и в случае с использованием функции
ДАТАМЕС, описанной выше. Для установки пакета анализа нужно выбрать ко-
манду Сервис Х£> Надстройки и установить в появившемся диалоге флажок рядом
с названием Пакет анализа. В случае, когда данного названия нет в диалоге, нуж-
но выполнить дополнительную установку Excel, чтобы добавить в систему нуж-
ную надстройку.
После того, как введены исходные данные, нужно ввести формулы в лист
расчетов зарплаты. Как отмечалось выше, на листе выполняется расчет зарплаты
в конкретном месяце, а скопировав содержимое листа на другой лист, вы може-
те рассчитать зарплату за другой месяц. Перейдите на новый лист и приготовь-
тесь вводить расчетные формулы.
В заголовке, кроме названия таблицы, нужно ввести дату, для которой вы-
полняются расчеты. При этом нужно ввести именно дату, например 1.01.02, а не
слова «Январь 2002». Чтобы в таблице выводилось название месяца и год, нужно
выбрать соответствующий формат даты. В нашем примере дата введена в ячейку
//, и именно эта ячейка используется в формулах.
Далее нужно определить количество рабочих дней. Если вы не ввели ранее
список праздников или не установили пакет анализа или просто не доверяете
Excel в определении количества рабочих дней, введите вручную нужное число в
ячейку D2. В противном случае введите в эту ячейку формулу
=ЧИСТРАБДНИ(ДАТА(ГОД(Л);МЕСЯЦ(Л);1);КОНМЕСЯЦА(Л;0);
Сведения!С2:С12)
Функция ЧИСТРАБДНИ вычисляет количество рабочих дней между датами
ДАТА(ГОД(Л);МЕСЯЦ(Л);1) и КОНМЕСЯЦА(Л;0), то есть между первым и по-
следним числом нужного месяца, который введен в ячейку //. Аргумент Сведе-
ния!С2:С12 задает список праздников, о котором было рассказано выше.
С четвертой по шестую строку вводятся заголовки расчетного листа, а начи-
ная с седьмой строки - расчетные формулы и исходные данные. Первые 11 столб-
196
Автоматизация отдельных направлений деятельности
Количество рабочих дней 20
D I Е 1 F ' ; 6'- I Н | ' I •[ :J ;:;;i:.: К
РАСЧЕТНЫЙ ЛИСТ по ЗАРПЛАТЕ за Январь 2002
4 №n/n
JL
6
Таб. № Ф.И.О. сотрудника Оклад Отработ
ано дней
Аванс Зарплата Больниц.
Лист
Отпуск Доплаты Начислено
7 1 20 Петров. О.Л. 3000,00 21; 1000,00: 3150,00 1000,00 4150,00
8 2;" 77 Иванов А.В. \2QOO~00] 15; 1500,00 ' . 5 0 0 . 0 0 - ' : 2000,00
Рис. 3.19. Левая часть расчетного листа
цов предназначены для определения величины начислений (Рис. 3.19). Введите
названия столбцов, после чего приступим к вводу нужных формул.
Для автоматической нумерации по порядку применим прием, описанный
выше. Введите в ячейку Л7 формулу =ЕСЛИ(В7<>"";!;""), то есть, если введен
табельный номер, в ячейке выводится единица, а в противном случае выводится
пробел. Введите в ячейку AS формулу =ЕСЛИ(В8О"";А7+1;"") и с помощью ав-
тозаполнения размножьте ее на расположенные ниже строки, чтобы количество
строк с формулами было не меньше, чем количество работников предприятия.
Табельный номер в следующем столбце вводится вручную, и автоматически по-
является порядковый номер в первом столбце.
Фамилия вставляется с помощью функции ВПР, которая используется в
предыдущих примерах. Введите в ячейку С7 формулу =ЕСЛИ(В7О"";ВПР(В7;
Сведения!$А$3:$Е$100;2;ЛОЖЬ);"") и размножьте ее на следующие строки с по-
мощью автозаполнения. Если введен табельный номер, из списка сотрудни-
ков берется фамилия, соответствующая этому номеру. Аналогично в ячейку D7
введите =ЕСЛИ(В7О"";ВПР(В7;Сведения!$А$3:$Е$100;3;ЛОЖЬ);"") и раз-
множьте эту формулу с помощью автозаполнения. В данный столбец помещает-
ся оклад.
Количество отработанных дней и выданный аванс вводятся вручную, а зар-
плата вычисляется по простой формуле =D7/$D$2*E7. Введите ее в ячейку G/и
размножьте на расположенные ниже ячейки. В нашем примере отпускные и оп-
лата больничного листа заполняется вручную, хотя вы можете добавить форму-
лы для их вычислений. Также вручную заполняются прочие доплаты, например
премии сотрудникам. В итоге для получения начисленной суммы нужно в ячей-
ку К7ввести формулу =CVMM(G7:J7) и размножить ее на остальные ячейки дан-
ного столбца.
Для лучшего внешнего вида скроем нулевые значения ячеек. Для этого вы-
делите ячейки, в которых расположены разные суммы, и выберите команду ме-
ню Формат э£> Ячейки. Появится диалог настройки формата, в котором перей-
дите на вкладку Число и выберите в списке все форматы. Введите тип формата
0,00;0,00;#. Теперь положительные и отрицательные числа будут выводиться в
формате с двумя знаками после запятой, а нули не будут отображаться.
После того, как вы ввели данные о начислениях, нужно заполнить ячей-
ки, рассчитывающие вычеты и сумму к выдаче (Рис. 3.20). В столбцах с L по У
197
Примеры использования Excel в бухгалтерии
v_r| '• L M N ! 0 i P ' j Q
ECU
: 5 j 28,00%
14,00%
Щ
7 j 581,00
Tl 280,00
страховая
часть
456,50
220^00
накопит
часть
4,00% 3,40% 0,20%
R
травм
атизм
2%
s ,. I т
ДОХОД С
начала
года
_ . u.l: L. . у
йдфл
W j X
стандартные вычеты
прочие
124,50 166,00 141,10: 8,30 8,30 0 400,00
60,00 80,00 68,00 4,00 4,00 0
КОЛ-ВО
детей
2
за
детей
Индией
ДУаЛ-
13%
Y
К ВЫДАЧЕ"
по
платежной
ведомости
600,00 409,50! 2740,60
300,00500,00 156,00 1844,00
Рис. 3.20. Правая часть расчетного листа
определяется не только сумма к выдаче, но и различные налоги. Введите за-
головки столбцов и сгруппируйте ячейки, чтобы получить такую же таблицу,
как у нас.
Вначале рассчитывается ЕСН. Никаких сложностей при вычислении частей
этого налога нет. Например, для определения части налога в ФОМС, нужно вве-
сти формулу =К7*0,2%. При желании, проценты можно ввести на листе сведе-
ний, а при расчете ссылаться на нужную ячейку, но проще ввести процент прямо
в формулу. Так же, как и ЕСН, рассчитывается и страхование травматизма. Для
расчета подоходного налога учитываются различные вычеты из налогооблагае-
мой базы. В ячейку U7 вводится формула =ЕСЛИ(В7О"";ВПР(В7;Сведе-
т1я!$А$3:$Е$100;5;ЛОЖЬ);""), позволяющая вставить количество детей сотруд-
ника. Отметим, что если по закону выплата на ребенка удваивается, нужно про-
ето указать, что у сотрудника двое детей. Сумма вычета за детей рассчитывается
по формуле =U7*300. В ячейке W7вводятся дополнительные льготы, установлен-
ные для отдельных категорий граждан. Для остальных льгота в 400 рублей вводит-
ся в столбец Т. Введите в ячейку 77формулу =ЕСЛИ(И(В7О"";Н7=0);400;0). Так
как эта льгота прекращается при получении 20000, в столбец S вводится суммар-
ный полученный доход. В принципе, его также можно рассчитать автоматически,
но в нашем простом примере это не делается.
Чтобы получить сумму налога на доходы физических лиц, введите в ячейку
Х7 формулу
=ЕСЛИ(В7< > "";ЕСЛЩ57<20000;(К7-Т7- V7- W7) *13%;
(K7-V7-W7)*13%);"").
Как и в других формулах, результат выводится только, если введен табель-
ный номер. Начисленная сумма без сумм вычетов умножается на 13 процентов.
При этом если сумма выплат в этом году не превысила 20000 рублей дополни-
тельно используется вычет в размере 400 рублей. Сумма к выдаче вычисляется в
ячейке У7по простой формуле =ЕСЛИ(В7О"";К7-Р7-Х7;""), то есть из начис-
ленной суммы вычитается выданный аванс и сумма подоходного налога.
Далее установите форматы, которые скрывают нулевые значения, как и для
первой части таблицы, и размножьте формулы на нужное количество строк. Еще
правее, в столбцах АА и АВ, можно ввести названия и общие суммы по разным
столбцам, например, Всего начислено и =СУММ(К7:К100) или Всего травматизм
и =СУММ(К7:К100).
Вы можете изменить таблицу в соответствии с особенностями расчета зар-
платы на вашем предприятии, но основные приемы, изложенные выше, под-
198
Автоматизация отдельных направлений деятельности
ходят практически везде. В результате вы получите все нужные данные, на
основании которых можно автоматически заполнить разные стандартные до-
кументы.
Расчеты выполняются на разных листах, каждый для своего месяца. Стан-
дартные формы вряд ли нужно размножать, поэтому необходимо вставлять ин-
формацию с различных листов в одни и те же бланки. Для того чтобы знать,
какой лист используется для текущих расчетов, его имя нужно ввести в какую-
либо ячейку. Мы выделили для этого ячейку HI листа Сведения. Вы можете назы-
вать листы так, как вам больше нравится, но перед тем, как заполнять стандарт-
ные формы, введите в эту ячейку имя текущего расчетного листа, например,
JIucmS или Октябрь.
Чтобы получить данные из нужной ячейки, например табельный номер пер-
вого сотрудника в списке, следует воспользоваться формулой =ДВССЫЛ(АД-
РЕС(7;2;;;Сведения!$Н$1)). Функция ДВССЫЛ возвращает значение ячейки, ад-
рес которой указан в качестве аргумента. Функция АДРЕС возвращает адрес
ячейки, расположенной на листе, имя которого задано в ячейке Сведения!$Н$1.
Первые два аргумента задают номер строки и столбца, так что с помощью опи-
санной формулы можно получить содержимое ячейки В7 нужного листа. Воз^
можно, формулы в ячейках стандартных бланков получатся громоздкие, но до-
статочно простые, и вам не понадобится вручную заполнять множество доку-
ментов.
Заполнение нужных полей простое и однообразное занятие. Вы берете поле
стандартного бланка и находите аналогичное поле листа расчетов. Вставляя фор-
мулу, аналогичную описанной выше, вы заполняете поле и переходите к следую-
щему. При этом могут понадобиться дополнительные вычисления. Например,
если на расчетном листе в ячейке АВ10 выводится общая сумма выплаты, вам мо-
жет понадобиться вывести ее прописью. Для этого введите формулу
=СуммаПрописью(ДВССЫЛ(АДРЕС(10;28;;;Сведения!$Н$1)))
Аналогично вы можете применять и другие функции, используя в качестве
аргумента описанную формулу. А какие стандартные бланки можно заполнить
автоматически на основе полученной информации? Таких бланков достаточно
много.
Так как в расчетном листе вычисляются различные налоги, можно сразу за-
полнить платежные поручения для их перечисления. О заполнении бланка пла-
тежного поручения рассказывалось выше. При уплате налогов нужно заполнить
ячейки информацией о плательщике и получателе, а сумму взять из расчетного
листа. Аналогично можно заполнить расходный кассовый ордер, по которому из
кассы выдаются деньги на зарплату. Бланк расходного кассового ордера очень
похож на бланк приходного кассового ордера, рассмотренного выше в одном из
примеров.
Также можно автоматически заполнить расчетную ведомость, то есть стан-
дартную форму № Т-51, создание которой описывалось в начале главы, и пла-
тежную ведомость, то есть стандартную форму № Т-53. Для создания платежной
199
Примеры использования Excel в бухгалтерии
ведомости следует применить точно те же приемы, что и при создании расчетной
ведомости. Так как платежная ведомость содержит некоторые поля расчетной
ведомости, и не содержит никакой дополнительной информации, ее заполнение
не представляет никаких трудностей, если вы сумели заполнить расчетную ведо-
мость. Рассмотрим некоторые особенности описания формул для добавления
нужных значений в обе ведомости.
Вначале нужно ввести порядковый номер. Для этого используется очень
длинная, но чрезвычайно простая формула. Если, как в нашем примере, номер в
расчетную ведомость вводится в первый столбец, начиная с пятой строки, в
ячейку А5 введите формулу
=ЕСЛИ(ДВССЫЛ(АДРЕС(СТРОКА()+2;1;;;Сведения!$Н$1))< > "";
ДВССЫЛ(АДРЕС(СТРОКА() +2;1;;;Сведенш!$Н$1));"")
Если в первом столбце расчетного листа на строке с номером, вычисляемым
по формуле СТРОКА()+2, есть номер, то он проставляется в расчетную ведо-
мость. Так как мы ввели формулу в ячейку пятой строки, то результатом вычис-
ления будет семь, то есть первая строка списка в расчетном листе. Если у вас спи-
ски расположены в других ячейках, измените соответственно формулу. Размно-
жив формулу по другим ячейкам первого столбца расчетной ведомости с помо-
щью автозаполнения, вы добавите автоматическую нумерацию для всех запол-
ненных строк.
Остальные ячейки заполняются еще проще. Например, чтобы вывести в
ячейке СЗ фамилию сотрудника, введите в нее формулу =ЕСЛИ(А5<>"";
ДВССЫЛ(АДРЕС(6+А5;3;;;Сведения!$Н$1));""). Если номер по порядку отсутст-
вует, выводится пустое место. В противном случае выводится значение из строки
6+А5, то есть из седьмой строки. При этом используется третий столбец, то есть
берется нужная фамилия. Размножив формулу, вы заполните все ячейки нужно-
го столбца. Аналогично, для вывода выплачиваемой суммы введите в нужную
ячейку расчетной ведомости формулу =ЕСЛИ(А5О"";ДВССЫЛ(АДРЕС(6+А5;
25;;;Сведенчя!$Н$1));"").
Если для некоторых столбцов отсутствуют исходные данные, можно ввес-
ти их вручную, но лучше добавить нужную информацию на лист сведений или
на расчетный лист. Например, можно добавить профессию сотрудника, доба-
вив еще один столбец в список сотрудников. Например, профессия расположе-
на в столбце F. В этом случае в ячейку расчетной ведомости нужно вставить
формулу
=ЕСЛИ(А50"";ВПР(В5;Сведения!$А$3:$Р$100;6;ЛОЖЬ);"")
Как и в расчетном листе, профессия определяется по табельному номеру.
Будьте особо внимательны! При добавлении строк и столбцов в таблицу нужная
информация может оказаться в ячейке с другим адресом. Например, вначале
название используемого расчетного листа располагалось в ячейке Ш, но при
добавлении столбца для профессии ячейка поменяла своя адрес на П. Ссылки в
формулах изменились автоматически, но если вы будете вводить новые форму-
лы, в них нужно указывать уже Сведения!$1$1, а не Сведения!$Н$1.
200
Автоматизация отдельных направлений деятельности
Создайте 11 листов и скопируйте на них данные с первого расчетного лис-
та. Так вы можете выполнять расчет зарплаты для каждого месяца. В новом го-
ду лучше создать новую копию рабочей книги. Вы можете добавить к рабочей
книге дополнительные листы по количеству сотрудников, и автоматически вес-
ти расчеты начислений и удержаний для каждого работника. Все данные для
этого имеются, и нужно просто сложить нужные суммы с разных расчетных ли-
стов. Вы без труда сможете самостоятельно выполнить эту работу при необходи-
мости.
Описанные приемы работы позволяют создать сложную, практически пол-
ностью автоматизированную систему расчета заработной платы с помощью эле-
ктронных таблиц Excel. Однако вам потребуется потратить для этого некоторое
время. Кроме того, наш пример можно рассматривать только как заготовку, а
настроить расчет на особенности вашего предприятия вам придется самостоя-
тельно.
3.3.3. Учет поставок товаров и услуг потребителям
Электронные таблицы Excel удобны для учета различных периодических дей-
ствий. При этом встроенные средства позволяют автоматизировать консолида-
цию значений и отобразить результат в удобном и красивом графическом виде.
Отметим, что наиболее удобны средства, встроенные в Excel 2002 или Excel 2000.
Предыдущие версии программы обладают только частью возможностей послед-
них версий.
В предлагаемом примере ведется учет поставок товаров крупной оптовой
фирмой, работающей с несколькими покупателями. Поставки в каждом месяце
вводятся на отдельном листе рабочей книги, причем заносятся данные по по-
ставкам различных групп товаров каждому покупателю. Создайте такую таблицу,
чтобы описать поставки за какой-либо месяц (Рис. 3.21).
Скопируйте содержимое листа на два других листа рабочей книги и измени-
те данные, чтобы описать поставки за три месяца. После того, как все исходные
данные введены, можно приступить к анализу поставок, и для этого удобно ис-
пользовать сводные таблицы. Если вы не знаете, что это такое, вначале прочи-
тайте раздел этой книги, посвящен-
ный работе со сводными таблицами.
Для создания сводной таблицы
выберите команду меню Данные Х£>
Сводная таблица. Будет запущен мас-
тер создания сводных таблиц и на эк-
ране появится его первый диалог. С
помощью верхнего переключателя на-
до выбрать исходные данные для таб-
лицы. Так как наша информация нахо-
: :J ...... .....ft. ........ J ............ Р ............ ! ........... и ..........
Поставки товаров за месяц
в миллионах рублей
4
5 Телевизоры
6 ; Видеомагнитофоны
7
в
Муз. центры
Бытовая техника
У Прочее
ФилиалвС
Пб
15.00
13,00
40.00
120,00
20.00
Филиале
НикНоег
25.40
67,00
43,00
50.00
120,00
ООО
"Продажи"
45.00
32.00
40,00
0,00
0,00
Сеть магазинов
"Солнце"
79,00
60.00
40.00
120.00
10,00
Рис. 3.21.
Поставки за месяц
201
Примеры использования Excel в бухгалтерии
дится на нескольких листах, нужно выбрать вариант в нескольких диапазонах кон-
солидации. В качестве создаваемого отчета выберите с помощью второго пере-
ключателя сводная диаграмма (со сводной таблицей). Если вы работаете с Excel 97,
сводную диаграмму построить нельзя. Установите переключатели в нужное по-
ложение, чтобы перейти к следующему шагу мастера. В диалоге выберите вари-
ант Создать одно поле страницы и нажмите кнопку Далее.
В появившемся диалоге нужно задать адреса ячеек с исходными данными.
Вы можете вручную ввести нужные адреса, но удобнее обвести ячейки с помо-
щью мыши. Щелкните мышью на поле Диапазон в диалоге, перейдите на первый
лист с данными, и выделите с помощью мыши ячейки с заголовками и введен-
ными данными. Адрес ячеек появится в поле. В нашем случае это адрес Октябрь!
$А$4:$Е$10. Первый лист мы назвали Октябрь, а в ячейках с А4 по ЕЮ располо-
жены введенные данные. Нажмите кнопку Добавить, и адрес будет добавлен в
список диапазонов, расположенный в нижней части диалога. Далее перейдите на
второй лист и выполните аналогичные действия, после чего добавьте адрес яче-
ек с третьей страницы. В итоге в списке диапазонов должны присутствовать три
строки со ссылками на нужные ячейки. Нажмите кнопку Далее, чтобы перейти к
следующему шагу. При работе с Excel 97 появится диалог настройки таблицы.
Ничего не меняя нажмите кнопку Далее. В более поздних версиях этот диалог не
появится, и вы сразу перейдете к следующему шагу мастера.
В появившемся диалоге с помощью переключателя выберите построение
диаграммы на новом листе. Дополнительные настройки можно не выполнять,
приняв значения по умолчанию. Нажмите кнопку Готово, чтобы завершить
работу с мастером. На новых листах будут построены сводная таблица и сводная
диаграмма.
Перейдите на лист со сводной таблицей. Вначале изменим названия заго-
ловков, после чего рассмотрим принципы работы со сводной таблицей. В ячей-
ку А1 вместо Страница! введите название Месяц. В ячейку A3 вместо Сумма по
полю Значение введите Сумма поставок. В ячейку А4 вместо Строка введите То-
вар, а в поле ВЗ вместо Столбец введите Клиент. В результате вы должны полу-
чить примерно такую таблицу (Рис. 3.22).
В каждой ячейке сводной таблицы выводится сумма поставок за все месяцы
определенного товара одному из клиентов. Нажав кнопку \+'-, расположенную
fl(Bce)
,р:
I : Бытовая техника
8 : Видеомагнитофоны
7 |Муз центры
8 i Прочее
9 ! Телевизоры
цийитог
Л
ООО "Продажи" ' Сеть магазинов
в:
222
172] '_
151
182Т ~
599;
"Солнце" Филиал в Ниж. Новг.
158;. 141
140: 114
121 91
77i 211
._.„, ~~{l9,4
709: 676,4
Филиал в С-Пб Общий итог
254 555
" 108 584
132 516
105 408
90 610,4
689 2673,4
Рис. 3.22. Сводная таблица
202
Автоматизация отдельных направлений деятельности
Рис. 3,23. Различный вид диаграмм
в правой части ячейки В2, вы откроете диалог со списком месяцев, правда, на-
зываются они иначе, и их нужно переименовать. Выберите один из элементов
списка и нажмите кнопку ОК. В таблице появятся данные о продажах за один из
месяцев, то есть копия одного из заполненных ранее листов. Щелкните мышью
на ячейке В1 и измените название на название нужного месяца, например,
ОбъектЗ на Октябрь. Аналогично введите названия остальных месяцев. Под ко-
нец выберите в списке месяцев элемент (Все), чтобы снова вывести суммарную
информацию.
В сводной таблице кроме сумм за все месяцы выводятся итоги по отдель-
ным товарам и по разным клиентам. Просмотрев эти цифры, вы можете сделать
соответствующие выводы, но значительно удобнее работать с графическим
представлением информации. Перейдите на лист с диаграммой, в которой ото-
бражается та же информация, что и в сводной таблице (Рис. 3.23, слева). Напо-
минаем, что при работе с Excel 97 сводная диаграмма не создается, но вы може-
те выделить сводную таблицу и построить обычную диаграмму. Мы же продол-
жим описание работы со сводной диаграммой, которую можно построить в
Excel 2002 и 2000.
Вы можете сильно изменить внешний вид диаграммы (Рис. 3.23, справа),
выбрав в меню команду Диаграмма и выбирая разные команды во вложенном
меню, но главное достоинство сводной диаграммы не в этом. Как и в сводной
таблице, вы можете выбрать конкретный месяц, информация о котором вас ин-
тересует. Для этого нужно нажать кнопку NT•-,
расположенную в левом верхнем углу таблицы,
и выбрать в появившемся диалоге нужный ме-
сяц. С помощью похожих списков, располо-
женных в правой и нижней части диаграммы,
можно выбрать вывод выборочной информа-
ции по отдельным клиентам и по отдельным
видам товаров (Рис. 3.24).
Если вы измените исходные данные, нуж-
но перейти на лист со сводной таблицей, щелк- рис. 3.24. Вывод
нуть на ней мышью и выбрать команду меню выборочной информации
203
Примеры использования Excel в бухгалтерии
Данные з£> Обновить данные. Сводная таблица будет пересчитана, а вместе с ней
автоматически изменится сводная диаграмма. При больших объемах информа-
ции сводные таблицы и сводные диаграммы являются чрезвычайно удобным
средством обобщения разных данных.
3.3.4. Автоматизация складского учета
При учете товаров, хранящихся на складе, бухгалтеру особенно важно
знать их себестоимость для верного расчета налогов. Если на склад поступают
партии товаров разной стоимости, стоимость уходящих со склада товаров мож-
но рассчитать разными способами. Проще всего вычислить средневзвешенную
стоимость всех товаров данного типа, и при отгрузке со склада считать стои-
мость таких товаров одинаковой. Иногда удобнее учитывать при уходе со скла-
да стоимость, по которой товар пришел на склад. При этом возможны разные
методы выбора товара для отгрузки. Наиболее часто применяется метод FIFO,
то есть первым уходит товар, поступивший первым на склад. В предлагаемом
примере мы покажем, как реализовать расчеты при использовании метода
FIFO и при определении средневзвешенной стоимости товара. При этом ос-
новной упор в примере сделан именно на расчет стоимости, а не на удобство
ввода информации о поступивших и ушедших товарах. Используя описанные
выше приемы, вы можете модифицировать таблицу, дополнив ее средствами
автоматизации ввода.
Рабочая книга Excel для учета движения товаров по складу состоит из двух
листов. На первом листе, названном нами Приход, описывается поступление то-
варов на склад. На втором листе, называющемся Уход, описывается уход товаров
и.рассчитывается их стоимость. Можно добавить еще один лист, в котором будет
отражаться текущее состояние склада, то есть все имеющиеся в наличии товары.
Эту простую задачу вы сможете решить самостоятельно, так что мы не будем на
ней останавливаться, сконцентрировав внимание на учете прихода и ухода.
Переименуйте первый лист рабочей книги, назвав его Приход. Введите заго-
ловки в первые две строки таблицы (Рис. 3.25). Вы можете создать таблицу с
; А В 2_sc ; 0 Е F
1 Поступление товаров на склад
: : 1 Наименование
1 ! товара
3 [Телевизор ТВ21
^<П Магнитофон М14
5 Телевизор ТВ21
в 'Телевизор ТВ25
7 i Телевизор ТВ21
8 ;Телевизор ТВ21
9; Телевизор ТВ21
10 j Радиоприемник Р1
Дата
поступления
01 10.2002
02.10.2002
05.10.2002
06.10.2002
06.10.2002
07.10.2002
08.10.2002
12.10.2003
Количество
120
200
30
57
50
111
55
120
Стоимость
единицы
3000
700
2950
4100
3100
3150
3200
"зрр
Стоимость
партии
360000
~НОООО
88500
233700
155000
349650
176000
36000
е н m
Общее количество товаров
Текущая
поставка
120
200
150
57
200
311
366
120
Предыдущая
поставка
0
0
120
0
150
200
311
. °
Следующая I
поставка [
150;
200)
200
57
311
366 ;
366
120
Рис. 3.25. Поступление товаров на склад
204
Автоматизация отдельных направлений деятельности
большим количеством столбцов, например, указав код товара, его дополнитель-
ные характеристики и так далее. Также можно не указывать дату поступления то-
вара. В нашем примере она введена только для справки, и не используется в рас-
четах. Главное, нужно ввести наименование товара, его количество и стоимость.
При этом можно ввести или стоимость единицы товара, или стоимость всей пар-
тии. В нашем примере вводится стоимость единицы, а стоимость партии рассчи-
тывается по формуле =D3*C3. Конечно, эту формулу нужно с помощью автоза-
полнения размножить на все строки таблицы.
Вы можете поступить иначе. Введя общую стоимость партии товара в ячей-
ку ЕЗ, в ячейку D3 ввести формулу =ЕЗ/СЗ. Для работы с таблицей выбор лю-
бого из этих способов безразличен. В столбцы F, G и Я вводятся формулы для
расчета общего количества товаров данного типа, находящихся на складе. Эта
информация потребуется для расчетов. Введите в ячейку F3 формулу =СУМ-
МЕСЛИ($А$3:АЗ;АЗ;$С$3:СЗ). Условное суммирование проверяет заданный ди-
апазон ячеек и складывает информацию из тех строк, в которых выполняется
заданное условие. Проверяются значения в ячейках $А$3:АЗ, то есть в первом
столбце, начиная с первой строки до текущей строки. Вначале первая и теку-
щая строки совпадают, но в дальнейшем они будут различаться, например, в
десятой строке формула примет вид $А$3:А10. Чтобы правильно работало авто-
заполнение, применяется абсолютная адресация для первой ячейки диапазона
и относительная нумерация для последней ячейки. В качестве второго аргу-
мента функции СУММЕСЛИ используется A3. Информация из всех ячеек пер-
вого столбца, расположенных выше текущей, будет сравниваться с информа-
цией из текущей строки. Так будут отобраны только строки, описывающие по-
ступление однотипного товара. Для этих строк будут просуммированы ячейки
$С$3:СЗ, то есть количество товаров в партии. В итоге, мы получим в ячейке F3
общее количество товаров данного типа, имеющихся на складе после текущей
поставки.
Введите в ячейку G3 формулу =РЗ-СЗ, чтобы получить количество товаров,
имеющихся на складе до текущей поставки. Для получения количества товаров,
которое будет на складе после следующей поставки, нужно использовать более
сложную формулу. Введите в ячейку НЗ формулу
=ЕСЛИ(ЕНД(ВПР(АЗ;А4:С101;6;ЛОЖЬ));РЗ;
ВЛР(АЗ;А4:С101;6;ЛОЖЬ))
С помощью формулы ВПР(АЗ;А4:С101;6;ЛОЖЬ) находится первая строка
после текущей, в которой описывается поставка такого же товара, и получается
информация из шестого столбца, то есть количество товаров в партии. Функция
ВПР подробно описана выше, так что не будем на ней останавливаться. Функция
ЕНД в формуле ЕНД(ВПР(АЗ;А4:С101;6;ЛОЖЬ) определяет, не возвращает ли
функция ВПР ошибку. Если функция возвращает ошибку, то есть больше поста-
вок товара не было, выводится количество товара после текущей поставки. В
противном случае выводится результат вычисления функции ВПР, то есть коли-
чество товара на складе после следующей поставки.
205
Примеры использования Excel в бухгалтерии
С 1: О . . „
Отарузка товаров со склада
2 Наименование
товара
щ
:4 :ТелевизорТВ21
5 : Магнитофон М1 4
6 Телевизор ТВ21
7 ;ТелевизорТВ21
8 Телевизор ТВ21
9 'Магнитофон М14
Дата
выдачи
Колмч
ество
08.10.2002 10
09.10.2002 32
10.10.2002 90
1010.2002 45
11.10.2002 19
12.10.2002 34
ФИФО
Стоимость
единицы
3000,00
700,00
3000,00
2972,22
3060,53
700,00
Стоимость
партии
30000,00
22400,00
270000,00
133750,00
58150,00
23800,00
СВЗ
Стоимость
единицы
3085,11
700,00
3085,11
3085,11
3085,11
700,00
Стоимость
партии
30851,09
22400,00
277659,84
138829,92
58617,08
23800,00
Так как последние три числа нужны только для вычислений, можно их
скрыть, например, выбрав для соответствующих ячеек белый цвет текста или
скрыв нужные столбцы. Однако вводить формулы в ячейку нужно обязательно,
иначе невозможно вычислить правильную стоимость уходящих со склада товаров.
При поступлении товара вы должны вручную заполнить ячейки с его наиме-
нованием, количеством и стоимостью, а также с другими параметрами, которые
вы захотели учитывать. Далее с помощью автозаполнения нужно скопировать
формулы из предыдущей строки. Для правильного функционирования таблицы
нужно вводить информацию в хронологическом порядке. Если вы вставите стро-
ку с описанием последней поставки в середину списка, система расчетов будет
нарушена. Введите несколько строк с описанием поставок разного товара, после
чего можно приступить к описанию таблицы учета ухода товара со склада.
Перейдите на второй лист рабочей книги и переименуйте его, назвав Уход.
В первые три столбца вручную вводится наименование товара, дата выдачи со
склада, количество ушедших то-
варов. Для удобства можно наст-
роить выбор товара из списка, но
мы не будем на этом останавли-
ваться. Далее выводится по раз-
ным методам рассчитанная стои-
мость единицы товара и всей от-
груженной партии. Формулы для
их расчетов мы введем немного
позже, а пока введите названия в
заголовки таблицы и для примера введите описания нескольких партий отгру-
женных со склада товаров (Рис. 3.26).
В столбцах с Н по О находятся промежуточные данные, нужные для рас-
чета (Рис. 3.27). Как и для первого листа, эта информация может быть скры-
та выбором белого цвета или скрытием соответствующих столбцов, но фор-
мулы в ячейки ввести нужно обязательно, а в дальнейшем размножать их на
следующие строки с помощью автозаполнения. Введите названия в заголов-
ки, после чего приступим к вводу формул.
Введите в ячейку Н4 формулу =СУММЕСЛИ($А$4:А4;А4;$С$4:С4). Как и при
поставке товаров, суммируется
количество ушедших со склада
товаров. Единственное отличие,
что складываются числа из ячеек
предыдущих строк, а не следую-
щих, как описано выше. В ячейку
14 введите формулу =Н4-С4. Так
вычисляется количество товаров,
ушедших со склада во всех преды-
дущих партиях.
Рис. 3.26.
Уход товаров со склада
м
Ячейки вспомогательных^ расчетов
j Всего ушло
: Текущая
\ операция
Прошлая
операция
Остаток поставки
Количест
во
Сумма
Основная поставка
Копичест
во
Сумма
Начало поставки
Количест
во
Сумма
10
32;
100
145
164
" 66
;
О О О
о о о
10 110 3*00
100 20 3000
145 5 2950
~32Г~ ~ 168 ~ ~70б!"
10
32
3000
700:
-20 3000
•j25"_' 2S50
_ м" "" 3100
700-134
Рис. 3.27.
Вспомогательные ячейки
206
Автоматизация отдельных направлений деятельности
Перед тем, как начать вводить достаточно сложные формулы в остальные
ячейки, нужно понять особенности используемого алгоритма расчетов. Товары
могут поступать на склад и уходить с него партиями разного размера. При этом
в уходящей партии могут быть товары из разных поступлений с различной сто-
имостью. Если нужно точно определить стоимость каждого уходящего товара,
следует отпускать со склада не партиями, а единицами товара. Соответственно,
в таблицу учета ухода вносятся записи о каждом ушедшем товаре. Однако ино-
гда это бывает не совсем удобно. В этом случае лучше определить средневзве-
шенную стоимость уходящих товаров для каждой партии, чтобы стоимость раз-
ных экземпляров товара в каждой отгруженной партии была одинаковой. Мы
реализуем именно такой метод, причем, если указывать в графе количества то-
варов единицу, определяться будет точная стоимость конкретного экземпляра
товара.
В любой уходящей партии могут находиться товары, условно разделенные на
три группы, для каждой из которых задается своя формула вычисления себесто-
имости. Часть товаров взято из партии прихода, товары из которой уже ушли ра-
нее. Вторая группа состоит из товаров, которые полностью, в составе всей при-
шедшей партии, уходят сейчас со склада. Третья группа состоит из товаров, при-
надлежащих партии прихода, товары из которой еще остаются на складе и будут
отгружены в следующий раз. Определив стоимость и количество товаров в каж-
дой группе, мы сможем узнать средневзвешенную себестоимость партии уходя-
щего товара.
Начнем мы с определения количества товара первой группы, но сначала от-
метим некоторые особенности используемых формул. В расчетах используются
формулы для массивов, которые позволяют вычислить множество значений за
одну операцию. В ячейке формулы массивов отмечены фигурными скобками {и },
но при вводе эти скобки вставлять не надо. После того, как вы введете нужную
формулу в ячейку, нужно нажать комбинацию клавиш [[см]+рыв|+||Enter|. Фи-
гурные скобки будут добавлены автоматически. Будьте особо внимательны! Если
вы случайно перейдете в режим редактирования ячейки с формулой массива и
нажмете клавишу [|Entei|, фигурные скобки будут убраны, формула массива пре-
вратится в обычную формулу, и расчеты окажутся неверными. Введите в ячейку
J4 формулу
{=ЕСЛИ(14=0;0;СУММ((Приход!$А$3:$А$101=А4)*
(Приход!$С$3:$С$10К14)*Приход!$С$3:$С$101))-14}
Не забудьте, что для добавления фигурных скобок нужно нажать комбина-
цию клавиш | ctri |+[jTshift]+[[Enter], а не вводить эти символы с клавиатуры.
С помощью функции ЕСЛИ определяется, были ли раньше отгрузки этого
товара. Если описываемый уход первый, выводится 0, так как товара первой
группы в этом случае быть не может. В противном случае количество товара рас-
считывается по формуле, используемой в качестве последнего аргумента функ-
ции ЕСЛИ. Эта формула достаточно сложная, поэтому подробно опишем осо-
бенности ее функционирования.
207
Примеры использования Excel в бухгалтерии
При работе с компьютерами вообще, и в Excel в частности, логическое зна-
чение ИСТИНА считается равной единице, а ЛОЖЬ — нулю. Если в формуле мас-
сива используется произведение логического выражения на любое число, в ре-
зультате мы получим исходное число, если выражение истинно, и ноль, если
логическое выражение ложно. Этой особенностью мы и воспользовались в опи-
сываемой формуле. Функция СУММ при использовании ее в формуле массива
суммирует вычисленные выражения для всех строк массива. Если для некоторых
строк результат будет нулевым, так как в ней имеется ложное логическое выра-
жение, данные из этих строк не будут учитываться при суммировании.
Например, в формуле введено выражение Приход!$А$3:$А$101=А4. Это вы-
ражение будет истинным только для строк, в которых описывается приход того
же товара, который должен уйти. Строки с описанием прихода других товаров
будут игнорироваться. В ячейке А4 текущего листа введено название товара. Это
же название ищется в ячейках $А$3:$А$101 листа Приход. Кстати, если у вас боль-
ше сотни строк с описанием прихода товаров, увеличьте соответствующее число
в формуле.
Следующая формула Приход!$С$3:$С$101<14 выделяет только те строки,
в которых описываются партии, товар из которых частично или полностью от-
гружен. Предыдущей поставки не хватило, чтобы полностью покрыть преды-
дущий уход товара, и часть товара взята из поставки, описанной в выбранной
строке. Это и отражено в формуле: сумма товара на складе после предыдущей
поставки, находящаяся в столбце G листа Приход, должна быть меньше, чем
количество ушедших товаров до учета текущей отгрузки, то есть значения в
ячейке 14.
Последнее выражение в формуле массива, Приход!$С$3:$С$101, является не
логическим, а арифметическим выражением. Оно просто определяет количество
товаров в нужной поставке. Произведение трех выражений для каждой строки
списка полученных товаров даст в результате ноль или количество товаров
в партии, если это нужная партия товара. Суммируя эти значения, мы получим
количество товара во всех поставках, которые полностью или частично исполь-
зовались для отгрузки. Добавив выражение -14, то есть вычтя количество реаль-
но отгруженного ранее товара, мы получим количество товара в последней пар-
тии, который еще не отгружен.
В следующем столбце определяется стоимость товара в партии, частично ис-
пользуемой при предыдущих отгрузках. Введите в ячейку К4 формулу
{=ЕСЛИ(14=0;0;СУММ((Приход!$А$3:$А$101=А4)*
(Приход!$Р$3:$Р$101 >14) *(Приход!$С$3:$С$101<14) *
npuxod!$D$3:$D$101))}
Обратите внимание, что это также формула массива, так что после ее ввода
нужно нажать комбинацию клавиш | ctn |+ЦГзмй]+[[Enter]. Формула похожа на опи-
санную выше. Также проверяется условие и суммируются произведения ячеек
пассива. Выражение Приход!$А$3:$А$101=А4, как и в предыдущей формуле,
отбирает строки с нужным товаром. Формулой Приход!$С$3:$С$101<14, как и
208
Автоматизация отдельных направлений деятельности
раньше, отбираются поставки, используемые при предыдущих отгрузках. Одна-
ко следующие части формулы немного другие.
Формула IIpuxod!$F$3:$F$101>I4 отбирает поставки, после которых общее
количество товаров на складе стало больше, чем требовалось для прошлой от-
грузки. С учетом предыдущей формулы, отобрана будет только последняя по-
ставка, товары из которой использовались при предыдущей отгрузке, но часть
товаров из которой осталась. С помощью формулы IIpuxod!$D$3:$D$101 опреде-
ляется стоимость товара. В результате мы получаем стоимость товара в поставке,
частично используемой нами в текущей отгрузке.
Далее нужно определить количество и стоимость товара во второй группе, то
есть из поставок, полностью вошедших в текущую отгрузку. Введите в ячейку L4
формулу массива
=СУММ((Приход!$А$3:$А$101=А4) *
(Приход!$Р$3:$Р$10К=Н4) *(Приход!$С$3:$С$101 >=14) *
Прчход!$С$3:$С$101)
Как и в предыдущих формулах, выражение Приход!$А$3:$А$101=А4 опреде-
ляет работу с нужным товаром. Формулой Приход!$С$3:$С$101>=14 отбираются
поставки, которые не использовались при предыдущих поставках. Обратите
внимание, что ранее в похожей формуле использовался оператор <, а теперь опе-
ратор >=.
Формула Приход!$Р$3:$Р$101<=Н4 отбирает поставки, после которых на
складе осталось столько товаров, что после текущей отгрузки они все уйдут со
склада. Используя это и предыдущее выражение, можно отобрать только постав-
ки, целиком вошедшие в отгрузку. Количество товаров в этих поставках опреде-
ляется формулой Приход!$С$3:$С$101. После выполнения вычислений, введен-
ная формула массива выдаст количество товаров второй группы.
Чтобы определить средневзвешенную стоимость товаров второй группы,
введите в ячейку М4 формулу
{=ЕСЛИ(Ь4=0;0;СУММ((Приход!$А$3:$А$101=А4)*
(Приход!$Р$3:$Р$10К=Н4) *(Приход!$С$3:$С$101>=14) *
Пршод!$Е$3:$Е$101)/Ь4)}
Как и другие формулы, эта формула является формулой массива, и ее надо
вводить так же, как и другие. Так как результат делится на количество товаров
данной группы, условие L4=0 позволяет избежать деления на ноль. Как и во всех
остальных формулах, с помощью Прчход!$А$3:$А$101=А4 отбираются поставки
нужного товара. Формулы Приход!$Р$3:$Р$10К=Н4 и Приход!$С$3:$С$101>=14,
как в предыдущем случае, отбирают поставки, целиком вошедшие в отгрузку.
С помощью Пршод!$Е$3:$Е$101 определяются стоимости партий товаров. Про-
суммировав все отобранные значения, мы получим суммарную стоимость всех
товаров второй группы. Разделив ее на значение в ячейке L4, то есть на количест-
во товаров этой группы, мы получим средневзвешенную стоимость этих товаров.
В ячейку N4 введите простую формулу =C4-J4-L4. Из общего количества то-
варов в поставке вычитаем количество товаров первой и второй группы, и полу-
209
8-5458
Примеры использования Excel в бухгалтерии
чаем количество товаров в третьей группе. В некоторых случаях в столбце N
могут получиться отрицательные числа. Это не ошибка, все вычисления будут
выполнены правильно. Если используется большая поставка, частично исполь-
зованная в предыдущей отгрузке и частично используемая в текущей отгрузке,
количество товара в столбце /определяет не количество товара используемого в
текущей отгрузке, а количество товара, оставшееся после предыдущей отгрузки.
Вычтя из этого числа значение из столбца /, то есть, добавив отрицательное чис-
ло из этого столбца, мы как раз получим количество товара используемого в те-
кущей отгрузке. Кстати, на расчет стоимости эти особенности никак не влияют.
Далее в ячейку О4 введите формулу массива
{=СУММ((Приход!$А$3:$А$101=А4)*
(Приход!$Р$3:$Р$101 >Н4) *(Приход!$С$3:$С$10КН4) *
Приход!$В$3:$О$101)}
Формула Приход!$Р$3:$Р$101>Н4 позволяет отобрать поставки, которые в
сумме превышают потребности текущей отгрузки. Формула Прчход!$С$3:
$G$10KH4 позволяет отобрать поставки, в которых до прихода товаров не хва-
тало товара для отгрузки. В результате использования этих двух формул, будут
отобраны поставки, которые частично обеспечили отгрузку, причем какое-то ко-
личество товара осталось. Формула Upuxod!$D$3:$D$101 позволяет определить
стоимость этой поставки.
На основании результатов расчетов в промежуточных ячейках можно
рассчитать стоимость ушедшей со склада продукции. Вначале рассчитаем стои-
мость товара при использовании метода FIFO. В ячейку D4 введите форму-
лу =(J4*K4+L4*M4+N4*O4)/C4. Суммируя стоимость товара в каждой группе на
количество в этой группе товара, мы получаем общую стоимость партии това-
ра. Разделив ее на количество товара в партии, мы получим стоимость единицы
товара.
Для расчета средневзвешенной стоимости введите в ячейку F4 формулу
{=СУММ((Прчход!$А$3:$А$101=А4)*Приход!$Е$3:$Е$101)/
СУММЕСЛИ(Приход!$А$3:$А$101;А4;Приход!$С$3:$С$101)}
Это снова формула массива, и после ее ввода нужно нажать комбинацию
клавиш |[ ctri |+|+sinft]+|Ent«»r). С помощью функции СУММ суммируется стоимость
всех поступивших партий товара. Функция СУММЕСЛИ, как и в некоторых рас-
смотренных выше формулах, вычисляет общее количество поступившего товара.
После деления мы получаем среднюю стоимость.
Для расчета стоимости всей партии введите в ячейку Е4 формулу =D4*C4, a
в ячейку G4 формулу =F4*C4. Наконец все формулы введены. Как вы заметили,
в этом примере используются более сложные формулы, чем в других примерах.
При уходе товара со склада вы должны ввести наименование товара, и его коли-
чество. Вы также можете указать дату и некоторую дополнительную информа-
цию, если добавите в таблицу соответствующие столбцы. Для всех столбцов, в
которых вводятся формулы, вы должны скопировать их из предыдущей строки с
помощью автозаполнения.
210
Проведение анализа и поиск приемлемых решений
Описанный пример позволяет вести учет поставок товаров на склад и уход
товаров со склада. При этом рассчитывается стоимость ушедшего товара по ме-
тоду FIFO и с помощью средневзвешенной стоимости. Вы можете доработать
пример, используя описанные приемы и добавив особенности учета товаров на
вашем предприятии. Отметим, что примерно также можно организовать учет то-
варов уходящих по методу LIFO. Проще всего для использования этого метода
на листе учета прихода вставлять все новые записи в первую строку списка, то
есть в третью строку таблицы.
3.4. Проведение анализа и поиск приемлемых решений
В Excel встроено мощное средство поиска решений. Оно реализовано как
надстройка. Если во вложенном меню Сервис отсутствует команда Поиск решения,
нужно выбрать команду Сервис :£> Надстройки и установить в появившемся диа-
логе флажок рядом с названием Поиск решения. Если в списке доступных надст-
роек отсутствует поиск решения, нужно повторно запустить установку Microsoft
Office и выбрать нужную надстройку в списке устанавливаемых компонентов.
3.4.1. Оптимизация сроков и объемов производства или закупок
Выше описывался расчет себестоимости продукции на примере себестоимо-
сти издания книги. Как было рассказано, себестоимость зависит от тиража. Ка-
залось бы, выгодно печатать большой тираж, чтобы получить небольшую себес-
тоимость, и постепенно распродавать его. Однако длительное замораживание
средств и складские расходы сводят на нет все преимущества большого тиража.
Нужно подобрать такой тираж, при котором соотношение стоимости тиража и
расходов на его хранение получится оптимальным. Составив расчетную таблицу,
можно попытаться подобрать нужные значения. Но вручную перебирать разные
варианты достаточно утомительно, значительно удобнее задать условия и почти
сразу получить наиболее подходящий вариант. Для этого в Excel и включено
средство принятия решений. Описанные приемы можно использовать в любой
таблице, описывающей объемы и сроки производства или закупок товаров с це-
лью их дальнейшей продажи.
Для простоты считаем, что , А L " L-s ! ° --'•• Е
'"2 Исходные данные
нужно в течение года продавать "НЕТ" c»1S™TioMi*T5ooo™Z
четыре разных книги, и получить gHn»r.i ш 1<юо«» ™500°0''°"
X"J07
 1МШ
45 2МО "̂ %
6 Книга2 250 250 1ЭО 100 95 1400 95%
ПРИ ЭТОМ МаКСИМаЛЬНЫИ ДОХОД. пк™газ 9» к ч «> » яю ао%
8 ;Книга4 90 129 ЙО 51 47 11000 100%
Исходные данные для расчетов
вносятся в верхнюю часть табли- Рис. 3.28.
цы (Рис. 3.28). В первых четырех Исходные данные для расчета
211
Примеры использования Excel в бухгалтерии
строках вводятся заголовки, а с пятой по восьмую строки вводится информация
о конкретных книгах.
В первом столбце вводится название книги, а во втором — ее отпускная це-
на. В нашей простой модели не учитываются оптовые скидки. В столбцах с С по
F вводится себестоимость печати одной книги, для разных объемов тиража. От-
метим, что при тираже менее 1000 себестоимость может быть выше отпускной
цены. В столбце G вводится количество продаваемых в месяц книг в начале про-
даж. Так как часто количество продаж уменьшается со временем, в следующем
столбце вводится коэффициент такого уменьшения. Если ввести 100%, продажи
будут постоянными. При вводе значения 90% во втором месяце продажи умень-
шатся на 10% от первого, в третьем уменьшатся на 10% от продаж во втором ме-
сяце, и так далее.
В столбце / вводятся расходы на хранение одной книги в течение месяца.
В эти расходы входят как оплата склада, так и разнообразные накладные расхо-
ды, а также в этом числе учитывается замораживание средств в товаре. То есть, в
этот столбец вводится обобщенный показатель расходов при хранении в течение
месяца одного экземпляра книги. Для реальной модели вместо числа нужно вво-
дить расчетную формулу, но мы рассмотрим более простой вариант.
В строках, расположенных ниже, помещается таблица издания книг по ме-
сяцам и наличия книг на конец каждого месяца (Рис. 3.29). В верхней таблице
вводятся тиражи книг, изданных в конкретные месяцы. Вы можете ввести вруч-
ную нужные цифры, но лучше предоставить Excel возможность найти нужное
решение, то есть заполнить эту таблицу. В нашем примере мы задали печать
больших тиражей в начале срока, чтобы распродавать книги в течение года без
допечатки. В дальнейшем вы увидите, что этот вариант далеко не оптимален.
Таблица наличия книг заполняется на основе расчетов. Введите в ячейку В 18
формулу =B12-$G5, то есть из количества изданных в этом месяце книг нужно
вычесть количество проданных за месяц книг. Скопируйте формулу в следующие
три строки, с помощью автозаполнения. Все остальные ячейки таблицы наличия
книг рассчитываются однотипно.
В ячейку С18 введите формулу =С12+В18-$С5*$Н5Л(СТ(МБЕЦ()-2). К кни-
гам, изданным в текущем месяце, добавляются книги, имеющиеся на конец пре-
дыдущего месяца, и вычитаются книги проданные за месяц. Количество продан-
ных книг рассчитывается по формуле -$С5*$Н5*(СТОЛБЕЦ()-2). Формула СТОЛ-
Январь Февраль Март .Апрель Май Июнь .Июль Август Сентябрь Октябрь Ноябрь Декабрь
Книга 1 25000. О 0 0 0 0 0 0 . . . . . 0 . . . . . . . . О О О
13 ; Книга 2 1 зооо : о о ; о о о о о о о: о о
Щ| Книга 3 : 27000 0 0 0 0 0 0 0 0 О О О
^З.;книга4 : 135000 о о о о о о о о о о о
щ." ~ /.. .; . . . . . . . . . . . . . . . . " . ! . " ' ' ; ' : П ~ " . . " . . ' ' '
Наличие книг на конец месяца
7118г;Книга1 22700.' " 20469 18305 16206; 14170 ...... 12195 10279! 8420, 6618 • 486S- 3173 '1526
19 ;Ккига2 . 11600 10270 9007 7806 6666- 55вз' 4553 357б' 264?' 1765 926 130
20"; Книга 3 21400 16920 13336 10469; 8175^ 6340 4872 3698 2758 2006 1405 924
21 Kwira4 124000 113000 102000 91000 80000 69000 58000 47000 36000! 25000 14000, 3000
Рис. 3.29. Таблица тиражей и остатков книг
212
Проведение анализа и поиск приемлемых решений
А В I С ; D i Е ; F I Q : H I ; J К ' L • М N :
,Й;' Доходы
24 : Январь февраль Март Апрель Май Июнь Июль Август Сентябрь Оетябрь Ноябрь Декабрь Сумма
25Жнига1 -1U3SOO 3464 25060 46008 66328 86038 105157 123702 141691 159141 176066 192484 -78660
28-Книга2 -1175000 75750 90713 104927 118431 131259 143446 155024 166023 176471 186398 195828 ЗС9269
27'КнигаЗ -697800 200160 162528 132422 108338 89070 73656 61325 51460 43568 37254 32204 2941SS
28 Кн'лга4 -7215000 -705000 -540000 -375000 -210000 -45000 120000 285000 450000 615000 760000 945000 -5895000..... '
Рис. 3.30. Доходы издателя
БЕЦ()-2 возвращает единицу для февраля, двойку для марта и так далее. Возведе-
ние коэффициента в нужную степень позволяет вычислить снижение продаж в
нужном месяце. Умножив полученное число на количество книг продаваемых
вначале, мы получим продажи в заданном месяце. Размножьте с помощью авто-
заполнения формулу на ячейки до М18, после чего выделите ячейки с C18no M18
и опять с помощью автозаполнения размножьте формулу на следующие три стро-
ки. Вся таблица наличия книг будет заполнена нужными формулами.
Еще ниже нужно расположить таблицу с доходами в каждом месяце от каж-
дой книги (Рис. 3.30). При этом расходы будут отображаться отрицательными
числами, а доходы — положительными. Как и для прошлой таблицы, нужно вве-
сти всего две формулы, после чего с помощью автозаполнения размножить их по
всем ячейкам.
В ячейку В25 введите длинную формулу
=С5*В5-ЕСЛИ(В12<1000;С5;ЕСЛИ(В12<5000;О5;
ЕСЛИ(В12<10000;Е5;Р5)))*В12-В18*15.
Выражение G5*B5 вычисляет доход от продажи книг в первом месяце. Он
определяется как произведение отпускной цены на начальные продажи. Из по-
лученной суммы вычитаются расходы на издание книги в текущем месяце, вы-
числяемые по длинной формуле. Основой этой формулы является выражение
ЕСЛИ(В12<1000;С5;ЕСЛИ(В12<5000;О5;ЕСЛИ(В12<10000;Е5;Р5)))
Три условных оператора позволяют определить стоимость издания книги в
зависимости от тиража. Если тираж менее 1000, стоимость берется из столбца С.
В противном случае, если тираж менее 5000, стоимость берется из столбца D. Ес-
ли же оба условия не верны, то есть тираж больше 5000, проверяется последнее
условие: если тираж меньше 10000, используется столбец Е, а если больше -
столбец F. Так стоимость берется из нужного столбца, после чего умножается на
тираж. Так рассчитывается стоимость изданных в данном месяце книг.
Также из дохода вычитается произведение В18*15, то есть расходы на хране-
ние тиража книг в этом месяце. Строго говоря, эта сумма не совсем верна, так
как в течение месяца количество книг менялось, но для упрощения модели мож-
но использовать и такую формулу.
В ячейку С25 введите формулу
=(В18+С12-С18) *$В5-ЕСЛИ(С12< 1000;$С5;
ЕСЛИ(С12<5000;$О5;ЕСЛИ(С12<10000;$Е5;$Р5))) *С12-С18*$15.
Единственное отличие этой формулы от предыдущей в том, что проданные
в текущем месяце книги вычисляются по формуле В18+С12-С18. К количеству
213
Примеры использования Excel в бухгалтерии
книг в текущем месяце прибавляется тираж вновь изданных книг и из результа-
та вычитается количество книг в предыдущем месяце. Все остальные вычисле-
ния аналогичны описанным выше, только вместо относительной адресации ис-
пользуется смешанная, чтобы можно было использовать автозаполнение. Раз-
множьте формулу из ячейки С25 во все ячейки до М25, после чего введите в ячей-
ку N25 формулу =СУММ(В25:М25). В столбце TV вычисляется суммарный доход
по каждой книге. Далее выделите ячейки с В25 по N25 и с помощью автозапол-
нения размножьте формулы в следующие три строки.
Наконец в ячейку СЗО введите формулу =СУММ(В25:М28), и таблица гото-
ва. Вы можете проверить, как она работает. Введите произвольные цифры в таб-
лицу издания тиражей книг, и вы увидите результаты расчетов в других частях ли-
ста. После того, как все формулы введены, можно приступать к поиску приемле-
мого решения.
Выберите команду меню Сервис :£> Поиск решения, чтобы открыть диалог на-
стройки параметров поиска. Напоминаем, что если команда Поиск решения от-
сутствует во вложенном меню Сервис, вам нужно установить соответствующую
надстройку. В диалоге вы должны задать цель поиска, установить ограничения и
указать, какие ячейки нужно менять для нахождения решения. Мы опишем, ад-
реса каких ячеек нужно ввести в поля ввода, но вы можете не вводить адрес, а ус-
тановив текстовый курсор в нужном поле диалога, выделить нужные ячейки.
В поле Установить целевую ячейку введите $С$30 и с помощью переключате-
ля выберите максимальное значение, то есть в качестве цели нужно максимизи-
ровать суммарный доход за год. В поле Изменяя ячейки введите $В$12:$М$15.
При поиске нужно менять тиражи изданий разных книг в разные месяцы.
Далее нужно ввести ограничения. Нажмите кнопку Добавить, и появится
диалог добавления условий. Введите в поле Ссылка на ячейку адрес $В$12:$М$15,
в следующем списке выберите вариант >=, а в расположенное еще правее поле
введите 0. Нажмите кнопку Добавить, и условие будет добавлено в список. Мы
описали, что тиражи книг не могут быть отрицательными. Аналогично добавьте
условия $В$18:$М$21>=0, и $N$25:$N$28>=0. Первое условие определяет, что в
любом месяце должны быть в наличии все наименования книг, то есть нельзя со-
кращать ассортимент, даже если одна книга значительно выгоднее другой. С по-
мощью последнего условия задается, что каждая книга должна приносить какой-
то доход и не быть убыточной. После того, как все нужные условия добавлены,
нажмите кнопку Отмена в диалоге добавления условий, и вы вернетесь в диалог
настройки параметров поиска решения. Нажмите кнопку Выполнить, и начнет-
ся процесс поиска решения. Он может занять некоторое время, по окончании
которого на экране появится диалог с результатом поиска. Если в диалоге сказа-
но, что решение найдено, нажмите кнопку ОК, и все поля в таблице будут запол-
нены нужными значениями (Рис. 3.31).
Если в диалоге сказано, что поиск не смог найти подходящего решения, на-
жмите кнопку Отмена. Вы задали такие условия, при которых невозможно найти
решение. Нужно изменить исходные данные и вновь попытаться найти решение.
214
Проведение анализа и поиск приемлемых решений
В.
Планирование выпуска нние
Исходны* данные
] .
:Книга 1
;Книга2
"] Книга 3
п опью о м в
Отпускная Себестоимость в зависимости от тиража Скорость продаж Расходы
цена меньше от 1000 от 5000 больше Начальная Коэффиц хранения
1000 до 5000 Д010000 10000 иент
130 160 60 47 4
250 250 130 100 9
90. 85 45 40 Э
90 129 60 51 4
2300
1400
11000
97%
95%.
11"
%! Книга!
13": Книга 2
14":КнигаЗ
"15 .'Книга 4
16":
"17 :
ЗШ Книга!
"19:;Книга2
20 (Книга 3
"21 'Книга 4
"22"!
2з ;
24"""
25": Книга 1
26 Книга 2
27 : Книга 3
28] Книга 4
Январь
18382
8446
18825
66000
16082
7046
13225
55000
Январь
-753355
-670756
-313573
-2937000
Издание тиражей
Июнь Июль :г Сентябрь Октябрь Ноябрь Декабрь
О 0 1749 1696 1645
978 929 882 838 796
О 11000 11000 11000 11000
13851 11687
5716 " 4453
8745 5161
44000 33000
Наличие книа на конец месяца
9588 7552 5577 3661 1803
3252 2112 1029 О О
2294 0 0 0 2292
22000 11000 0 0 0
О
О
1353
О О
Дохойы
враль Март Апрель Май Июнь Июль Азгусг Сентябрь Октябрь Ноябрь Декабрь Сумма
96112 117708 138656 158976 178686 197805 216350 234339 122397 118725 115164 941584
189599 204561 218776 232279 245108 257156 0 0 0 0 0 676722
298260 260628 230523 206438 82575 66060 -77821 68322 60430 54117 2405 938386
 330000 495000 660000 825000 390000 473000 473000 473000 473000 473000 473000 ЗЯНООО
||]С|«1«Н|«ВМ«юМ 5757652,68/1
Рис. 3.31. Результат поиска решения
Возможно, данный пример кому-то покажется слишком громоздким. Одна-
ко в действительности нужно ввести только несколько не слишком сложных
формул, и размножить их с помощью автозаполнения. Подбор параметров вруч-
ную займет значительно больше времени, и вы не можете быть уверенными, что
нашли оптимальное решение.
Описанные приемы можно использовать не только для определения опти-
мальных тиражей книг, но и для оптимизации количества и сроков выпуска или
закупок любых товаров. Конечно, это не совсем задача бухгалтера, но на данном
примере хорошо видны особенности поиска решений. Разобравшись с этой про-
цедурой, вы можете применять ее и в любых других таблицах.
3.4.2. Управление оборотным капиталом
В случае наличия свободных средств, их лучше положить на депозит. Одна-
ко бывает сложно определить, какими депозитами пользоваться, на какой срок и
под какой процент. В решении этой задачи бесценную помощь могут оказать
средства поиска решений.
Допустим, что в начале года у вас есть свободные средства, которые предпо-
лагается потратить в течение года. Вы заранее знаете, в каком месяце сколько де-
нег нужно потратить, и к концу года у вас не должно ничего остаться из имею-
щейся суммы. Однако лучше положить часть средств на депозит, чтобы получить
дополнительный доход. При этом нужно обеспечивать запланированные выпла-
ты в каждом месяце и иметь некоторый резерв на всякий случай. Остальные
деньги должны находиться на депозите и приносить доход. Так как можно вы-
215
Примеры использования Excel в бухгалтерии
>\
А ; в ; с ; о Е : F : • с - н ; i : л : к > L
Управление оборотными средствами
Процент Сро«
2 ;(годовой);депозита
3 ;0дномесячный 8% 1
4 Двухмесячный 12%: 2
5 Трехмесячный 15% 3
S Полугодовой 20% 6
7~: . . ' '....' ; " [...'.'. . ' . . . . . . . . . . " Г "." ' ГГЛ. Г" Г. ... . . • . Г. . ' . . . . . .
8 i Месяц Янллрь Февраль Март Апрель Май Июнь Июль Август Сентябр Октябрь Ноябрь
9.1 Сумма в начале периода 1500000 1500000 1500000 1500000 1500000 1500000 1500000 1500000 1500000 1500000 15000Qt> 1500000
1 0 Погашение депозита 0 0 0 0 0 0 0 0 0
1 i :Полученные проценты О О О P.i.............._Р ° О О О
12 Одномесячный О О О О О О О; О О О
13; Двухмесячный 0; 6 0 0 0 0 . . . . Р: О 0 . . ,°..
:. О- О
14 Трехмесячный О О О О О О О О О О 0= 0.
'15.Г Полугодовой
fie: I Расходы О 0 0"
. . . _
7" Сумма а конце периода 1500000 1500000 1500000 1500000 1500000 1500000 1600000 1500000 1500000 1500000 1500000 1500000
| . . . . " " " ' . . . " . : " " . . . . . . . . . . . . . . . . . ' . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ; . . . . . . . . . . "1" . . . . . . . . .'....II']'... . . . . . . . . . . . . . ! . . . . . . . . . . . . . . ~1
19 : Всего расходов за год О
Щл Дополнительный доход 0 Процент 0%
Рис. 3.32. Подготовка таблицы
брать между депозитами разного срока и, соответственно, с разными процент-
ными ставками, задача выбора сумм, размещаемых на разных депозитах в разные
месяцы, может оказаться достаточно сложной. Если же воспользоваться помо-
щью Excel, эта задача решается очень быстро и без лишних усилий.
Вначале нужно подготовить расчетную таблицу (Рис. 3.32). В верхней части
листа введите параметры депозитов — годовые процентные ставки и сроки пога-
шения. Понятно, что более короткие сроки определяют меньшие процентные
ставки, и наоборот. Введите заголовок таблицы и названия депозитов, а также за-
головки столбцов в ячейки В2 и С2. Далее введите в ячейки с ВЗ по С6 характери-
стики депозитов.
В центральной части листа расположена основная расчетная таблица. Вве-
дите заголовки строк и столбцов, как в нашем примере. Каждый столбец описы-
вает операции в конкретном месяце, а в строках вычисляются имеющиеся сум-
мы в начале и конце месяца, положенные на депозит средства и погашенные де-
позиты, а также полученные проценты. Введите в ячейку В9 начальную сумму,
которая у вас имеется в наличии в начале года. Далее нужно ввести в остальные
ячейки расчетные формулы.
В столбце В вводится информация о первом месяце. Так как никакие де-
позиты пока не погашались и, естественно, нет никаких процентов, ячейки
В10 и В11 нужно оставить пустыми. В ячейки с В12 по В15 нужно будет вво-
дить конкретные суммы, положенные на данный тип депозита. Эти ячейки бу-
дут заполняться автоматически при поиске решения. В ячейку В16 нужно вве-
сти планируемые расходы в январе. Сразу введите нужные значения в ячейки
с С16 по М16, то есть планируемые расходы во все оставшиеся месяцы. Эти
числа являются исходными данными для расчетов и должны быть введены ва-
ми вручную.
В ячейку В1 7 вводится формула для расчета оставшейся в конце месяца у вас
суммы. Введите в эту ячейку формулу =СУММ(В10:В12)-СУММ(В13:В17). С по-
мощью автозаполнения скопируйте формулу из ячейки В17 в ячейки с С1 7 по
216
Проведение анализа и поиск приемлемых решений
М17. В каждом месяце сумма в конце периода считается как сумма в начале пе-
риода плюс погашенный депозит и полученные проценты за вычетом сумм, раз-
мещенных на депозитах в данном месяце. В ячейку СЮ введите формулу =В18 и
с помощью автозаполнения скопируйте формулу на ячейки с D10 по М10. В каж-
дом следующем месяце сумма на начало периода равна сумме на конец предыду-
щего периода.
Нам осталось ввести формулы в ячейки с СИ по М12, то есть определить по-
гашенные депозиты и полученные проценты в каждом месяце. Формулы при
этом немного длиннее, чем в остальных ячейках, но при этом достаточно про-
стые. Введите в ячейку СП формулу =В13. Во втором месяце может быть погашен
только одномесячный депозит, выданный в предыдущем месяце. Срок погаше-
ния остальных депозитов еще не наступил. В ячейку D11 введите формулу
=С13+В14, а в ячейку Е11 введите =£13+D14+C15. В третий месяц может быть
погашен одномесячный депозит, выданный в прошлом месяце и двухмесячный
депозит, выданный два месяца назад. Аналогично в четвертый месяц погашаются
такие же депозиты и трехмесячный депозит, выданный три месяца назад. С помо-
щью автозаполнения скопируйте формулу из ячейки Е11 в ячейки F11 и G11. По-
ка не наступил срок погашения полугодового депозита, формула составляется
аналогично предыдущей. В ячейку НИ введите формулу =G13+F14+E15+B16 и
размножьте ее на ячейки вплоть до МИ. Добавлено погашение полугодового де-
позита, выданного шесть месяцев назад.
Далее введем формулы определения полученных процентов в каждом меся-
це. В ячейку С12 введите формулу =В13*ВЗ/12. Сумма погашенного одномесяч-
ного депозита умножается на годовую процентную ставку и делится на двенад-
цать, чтобы получить процент, получаемый за месяц. В ячейку D12 введите фор-
мулу =С13*ВЗ/12+В14*В4/12*С4. К процентам за погашенный одномесячный
депозит добавляется процент за двухмесячный депозит. При этом годовая про-
центная ставка делится на 12 и умножается на срок депозита. В ячейку Е12 вве-
дите =D13*$B$3/12+C14*$B$4/12*$C$4+B15*$B$5/12*$C$5 и с помощью авто-
заполнения размножьте формулу в ячейки F12 и G12. Относительные ссылки в
формуле заменены на абсолютные, чтобы процентные ставки и сроки депозитов
не менялись при автозаполнении. Как и при расчете погашения депозитов, про-
центы считаются для одномесячных, двухмесячных и трехмесячных депозитов.
Аналогично добавляются и проценты за полугодовые депозиты. Введите в ячей-
ку Н12 формулу =F13*$B$3/12+E14*$B$4/12*$C$4+D15*$B$5/12*$C$5 и раз-
множьте ее на ячейки вплоть до М12.
Почти все формулы введены. Введите названия в нижней части таблицы, по-
сле чего введите в ячейку В20 формулу =СУММ(В17:М17), чтобы вывести сумму
расходов за год, а в ячейку В21 введите формулу =СУММ(В12:М12). В этой ячей-
ке вычисляется сумма полученных процентов. Введите в ячейку D21 формулу
=В21/В10 и выберите процентный формат ячейки, чтобы узнать, сколько про-
центов дополнительного дохода вы получите в текущем году от использования
депозитов.
217
Примеры использования Excel в бухгалтерии
Все исходные данные и расчетные формулы введены. Вы можете попробо-
вать вручную подобрать нужные суммы депозитов в разные месяцы, но лучше
воспользоваться средством поиска решений Excel.
Выберите команду меню Сервис ;£> Поиск решения, чтобы открыть диалог на-
стройки параметров поиска. Еще раз напоминаем, что для поиска решения
должна быть установлена нужная надстройка. В диалоге вы должны задать цель
поиска, выбрав целевую ячейку, установить ограничения и указать, какие ячей-
ки нужно менять для нахождения решения.
В поле Установить целевую ячейку введите $М$10 и с помощью переключа-
теля выберите максимальное значение, то есть в качестве цели нужно максими-
зировать сумму, остающуюся в вашем распоряжении в конце последнего месяца.
В поле Изменяя ячейки введите $В$13:$М$16. При поиске решения нужно ме-
нять суммы, положенные на депозиты различного срока в разные месяцы.
Далее нужно ввести используемые ограничения. Нажмите в диалоге кнопку
Добавить, и будет открыт диалог добавления условий. Введите в поле Ссылка на
ячейку адрес $В$13:$М$16, а в следующем списке выберите вариант >=. Далее в
расположенное в правой части диалога поле введите 0. Нажмите кнопку Доба-
вить, и условие будет добавлено в список. Мы описали, что депозиты не могут
быть отрицательными. После добавления поля диалога очистились, и вы може-
те добавить следующее условие. Введите в поле Ссылка на ячейку адрес
$В$18:$М$18, в следующем списке выберите вариант >=, а в последнее поле вве-
дите 50000. Нажмите кнопку Добавить, чтобы добавить в список второе условие.
Этим условием мы описали, что в конце каждого месяца нужно иметь резерв в
размере 50000 рублей. Если резерв не нужен, вместо 50000 нужно ввести 0. Одна-
ко второе условие обязательно нужно добавить, так как отрицательные суммы в
любом месяце недопустимы.
После того, как все нужные условия добавлены, нажмите кнопку Отмена в
диалоге добавления условий, и вы вернетесь в диалог настройки параметров по-
иска решения. Нажмите в этом диалоге кнопку Выполнить, и начнется процесс
поиска решения. Достаточно быстро будет найдено решение, и на экране по-
явится соответствующий диалог. Если в диалоге сказано, что решение найдено,
нажмите кнопку ОК, и все поля в таблице будут заполнены нужными значения-
ми (Рис. 3.33).
-•--! ' А """ ! ' в i с : D i Е : F ' G i н i i '. ,.J.:.:!..' K ' I L : м I
9 Месяц Январь Февраль Март Апрель Май Июнь Июль Август Сентябр Октябрь Ноябрь Декабрь
10;Сумма 8 начале периода 1500000 50000 50000 50000 50000 50000 50000 50000 50000 50000 50000 50000
11 :Погашение депозита 152371 317245 408915 162905 126793; 411470 179548 225860 238736 157889 205629
12;Полученные проценты 1016 6345 15334 1086 4043 41147 4313 13114 17120 12111 8762
13 Одномесячный: 152371 0 0 162905 О О 146162 0 0 10037 О О
14 Двухмесячный 317245 0 0 40666 О О 118398 0 0 85818 0 О
1 6 ; Трехмесячный 408915 0 86127 О О О 108057 43861 78975 (X О О
1U Полугодовой 411470 33386 107462 130679 103991 40836 О О 0 0: О О!
!|Г]Расходы 160000120000 130000 90000 60000 90000 80000 140000 160000 160000 170000 140000
18 -Сумма 8 конце периода 50000 50000 50000 50000 50000 50000 50000' 50000 50000 50000 50000 124391!
УО .Всего расходов за год
21 'Дополнительный доход 124391 Процент
Рис. 3.33. Найденное решение
218
Связь с бухгалтерскими программами
Если в диалоге сказано, что поиск не смог найти подходящего решения, на-
жмите кнопку Отмена. Вы задали такие условия, при которых невозможно най-
ти решение. Нужно изменить исходные данные и вновь попытаться найти вари-
ант решения.
Нужно сказать, что вручную оптимальное решение найти практически не-
возможно. Перебрать все возможные варианты и сравнить полученные результа-
ты достаточно трудно. Попробуйте ввести любые другие значения в ячейки ис-
пользуемых в разные месяцы депозитов, и вы увидите, что окончательная сумма
уменьшится или в каком-то месяце имеющиеся средства уменьшатся ниже допу-
стимого резерва. Рекомендуем активнее использовать средства поиска решений
для решения различных задач.
3.5. Связь с бухгалтерскими программами
Бухгалтерские программы достаточно качественно ведут учет всех первич-
ных документов и строят на его основе журнал хозяйственных операций. Одна-
ко нестандартные расчеты на основе информации из журнала операций некото-
рые программы выполнить не могут. Кроме того, может понадобиться выпол-
нить расчеты на основе информации из некоторых отчетных форм, например
оборотной ведомости. В любом случае, нужно передать данные из бухгалтерской
программы в Excel для дальнейших вычислений. Сразу следует отметить, что об-
ратная задача, то есть передача информации из Excel в бухгалтерскую програм-
му, практически невыполнима. Большинство программ не позволяет импорти-
ровать данные в формате Excel, а писать специальные программы для такого им-
порта достаточно трудоемко и вряд ли полезно. Программы, позволяющие такой
импорт, например ПАРУС, выдвигают жесткие требования к формату таблиц
Excel, и четко регламентируют назначение импорта. Никаких произвольных
данных вы ввести в программу не сможете. То есть, мы рассмотрим только пере-
дачу информации из бухгалтерской программы в Excel, а не наоборот.
Большинство программ позволяет сохранить отчеты в формате Excel. В
этом случае вы можете в дальнейшем работать с ними, как с любыми другими
файлами. Например, экспортировав журнал проводок, вы можете задать собст-
венные формулы для обработки и получения нестандартных отчетов. К сожале-
нию, в некоторых программах, например в Инфо-Бухгалтер, экспорт в Excel ре-
ализован так, что вы не сможете воспользоваться вычислениями. Все числа по-
мещаются не в ячейки таблицы, а в надписи. Фактически получается просто ри-
сунок документа, не подходящий для работы. Отдельные программы не позво-
ляют экспортировать в Excel. В этом случае вы можете выделить нужные строки
редактируемого документа, например журнала операций, и скопировать их в бу-
фер обмена. После этого вы можете вставить в таблицу Excel данные из буфера
обмена и работать с ними обычным способом. Если программа, например Тур-
219
Примеры использования Excel в бухгалтерии
бо Бухгалтер, позволяет экспортировать документ в текстовый файл, то вы мо-
жете прочитать его из Excel, однако при двойном преобразовании из таблицы в
текст и снова в таблицу может потеряться структура, так что информацию будет
трудно обработать.
Во всех программах информация из разных документов, журналов и отчетов
переносится в Excel различными способами. Например, отчет можно просто со-
хранить в формате Excel, а для экспорта первичного документа следует восполь-
зоваться буфером обмена. Наиболее удобно связь с Excel реализована в програм-
мах 1C:Бухгалтерия, ПАРУС и ИНФИН, а наименее удобна для экспорта в Excel
программа Турбо Бухгалтер. При использовании бухгалтерской программы Ин-
фо-Бухгалтер экспорт в Excel выполнить чрезвычайно легко, но формат полу-
ченных данных неудобен для расчетов. Из программы БЭСТ экспортировать не-
которую информацию можно с помощью генератора отчетов, предназначенного
для печати отчетов в Windows.
Excel может читать информацию из стандартных баз данных. Многие бух-
галтерские программы хранят информацию в базах форматов dBase или Paradox,
которые легко используются Excel для чтения. Однако часто информация в базах
носит служебный характер, и получить нужные данные бывает достаточно слож-
но. Кроме того, часто информация хранится в кодировке ДОС, а не в кодировке
Windows, используемой Excel. В этом случае все русские слова невозможно про-
читать, хотя все числа читаются правильно.
Попробуйте все варианты получения информации из вашей бухгалтерской
программы: экспортируйте в формат Excel, переносите информацию через бу-
фер обмена и попытайтесь открыть для чтения базу данных. Если вы получите
полезную информацию, можете с помощью Excel попытаться ее обработать.
ГЛАВА 4.
БУХГАЛТЕРСКИЙ, НАЛОГОВЫЙ
И УПРАВЛЕНЧЕСКИЙ УЧЕТ В EXCEI
Электронные таблицы Excel позволяют вести полноценный бухгалтерский,
налоговый и управленческий учет, однако для настройки учета, учитывающего
все нюансы, нужно потратить достаточно много времени и усилий. Часто быва-
ет проще приобрести специализированную программу, чем самостоятельно со-
здавать сложные таблицы и настраивать их под особенности учета на вашем
предприятии. Excel удобно использовать для ведения фрагментов учета или для
ведения учета на небольших предприятиях, с малым количеством хозяйственных
операций.
Вместе с тем часто стандартные программы не позволяют рассчитывать не-
которые нужные показатели, и в этом случае использование Excel особенно по-
лезно. С помощью приемов, описанных ниже, вы сможете создать свою собст-
венную систему, автоматизирующую частично или полностью ведение различ-
ных типов учета на вашем предприятии.
4.1. Пример бухгалтерского учета
Для ведения полноценного бухгалтерского учета желательно использовать
специализированную бухгалтерскую программу, настроенную на особенности
хозяйственной деятельности конкретного предприятия. Однако в некоторых
случаях приобретение такой программы и ее настройка будет стоить слишком
дорого, кроме того, ее внедрение может растянуться на достаточно продолжи-
221
Бухгалтерский, налоговый и управленческий учет в Excel
тельное время. Если хозяйственных операций мало, то использование специа-
лизированной программы вряд ли выгодно. Вместе с тем, вести весь учет вруч-
ную чрезвычайно неудобно, так что желательно автоматизировать хотя бы на-
иболее трудоемкую часть бухгалтерского учета. Ведение архива документов ав-
томатизировать достаточно трудно, да и нецелесообразно. Бухгалтер без особо-
го труда составит нужный документ в текстовом редакторе Word, распечатает
его и подошьет в дело. Вместе с тем, ведение журнала операций и расчет на его
основе финансовых результатов — процесс достаточно трудоемкий и требую-
щий большого внимания. Легко допустить ошибку при ручном суммировании
большого количества чисел, так что данные действия желательно автоматизи-
ровать. Лучше всего для ведения журнала хозяйственных операций и построе-
ния отчетов использовать программу для работы с электронными таблицами
Excel, сочетающую в себе простоту освоения и мощные средства обработки ин-
формации.
Приведенный ниже пример не претендует на полноту и завершенность. Мы
только описываем возможные приемы применения электронных таблиц Excel
в бухгалтерии, а разработать таблицы для конкретного предприятия нужно бу-
дет самостоятельно. Однако с использованием описанных приемов это будет до-
статочно легко сделать любому пользователю, даже не слишком хорошо знающе-
му Excel.
Запустите программу Excel, и будет создана новая рабочая книга, состоящая
из трех листов. В процессе работы мы поместим информацию на нескольких
листах, добавив новые листы при необходимости. Начать следует с создания
журнала хозяйственных операций. Щелкнув правой кнопкой мыши на ярлычке
первого листа, расположенном в левом нижнем углу страницы, выберите ко-
манду Переименовать во вспомогательном меню и введите новое имя — Журнал
операций.
Выделите семь ячеек в первой строке таблицы и нажмите кнопку [нн| на па-
нели инструментов. Выделенные ячейки объединятся в одну. Введите заголовок
Журнал хозяйственный операций. При желании вы можете изменить шрифт и цвет
заголовка. Далее следует во вторую строку ввести названия заголовков столбцов.
Введите в ячейки с А2 по G2 следующие названия: Дата, Дебет, Деб. СубСч., Кре-
дит, Кред. СубСч., Сумма, Содержание. Следует отметить, что счета и субсчета бу-
дут вводиться в различные ячейки. Например, для ввода кредита счета 19.1 сле-
дует ввести в столбец Кредит значение 19, а в столбец Кред. СубСч. значение 1.
Если же субсчет отсутствует, то в столбец Кред. СубСч. ничего не заносится. Ана-
логично заполняются ячейки в столбцах Дебет иДеб. СубСч. Назначение ячеек в
столбцах Дата, Сумма и Содержание ясно из их названий.
В простейшем случае все операции в журнал вводятся вручную. Каждая
строка соответствует одной хозяйственной операции. Заполняете нужные
ячейки, и операция описана в журнале (Рис. 4.1). Отметим, что для удобства
в третьем, пятом и седьмом столбцах установлено выравнивание по левому
краю, а в остальных - по правому. В суммах отображаются два разряда после
222
Пример бухгалтерского учета
Журнал хозяйственных операций
Дя6.Су6Сч. Кредит Крой. СубСч.
1
К
15;
•
1Я
21000.00
1500000
3500..00
7500,00
15000,00
2500.00
15000,00
560.00
500,00
500.00
5250,00
15400.00
2566..67
93,33
560,00
93,33
Зачтен аванс
Зачтена предоплата
НДС к зачету
Поступило ОС
Поступило ОС
Передан материал
Передан материал
Передан материал
Введено в эксплуатацию О<
введено в эксплуатацию Of
Выделен НДС
НДС к зачету
Рис. 4.1.
Заполнение журнала операций
запятой. Заголовки столбцов выделе-
ны жирным курсивом и выровнены
по центру. Кроме того, подобрана
подходящая ширина столбцов. Од-
нако все это никак не влияет на
логику работы, а только улучшает
внешний вид таблицы. Вы можете
выбрать то форматирование, какое
вам больше нравится.
Для автоматизации обработки
журнала воспользуемся автофильт-
ром. Щелкните мышью на любой
ячейке внутри списка, после чего выберите команду меню Данные ^> Фильтр Х£>
Автофильтр. В правой части каждой ячейки заголовка появится кнопка со
стрелкой , т-. При нажатии этой кнопки открывается список со значениями,
по которым можно отфильтровать журнал. Например, нажмите кнопку
w в столбце Дебет, и будет открыт список счетов (Рис. 4.2).
Выберите нужный счет, и в списке останутся только операции с использова-
нием данного счета по дебету. Чтобы снова показать все операции, следует снова
нажать кнопку w в столбце Дебет и выбрать элемент Все в открывающемся
списке. Вы можете выбрать одновременную фильтрацию по нескольким значе-
ниям, например по дебету одного счета и кредиту другого. Аналогично можно
отобрать операции с нужными датами или суммами. Можно задать более слож-
ное условие для фильтрации, выбрав элемент открывающегося списка Условие.
На экране появится диалог, в котором вы можете задать любое условие, напри-
мер сумма операции должна быть больше 100 и меньше 1000 или дата больше
1 января отчетного года.
После того, как отобраны только нужные записи, можно узнать сумму чисел
в столбце Сумма. Для этого введите в ячейку 12 формулу =ПРОМЕЖУТОЧ-
НЫЕ.ИТОГИ(9;Р:Р). В ячейке появится сумма ото-
бражаемых чисел по столбцу F. Выбирая разные
значения автофильтра, отбирая операции с нужны-
ми датами и счетами, вы сможете узнать обороты и
остатки по различным счетам. На основе этой ин-
формации можно составить вручную любой бух-
галтерский отчет. Таким способом можно за корот-
кое время выполнить минимальную автоматиза-
цию своей работы. Рассмотрим, как можно с помо-
щью Excel еще больше облегчить свой труд.
Вводить и редактировать операции в журнал
хозяйственных операций можно с помощью спе-
циальной формы. Щелкните мышью на любой
ячейке в списке операций и выберите команду ме-
В
Тт
~8
9
13.01Р
13.01
13.01
13U1
13.01
{Первые 10...)
(Условие...)
8
60
62
68
90
(Пустые)
(Непустые)
Рис. 4.2.
Автофильтр
223
Бухгалтерский, налоговый и управленческий учет в Excel
Р«с. 4.J.
Форма для ввода записей
в журнал операций
ню Данные :£> Форма. На экране появится диа-
лог, позволяющий вводить новые операции и
изменять введенные ранее (Рис. 4.3).
В заголовке диалога выводится название
листа, на котором расположен список. В левой
части диалога расположены поля, которые нуж-
но заполнить для ввода записи в журнал. Обра-
тите внимание, что заголовки полей взяты из
заголовков соответствующих столбцов табли-
цы. С помощью полосы прокрутки, располо-
женной правее, вы можете выбирать нужную
запись журнала. При этом номер записи и об-
щее количество записей выводятся в правом
верхнем углу программы, например / из 5. Для перехода к предыдущей и следу-
ющей записи можно также нажимать кнопки Назад и Далее, соответственно.
Кроме того, перейти к следующей записи можно, нажав клавишу Щ или ||Entet|.
Для перехода к предыдущей записи нужно нажать клавишу Щ.
Если вы внесете изменения в любое поле и перейдете к другой записи, все
изменения будут внесены в соответствующие ячейки таблицы. Чтобы отменить
изменения до того, как вы перешли к другой записи, нужно нажать кнопку Вер-
нуть. Нажав кнопку Удалить, вы удалите текущую запись из журнала. С помо-
щью этих приемов можно редактировать введенные ранее записи.
Если вы попытаетесь перейти к записи, следующей за последней, в диало-
ге появится сообщение Новая запись и все поля будут очищены. Введите нуж-
ные данные и нажмите кнопку Добавить. Нужная запись будет добавлена в ко-
нец списка и в диалоге вам будет предложено ввести еще одну запись. Так вы
можете ввести нужное количество записей в журнал, после чего нужно нажать
кнопку Закрыть, чтобы закрыть диалог и вернуться к работе с электронной
таблицей.
Аналогичные формы автоматически создаются для всех списков Excel. Если
вам больше нравится вводить данные в поля диалога, а не непосредственно в
ячейки таблицы, используйте это средство Excel. Достаточно щелкнуть мышью
внутри списка и выбрать команду меню Данные :£> Форма.
Рассмотрим еще один способ повышения эффективности работы. Часто
удобнее не вводить все данные какой-то операции, а скопировать строку в нуж-
ное место списка и изменить некоторые поля. Однако можно пойти еще дальше
в автоматизации работы. Так как часто вводятся однотипные операции, удобно
описать типовые операции и использовать их в дальнейшем. Переименуйте вто-
рой лист рабочей книги, назвав его Типовые операции, после чего перейдите на
этот лист. Создайте список типовых операций так же, как и журнал операций, но
не единым списком, а как отдельные строки с заголовками (Рис. 4.4).
При этом каждая операция может содержать одну или несколько проводок.
Дату и сумму можно задать любые, так как при добавлении операции эти поля
224
Пример бухгалтерского учета
Поступление
01.01 02 10 1
01.01 02
01.01 02
01.01.02
01.01.02
01.01.02
Поступление товаре»
О Передан материал
О Поступили товары
О Выделен НДС
О Поступило ОС
О Выделен НДС
О Зачтен аванс
НуЖНО будет ЗаПОЛНИТЬ. Выделив СТрО- ; * ; в ; с ъ о ; E _ L F: Типовые операции
ки, относящиеся к нужной операции,
нажмите кнопку Ц )̂ на панели инстру-
ментов, чтобы скопировать их в буфер
обмена. Перейдите на страницу журна-
ла операций и сделайте текущей первую
пустую ячейку в первом столбце, после
Ш
\ Приобре
. Новые стро-
ки будут добавлены в журнал операций.
После этого вручную измените даты и
суммы — и типовая операция добавлена •
в журнал Справочник типовых операций
Вы можете еще более автоматизи-
ровать работу с типовыми операциями, состоящими из нескольких проводок.
Для некоторых проводок можно добавить автоматическое вычисление суммы и
заполнение даты. Например, первая строка операции расположена на строке 16
листа Типовые операции, и следующие две строки также описывают проводки
данной операции. Введите в ячейку А17 формулу =А16, после чего подведите ука-
затель мыши к маркеру заполнения, расположенному в правом нижнем углу
ячейки А17. Нажмите кнопку мыши и переместите указатель мыши на ячейку
А18, после чего отпустите кнопку мыши. В ячейку А18 будет введена формула
=А17. Вы воспользовались средством автозаполнения ячеек. Теперь, как только
вы введете дату в первую строку данной типовой операции, такие же даты будут
заданы и для остальных строк.
Аналогично можно задать одинаковые суммы для всех проводок одной опе-
рации. Если в рамках операции следует проводить вычисления, например выде-
ление налогов, то и это действие можно автоматизировать. Например, чтобы вы-
делить 20% от суммы из ячейки F16, следует ввести в другую ячейку, например
F17, выражение =¥16*20%. При необходимости можно ввести достаточно слож-
ные формулы для расчета необходимых сумм. В этом случае после копирования
нескольких строк в журнал проводок требуется только заполнить дату и сумму в
первой строке типовой операции, а нужные значения в остальных строках будут
подставлены автоматически.
Автоматический расчет полей в типовых операциях имеет одно существен-
ное ограничение. Построенный таким способом журнал операций нельзя сор-
тировать. Если вы измените последовательность расположения записей, то
ссылки будут указывать на неверные ячейки. При этом можно добавлять и уда-
лять строки в журнал, но следует быть внимательным и не вставить новую стро-
ку между связанными строками типовой операции, а также не удалить одну из
строк типовой операции. Если вам не требуется сортировка операций в журна-
ле, удобнее автоматизировать расчеты в полях типовых операций. Если же сор-
тировка записей, например по дате, может потребоваться, все поля следует за-
полнять вручную.
225
Бухгалтерский, налоговый и управленческий учет в Excel
01 01 02
01 01.02
01.01.02
0101.02
01.01.02
01 ЛГ027
01.01.02
Журнал хозяйственных операций
Вспомогательная проводка
Вспомогательная проводка
Вспомогательная проводка
: Вспомогательная проводка
Вспомогательная проводка ;
: Вспомогательная проводка •
Вспомогательная проводка
Рис. 4.5.
Вспомогательные проводки
На основе журнала операций
можно построить практически лю-
бой бухгалтерский отчет. Рассмот-
рим, как можно автоматизировать
построение некоторых отчетов в
Excel. Построим шахматку, вос-
пользовавшись для этого средством
создания сводных таблиц в Excel.
Вначале следует добавить несколько вспомогательных проводок, в дебете и кре-
дите которых указан один и тот же счет. Дата проводок может быть произволь-
ной, а поле суммы не следует заполнять (Рис. 4.5). Необходимо таким способом
описать все используемые вами счета, после чего можно приступать к построе-
нию отчета.
Щелкните мышью на любой ячейке в списке операций, после чего выбери-
те команду меню Данные :£> Сводная таблица. Будет запущен мастер построения
сводных таблиц, и на экране появится его первый диалог. Отметим, что в разных
версиях Excel диалоги при построении сводной таблицы могут немного разли-
чаться. С помощью переключателей выберите создание сводной таблицы в спи-
ске Microsoft Excel и нажмите кнопку Далее, чтобы перейти ко второму шагу ма-
стера. В нем необходимо указать диапазон, содержащий исходные данные, то
есть ваш журнал операций. Программа автоматически определила границы вве-
денных данных, но лучше указать границы списка с запасом, чтобы вы смогли
добавить в журнал дополнительные записи. Введите в поле значение
$A$2:$G$ 10000. Построенный нами список начинается в ячейке А2, а заканчива-
ется в столбце G. Мы зарезервировали 10000 строк для описания операций. Вы
можете ввести иное значение для количества строк в журнале операций, после
чего нажмите кнопку Долее, чтобы продолжить работу мастера. В нем с помощью
переключателя следует указать, что таблица будет построена на новом листе, а
также настроить дополнительные параметры. Нажмите кнопку Макет, и бу-
дет открыт диалог формирования
столбцов и строк сводной таблицы
(Рис. 4.6). Если вы работаете с вер-
сией Excel 97, нужный диалог появ-
ляется при нажатии кнопки Далее.
С помощью мыши вы должны
перетащить поля с названиями
столбцов, расположенные справа, в
нужное место макета таблицы. Пе-
ретащите поле Дебет в левое поле
макета, с надписью Строка. Далее
перетащите поле Деб. СубСч. также
в поле Строка, чтобы оно располо-
жилось ниже поля Дебет. Анало-
CJgBMJug
Строка
KPP.WI ЬтЗв
ЬмюШйШ
Данные
i]
Рис. 4.6.
Настройка макета сводной таблицы
226
Пример бухгалтерского учета
гично перетащите поля Кредит и Кред. СубСч. в верхнее поле макета, с названи-
ем Столбец. Под конец перетащите поле Сумма в центральное поле макета с на-
званием Дойные. В сводной таблице можно вычислять максимум, минимум, про-
изведение и тому подобные вычисления. Нам же нужно рассчитать сумму. Для
этого дважды щелкните мышью на поле Количество по полю Сумма, которое по-
явилось внутри поля Данные, и будет открыт диалог выбора метода вычисления.
Выберите в списке Операция элемент Сумма, после чего нажмите кнопку ОКддя
закрытия диалога. В поле Данные теперь расположено поле Сумма по полю Сум-
ма. Макет таблицы готов, нажмите кнопку ОК, чтобы вернуться к мастеру пост-
роения сводной таблицы. В Excel 97 вы продолжали работать с мастером, так что
кнопки ОК нет, а значит и нажимать ее не надо. Нажмите кнопку Далее, чтобы
перейти к следующему шагу. В появившемся диалоге с помощью переключателя
выберите построение диаграммы на новом листе. Вся нужная информация вве-
дена, так что вам следует нажать кнопку Готово, и сводная таблица будет постро-
ена на новом листе.
В таком виде работать с таблицей не очень удобно. Лучше скрыть информа-
цию по субсчетам, оставив только данные по всем счетам. Щелкните правой
кнопкой мыши на заголовке Деб. Суб.Сч. и в открывшемся вспомогательном ме-
ню выберите команду Группа и структура т£> Скрыть детали. После этого щелк-
ните правой кнопкой мыши на заголовке Кред. Суб.Сч. и точно так же выберите
команду меню Группа и структура Х£> Скрыть детали. Теперь сводная таблица
стала похожа на шахматку (Рис. 4.7). На пересечении столбцов рассчитанные
суммы оборотов, в последнем столбце выведены дебетовые обороты, а в послед-
ней строке — кредитовые обороты. Можете переименовать лист со сводной таб-
лицей, назвав его Шахматка.
Для практических целей значительно полезнее не шахматка, а оборотная
ведомость. Рассмотрим, как можно построить оборотную ведомость на основе
информации из шахматки, но вначале добавим описание плана счетов, чтобы
использовать названия счетов в оборотной ведомости. Переименуйте остав-
шийся пустым лист в План счетов и перейдите на него. Введите заголовок План
счетов и заголовки столбцов Счет и Наименование. Щелкните правой кнопкой
SY«M«:l»j'
(IWCTO
1 to '9 К
«ОС
Л «
-42М.Ь том
41
7Ш
*
М
1КОЕ
И
17ЫМ
ео
WSK.3!
1ММО
еа
нам
ее
~^Ъ
твм
ч*
аяг
п
"
га 76
710! IS
ft
И
?3<щ
И И
вш
до
0вЩ1ЙетС'
1мда
9МО
3!Ж1
143вИ
1Э5ОТ
2WOW
7161 .42
•М80
Рис. 4.7. Шахматка
227
Бухгалтерский, налоговый и управленческий учет в Excel
мыши на заголовке столбца Л и выберите
во вспомогательном меню команду Фор-
Mam ячеек. Откроется диалог настройки
формата, в котором вы должны перейти
на вкладку Число. В списке выберите й«-
стовый и нажмите кнопку ОК. Теперь
числа в пеРвом столбце будут восприни-
13! 15:за.он.впвнвв и приобрвтвни^материапьмых ценностей^ i мяткга ьгяь' тртггт м RT.T г\/fПЖРТР RRPP-TMi l l M ° ™ < ^ « A ^ ^ J маться как текст, i вы сможете ввести
значения 01, 02 и аналогичные. Заполни-
Рис. 4.8. те план счетов, введя номера и описания
План счетов используемых счетов (Рис. 4.8). Субсчета
можно не вводить.
Далее можно приступать к созданию оборотной ведомости. Добавьте лист
в рабочую книгу и назовите его Оборотная ведомость. Введите в первой строке
заголовок ведомости, после чего следует ввести заголовки столбцов. В ячейку
A3 введите заголовок Счет, а в ячейку ВЗ — Наименование счета. Объедините
ячейки С2 и D2, выделив их и нажав кнопку Щ, и введите в них название Саль-
до на начало периода. Аналогично объедините попарно ячейки в четырех следу-
ющих столбцах и введите названия Обороты за период и Сальдо на конец перио-
да. В третьей строке введите в столбцах С, Е и G название Дебет, а в столбцах
D, Ги Нвведите название Кредит. Заголовок таблицы сформирован, и можно
приступать к введению формул. Следует ввести всего одну строку, после чего
размножить ее средством автозаполнения. Итак, заполним ячейки четвертой
строки таблицы.
Введите в ячейку ЛМ формулу =ТЕКСТ(Шахматка!А6;"00"). В ячейку будет
вставлен номер счета из первой строки шахматки, причем номер будет выглядеть
как 01, 02 и так далее, а не 1 или 2. Чтобы по номеру счета определить его наиме-
нование, в ячейку В2 введите формулу =ВПР(А4;'План счетов'!$А$3:$В$63;2).
Взяв номер счета из ячейки А4, Excel найдет на листе с планом счетов список, на-
чинающийся в ячейке A3 и заканчивающийся в ячейке В63. Если в вашем плане
счетов размер списка иной, поставьте нужное число с номером последней стро-
ки в списке вместо 63, например $В$55 или $В$101. В обнаруженном списке
Excel найдет строку, в первом столбце которой заданный номер счета, и выдаст
значение из второй ячейки таблицы, то есть название счета. Отметим, что для
правильной работы план счетов должен быть отсортирован в порядке возраста-
ния номеров. Если вы вводили последовательно все счета, он так и будет отсор-
тирован. Кстати, если при добавлении вспомогательных проводок в журнал опе-
раций, в которых указан одинаковый счет по дебету и кредиту, вы описали не все
счета, указанные в плане счетов, оборотная ведомость будет рассчитываться
неверно. Далее следует заполнить расчетные ячейки оборотной ведомости.
В столбцах Дебет и Кредит, объединенных заголовком Сальдо на начало периода,
ничего вводить не надо, так как начальное сальдо будет в дальнейшем вводиться
вручную.
228
Пример бухгалтерского учета
В ячейку Е4 введем формулу для расчета дебетовых оборотов за период
=ВПР(ЗНАЧЕН(А4);Шохматка!$А$6:$АА$28;27). Конкретные значения в фор-
муле зависят от количества используемых вами счетов. Взяв из поля А4 значение
номера счета, Excel ищет его в первом столбце сводной таблицы, то есть создан-
ной ранее шахматки. Сводная таблица у нас располагается до ячейки $АА$28.
В этой ячейке выводятся дебетовые обороты по счету с наибольшим номером.
Возможно, вам потребуется ввести иной адрес ячейки, например $¥$26. Будьте
внимательны, так как правильное указание адреса важно для выполнения вер-
ных вычислений. Последнее число в формуле указывает на номер столбца в
списке, из которого следует взять нужное значение. Если вы все делали пра-
вильно, сводная таблица должна содержать одинаковое количество строк и
столбцов, и данное число на единицу меньше номера последней используемой
строки. В нашем случае, при ссылке $АА$28, число равно 27. Если у вас получи-
лась ссылка $Y$26, то следует указать число 25. Если после ввода формулы вы
увидите в ячейке вместо числа текст #Н/Д, #ЗНАЧ! или #ССЫЛКА!, то вы не-
верно указали параметры. Исправьте формулу в соответствии с вашими кон-
кретными условиями.
Далее следует ввести кредитовые обороты. Для этого в ячейку F4 введите
формулу =ГПР(ЗНАЧЕН(А4);Шахматка!$С$4:$¥$30;27). Функция ГПР рабо-
тает почти так же, как и ВПР, но ищет не по строкам, а по столбцам. В отличие
от расчета дебетовых оборотов, в этой формуле ищется столбец в сводной таб-
лице, в первой строке которого указан нужный счет. В качестве результата под-
ставляется значение из последней строки сводной таблицы. Обратите внима-
ние, что в качестве списка выделена другая часть сводной таблицы. При расче-
те дебета из сводной таблицы не были взяты первые две строки, а теперь не
принимаются в расчет первые два столбца. Кроме того, последней ячейкой счи-
тается не та, в которой выводятся дебетовые обороты по счету с наибольшим
номером, а ячейка, в которой выводятся кредитовые обороты по данному сче-
ту. Если в первом случае вы подставили в формулу значение $Y$26, то теперь
следует подставить значение $W$28. Последнее число в формуле то же, что и в
предыдущей формуле.
Наиболее сложная часть оборотной ведомости описана. Вы ввели формулы
для расчета оборотов по дебету и кредиту. Если хотите, можете выделить ячейки
Е4 и F4, после чего задать формат для вывода целых чисел, чтобы в оборотной
ведомости не выводились копейки. Далее следует ввести формулы для расчета
конечного сальдо. Введите в ячейку G4 формулу =C4+E4-D4-F4, а в ячейку Н4
формулу =D4+F4-C4-E4. В результате в ячейках отображаются одинаковые чис-
ла, но с разными знаками. Чтобы не отображать нулевые и отрицательные сум-
мы, выделите ячейки G4 и Н4, после чего выберите команду меню Формат :а£>
Ячейки. В открывшемся диалоге перейдите на вкладку Число и выберите в спис-
ке Числовые форматы элемент (все форматы). В поле Тип введите шаблон фор-
мата 0;;. Ноль означает, что положительное число должно выводиться как целое
число. Два знака точки с запятой, после которых ничего не указано, означают,
229
Бухгалтерский, налоговый и управленческий учет в Excel
что нулевые и отрицательные значения не отображаются. Нажмите кнопку ОК,
и диалог закроется. Теперь из двух сумм отображается только положительная.
Если эта сумма в столбце дебета, то в столбце кредита ничего не отображается,
и наоборот.
Мы ввели формулы для одной строки, а теперь следует размножить их. Вы-
делите ячейки с А4 по Н4, подведите указатель мыши к маркеру заполнения, рас-
положенном в правом нижнем углу области выделения, после чего нажмите
кнопку мыши и переместите указатель вниз на несколько строк. Следует запол-
нить столько строк, сколько счетов используется в вашем плане счетов. Если в
нижних строках в ячейках появились сообщения #Н/Д, #ЗНАЧ!ыш #ССЫЛКА!,
вы заполнили слишком много ячеек, и лишние строки следует очистить.
Нам осталось только ввести формулы для подсчета сумм по столбцам. Вве-
дите в ячейку на пересечении столбца С и строки, расположенной через одну за
последней строкой таблицы, выражение =СУММ(С4:С26). Отметим, что вместо
С26 вы должны подставить номер последней строки в вашей таблице, например
С24. Перетащив маркер заполнения вправо, заполните ячейки в трех следующих
столбцах. Суммы по начальному сальдо и оборотам рассчитаны.
Для расчета сумм на конец периода следует ввести более сложную формулу.
Как вы помните, мы с помощью задания формата чисел не отображаем отрица-
тельные суммы, однако при расчетах отрицательные числа из ячеек также будут
суммироваться. Поэтому в ячейку суммы в столбце G следует ввести формулу
=СУММЕСЛИ(С4:С26;">0"). Так же, как и в предыдущей формуле, вам следует
\ Няинюмоыни» счете
: Основные средства
Вложения во внеоборотные активы
; Материалы
: Налог"на добавленную стоимость по
приобретенным ценностям
Основное производство
[Общехозяйственные расходы
: Выпуск продукции (работ, услуг)
Товары
Готовая продукция
Выполненные этапы по незавершенным работам
JKacca
'Расчетные счета
Расчеты с поставщиками и подрядчиками
Расчеты с покупателями и заказчиками
I Расчеты по налогам и сборам
; Расчеты по социальному страхованию и
обеспечению
: Расчеты с персоналом по оплате труда
; Расчеты с подотчетными лицами
; Расчеты с учредителями
:Расчеты с разными дебиторами и кредиторами
Уставный капитал
: Продажи
Прибыли и убытки
I - с •' "I и"'. Г". Е
Оборотная ведомость
Сяльдо нш начв/ю
'•. Кредит
4545;"
54345
54345
Обороты за период Сальдо на конец периоде
Зебет Кредит Дебет Кредит
40767;
40767
25000!
35660:
25229:
18767;
13796'
135000!
9800:
12600!
31360.
242600
243120!
86460:
34095
0
19500!
1500!
230000!
7161;
0!
438667
" ' о !
0
40767:
15350J''
26993
143961
17667-
5596
юооо Г
7500!
12600'
31143.
179060
295120
86460
17418
7713!
19500:
1500
222800
7161
2300о6
43860
4438
45312
9650
8667
10833
1100:
8200;
125000:
2300
217
117885
16676
7200
52000
77131
54345
234545!
4438
588901 58890 1297041 1297041 353040 353040
Рис. 4.9. Оборотная ведомость
230
Ведение налогового учета с помощью Excel
изменить значение G26 на адрес последней ячейки в столбце. В данной формуле
указывается, что следует суммировать только положительные значения из ячеек.
С помощью автозаполнения введете аналогичную формулу в столбец Н. Теперь
осталось ввести начальные остатки, и оборотная ведомость готова (Рис. 4.9).
Вы можете изменить проводки в журнале операций или ввести новые опера-
ции. После этого следует перейти на лист Шахматка, щелкнуть правой кнопкой
мыши на сводной таблице и выбрать команду меню Обновить данные. Сводная
таблица будет построена заново, при этом автоматически будет пересчитана обо-
ротная ведомость. На основе информации из оборотной ведомости можно пост-
роить множество полезных отчетов, но мы не будем сейчас этого делать. Вы мо-
жете самостоятельно создать стандартные бланки в Excel, воспользовавшись
приемами, описанными в предыдущей главе, и добавить ссылки на нужные
ячейки оборотной ведомости.
При ссылке на ячейки оборотной ведомости совершенно необязательно по-
мещать стандартные бланки в ту же рабочую книгу, в которой организован бух-
галтерский учет. Excel позволяет ссылаться на ячейки таблицы, расположенной
в другом файле. Например, если вы хотите вставить ссылку на ячейку G4 оборот-
ной ведомости, введите формулу = '[Бухгалтерский учет.х15]Оборотная ведо-
мость '!$G$4. Обратите внимание, что для использования в именах пробелов
нужно поместить названия в одинарные кавычки.
При открытии файла со ссылками на ячейки таблицы из другого файла, на
экране появится диалог с предупреждением. Вы можете обновить связи, получив
последние данные. Для этого нужно нажать кнопку Обновить в диалоге. При
этом диалог закроется, а в ячейках появятся последние данные из бухгалтерско-
го учета. Если же вы нажмете кнопку Не обновлять, то после закрытия диалога
информация в ячейках останется неизменной.
Рассмотренный пример показывает, что с помощью Excel можно автоматизи-
ровать различные участки бухгалтерского учета, причем качество автоматизации
ничем не хуже, чем при использовании специализированных бухгалтерских про-
грамм. Аналогично можно автоматизировать и налоговый учет, если в вашей про-
грамме он не реализован. При этом следует помнить, что возможности Excel зна-
чительно шире, и в нем можно использовать программы, написанные на языке
программирования Visual Basic. Однако написание таких программ требует опре-
деленных знаний, и лучше, чтобы этим занимался программист, а не бухгалтер.
4.2. Ведение налогового учета с помощью Excel
Налоговый учет доставляет много неприятностей бухгалтерам, и, к сожале-
нию, полностью решить все проблемы с помощью Excel не получается. Однако
кое в чем помочь Excel все же сможет, и мы постараемся описать основы ведения
налогового учета с использованием электронных таблиц Excel. Вначале рассмо-
231
Бухгалтерский, налоговый и управленческий учет в Excel
трим различные варианты ведения налогового учета в организации, после чего
опишем некоторые принципы использования Excel для автоматизации налого-
вого учета или его частей.
Если вы используете для бухгалтерского учета специализированные бухгал-
терские программы, лучше их же использовать и для налогового учета. Практи-
чески все современные программы позволяют это делать. Если вас не устраивает
реализация налогового учета в программах, можно попытаться получить из них
исходные данные и на основе этих данных автоматически организовать налого-
вый учет. На практике это сделать практически невозможно или, по крайней ме-
ре, очень сложно. Значительно проще вручную заполнить налоговую деклара-
цию, воспользовавшись данными бухгалтерского учета. Но при этом вам нужно,
согласно требованиям текущего законодательства, вести налоговые регистры.
В данном случае они ведутся только для того, чтобы показать их при проверке, а
не для работы. В качестве таких регистров можно использовать некоторые отчет-
ные формы, получаемые из бухгалтерской программы. Сформировав подходя-
щий отчет, вы можете экспортировать его в Excel и назвать регистром налогово-
го учета. При таком подходе описывать работу в Excel не нужно, так как почти
никакой работы не ведется.
Практически такие же рассуждения подходят и для случая, когда вы ведете
бухгалтерский учет в Excel. Вы можете скопировать журнал хозяйственных опе-
раций и назвать его регистром налогового учета. Некоторые данные в налоговой
декларации можно заполнить автоматически, на основании данных из оборот-
ной ведомости, а некоторые рассчитать вручную. Никаких трудностей такой
подход также не вызывает.
Если же вы хотите вести полноценный налоговый учет параллельно с бухгал-
терским, причем вас не устраивают встроенные в бухгалтерские программы
средства, для организации налогового учета можно использовать Excel. Однако
сразу стоит заметить, что параллельное ведение бухгалтерского и налогового уче-
та вряд ли целесообразно. Вам придется вести двойной учет исходных докумен-
тов — в журнале операций бухгалтерского учета и в регистрах налогового учета.
Кроме того, автоматизировать полностью весь налоговый учет с помощью Excel
вам вряд ли удастся.
Если вы все же хотите создать с помощью Excel систему налогового учета,
вначале нужно определиться, какая степень автоматизации вам нужна. Чем
меньше автоматизация, тем проще создать систему, но тем сложнее с ней рабо-
тать. Если же вы хотите облегчить работу с системой, полностью автоматизиро-
вав все вычисления, то приготовьтесь к тому, что вы много времени и сил потра-
тите на создание системы. При этом, вполне возможно, что вы так и не создади-
те работающую систему налогового учета.
В нашей книге мы не предлагаем готового решения, так как выбор того или
иного подхода к налоговому учету зависит от особенностей предприятия, а со-
здать универсальную систему чрезвычайно сложно. Мы только опишем несколь-
ко подходов к построению системы и рекомендуемые приемы, которые помогут
232
Ведение налогового учета с помощью Excel
построить вам такую систему. Следует отметить, что с точки зрения использова-
ния Excel налоговый учет достаточно прост. Однако большой объем обрабатыва-
емой информации может вызвать трудности при создании законченной системы
автоматизации налогового учета. При вводе сотни простых формул легко допус-
тить ошибку, которую в дальнейшем найти чрезвычайно сложно.
Построение системы следует начать с конца, то есть, отталкиваясь от нало-
говой декларации по налогу на прибыль организаций. Хотя вы можете самосто-
ятельно создать эту форму в Excel, вряд ли это целесообразно. Лучше найти го-
товую таблицу Excel и использовать ее в своих целях. Найти эту форму можно в
системах КонсультантПлюс, Гарант или похожей системе, а также в Интернете.
Отметим, что в Интернете по адресу www.consultant.ru/Online расположены ин-
формационные базы системы КонсультантПлюс, в том числе в бесплатном круг-
лосуточном доступе имеется база КонсультантПлюс:НалогиБухучет. Также мож-
но сходить на сайт Министерства по налогам и сборам, который расположен по
адресу www.nalog.ru. Осуществив поиск на этом сайте, можно найти нужный до-
кумент. Можно попытаться найти нужную форму и в других местах, а в крайнем
случае, можно создать ее самостоятельно, используя приемы, описанные в пре-
дыдущей главе.
После того, как вы создали или получили форму налоговой декларации,
нужно вставить в нее расчетные формулы. Некоторые ячейки ссылаются на дан-
ные из других ячеек этой же формы. В таком случае нужно вставить простые
формулы, например, если в таблице написано: «Итого прибыль (убыток) (стро-
ка 010-строка 020+строка 030-строка 040)», то в расположенном рядом поле
нужно ввести примерно такую формулу: =AZ13-AZ14+AZ15-AZ16. Конечно, у вас
могут использоваться адреса других ячеек, но общий принцип должен остаться
тем же. Возможно, в формулах будут использоваться ссылки на другие листы ра-
бочей книги, например =стр6!АХ81. Часть ячеек вы заполните таким способом,
но остальные ячейки нужно заполнить на основе данных налоговых регистров.
Лучше всего в остальные ячейки вставить примерно такие формулы:
= 'C:\Mou документы\[Регистры налоговогоучета.х1$]Лист!'!$G$3
То есть, в налоговой декларации используются ссылки на другие рабочие
книги Excel, в которых собственно и ведутся все расчеты. При этом Excel будет
предлагать вам обновить ссылки при каждом открытии файла с налоговой дек-
ларацией. После обновления ссылок в отчетной форме будет находиться самая
последняя информация, рассчитанная в других электронных таблицах на основе
информации из регистров налогового учета.
Просмотрев налоговую декларацию, вы должны определить, какие данные
вы можете рассчитать автоматически, а какие проще ввести вручную, рассчи-
тав их на основе различных имеющихся данных, без использования автомати-
зации. Если вы используете данные бухгалтерского учета для получения неко-
торых чисел, создайте дополнительную таблицу и введите нужные расчетные
формулы. При этом в расчетной таблице могут находиться ссылки на таблицу,
реализующую бухгалтерский учет, или на таблицу, экспортированную из бух-
233
Бухгалтерский, налоговый и управленческий учет в Excel
опимми»
выручч or рмлпицкн имущити
Рис. 4.10. Регистр налогового учета
галтерской программы. Данные из расчетной таблицы автоматически перено-
сятся в налоговую декларацию, так как в декларации имеются соответствую-
щие ссылки.
Если вы хотите вести налоговый учет, параллельный с бухгалтерским, в
простейшем случае можно создать один регистр. При этом нужно добавить
один столбец, в котором указывается шифр нужной строки налоговой деклара-
ции (Рис. 4.10, слева). Сумма из операции будет добавлена к значению в нуж-
ной строке. Например, если указан шифр п01с020, сумму нужно добавить в
строку 20 приложения № 1 к листу 02 налоговой декларации, то есть, в строку
с названием «выручка от реализации товаров (работ, услуг) собственного про-
изводства».
Чтобы автоматизировать суммирование, вначале на отдельном листе нужно
ввести варианты поиска (Рис. 4.10, справа). Каждый вариант состоит из заголов-
ка, повторяющего заголовок основной таблицы, и строки с шифром. Так как по-
иск будет осуществляться по значениям в одном столбце, достаточно ввести об-
разец этого столбца. Например, информация для поиска вводится на второй лист
рабочей книги. При этом в ячейку A3 вводится название Код строки налоговой
декларации, а в ячейку А4 вводится шифр п01с020. При этом на первом листе рас-
положен регистр, в котором также есть столбец с заголовком Код строки налого-
вой декларации и разными кодами в различных строках.
Чтобы рассчитать нужную сумму, следует использовать выражение
=БДСУММ(ЛистШ4:Н1000;7;Лист2!АЗ:А4). Функция БДСУММ находит в
ячейках с А4 по Н6 на первом листе строки, в которых используется нужный код
строки, и суммирует значения седьмого столбца в этих строках. Так, мы вычис-
ляем сумму операций, для которых указан определенный шифр в первом столб-
це. Аналогично можно описать нужные расчеты по остальным строкам налого-
вой декларации. Для этого нужно в качестве последнего аргумента указать дру-
гой образец со второго листа.
Основной недостаток описанного метода — необходимость при вводе каждой
операции помнить шифр строки налоговой декларации. При этом можно допус-
тить ошибку, которую в дальнейшем достаточно сложно найти. Однако данный
метод легко автоматизировать, что и является его главным достоинством.
Другим крайним случаем реализации налогового учета является ведение
большого количества регистров, в каждом из которых отражаются только опера-
ции, относящиеся к одной конкретной строке налоговой декларации. В этом
случае суммы легко вычислить с помощью функций СУММ или СУММЕСЛИ, но
вести десятки налоговых регистров достаточно утомительно.
234
Пример управленческого учета
Промежуточный вариант реализации налогового учета заключается в веде-
нии всего нескольких регистров, например можно создать следующие регистры:
Доходы от реализации, Расходы, уменьшающие сумму доходов от реализации, Вне-
реализационные доходы, Внереализационные расходы и так далее. В каждом из та-
ких регистров следует использовать дополнительные признаки, позволяющие
относить суммы к конкретным строкам налоговой декларации. Для получения
сумм удобно использовать функцию БДСУММ, описанную выше. Регистры
удобно расположить на разных листах одной рабочей книги Excel, выделив от-
дельный лист для расчетов и еще один лист для информации, нужной для поис-
ка с помощью функции БДСУММ.
Иногда удобнее не добавлять дополнительные признаки, а вносить суммы
в разные столбцы таблицы. Например, выручка от реализации товаров, работ
и услуг собственного производства заносится в один столбец, а выручка от ре-
ализации покупных товаров заносится в другой столбец, и так далее. При этом
для определения требуемой суммы нужно просто вычислить сумму по кон-
кретному столбцу. Таблица в таком методе автоматизации сильно увеличится,
но заполнять ее будет проще. Кроме того, проще будет вычислить нужные
суммы.
Выбор того или иного способа автоматизации налогового учета зависит от
особенностей вашего предприятия, но, скорее всего, вы выберете вариант, час-
тично автоматизирующий учет. Полная автоматизация слишком трудоемка и
вряд ли необходима. Проанализируйте налоговую декларацию и определите, ка-
кие поля заполняются на вашем предприятии и как они рассчитываются. Далее
определите состав налоговых регистров и данные, автоматически рассчитываю-
щиеся на их основе. Далее следует создать электронные таблицы Excel, руковод-
ствуясь нашими рекомендациями, и налоговый учет на вашем предприятии
можно считать автоматизированным. Однако еще раз отметим, что значительно
удобнее для налогового учета использовать специализированные бухгалтерские
программы, так как в этом случае вам не придется вводить повторно всю нужную
информацию.
4.3. Пример управленческого учета
Под управленческим учетом в различных организациях понимают совер-
шенно разные вещи. Иногда управленческий учет ведется точно так же, как и
бухгалтерский, но в него включаются все без исключения операции, в том числе
и те, которые по разным причинам не отражены в бухгалтерском учете. В этом
случае для управленческого учета можно использовать бухгалтерскую програм-
му, фактически ведя учет еще одного предприятия. Также можно использовать
Excel, построив учет на основе таблицы, предложенной для ведения бухгалтер-
ского учета и описанный в начале главы.
235
Бухгалтерский, налоговый и управленческий учет в Excel
• * '••* -| i о L E J В некоторых организациях управ-
1 Расходы за отчетный период
{'.»*, с,„«. *»«» с*»» ..««.ч»* »«5'«г ленческий учет тесно связан с финан-
4 - 1 1000 Выдано на закупку бумаги Закупки и продажи -4 083 05Л
13 г -г»а*»,»,«т,™ г******* зя^га совым анализом и прогнозированием.
Для этих целей используются специа-
D»л А 11
лизированные финансовые програм-
Резулыпаты расчетов _
мы. Хотя с помощью Excel можно по-
строить систему финансового анализа любой сложности, это потребует слишком
много усилий. Лучше воспользоваться готовыми системами финансового анали-
за на основе Excel, попытавшись найти их в Интернете.
Часто на предприятии автоматизированы только фрагменты управленческо-
го учета. Именно в этих случаях наиболее полезным становится Excel. Некото-
рые из примеров, рассмотренных в предыдущей главе, могут использоваться в
системе управленческого учета, автоматизируя ее различные фрагменты. Опи-
санный ниже пример также позволяет вести простой учет доходов и расходов,
который можно назвать управленческим учетом.
Мы опишем учет работы оптовой торговой фирмы, закупающей товары
крупным оптом и продающей их поставщикам мелкими партиями. В зависимо-
сти от объема партии, автоматически вычисляются оптовые скидки. Кроме того,
в таблице учитываются прочие расходы и доходы предприятия, не связанные с
закупкой и продажей партий товаров.
На первом листе рабочей книги в списке вводятся все расходы, не связанные
с покупкой и продажей товаров (Рис. 4.11). Никакой автоматизации не предус-
мотрено, просто в первые три столбца, в строки, начиная с четвертой, заносится
информация о расходах. Если получен доход, он вносится со знаком минус. При
желании можно автоматизировать нумерацию записей, введя в ячейку А4 форму-
лу =ЕСЛИ(В4<>"";1;""), в ячейку А5 формулу =ЕСЛИ(В5О"";А4+1;""), и раз-
множив формулу в расположенные ниже ячейки с помощью автозаполнения. Та-
ким образом, если вы введете название в столбец В, в соответствующей ячейке
столбца А появится порядковый номер.
В ячейки столбца D вводятся названия итоговых показателей, а в ячейки
столбца ̂ вводятся формулы для вычислений. Введите в ячейку ЕЗ сумму, имею-
щуюся на начало периода, а в ячейку Е4 формулу =СУММ(ЛистЗ!Р4:Р1000). На
третьем листе рабочей книги мы в дальнейшем организуем учет закупок и про-
даж. В ячейку Е5 введите формулу =ЕЗ-СУММ(В4:В1000)+Е4. Из начальной
суммы вычитаются все расходы и добавляется результат закупок и продаж. Все
чрезвычайно просто.
Далее перейдите на второй лист рабочей книги Excel. На нем мы введем ис-
ходные данные для расчетов. Нужно ввести все товары, которыми торгует фир-
ма, их отпускные и закупочные цены (Рис. 4.12). Введите заголовки таблицы,
названия товаров, их розничные цены и закупочные цены. В третью строку вве-
дите верхние границы размера партии товара, в то время, как во второй строке
вводится просто текстовое описание. В четвертой строке вводятся проценты
скидок.
236
Пример управленческого учета
Вы также можете вручную ввес- ... i А ; в < с : 0 ; Е ; „г j1 I Прейскурант
ти оптовые цены, но мы в приме- у «°10 '°Г1да5° "m"*"00 ST°°
|Л£» отзтнг\\латтл тттп\7АЛ* dTA7 тт1лг»тт£>ттл7Г|Л7 •УТоваРы "̂  3% 5% 10% Закупочная ценаре автоматизируем эту процедуру. 5 тта»»!, шоо 12319 «ои шзо юош
т^ -,_ 6 Магнитофон 1400 1358 1330 1280 1000В ячейку С.5 введите формулу i .awo.»™™*»» ?5ш ?2?5 /i» в?» «т
8 Муз. центр 9700 9409 9215 8730 7900
=$В5*(1-С$4). Из розничной цены
вычитается скидка, и получается оп- Рис. 4.12.
товая цена. Смешанная адресация Прейскурант
используется для облегчения автоза-
полнения. Скопируйте с помощью автозаполнения формулу из ячейки С5 в
ячейки пятой строки, до Е5 включительно. Далее выделите ячейки с С5 до Е5 и
с помощью автозаполнения размножьте формулы на все строки с описанием то-
варов. Прейскурант заполнен, и можно приступать к созданию таблицы учета
закупок и продаж.
Перейдите на третий лист рабочей книги и введите заголовки таблицы
(Рис. 4.13, слева). В ячейку А4 введите =ЕСЛИ(В4<>"";1;""), а в ячейку А5 введи-
те =ЕСЛИ(В5О"";А4+1;""). С помощью автозаполнения размножьте формулу
из ячейки А5 в расположенные ниже ячейки. Как и для списка с первого листа,
мы создали автоматическую нумерацию введенных записей.
Во втором столбце нужно ввести тип операции — Закупка или Продажа. Что-
бы упростить ввод, воспользуемся средством проверки вводимых значений. Сде-
лайте текущей ячейку В4, щелкнув на ней мышью, и выберите команду меню
Данные 1£> Проверка, чтобы открыть диалог настройки проверки вводимых зна-
чений. На вкладке Параметры этого диалога выберите в списке Тип данных вари-
ант Список. Этим вы укажете, что в данную ячейку можно вводить значения толь-
ко из определенного списка. Далее нужно указать, какой список используется.
Введите в поле Источник выражение Закупка; Продажа. Вы создали список из
двух элементов. Установите флажок Список допустимых значений, и нажмите
кнопку ОК. Диалог закроется, и теперь вы не сможете ввести в ячейку непра-
вильное значение. Р„™~
Когда вы сделаете активной ячейку В4, правее ячейки появится кнопка ]-w\.
Нажав ее, вы откроете список возможных вариантов (Рис. 4.13, справа). Выбери-
те вариант, список закроется, и нужный вариант будет вставлен в ячейку. Попы-
тайтесь ввести неверное значение, и Excel сообщит об ошибке. Ничего, кроме
указанных двух слов, вы ввести не сможете.
; А ; в s с : . г : р
1 '••... „. Движение товаров £• ̂ 5е l¥c£n «̂ ^̂  ?
3 NSn/n Операция Количество Наименование Сумма 311ТООДЗЖЭ I "Т
4" 1 Продажа " ~ 234 Телевизор 2882646; .1 Г П и «""''"•
5 ; 2 Закупка 2000 Видеомагнитофон -12000000 |̂ ЗЭКУПКЭ
6 j 3 Продажа 232 Видеомагнитофон 1687800
7 J 4 Продажа 40 Видеомагнитофон • J91000J
8 ; 5 Продажа 120 Видеомагнитофон^ 873000]
9 6 Продажа 300 Видеомагнитофон д 2182500
Рис. 4.13. Основная расчетная таблица
237
Бухгалтерский, налоговый и управленческий учете Excel
Количество товара в столбце С вводится вручную, а наименование товара
также выбирается из списка. Вначале нужно перейти на второй лист, на котором
расположен прейскурант. Выделите ячейки с названиями товаров, расположен-
ные в первом столбце в строках, начиная с пятой. Вы можете выделить строки с
запасом, чтобы в дальнейшем можно было бы добавить описание новых товаров.
Далее введите в поле имени, расположенное в левой части строки формул, имя
Товары. Так вы присвоили имя выделенным ячейкам.
Вернитесь на третий лист, сделайте активной ячейку D4 и выберите команду
меню Данные э£> Проверка. Выберите в списке Tun данных вариант Список, а в по-
ле Источник введите выражение =Товары. Установите флажок Игнорировать пус-
тые ячейки и флажок Список допустимых значений, после чего нажмите кнопку ОК.
Диалог закроется, и для ввода в ячейку можно будет использовать список товаров.
Далее нужно ввести формулу для расчета суммы. В принципе, можно ис-
пользовать одну формулу, но она получится слишком длинной. Для удобства мы
разбили формулу на несколько частей, и занесли их в разные ячейки. При этом
результаты расчетов в столбцах FVL G имеют вспомогательный характер, и лучше
эти столбцы не отображать, выбрав белый цвет шрифта или скрыв столбцы. При
этом надо помнить, что формулы в ячейках должны обязательно присутствовать.
Введите в ячейку G4 формулу
=ЕСЛИ(В4= "Закупка ";6;ЕСЛИ(С4>Лист2!$О$3;5;
ЕСЛИ(С4>Лист2!$С$3;4;ЕСЛИ(С4>Лист2!$В$3;3;2))))
Так мы определим, какой столбец прейскуранта нам нужен. Если выбрана
закупка, нужен шестой столбец, то есть закупочная цена товара. В противном
случае, если продается больше, чем 100 экземпляров, цена выбирается из пятого
столбца. Если меньше, то проверяется количество с помощью следующей функ-
ции. Если больше, чем 50 экземпляров, цена выбирается из четвертого столбца и
так далее. В результате мы получили номер нужного столбца прейскуранта. Да-
лее в ячейку F4 введите формулу
=ЕСЛИ(В4< > "";ЕСЛИ(В4= "Закупка ";
-ВПР(П4;Лист2!$А$5:$Р$100;С4;ЛОЖЬ);
ВПР(О4;Лист2!$А$5:$Р$100;С4;ЛОЖЬ)) *С4;"")
Если операция не определена, в ячейке выводится пробел. В противном слу-
чае, с помощью формулы ВПР(О4;Лист2!$А$5:$Р$100;С4;ЛОЖЬ) находится
нужная цена. Ищется строка, в которой в первой ячейке то же название, что и в
D4, и берется число из столбца с номером G4. Причем, если произведена закуп-
ка, число меняет знак. Полученная сумма умножается на содержимое ячейки С4,
то есть на количество. В результате мы получаем сумму описанной операции.
Введите в ячейку Е4 формулу =ЕСЛИ(ЕНД(Р4); "";F4). Если нужная строка в
прейскуранте найдена, выводится сумма, в противном случае ячейка будет пус-
той. Эта проверка добавлена, чтобы в таблице никогда не появлялись ошибки
типа #Н/Д.
Очистите ячейки В4, С4 и D4. Выделите ячейки с В4 по G4 и, с помощью ав-
тозаполнения, размножьте информацию из них в расположенные ниже строки.
238
Пример управленческого учета
При этом нужно заполнить все строки, которые в дальнейшем могут использо-
ваться, например 100 или 1000 строк. Скройте вспомогательные столбцы, если
вы не сделали этого раньше. Теперь вы готовы к работе с таблицей.
В очередной строке списка вначале вы должны выбрать тип операции — за-
купку или продажу. Далее вы вводите количество и выбираете в списке товар. Все
остальные данные будут вычислены автоматически. Вы можете перейти на пер-
вый лист рабочей книги и убедиться, что данные о закупках и продажах внесены
в общую сумму.
Описанный пример только демонстрирует возможные приемы при автома-
тизации управленческого учета. В настоящее время нет никаких единых реко-
мендаций по ведению этого вида учета на разных предприятиях, поэтому вам
придется самостоятельно налаживать управленческий учет, руководствуясь сво-
им видением этой проблемы. Если вы при этом используете приемы, описанные
в этом примере и в примерах, рассмотренных выше, вы сможете существенно об-
легчить построение системы управленческого учета.
Б У Х Г А Л Т Е Р С К А Я П А Н О Р А М А
А.О. Коцюбинский, С.В. Грошев
EXCEL ДЛЯ БУХГАЛТЕРА
В ПРИМЕРАХ
Ответственный за выпуск Е.Н. Волкова
Редактор А.Ю. Федосов
Верстка Н.В. Молоканова
Корректор Л.В. Федосова
ЗАО «Издательский Дом «Главбух»
103051, Москва, Б. Сухаревский пер., 2/24
Тел.(095)785-01-13
www.glavbukh.ru
Подписано в печать 30.01.2003 г.
Бумага офсетная. Формат 70x108/16. Гарнитура «Ньютон»
Печать офсетная. Печ. л. 15,0. Тираж 5000 экз. Заказ № 5458
Отпечатано с готовых диапозитивов в ОАО «Типография «Новости»
107005, Москва, ул. Фр. Энгельса, 46
Грошев С.В.
Начиная с 1995 года, А.О. Коцюбинский и С.В. Гро-
шев написали более двадцати книг, посвященных
разным направлениям профессиональной деятель-
ности, связанной с работой на компьютере. Многие
из этих книг стали бестселлерами, а общий тираж
изданий составил более 400 000 экземпляров, что
лучше всего говорит об их популярности.
Коцюбинский А
Данная книга поможет освоить электронные таблицы Excel,
причем особое внимание уделяется практическим вопросам по-
вседневного использования Excel в работе бухгалтера. Книга
предназначена для широкого круга читателей, как только начав-
ших изучение Excel, так и достаточно опытных пользователей, по-
вышающих свою квалификацию.
Основы работы с электронными таблицами Excel изложены
в первой главе книги. В ней представлены основные понятия
и правила работы, подробно описан процесс создания и редакти-
рования таблиц, а также особенности их оформления. Отдельный
раздел посвящен расчетам в электронных таблицах. Во второй
главе книги описаны особенности Excel, полезные бухгалтеру.
Рассмотрены разные средства автоматизации работы и повыше-
ния эффективности использования Excel, использование списков,
сложных формул и сводных таблиц. Также описана работа с фор-
мами, рисунками и диаграммами.
Третья глава целиком посвящена примерам использования
Excel в бухгалтерии. Известно, что лучше изучать приемы работы
с программой на примерах, и бухгалтеру понятнее примеры из его
профессиональной области. Описано создание бухгалтерских
бланков и автоматизация составления документов, проведение
анализа и поиск приемлемых решений. Также описана автомати-
зация отдельных направлений деятельности и связь Excel с попу-
лярными бухгалтерскими программами. Многочисленные приме-
ры не только облегчат изучение Excel, но и могут быть использова-
ны в работе, практически без каких-либо доработок. Вы легко
сможете автоматизировать расчет зарплаты, учет поставок и на-
личия товаров, учет и амортизацию основных средств, расчет се-
бестоимости и многие другие операции, воспользовавшись пред-
лагаемыми электронными таблицами. В четвертой главе описаны
примеры ведения бухгалтерского, налогового и управленческого
учета в Excel.
ISSN ОЕЗЧ-5ЧЗЧ
